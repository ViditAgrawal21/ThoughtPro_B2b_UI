/*! For license information please see main.f3eb8063.js.LICENSE.txt */
(()=>{"use strict";var e={4:(e,t,a)=>{var r=a(853),n=a(43),s=a(950);function i(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var a=2;a<arguments.length;a++)t+="&args[]="+encodeURIComponent(arguments[a])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function l(e){var t=e,a=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(a=t.return),e=t.return}while(e)}return 3===t.tag?a:null}function c(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function u(e){if(31===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function d(e){if(l(e)!==e)throw Error(i(188))}function f(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=f(e)))return t;e=e.sibling}return null}var h=Object.assign,m=Symbol.for("react.element"),p=Symbol.for("react.transitional.element"),g=Symbol.for("react.portal"),v=Symbol.for("react.fragment"),y=Symbol.for("react.strict_mode"),b=Symbol.for("react.profiler"),w=Symbol.for("react.consumer"),x=Symbol.for("react.context"),k=Symbol.for("react.forward_ref"),S=Symbol.for("react.suspense"),E=Symbol.for("react.suspense_list"),T=Symbol.for("react.memo"),N=Symbol.for("react.lazy");Symbol.for("react.scope");var j=Symbol.for("react.activity");Symbol.for("react.legacy_hidden"),Symbol.for("react.tracing_marker");var C=Symbol.for("react.memo_cache_sentinel");Symbol.for("react.view_transition");var _=Symbol.iterator;function A(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=_&&e[_]||e["@@iterator"])?e:null}var P=Symbol.for("react.client.reference");function R(e){if(null==e)return null;if("function"===typeof e)return e.$$typeof===P?null:e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case v:return"Fragment";case b:return"Profiler";case y:return"StrictMode";case S:return"Suspense";case E:return"SuspenseList";case j:return"Activity"}if("object"===typeof e)switch(e.$$typeof){case g:return"Portal";case x:return e.displayName||"Context";case w:return(e._context.displayName||"Context")+".Consumer";case k:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case T:return null!==(t=e.displayName||null)?t:R(e.type)||"Memo";case N:t=e._payload,e=e._init;try{return R(e(t))}catch(a){}}return null}var O=Array.isArray,D=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,F=s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,I={pending:!1,data:null,method:null,action:null},L=[],M=-1;function z(e){return{current:e}}function U(e){0>M||(e.current=L[M],L[M]=null,M--)}function B(e,t){M++,L[M]=e.current,e.current=t}var W,H,V=z(null),G=z(null),$=z(null),q=z(null);function Y(e,t){switch(B($,t),B(G,e),B(V,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?vd(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)e=yd(t=vd(t),e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}U(V),B(V,e)}function X(){U(V),U(G),U($)}function K(e){null!==e.memoizedState&&B(q,e);var t=V.current,a=yd(t,e.type);t!==a&&(B(G,e),B(V,a))}function J(e){G.current===e&&(U(V),U(G)),q.current===e&&(U(q),df._currentValue=I)}function Q(e){if(void 0===W)try{throw Error()}catch(a){var t=a.stack.trim().match(/\n( *(at )?)/);W=t&&t[1]||"",H=-1<a.stack.indexOf("\n    at")?" (<anonymous>)":-1<a.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+W+e+H}var Z=!1;function ee(e,t){if(!e||Z)return"";Z=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var r={DetermineComponentFrameRoot:function(){try{if(t){var a=function(){throw Error()};if(Object.defineProperty(a.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(a,[])}catch(n){var r=n}Reflect.construct(e,[],a)}else{try{a.call()}catch(s){r=s}e.call(a.prototype)}}else{try{throw Error()}catch(i){r=i}(a=e())&&"function"===typeof a.catch&&a.catch(function(){})}}catch(o){if(o&&r&&"string"===typeof o.stack)return[o.stack,r.stack]}return[null,null]}};r.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var n=Object.getOwnPropertyDescriptor(r.DetermineComponentFrameRoot,"name");n&&n.configurable&&Object.defineProperty(r.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var s=r.DetermineComponentFrameRoot(),i=s[0],o=s[1];if(i&&o){var l=i.split("\n"),c=o.split("\n");for(n=r=0;r<l.length&&!l[r].includes("DetermineComponentFrameRoot");)r++;for(;n<c.length&&!c[n].includes("DetermineComponentFrameRoot");)n++;if(r===l.length||n===c.length)for(r=l.length-1,n=c.length-1;1<=r&&0<=n&&l[r]!==c[n];)n--;for(;1<=r&&0<=n;r--,n--)if(l[r]!==c[n]){if(1!==r||1!==n)do{if(r--,0>--n||l[r]!==c[n]){var u="\n"+l[r].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=r&&0<=n);break}}}finally{Z=!1,Error.prepareStackTrace=a}return(a=e?e.displayName||e.name:"")?Q(a):""}function te(e,t){switch(e.tag){case 26:case 27:case 5:return Q(e.type);case 16:return Q("Lazy");case 13:return e.child!==t&&null!==t?Q("Suspense Fallback"):Q("Suspense");case 19:return Q("SuspenseList");case 0:case 15:return ee(e.type,!1);case 11:return ee(e.type.render,!1);case 1:return ee(e.type,!0);case 31:return Q("Activity");default:return""}}function ae(e){try{var t="",a=null;do{t+=te(e,a),a=e,e=e.return}while(e);return t}catch(r){return"\nError generating stack: "+r.message+"\n"+r.stack}}var re=Object.prototype.hasOwnProperty,ne=r.unstable_scheduleCallback,se=r.unstable_cancelCallback,ie=r.unstable_shouldYield,oe=r.unstable_requestPaint,le=r.unstable_now,ce=r.unstable_getCurrentPriorityLevel,ue=r.unstable_ImmediatePriority,de=r.unstable_UserBlockingPriority,fe=r.unstable_NormalPriority,he=r.unstable_LowPriority,me=r.unstable_IdlePriority,pe=r.log,ge=r.unstable_setDisableYieldValue,ve=null,ye=null;function be(e){if("function"===typeof pe&&ge(e),ye&&"function"===typeof ye.setStrictMode)try{ye.setStrictMode(ve,e)}catch(t){}}var we=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(xe(e)/ke|0)|0},xe=Math.log,ke=Math.LN2;var Se=256,Ee=262144,Te=4194304;function Ne(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return 261888&e;case 262144:case 524288:case 1048576:case 2097152:return 3932160&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function je(e,t,a){var r=e.pendingLanes;if(0===r)return 0;var n=0,s=e.suspendedLanes,i=e.pingedLanes;e=e.warmLanes;var o=134217727&r;return 0!==o?0!==(r=o&~s)?n=Ne(r):0!==(i&=o)?n=Ne(i):a||0!==(a=o&~e)&&(n=Ne(a)):0!==(o=r&~s)?n=Ne(o):0!==i?n=Ne(i):a||0!==(a=r&~e)&&(n=Ne(a)),0===n?0:0!==t&&t!==n&&0===(t&s)&&((s=n&-n)>=(a=t&-t)||32===s&&0!==(4194048&a))?t:n}function Ce(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function _e(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function Ae(){var e=Te;return 0===(62914560&(Te<<=1))&&(Te=4194304),e}function Pe(e){for(var t=[],a=0;31>a;a++)t.push(e);return t}function Re(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Oe(e,t,a){e.pendingLanes|=t,e.suspendedLanes&=~t;var r=31-we(t);e.entangledLanes|=t,e.entanglements[r]=1073741824|e.entanglements[r]|261930&a}function De(e,t){var a=e.entangledLanes|=t;for(e=e.entanglements;a;){var r=31-we(a),n=1<<r;n&t|e[r]&t&&(e[r]|=t),a&=~n}}function Fe(e,t){var a=t&-t;return 0!==((a=0!==(42&a)?1:Ie(a))&(e.suspendedLanes|t))?0:a}function Ie(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Le(e){return 2<(e&=-e)?8<e?0!==(134217727&e)?32:268435456:8:2}function Me(){var e=F.p;return 0!==e?e:void 0===(e=window.event)?32:jf(e.type)}function ze(e,t){var a=F.p;try{return F.p=e,t()}finally{F.p=a}}var Ue=Math.random().toString(36).slice(2),Be="__reactFiber$"+Ue,We="__reactProps$"+Ue,He="__reactContainer$"+Ue,Ve="__reactEvents$"+Ue,Ge="__reactListeners$"+Ue,$e="__reactHandles$"+Ue,qe="__reactResources$"+Ue,Ye="__reactMarker$"+Ue;function Xe(e){delete e[Be],delete e[We],delete e[Ve],delete e[Ge],delete e[$e]}function Ke(e){var t=e[Be];if(t)return t;for(var a=e.parentNode;a;){if(t=a[He]||a[Be]){if(a=t.alternate,null!==t.child||null!==a&&null!==a.child)for(e=Id(e);null!==e;){if(a=e[Be])return a;e=Id(e)}return t}a=(e=a).parentNode}return null}function Je(e){if(e=e[Be]||e[He]){var t=e.tag;if(5===t||6===t||13===t||31===t||26===t||27===t||3===t)return e}return null}function Qe(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(i(33))}function Ze(e){var t=e[qe];return t||(t=e[qe]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function et(e){e[Ye]=!0}var tt=new Set,at={};function rt(e,t){nt(e,t),nt(e+"Capture",t)}function nt(e,t){for(at[e]=t,e=0;e<t.length;e++)tt.add(t[e])}var st=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),it={},ot={};function lt(e,t,a){if(n=t,re.call(ot,n)||!re.call(it,n)&&(st.test(n)?ot[n]=!0:(it[n]=!0,0)))if(null===a)e.removeAttribute(t);else{switch(typeof a){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var r=t.toLowerCase().slice(0,5);if("data-"!==r&&"aria-"!==r)return void e.removeAttribute(t)}e.setAttribute(t,""+a)}var n}function ct(e,t,a){if(null===a)e.removeAttribute(t);else{switch(typeof a){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+a)}}function ut(e,t,a,r){if(null===r)e.removeAttribute(a);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(a)}e.setAttributeNS(t,a,""+r)}}function dt(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function ft(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function ht(e){if(!e._valueTracker){var t=ft(e)?"checked":"value";e._valueTracker=function(e,t,a){var r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&"undefined"!==typeof r&&"function"===typeof r.get&&"function"===typeof r.set){var n=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return n.call(this)},set:function(e){a=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return a},setValue:function(e){a=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e,t,""+e[t])}}function mt(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var a=t.getValue(),r="";return e&&(r=ft(e)?e.checked?"true":"false":e.value),(e=r)!==a&&(t.setValue(e),!0)}function pt(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}var gt=/[\n"\\]/g;function vt(e){return e.replace(gt,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function yt(e,t,a,r,n,s,i,o){e.name="",null!=i&&"function"!==typeof i&&"symbol"!==typeof i&&"boolean"!==typeof i?e.type=i:e.removeAttribute("type"),null!=t?"number"===i?(0===t&&""===e.value||e.value!=t)&&(e.value=""+dt(t)):e.value!==""+dt(t)&&(e.value=""+dt(t)):"submit"!==i&&"reset"!==i||e.removeAttribute("value"),null!=t?wt(e,i,dt(t)):null!=a?wt(e,i,dt(a)):null!=r&&e.removeAttribute("value"),null==n&&null!=s&&(e.defaultChecked=!!s),null!=n&&(e.checked=n&&"function"!==typeof n&&"symbol"!==typeof n),null!=o&&"function"!==typeof o&&"symbol"!==typeof o&&"boolean"!==typeof o?e.name=""+dt(o):e.removeAttribute("name")}function bt(e,t,a,r,n,s,i,o){if(null!=s&&"function"!==typeof s&&"symbol"!==typeof s&&"boolean"!==typeof s&&(e.type=s),null!=t||null!=a){if(!("submit"!==s&&"reset"!==s||void 0!==t&&null!==t))return void ht(e);a=null!=a?""+dt(a):"",t=null!=t?""+dt(t):a,o||t===e.value||(e.value=t),e.defaultValue=t}r="function"!==typeof(r=null!=r?r:n)&&"symbol"!==typeof r&&!!r,e.checked=o?e.checked:!!r,e.defaultChecked=!!r,null!=i&&"function"!==typeof i&&"symbol"!==typeof i&&"boolean"!==typeof i&&(e.name=i),ht(e)}function wt(e,t,a){"number"===t&&pt(e.ownerDocument)===e||e.defaultValue===""+a||(e.defaultValue=""+a)}function xt(e,t,a,r){if(e=e.options,t){t={};for(var n=0;n<a.length;n++)t["$"+a[n]]=!0;for(a=0;a<e.length;a++)n=t.hasOwnProperty("$"+e[a].value),e[a].selected!==n&&(e[a].selected=n),n&&r&&(e[a].defaultSelected=!0)}else{for(a=""+dt(a),t=null,n=0;n<e.length;n++){if(e[n].value===a)return e[n].selected=!0,void(r&&(e[n].defaultSelected=!0));null!==t||e[n].disabled||(t=e[n])}null!==t&&(t.selected=!0)}}function kt(e,t,a){null==t||((t=""+dt(t))!==e.value&&(e.value=t),null!=a)?e.defaultValue=null!=a?""+dt(a):"":e.defaultValue!==t&&(e.defaultValue=t)}function St(e,t,a,r){if(null==t){if(null!=r){if(null!=a)throw Error(i(92));if(O(r)){if(1<r.length)throw Error(i(93));r=r[0]}a=r}null==a&&(a=""),t=a}a=dt(t),e.defaultValue=a,(r=e.textContent)===a&&""!==r&&null!==r&&(e.value=r),ht(e)}function Et(e,t){if(t){var a=e.firstChild;if(a&&a===e.lastChild&&3===a.nodeType)return void(a.nodeValue=t)}e.textContent=t}var Tt=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Nt(e,t,a){var r=0===t.indexOf("--");null==a||"boolean"===typeof a||""===a?r?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":r?e.setProperty(t,a):"number"!==typeof a||0===a||Tt.has(t)?"float"===t?e.cssFloat=a:e[t]=(""+a).trim():e[t]=a+"px"}function jt(e,t,a){if(null!=t&&"object"!==typeof t)throw Error(i(62));if(e=e.style,null!=a){for(var r in a)!a.hasOwnProperty(r)||null!=t&&t.hasOwnProperty(r)||(0===r.indexOf("--")?e.setProperty(r,""):"float"===r?e.cssFloat="":e[r]="");for(var n in t)r=t[n],t.hasOwnProperty(n)&&a[n]!==r&&Nt(e,n,r)}else for(var s in t)t.hasOwnProperty(s)&&Nt(e,s,t[s])}function Ct(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var _t=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),At=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Pt(e){return At.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Rt(){}var Ot=null;function Dt(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Ft=null,It=null;function Lt(e){var t=Je(e);if(t&&(e=t.stateNode)){var a=e[We]||null;e:switch(e=t.stateNode,t.type){case"input":if(yt(e,a.value,a.defaultValue,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name),t=a.name,"radio"===a.type&&null!=t){for(a=e;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll('input[name="'+vt(""+t)+'"][type="radio"]'),t=0;t<a.length;t++){var r=a[t];if(r!==e&&r.form===e.form){var n=r[We]||null;if(!n)throw Error(i(90));yt(r,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name)}}for(t=0;t<a.length;t++)(r=a[t]).form===e.form&&mt(r)}break e;case"textarea":kt(e,a.value,a.defaultValue);break e;case"select":null!=(t=a.value)&&xt(e,!!a.multiple,t,!1)}}}var Mt=!1;function zt(e,t,a){if(Mt)return e(t,a);Mt=!0;try{return e(t)}finally{if(Mt=!1,(null!==Ft||null!==It)&&(Zc(),Ft&&(t=Ft,e=It,It=Ft=null,Lt(t),e)))for(t=0;t<e.length;t++)Lt(e[t])}}function Ut(e,t){var a=e.stateNode;if(null===a)return null;var r=a[We]||null;if(null===r)return null;a=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(a&&"function"!==typeof a)throw Error(i(231,t,typeof a));return a}var Bt=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),Wt=!1;if(Bt)try{var Ht={};Object.defineProperty(Ht,"passive",{get:function(){Wt=!0}}),window.addEventListener("test",Ht,Ht),window.removeEventListener("test",Ht,Ht)}catch(Qf){Wt=!1}var Vt=null,Gt=null,$t=null;function qt(){if($t)return $t;var e,t,a=Gt,r=a.length,n="value"in Vt?Vt.value:Vt.textContent,s=n.length;for(e=0;e<r&&a[e]===n[e];e++);var i=r-e;for(t=1;t<=i&&a[r-t]===n[s-t];t++);return $t=n.slice(e,1<t?1-t:void 0)}function Yt(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function Xt(){return!0}function Kt(){return!1}function Jt(e){function t(t,a,r,n,s){for(var i in this._reactName=t,this._targetInst=r,this.type=a,this.nativeEvent=n,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(i)&&(t=e[i],this[i]=t?t(n):n[i]);return this.isDefaultPrevented=(null!=n.defaultPrevented?n.defaultPrevented:!1===n.returnValue)?Xt:Kt,this.isPropagationStopped=Kt,this}return h(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Xt)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Xt)},persist:function(){},isPersistent:Xt}),t}var Qt,Zt,ea,ta={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},aa=Jt(ta),ra=h({},ta,{view:0,detail:0}),na=Jt(ra),sa=h({},ra,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ga,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ea&&(ea&&"mousemove"===e.type?(Qt=e.screenX-ea.screenX,Zt=e.screenY-ea.screenY):Zt=Qt=0,ea=e),Qt)},movementY:function(e){return"movementY"in e?e.movementY:Zt}}),ia=Jt(sa),oa=Jt(h({},sa,{dataTransfer:0})),la=Jt(h({},ra,{relatedTarget:0})),ca=Jt(h({},ta,{animationName:0,elapsedTime:0,pseudoElement:0})),ua=Jt(h({},ta,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),da=Jt(h({},ta,{data:0})),fa={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ha={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ma={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function pa(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=ma[e])&&!!t[e]}function ga(){return pa}var va=Jt(h({},ra,{key:function(e){if(e.key){var t=fa[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Yt(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?ha[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ga,charCode:function(e){return"keypress"===e.type?Yt(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Yt(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),ya=Jt(h({},sa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),ba=Jt(h({},ra,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ga})),wa=Jt(h({},ta,{propertyName:0,elapsedTime:0,pseudoElement:0})),xa=Jt(h({},sa,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),ka=Jt(h({},ta,{newState:0,oldState:0})),Sa=[9,13,27,32],Ea=Bt&&"CompositionEvent"in window,Ta=null;Bt&&"documentMode"in document&&(Ta=document.documentMode);var Na=Bt&&"TextEvent"in window&&!Ta,ja=Bt&&(!Ea||Ta&&8<Ta&&11>=Ta),Ca=String.fromCharCode(32),_a=!1;function Aa(e,t){switch(e){case"keyup":return-1!==Sa.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Pa(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Ra=!1;var Oa={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Da(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Oa[e.type]:"textarea"===t}function Fa(e,t,a,r){Ft?It?It.push(r):It=[r]:Ft=r,0<(t=rd(t,"onChange")).length&&(a=new aa("onChange","change",null,a,r),e.push({event:a,listeners:t}))}var Ia=null,La=null;function Ma(e){Xu(e,0)}function za(e){if(mt(Qe(e)))return e}function Ua(e,t){if("change"===e)return t}var Ba=!1;if(Bt){var Wa;if(Bt){var Ha="oninput"in document;if(!Ha){var Va=document.createElement("div");Va.setAttribute("oninput","return;"),Ha="function"===typeof Va.oninput}Wa=Ha}else Wa=!1;Ba=Wa&&(!document.documentMode||9<document.documentMode)}function Ga(){Ia&&(Ia.detachEvent("onpropertychange",$a),La=Ia=null)}function $a(e){if("value"===e.propertyName&&za(La)){var t=[];Fa(t,La,e,Dt(e)),zt(Ma,t)}}function qa(e,t,a){"focusin"===e?(Ga(),La=a,(Ia=t).attachEvent("onpropertychange",$a)):"focusout"===e&&Ga()}function Ya(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return za(La)}function Xa(e,t){if("click"===e)return za(t)}function Ka(e,t){if("input"===e||"change"===e)return za(t)}var Ja="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function Qa(e,t){if(Ja(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var a=Object.keys(e),r=Object.keys(t);if(a.length!==r.length)return!1;for(r=0;r<a.length;r++){var n=a[r];if(!re.call(t,n)||!Ja(e[n],t[n]))return!1}return!0}function Za(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function er(e,t){var a,r=Za(e);for(e=0;r;){if(3===r.nodeType){if(a=e+r.textContent.length,e<=t&&a>=t)return{node:r,offset:t-e};e=a}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Za(r)}}function tr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?tr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function ar(e){for(var t=pt((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var a="string"===typeof t.contentWindow.location.href}catch(r){a=!1}if(!a)break;t=pt((e=t.contentWindow).document)}return t}function rr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var nr=Bt&&"documentMode"in document&&11>=document.documentMode,sr=null,ir=null,or=null,lr=!1;function cr(e,t,a){var r=a.window===a?a.document:9===a.nodeType?a:a.ownerDocument;lr||null==sr||sr!==pt(r)||("selectionStart"in(r=sr)&&rr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},or&&Qa(or,r)||(or=r,0<(r=rd(ir,"onSelect")).length&&(t=new aa("onSelect","select",null,t,a),e.push({event:t,listeners:r}),t.target=sr)))}function ur(e,t){var a={};return a[e.toLowerCase()]=t.toLowerCase(),a["Webkit"+e]="webkit"+t,a["Moz"+e]="moz"+t,a}var dr={animationend:ur("Animation","AnimationEnd"),animationiteration:ur("Animation","AnimationIteration"),animationstart:ur("Animation","AnimationStart"),transitionrun:ur("Transition","TransitionRun"),transitionstart:ur("Transition","TransitionStart"),transitioncancel:ur("Transition","TransitionCancel"),transitionend:ur("Transition","TransitionEnd")},fr={},hr={};function mr(e){if(fr[e])return fr[e];if(!dr[e])return e;var t,a=dr[e];for(t in a)if(a.hasOwnProperty(t)&&t in hr)return fr[e]=a[t];return e}Bt&&(hr=document.createElement("div").style,"AnimationEvent"in window||(delete dr.animationend.animation,delete dr.animationiteration.animation,delete dr.animationstart.animation),"TransitionEvent"in window||delete dr.transitionend.transition);var pr=mr("animationend"),gr=mr("animationiteration"),vr=mr("animationstart"),yr=mr("transitionrun"),br=mr("transitionstart"),wr=mr("transitioncancel"),xr=mr("transitionend"),kr=new Map,Sr="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Er(e,t){kr.set(e,t),rt(t,[e])}Sr.push("scrollEnd");var Tr="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)},Nr=[],jr=0,Cr=0;function _r(){for(var e=jr,t=Cr=jr=0;t<e;){var a=Nr[t];Nr[t++]=null;var r=Nr[t];Nr[t++]=null;var n=Nr[t];Nr[t++]=null;var s=Nr[t];if(Nr[t++]=null,null!==r&&null!==n){var i=r.pending;null===i?n.next=n:(n.next=i.next,i.next=n),r.pending=n}0!==s&&Or(a,n,s)}}function Ar(e,t,a,r){Nr[jr++]=e,Nr[jr++]=t,Nr[jr++]=a,Nr[jr++]=r,Cr|=r,e.lanes|=r,null!==(e=e.alternate)&&(e.lanes|=r)}function Pr(e,t,a,r){return Ar(e,t,a,r),Dr(e)}function Rr(e,t){return Ar(e,null,null,t),Dr(e)}function Or(e,t,a){e.lanes|=a;var r=e.alternate;null!==r&&(r.lanes|=a);for(var n=!1,s=e.return;null!==s;)s.childLanes|=a,null!==(r=s.alternate)&&(r.childLanes|=a),22===s.tag&&(null===(e=s.stateNode)||1&e._visibility||(n=!0)),e=s,s=s.return;return 3===e.tag?(s=e.stateNode,n&&null!==t&&(n=31-we(a),null===(r=(e=s.hiddenUpdates)[n])?e[n]=[t]:r.push(t),t.lane=536870912|a),s):null}function Dr(e){if(50<Vc)throw Vc=0,Gc=null,Error(i(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var Fr={};function Ir(e,t,a,r){this.tag=e,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Lr(e,t,a,r){return new Ir(e,t,a,r)}function Mr(e){return!(!(e=e.prototype)||!e.isReactComponent)}function zr(e,t){var a=e.alternate;return null===a?((a=Lr(e.tag,t,e.key,e.mode)).elementType=e.elementType,a.type=e.type,a.stateNode=e.stateNode,a.alternate=e,e.alternate=a):(a.pendingProps=t,a.type=e.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=65011712&e.flags,a.childLanes=e.childLanes,a.lanes=e.lanes,a.child=e.child,a.memoizedProps=e.memoizedProps,a.memoizedState=e.memoizedState,a.updateQueue=e.updateQueue,t=e.dependencies,a.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},a.sibling=e.sibling,a.index=e.index,a.ref=e.ref,a.refCleanup=e.refCleanup,a}function Ur(e,t){e.flags&=65011714;var a=e.alternate;return null===a?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=a.childLanes,e.lanes=a.lanes,e.child=a.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=a.memoizedProps,e.memoizedState=a.memoizedState,e.updateQueue=a.updateQueue,e.type=a.type,t=a.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Br(e,t,a,r,n,s){var o=0;if(r=e,"function"===typeof e)Mr(e)&&(o=1);else if("string"===typeof e)o=function(e,t,a){if(1===a||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!==typeof t.precedence||"string"!==typeof t.href||""===t.href)break;return!0;case"link":if("string"!==typeof t.rel||"string"!==typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"===typeof t.precedence&&null==e);case"script":if(t.async&&"function"!==typeof t.async&&"symbol"!==typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"===typeof t.src)return!0}return!1}(e,a,V.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case j:return(e=Lr(31,a,t,n)).elementType=j,e.lanes=s,e;case v:return Wr(a.children,n,s,t);case y:o=8,n|=24;break;case b:return(e=Lr(12,a,t,2|n)).elementType=b,e.lanes=s,e;case S:return(e=Lr(13,a,t,n)).elementType=S,e.lanes=s,e;case E:return(e=Lr(19,a,t,n)).elementType=E,e.lanes=s,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case x:o=10;break e;case w:o=9;break e;case k:o=11;break e;case T:o=14;break e;case N:o=16,r=null;break e}o=29,a=Error(i(130,null===e?"null":typeof e,"")),r=null}return(t=Lr(o,a,t,n)).elementType=e,t.type=r,t.lanes=s,t}function Wr(e,t,a,r){return(e=Lr(7,e,r,t)).lanes=a,e}function Hr(e,t,a){return(e=Lr(6,e,null,t)).lanes=a,e}function Vr(e){var t=Lr(18,null,null,0);return t.stateNode=e,t}function Gr(e,t,a){return(t=Lr(4,null!==e.children?e.children:[],e.key,t)).lanes=a,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var $r=new WeakMap;function qr(e,t){if("object"===typeof e&&null!==e){var a=$r.get(e);return void 0!==a?a:(t={value:e,source:t,stack:ae(t)},$r.set(e,t),t)}return{value:e,source:t,stack:ae(t)}}var Yr=[],Xr=0,Kr=null,Jr=0,Qr=[],Zr=0,en=null,tn=1,an="";function rn(e,t){Yr[Xr++]=Jr,Yr[Xr++]=Kr,Kr=e,Jr=t}function nn(e,t,a){Qr[Zr++]=tn,Qr[Zr++]=an,Qr[Zr++]=en,en=e;var r=tn;e=an;var n=32-we(r)-1;r&=~(1<<n),a+=1;var s=32-we(t)+n;if(30<s){var i=n-n%5;s=(r&(1<<i)-1).toString(32),r>>=i,n-=i,tn=1<<32-we(t)+n|a<<n|r,an=s+e}else tn=1<<s|a<<n|r,an=e}function sn(e){null!==e.return&&(rn(e,1),nn(e,1,0))}function on(e){for(;e===Kr;)Kr=Yr[--Xr],Yr[Xr]=null,Jr=Yr[--Xr],Yr[Xr]=null;for(;e===en;)en=Qr[--Zr],Qr[Zr]=null,an=Qr[--Zr],Qr[Zr]=null,tn=Qr[--Zr],Qr[Zr]=null}function ln(e,t){Qr[Zr++]=tn,Qr[Zr++]=an,Qr[Zr++]=en,tn=t.id,an=t.overflow,en=e}var cn=null,un=null,dn=!1,fn=null,hn=!1,mn=Error(i(519));function pn(e){throw xn(qr(Error(i(418,1<arguments.length&&void 0!==arguments[1]&&arguments[1]?"text":"HTML","")),e)),mn}function gn(e){var t=e.stateNode,a=e.type,r=e.memoizedProps;switch(t[Be]=e,t[We]=r,a){case"dialog":Ku("cancel",t),Ku("close",t);break;case"iframe":case"object":case"embed":Ku("load",t);break;case"video":case"audio":for(a=0;a<qu.length;a++)Ku(qu[a],t);break;case"source":Ku("error",t);break;case"img":case"image":case"link":Ku("error",t),Ku("load",t);break;case"details":Ku("toggle",t);break;case"input":Ku("invalid",t),bt(t,r.value,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name,!0);break;case"select":Ku("invalid",t);break;case"textarea":Ku("invalid",t),St(t,r.value,r.defaultValue,r.children)}"string"!==typeof(a=r.children)&&"number"!==typeof a&&"bigint"!==typeof a||t.textContent===""+a||!0===r.suppressHydrationWarning||cd(t.textContent,a)?(null!=r.popover&&(Ku("beforetoggle",t),Ku("toggle",t)),null!=r.onScroll&&Ku("scroll",t),null!=r.onScrollEnd&&Ku("scrollend",t),null!=r.onClick&&(t.onclick=Rt),t=!0):t=!1,t||pn(e,!0)}function vn(e){for(cn=e.return;cn;)switch(cn.tag){case 5:case 31:case 13:return void(hn=!1);case 27:case 3:return void(hn=!0);default:cn=cn.return}}function yn(e){if(e!==cn)return!1;if(!dn)return vn(e),dn=!0,!1;var t,a=e.tag;if((t=3!==a&&27!==a)&&((t=5===a)&&(t=!("form"!==(t=e.type)&&"button"!==t)||bd(e.type,e.memoizedProps)),t=!t),t&&un&&pn(e),vn(e),13===a){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));un=Fd(e)}else if(31===a){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));un=Fd(e)}else 27===a?(a=un,Nd(e.type)?(e=Dd,Dd=null,un=e):un=a):un=cn?Od(e.stateNode.nextSibling):null;return!0}function bn(){un=cn=null,dn=!1}function wn(){var e=fn;return null!==e&&(null===Ac?Ac=e:Ac.push.apply(Ac,e),fn=null),e}function xn(e){null===fn?fn=[e]:fn.push(e)}var kn=z(null),Sn=null,En=null;function Tn(e,t,a){B(kn,t._currentValue),t._currentValue=a}function Nn(e){e._currentValue=kn.current,U(kn)}function jn(e,t,a){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===a)break;e=e.return}}function Cn(e,t,a,r){var n=e.child;for(null!==n&&(n.return=e);null!==n;){var s=n.dependencies;if(null!==s){var o=n.child;s=s.firstContext;e:for(;null!==s;){var l=s;s=n;for(var c=0;c<t.length;c++)if(l.context===t[c]){s.lanes|=a,null!==(l=s.alternate)&&(l.lanes|=a),jn(s.return,a,e),r||(o=null);break e}s=l.next}}else if(18===n.tag){if(null===(o=n.return))throw Error(i(341));o.lanes|=a,null!==(s=o.alternate)&&(s.lanes|=a),jn(o,a,e),o=null}else o=n.child;if(null!==o)o.return=n;else for(o=n;null!==o;){if(o===e){o=null;break}if(null!==(n=o.sibling)){n.return=o.return,o=n;break}o=o.return}n=o}}function _n(e,t,a,r){e=null;for(var n=t,s=!1;null!==n;){if(!s)if(0!==(524288&n.flags))s=!0;else if(0!==(262144&n.flags))break;if(10===n.tag){var o=n.alternate;if(null===o)throw Error(i(387));if(null!==(o=o.memoizedProps)){var l=n.type;Ja(n.pendingProps.value,o.value)||(null!==e?e.push(l):e=[l])}}else if(n===q.current){if(null===(o=n.alternate))throw Error(i(387));o.memoizedState.memoizedState!==n.memoizedState.memoizedState&&(null!==e?e.push(df):e=[df])}n=n.return}null!==e&&Cn(t,e,a,r),t.flags|=262144}function An(e){for(e=e.firstContext;null!==e;){if(!Ja(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Pn(e){Sn=e,En=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function Rn(e){return Dn(Sn,e)}function On(e,t){return null===Sn&&Pn(e),Dn(e,t)}function Dn(e,t){var a=t._currentValue;if(t={context:t,memoizedValue:a,next:null},null===En){if(null===e)throw Error(i(308));En=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else En=En.next=t;return a}var Fn="undefined"!==typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,a){e.push(a)}};this.abort=function(){t.aborted=!0,e.forEach(function(e){return e()})}},In=r.unstable_scheduleCallback,Ln=r.unstable_NormalPriority,Mn={$$typeof:x,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function zn(){return{controller:new Fn,data:new Map,refCount:0}}function Un(e){e.refCount--,0===e.refCount&&In(Ln,function(){e.controller.abort()})}var Bn=null,Wn=0,Hn=0,Vn=null;function Gn(){if(0===--Wn&&null!==Bn){null!==Vn&&(Vn.status="fulfilled");var e=Bn;Bn=null,Hn=0,Vn=null;for(var t=0;t<e.length;t++)(0,e[t])()}}var $n=D.S;D.S=function(e,t){Oc=le(),"object"===typeof t&&null!==t&&"function"===typeof t.then&&function(e,t){if(null===Bn){var a=Bn=[];Wn=0,Hn=Wu(),Vn={status:"pending",value:void 0,then:function(e){a.push(e)}}}Wn++,t.then(Gn,Gn)}(0,t),null!==$n&&$n(e,t)};var qn=z(null);function Yn(){var e=qn.current;return null!==e?e:mc.pooledCache}function Xn(e,t){B(qn,null===t?qn.current:t.pool)}function Kn(){var e=Yn();return null===e?null:{parent:Mn._currentValue,pool:e}}var Jn=Error(i(460)),Qn=Error(i(474)),Zn=Error(i(542)),es={then:function(){}};function ts(e){return"fulfilled"===(e=e.status)||"rejected"===e}function as(e,t,a){switch(void 0===(a=e[a])?e.push(t):a!==t&&(t.then(Rt,Rt),t=a),t.status){case"fulfilled":return t.value;case"rejected":throw is(e=t.reason),e;default:if("string"===typeof t.status)t.then(Rt,Rt);else{if(null!==(e=mc)&&100<e.shellSuspendCounter)throw Error(i(482));(e=t).status="pending",e.then(function(e){if("pending"===t.status){var a=t;a.status="fulfilled",a.value=e}},function(e){if("pending"===t.status){var a=t;a.status="rejected",a.reason=e}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw is(e=t.reason),e}throw ns=t,Jn}}function rs(e){try{return(0,e._init)(e._payload)}catch(t){if(null!==t&&"object"===typeof t&&"function"===typeof t.then)throw ns=t,Jn;throw t}}var ns=null;function ss(){if(null===ns)throw Error(i(459));var e=ns;return ns=null,e}function is(e){if(e===Jn||e===Zn)throw Error(i(483))}var os=null,ls=0;function cs(e){var t=ls;return ls+=1,null===os&&(os=[]),as(os,e,t)}function us(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function ds(e,t){if(t.$$typeof===m)throw Error(i(525));throw e=Object.prototype.toString.call(t),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function fs(e){function t(t,a){if(e){var r=t.deletions;null===r?(t.deletions=[a],t.flags|=16):r.push(a)}}function a(a,r){if(!e)return null;for(;null!==r;)t(a,r),r=r.sibling;return null}function r(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function n(e,t){return(e=zr(e,t)).index=0,e.sibling=null,e}function s(t,a,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<a?(t.flags|=67108866,a):r:(t.flags|=67108866,a):(t.flags|=1048576,a)}function o(t){return e&&null===t.alternate&&(t.flags|=67108866),t}function l(e,t,a,r){return null===t||6!==t.tag?((t=Hr(a,e.mode,r)).return=e,t):((t=n(t,a)).return=e,t)}function c(e,t,a,r){var s=a.type;return s===v?d(e,t,a.props.children,r,a.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===N&&rs(s)===t.type)?(us(t=n(t,a.props),a),t.return=e,t):(us(t=Br(a.type,a.key,a.props,null,e.mode,r),a),t.return=e,t)}function u(e,t,a,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==a.containerInfo||t.stateNode.implementation!==a.implementation?((t=Gr(a,e.mode,r)).return=e,t):((t=n(t,a.children||[])).return=e,t)}function d(e,t,a,r,s){return null===t||7!==t.tag?((t=Wr(a,e.mode,r,s)).return=e,t):((t=n(t,a)).return=e,t)}function f(e,t,a){if("string"===typeof t&&""!==t||"number"===typeof t||"bigint"===typeof t)return(t=Hr(""+t,e.mode,a)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case p:return us(a=Br(t.type,t.key,t.props,null,e.mode,a),t),a.return=e,a;case g:return(t=Gr(t,e.mode,a)).return=e,t;case N:return f(e,t=rs(t),a)}if(O(t)||A(t))return(t=Wr(t,e.mode,a,null)).return=e,t;if("function"===typeof t.then)return f(e,cs(t),a);if(t.$$typeof===x)return f(e,On(e,t),a);ds(e,t)}return null}function h(e,t,a,r){var n=null!==t?t.key:null;if("string"===typeof a&&""!==a||"number"===typeof a||"bigint"===typeof a)return null!==n?null:l(e,t,""+a,r);if("object"===typeof a&&null!==a){switch(a.$$typeof){case p:return a.key===n?c(e,t,a,r):null;case g:return a.key===n?u(e,t,a,r):null;case N:return h(e,t,a=rs(a),r)}if(O(a)||A(a))return null!==n?null:d(e,t,a,r,null);if("function"===typeof a.then)return h(e,t,cs(a),r);if(a.$$typeof===x)return h(e,t,On(e,a),r);ds(e,a)}return null}function m(e,t,a,r,n){if("string"===typeof r&&""!==r||"number"===typeof r||"bigint"===typeof r)return l(t,e=e.get(a)||null,""+r,n);if("object"===typeof r&&null!==r){switch(r.$$typeof){case p:return c(t,e=e.get(null===r.key?a:r.key)||null,r,n);case g:return u(t,e=e.get(null===r.key?a:r.key)||null,r,n);case N:return m(e,t,a,r=rs(r),n)}if(O(r)||A(r))return d(t,e=e.get(a)||null,r,n,null);if("function"===typeof r.then)return m(e,t,a,cs(r),n);if(r.$$typeof===x)return m(e,t,a,On(t,r),n);ds(t,r)}return null}function y(l,c,u,d){if("object"===typeof u&&null!==u&&u.type===v&&null===u.key&&(u=u.props.children),"object"===typeof u&&null!==u){switch(u.$$typeof){case p:e:{for(var b=u.key;null!==c;){if(c.key===b){if((b=u.type)===v){if(7===c.tag){a(l,c.sibling),(d=n(c,u.props.children)).return=l,l=d;break e}}else if(c.elementType===b||"object"===typeof b&&null!==b&&b.$$typeof===N&&rs(b)===c.type){a(l,c.sibling),us(d=n(c,u.props),u),d.return=l,l=d;break e}a(l,c);break}t(l,c),c=c.sibling}u.type===v?((d=Wr(u.props.children,l.mode,d,u.key)).return=l,l=d):(us(d=Br(u.type,u.key,u.props,null,l.mode,d),u),d.return=l,l=d)}return o(l);case g:e:{for(b=u.key;null!==c;){if(c.key===b){if(4===c.tag&&c.stateNode.containerInfo===u.containerInfo&&c.stateNode.implementation===u.implementation){a(l,c.sibling),(d=n(c,u.children||[])).return=l,l=d;break e}a(l,c);break}t(l,c),c=c.sibling}(d=Gr(u,l.mode,d)).return=l,l=d}return o(l);case N:return y(l,c,u=rs(u),d)}if(O(u))return function(n,i,o,l){for(var c=null,u=null,d=i,p=i=0,g=null;null!==d&&p<o.length;p++){d.index>p?(g=d,d=null):g=d.sibling;var v=h(n,d,o[p],l);if(null===v){null===d&&(d=g);break}e&&d&&null===v.alternate&&t(n,d),i=s(v,i,p),null===u?c=v:u.sibling=v,u=v,d=g}if(p===o.length)return a(n,d),dn&&rn(n,p),c;if(null===d){for(;p<o.length;p++)null!==(d=f(n,o[p],l))&&(i=s(d,i,p),null===u?c=d:u.sibling=d,u=d);return dn&&rn(n,p),c}for(d=r(d);p<o.length;p++)null!==(g=m(d,n,p,o[p],l))&&(e&&null!==g.alternate&&d.delete(null===g.key?p:g.key),i=s(g,i,p),null===u?c=g:u.sibling=g,u=g);return e&&d.forEach(function(e){return t(n,e)}),dn&&rn(n,p),c}(l,c,u,d);if(A(u)){if("function"!==typeof(b=A(u)))throw Error(i(150));return function(n,o,l,c){if(null==l)throw Error(i(151));for(var u=null,d=null,p=o,g=o=0,v=null,y=l.next();null!==p&&!y.done;g++,y=l.next()){p.index>g?(v=p,p=null):v=p.sibling;var b=h(n,p,y.value,c);if(null===b){null===p&&(p=v);break}e&&p&&null===b.alternate&&t(n,p),o=s(b,o,g),null===d?u=b:d.sibling=b,d=b,p=v}if(y.done)return a(n,p),dn&&rn(n,g),u;if(null===p){for(;!y.done;g++,y=l.next())null!==(y=f(n,y.value,c))&&(o=s(y,o,g),null===d?u=y:d.sibling=y,d=y);return dn&&rn(n,g),u}for(p=r(p);!y.done;g++,y=l.next())null!==(y=m(p,n,g,y.value,c))&&(e&&null!==y.alternate&&p.delete(null===y.key?g:y.key),o=s(y,o,g),null===d?u=y:d.sibling=y,d=y);return e&&p.forEach(function(e){return t(n,e)}),dn&&rn(n,g),u}(l,c,u=b.call(u),d)}if("function"===typeof u.then)return y(l,c,cs(u),d);if(u.$$typeof===x)return y(l,c,On(l,u),d);ds(l,u)}return"string"===typeof u&&""!==u||"number"===typeof u||"bigint"===typeof u?(u=""+u,null!==c&&6===c.tag?(a(l,c.sibling),(d=n(c,u)).return=l,l=d):(a(l,c),(d=Hr(u,l.mode,d)).return=l,l=d),o(l)):a(l,c)}return function(e,t,a,r){try{ls=0;var n=y(e,t,a,r);return os=null,n}catch(i){if(i===Jn||i===Zn)throw i;var s=Lr(29,i,null,e.mode);return s.lanes=r,s.return=e,s}}}var hs=fs(!0),ms=fs(!1),ps=!1;function gs(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function vs(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function ys(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function bs(e,t,a){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&hc)){var n=r.pending;return null===n?t.next=t:(t.next=n.next,n.next=t),r.pending=t,t=Dr(e),Or(e,null,a),t}return Ar(e,r,t,a),Dr(e)}function ws(e,t,a){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194048&a))){var r=t.lanes;a|=r&=e.pendingLanes,t.lanes=a,De(e,a)}}function xs(e,t){var a=e.updateQueue,r=e.alternate;if(null!==r&&a===(r=r.updateQueue)){var n=null,s=null;if(null!==(a=a.firstBaseUpdate)){do{var i={lane:a.lane,tag:a.tag,payload:a.payload,callback:null,next:null};null===s?n=s=i:s=s.next=i,a=a.next}while(null!==a);null===s?n=s=t:s=s.next=t}else n=s=t;return a={baseState:r.baseState,firstBaseUpdate:n,lastBaseUpdate:s,shared:r.shared,callbacks:r.callbacks},void(e.updateQueue=a)}null===(e=a.lastBaseUpdate)?a.firstBaseUpdate=t:e.next=t,a.lastBaseUpdate=t}var ks=!1;function Ss(){if(ks){if(null!==Vn)throw Vn}}function Es(e,t,a,r){ks=!1;var n=e.updateQueue;ps=!1;var s=n.firstBaseUpdate,i=n.lastBaseUpdate,o=n.shared.pending;if(null!==o){n.shared.pending=null;var l=o,c=l.next;l.next=null,null===i?s=c:i.next=c,i=l;var u=e.alternate;null!==u&&((o=(u=u.updateQueue).lastBaseUpdate)!==i&&(null===o?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(null!==s){var d=n.baseState;for(i=0,u=c=l=null,o=s;;){var f=-536870913&o.lane,m=f!==o.lane;if(m?(gc&f)===f:(r&f)===f){0!==f&&f===Hn&&(ks=!0),null!==u&&(u=u.next={lane:0,tag:o.tag,payload:o.payload,callback:null,next:null});e:{var p=e,g=o;f=t;var v=a;switch(g.tag){case 1:if("function"===typeof(p=g.payload)){d=p.call(v,d,f);break e}d=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(f="function"===typeof(p=g.payload)?p.call(v,d,f):p)||void 0===f)break e;d=h({},d,f);break e;case 2:ps=!0}}null!==(f=o.callback)&&(e.flags|=64,m&&(e.flags|=8192),null===(m=n.callbacks)?n.callbacks=[f]:m.push(f))}else m={lane:f,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===u?(c=u=m,l=d):u=u.next=m,i|=f;if(null===(o=o.next)){if(null===(o=n.shared.pending))break;o=(m=o).next,m.next=null,n.lastBaseUpdate=m,n.shared.pending=null}}null===u&&(l=d),n.baseState=l,n.firstBaseUpdate=c,n.lastBaseUpdate=u,null===s&&(n.shared.lanes=0),Ec|=i,e.lanes=i,e.memoizedState=d}}function Ts(e,t){if("function"!==typeof e)throw Error(i(191,e));e.call(t)}function Ns(e,t){var a=e.callbacks;if(null!==a)for(e.callbacks=null,e=0;e<a.length;e++)Ts(a[e],t)}var js=z(null),Cs=z(0);function _s(e,t){B(Cs,e=kc),B(js,t),kc=e|t.baseLanes}function As(){B(Cs,kc),B(js,js.current)}function Ps(){kc=Cs.current,U(js),U(Cs)}var Rs=z(null),Os=null;function Ds(e){var t=e.alternate;B(zs,1&zs.current),B(Rs,e),null===Os&&(null===t||null!==js.current||null!==t.memoizedState)&&(Os=e)}function Fs(e){B(zs,zs.current),B(Rs,e),null===Os&&(Os=e)}function Is(e){22===e.tag?(B(zs,zs.current),B(Rs,e),null===Os&&(Os=e)):Ls()}function Ls(){B(zs,zs.current),B(Rs,Rs.current)}function Ms(e){U(Rs),Os===e&&(Os=null),U(zs)}var zs=z(0);function Us(e){for(var t=e;null!==t;){if(13===t.tag){var a=t.memoizedState;if(null!==a&&(null===(a=a.dehydrated)||Pd(a)||Rd(a)))return t}else if(19!==t.tag||"forwards"!==t.memoizedProps.revealOrder&&"backwards"!==t.memoizedProps.revealOrder&&"unstable_legacy-backwards"!==t.memoizedProps.revealOrder&&"together"!==t.memoizedProps.revealOrder){if(null!==t.child){t.child.return=t,t=t.child;continue}}else if(0!==(128&t.flags))return t;if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Bs=0,Ws=null,Hs=null,Vs=null,Gs=!1,$s=!1,qs=!1,Ys=0,Xs=0,Ks=null,Js=0;function Qs(){throw Error(i(321))}function Zs(e,t){if(null===t)return!1;for(var a=0;a<t.length&&a<e.length;a++)if(!Ja(e[a],t[a]))return!1;return!0}function ei(e,t,a,r,n,s){return Bs=s,Ws=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,D.H=null===e||null===e.memoizedState?go:vo,qs=!1,s=a(r,n),qs=!1,$s&&(s=ai(t,a,r,n)),ti(e),s}function ti(e){D.H=po;var t=null!==Hs&&null!==Hs.next;if(Bs=0,Vs=Hs=Ws=null,Gs=!1,Xs=0,Ks=null,t)throw Error(i(300));null===e||Oo||null!==(e=e.dependencies)&&An(e)&&(Oo=!0)}function ai(e,t,a,r){Ws=e;var n=0;do{if($s&&(Ks=null),Xs=0,$s=!1,25<=n)throw Error(i(301));if(n+=1,Vs=Hs=null,null!=e.updateQueue){var s=e.updateQueue;s.lastEffect=null,s.events=null,s.stores=null,null!=s.memoCache&&(s.memoCache.index=0)}D.H=yo,s=t(a,r)}while($s);return s}function ri(){var e=D.H,t=e.useState()[0];return t="function"===typeof t.then?ci(t):t,e=e.useState()[0],(null!==Hs?Hs.memoizedState:null)!==e&&(Ws.flags|=1024),t}function ni(){var e=0!==Ys;return Ys=0,e}function si(e,t,a){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a}function ii(e){if(Gs){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}Gs=!1}Bs=0,Vs=Hs=Ws=null,$s=!1,Xs=Ys=0,Ks=null}function oi(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Vs?Ws.memoizedState=Vs=e:Vs=Vs.next=e,Vs}function li(){if(null===Hs){var e=Ws.alternate;e=null!==e?e.memoizedState:null}else e=Hs.next;var t=null===Vs?Ws.memoizedState:Vs.next;if(null!==t)Vs=t,Hs=e;else{if(null===e){if(null===Ws.alternate)throw Error(i(467));throw Error(i(310))}e={memoizedState:(Hs=e).memoizedState,baseState:Hs.baseState,baseQueue:Hs.baseQueue,queue:Hs.queue,next:null},null===Vs?Ws.memoizedState=Vs=e:Vs=Vs.next=e}return Vs}function ci(e){var t=Xs;return Xs+=1,null===Ks&&(Ks=[]),e=as(Ks,e,t),t=Ws,null===(null===Vs?t.memoizedState:Vs.next)&&(t=t.alternate,D.H=null===t||null===t.memoizedState?go:vo),e}function ui(e){if(null!==e&&"object"===typeof e){if("function"===typeof e.then)return ci(e);if(e.$$typeof===x)return Rn(e)}throw Error(i(438,String(e)))}function di(e){var t=null,a=Ws.updateQueue;if(null!==a&&(t=a.memoCache),null==t){var r=Ws.alternate;null!==r&&(null!==(r=r.updateQueue)&&(null!=(r=r.memoCache)&&(t={data:r.data.map(function(e){return e.slice()}),index:0})))}if(null==t&&(t={data:[],index:0}),null===a&&(a={lastEffect:null,events:null,stores:null,memoCache:null},Ws.updateQueue=a),a.memoCache=t,void 0===(a=t.data[t.index]))for(a=t.data[t.index]=Array(e),r=0;r<e;r++)a[r]=C;return t.index++,a}function fi(e,t){return"function"===typeof t?t(e):t}function hi(e){return mi(li(),Hs,e)}function mi(e,t,a){var r=e.queue;if(null===r)throw Error(i(311));r.lastRenderedReducer=a;var n=e.baseQueue,s=r.pending;if(null!==s){if(null!==n){var o=n.next;n.next=s.next,s.next=o}t.baseQueue=n=s,r.pending=null}if(s=e.baseState,null===n)e.memoizedState=s;else{var l=o=null,c=null,u=t=n.next,d=!1;do{var f=-536870913&u.lane;if(f!==u.lane?(gc&f)===f:(Bs&f)===f){var h=u.revertLane;if(0===h)null!==c&&(c=c.next={lane:0,revertLane:0,gesture:null,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),f===Hn&&(d=!0);else{if((Bs&h)===h){u=u.next,h===Hn&&(d=!0);continue}f={lane:0,revertLane:u.revertLane,gesture:null,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=f,o=s):c=c.next=f,Ws.lanes|=h,Ec|=h}f=u.action,qs&&a(s,f),s=u.hasEagerState?u.eagerState:a(s,f)}else h={lane:f,revertLane:u.revertLane,gesture:u.gesture,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=h,o=s):c=c.next=h,Ws.lanes|=f,Ec|=f;u=u.next}while(null!==u&&u!==t);if(null===c?o=s:c.next=l,!Ja(s,e.memoizedState)&&(Oo=!0,d&&null!==(a=Vn)))throw a;e.memoizedState=s,e.baseState=o,e.baseQueue=c,r.lastRenderedState=s}return null===n&&(r.lanes=0),[e.memoizedState,r.dispatch]}function pi(e){var t=li(),a=t.queue;if(null===a)throw Error(i(311));a.lastRenderedReducer=e;var r=a.dispatch,n=a.pending,s=t.memoizedState;if(null!==n){a.pending=null;var o=n=n.next;do{s=e(s,o.action),o=o.next}while(o!==n);Ja(s,t.memoizedState)||(Oo=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),a.lastRenderedState=s}return[s,r]}function gi(e,t,a){var r=Ws,n=li(),s=dn;if(s){if(void 0===a)throw Error(i(407));a=a()}else a=t();var o=!Ja((Hs||n).memoizedState,a);if(o&&(n.memoizedState=a,Oo=!0),n=n.queue,Bi(bi.bind(null,r,n,e),[e]),n.getSnapshot!==t||o||null!==Vs&&1&Vs.memoizedState.tag){if(r.flags|=2048,Ii(9,{destroy:void 0},yi.bind(null,r,n,a,t),null),null===mc)throw Error(i(349));s||0!==(127&Bs)||vi(r,t,a)}return a}function vi(e,t,a){e.flags|=16384,e={getSnapshot:t,value:a},null===(t=Ws.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},Ws.updateQueue=t,t.stores=[e]):null===(a=t.stores)?t.stores=[e]:a.push(e)}function yi(e,t,a,r){t.value=a,t.getSnapshot=r,wi(t)&&xi(e)}function bi(e,t,a){return a(function(){wi(t)&&xi(e)})}function wi(e){var t=e.getSnapshot;e=e.value;try{var a=t();return!Ja(e,a)}catch(r){return!0}}function xi(e){var t=Rr(e,2);null!==t&&Yc(t,e,2)}function ki(e){var t=oi();if("function"===typeof e){var a=e;if(e=a(),qs){be(!0);try{a()}finally{be(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:fi,lastRenderedState:e},t}function Si(e,t,a,r){return e.baseState=a,mi(e,Hs,"function"===typeof r?r:fi)}function Ei(e,t,a,r,n){if(fo(e))throw Error(i(485));if(null!==(e=t.action)){var s={payload:n,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){s.listeners.push(e)}};null!==D.T?a(!0):s.isTransition=!1,r(s),null===(a=t.pending)?(s.next=t.pending=s,Ti(t,s)):(s.next=a.next,t.pending=a.next=s)}}function Ti(e,t){var a=t.action,r=t.payload,n=e.state;if(t.isTransition){var s=D.T,i={};D.T=i;try{var o=a(n,r),l=D.S;null!==l&&l(i,o),Ni(e,t,o)}catch(c){Ci(e,t,c)}finally{null!==s&&null!==i.types&&(s.types=i.types),D.T=s}}else try{Ni(e,t,s=a(n,r))}catch(u){Ci(e,t,u)}}function Ni(e,t,a){null!==a&&"object"===typeof a&&"function"===typeof a.then?a.then(function(a){ji(e,t,a)},function(a){return Ci(e,t,a)}):ji(e,t,a)}function ji(e,t,a){t.status="fulfilled",t.value=a,_i(t),e.state=a,null!==(t=e.pending)&&((a=t.next)===t?e.pending=null:(a=a.next,t.next=a,Ti(e,a)))}function Ci(e,t,a){var r=e.pending;if(e.pending=null,null!==r){r=r.next;do{t.status="rejected",t.reason=a,_i(t),t=t.next}while(t!==r)}e.action=null}function _i(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function Ai(e,t){return t}function Pi(e,t){if(dn){var a=mc.formState;if(null!==a){e:{var r=Ws;if(dn){if(un){t:{for(var n=un,s=hn;8!==n.nodeType;){if(!s){n=null;break t}if(null===(n=Od(n.nextSibling))){n=null;break t}}n="F!"===(s=n.data)||"F"===s?n:null}if(n){un=Od(n.nextSibling),r="F!"===n.data;break e}}pn(r)}r=!1}r&&(t=a[0])}}return(a=oi()).memoizedState=a.baseState=t,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ai,lastRenderedState:t},a.queue=r,a=lo.bind(null,Ws,r),r.dispatch=a,r=ki(!1),s=uo.bind(null,Ws,!1,r.queue),n={state:t,dispatch:null,action:e,pending:null},(r=oi()).queue=n,a=Ei.bind(null,Ws,n,s,a),n.dispatch=a,r.memoizedState=e,[t,a,!1]}function Ri(e){return Oi(li(),Hs,e)}function Oi(e,t,a){if(t=mi(e,t,Ai)[0],e=hi(fi)[0],"object"===typeof t&&null!==t&&"function"===typeof t.then)try{var r=ci(t)}catch(i){if(i===Jn)throw Zn;throw i}else r=t;var n=(t=li()).queue,s=n.dispatch;return a!==t.memoizedState&&(Ws.flags|=2048,Ii(9,{destroy:void 0},Di.bind(null,n,a),null)),[r,s,e]}function Di(e,t){e.action=t}function Fi(e){var t=li(),a=Hs;if(null!==a)return Oi(t,a,e);li(),t=t.memoizedState;var r=(a=li()).queue.dispatch;return a.memoizedState=e,[t,r,!1]}function Ii(e,t,a,r){return e={tag:e,create:a,deps:r,inst:t,next:null},null===(t=Ws.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},Ws.updateQueue=t),null===(a=t.lastEffect)?t.lastEffect=e.next=e:(r=a.next,a.next=e,e.next=r,t.lastEffect=e),e}function Li(){return li().memoizedState}function Mi(e,t,a,r){var n=oi();Ws.flags|=e,n.memoizedState=Ii(1|t,{destroy:void 0},a,void 0===r?null:r)}function zi(e,t,a,r){var n=li();r=void 0===r?null:r;var s=n.memoizedState.inst;null!==Hs&&null!==r&&Zs(r,Hs.memoizedState.deps)?n.memoizedState=Ii(t,s,a,r):(Ws.flags|=e,n.memoizedState=Ii(1|t,s,a,r))}function Ui(e,t){Mi(8390656,8,e,t)}function Bi(e,t){zi(2048,8,e,t)}function Wi(e){var t=li().memoizedState;return function(e){Ws.flags|=4;var t=Ws.updateQueue;if(null===t)t={lastEffect:null,events:null,stores:null,memoCache:null},Ws.updateQueue=t,t.events=[e];else{var a=t.events;null===a?t.events=[e]:a.push(e)}}({ref:t,nextImpl:e}),function(){if(0!==(2&hc))throw Error(i(440));return t.impl.apply(void 0,arguments)}}function Hi(e,t){return zi(4,2,e,t)}function Vi(e,t){return zi(4,4,e,t)}function Gi(e,t){if("function"===typeof t){e=e();var a=t(e);return function(){"function"===typeof a?a():t(null)}}if(null!==t&&void 0!==t)return e=e(),t.current=e,function(){t.current=null}}function $i(e,t,a){a=null!==a&&void 0!==a?a.concat([e]):null,zi(4,4,Gi.bind(null,t,e),a)}function qi(){}function Yi(e,t){var a=li();t=void 0===t?null:t;var r=a.memoizedState;return null!==t&&Zs(t,r[1])?r[0]:(a.memoizedState=[e,t],e)}function Xi(e,t){var a=li();t=void 0===t?null:t;var r=a.memoizedState;if(null!==t&&Zs(t,r[1]))return r[0];if(r=e(),qs){be(!0);try{e()}finally{be(!1)}}return a.memoizedState=[r,t],r}function Ki(e,t,a){return void 0===a||0!==(1073741824&Bs)&&0===(261930&gc)?e.memoizedState=t:(e.memoizedState=a,e=qc(),Ws.lanes|=e,Ec|=e,a)}function Ji(e,t,a,r){return Ja(a,t)?a:null!==js.current?(e=Ki(e,a,r),Ja(e,t)||(Oo=!0),e):0===(42&Bs)||0!==(1073741824&Bs)&&0===(261930&gc)?(Oo=!0,e.memoizedState=a):(e=qc(),Ws.lanes|=e,Ec|=e,t)}function Qi(e,t,a,r,n){var s=F.p;F.p=0!==s&&8>s?s:8;var i=D.T,o={};D.T=o,uo(e,!1,t,a);try{var l=n(),c=D.S;if(null!==c&&c(o,l),null!==l&&"object"===typeof l&&"function"===typeof l.then)co(e,t,function(e,t){var a=[],r={status:"pending",value:null,reason:null,then:function(e){a.push(e)}};return e.then(function(){r.status="fulfilled",r.value=t;for(var e=0;e<a.length;e++)(0,a[e])(t)},function(e){for(r.status="rejected",r.reason=e,e=0;e<a.length;e++)(0,a[e])(void 0)}),r}(l,r),$c());else co(e,t,r,$c())}catch(u){co(e,t,{then:function(){},status:"rejected",reason:u},$c())}finally{F.p=s,null!==i&&null!==o.types&&(i.types=o.types),D.T=i}}function Zi(){}function eo(e,t,a,r){if(5!==e.tag)throw Error(i(476));var n=to(e).queue;Qi(e,n,t,I,null===a?Zi:function(){return ao(e),a(r)})}function to(e){var t=e.memoizedState;if(null!==t)return t;var a={};return(t={memoizedState:I,baseState:I,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:fi,lastRenderedState:I},next:null}).next={memoizedState:a,baseState:a,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:fi,lastRenderedState:a},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function ao(e){var t=to(e);null===t.next&&(t=e.alternate.memoizedState),co(e,t.next.queue,{},$c())}function ro(){return Rn(df)}function no(){return li().memoizedState}function so(){return li().memoizedState}function io(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var a=$c(),r=bs(t,e=ys(a),a);return null!==r&&(Yc(r,t,a),ws(r,t,a)),t={cache:zn()},void(e.payload=t)}t=t.return}}function oo(e,t,a){var r=$c();a={lane:r,revertLane:0,gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null},fo(e)?ho(t,a):null!==(a=Pr(e,t,a,r))&&(Yc(a,e,r),mo(a,t,r))}function lo(e,t,a){co(e,t,a,$c())}function co(e,t,a,r){var n={lane:r,revertLane:0,gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null};if(fo(e))ho(t,n);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var i=t.lastRenderedState,o=s(i,a);if(n.hasEagerState=!0,n.eagerState=o,Ja(o,i))return Ar(e,t,n,0),null===mc&&_r(),!1}catch(l){}if(null!==(a=Pr(e,t,n,r)))return Yc(a,e,r),mo(a,t,r),!0}return!1}function uo(e,t,a,r){if(r={lane:2,revertLane:Wu(),gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null},fo(e)){if(t)throw Error(i(479))}else null!==(t=Pr(e,a,r,2))&&Yc(t,e,2)}function fo(e){var t=e.alternate;return e===Ws||null!==t&&t===Ws}function ho(e,t){$s=Gs=!0;var a=e.pending;null===a?t.next=t:(t.next=a.next,a.next=t),e.pending=t}function mo(e,t,a){if(0!==(4194048&a)){var r=t.lanes;a|=r&=e.pendingLanes,t.lanes=a,De(e,a)}}var po={readContext:Rn,use:ui,useCallback:Qs,useContext:Qs,useEffect:Qs,useImperativeHandle:Qs,useLayoutEffect:Qs,useInsertionEffect:Qs,useMemo:Qs,useReducer:Qs,useRef:Qs,useState:Qs,useDebugValue:Qs,useDeferredValue:Qs,useTransition:Qs,useSyncExternalStore:Qs,useId:Qs,useHostTransitionStatus:Qs,useFormState:Qs,useActionState:Qs,useOptimistic:Qs,useMemoCache:Qs,useCacheRefresh:Qs};po.useEffectEvent=Qs;var go={readContext:Rn,use:ui,useCallback:function(e,t){return oi().memoizedState=[e,void 0===t?null:t],e},useContext:Rn,useEffect:Ui,useImperativeHandle:function(e,t,a){a=null!==a&&void 0!==a?a.concat([e]):null,Mi(4194308,4,Gi.bind(null,t,e),a)},useLayoutEffect:function(e,t){return Mi(4194308,4,e,t)},useInsertionEffect:function(e,t){Mi(4,2,e,t)},useMemo:function(e,t){var a=oi();t=void 0===t?null:t;var r=e();if(qs){be(!0);try{e()}finally{be(!1)}}return a.memoizedState=[r,t],r},useReducer:function(e,t,a){var r=oi();if(void 0!==a){var n=a(t);if(qs){be(!0);try{a(t)}finally{be(!1)}}}else n=t;return r.memoizedState=r.baseState=n,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:n},r.queue=e,e=e.dispatch=oo.bind(null,Ws,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},oi().memoizedState=e},useState:function(e){var t=(e=ki(e)).queue,a=lo.bind(null,Ws,t);return t.dispatch=a,[e.memoizedState,a]},useDebugValue:qi,useDeferredValue:function(e,t){return Ki(oi(),e,t)},useTransition:function(){var e=ki(!1);return e=Qi.bind(null,Ws,e.queue,!0,!1),oi().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,a){var r=Ws,n=oi();if(dn){if(void 0===a)throw Error(i(407));a=a()}else{if(a=t(),null===mc)throw Error(i(349));0!==(127&gc)||vi(r,t,a)}n.memoizedState=a;var s={value:a,getSnapshot:t};return n.queue=s,Ui(bi.bind(null,r,s,e),[e]),r.flags|=2048,Ii(9,{destroy:void 0},yi.bind(null,r,s,a,t),null),a},useId:function(){var e=oi(),t=mc.identifierPrefix;if(dn){var a=an;t="_"+t+"R_"+(a=(tn&~(1<<32-we(tn)-1)).toString(32)+a),0<(a=Ys++)&&(t+="H"+a.toString(32)),t+="_"}else t="_"+t+"r_"+(a=Js++).toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:ro,useFormState:Pi,useActionState:Pi,useOptimistic:function(e){var t=oi();t.memoizedState=t.baseState=e;var a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=a,t=uo.bind(null,Ws,!0,a),a.dispatch=t,[e,t]},useMemoCache:di,useCacheRefresh:function(){return oi().memoizedState=io.bind(null,Ws)},useEffectEvent:function(e){var t=oi(),a={impl:e};return t.memoizedState=a,function(){if(0!==(2&hc))throw Error(i(440));return a.impl.apply(void 0,arguments)}}},vo={readContext:Rn,use:ui,useCallback:Yi,useContext:Rn,useEffect:Bi,useImperativeHandle:$i,useInsertionEffect:Hi,useLayoutEffect:Vi,useMemo:Xi,useReducer:hi,useRef:Li,useState:function(){return hi(fi)},useDebugValue:qi,useDeferredValue:function(e,t){return Ji(li(),Hs.memoizedState,e,t)},useTransition:function(){var e=hi(fi)[0],t=li().memoizedState;return["boolean"===typeof e?e:ci(e),t]},useSyncExternalStore:gi,useId:no,useHostTransitionStatus:ro,useFormState:Ri,useActionState:Ri,useOptimistic:function(e,t){return Si(li(),0,e,t)},useMemoCache:di,useCacheRefresh:so};vo.useEffectEvent=Wi;var yo={readContext:Rn,use:ui,useCallback:Yi,useContext:Rn,useEffect:Bi,useImperativeHandle:$i,useInsertionEffect:Hi,useLayoutEffect:Vi,useMemo:Xi,useReducer:pi,useRef:Li,useState:function(){return pi(fi)},useDebugValue:qi,useDeferredValue:function(e,t){var a=li();return null===Hs?Ki(a,e,t):Ji(a,Hs.memoizedState,e,t)},useTransition:function(){var e=pi(fi)[0],t=li().memoizedState;return["boolean"===typeof e?e:ci(e),t]},useSyncExternalStore:gi,useId:no,useHostTransitionStatus:ro,useFormState:Fi,useActionState:Fi,useOptimistic:function(e,t){var a=li();return null!==Hs?Si(a,0,e,t):(a.baseState=e,[e,a.queue.dispatch])},useMemoCache:di,useCacheRefresh:so};function bo(e,t,a,r){a=null===(a=a(r,t=e.memoizedState))||void 0===a?t:h({},t,a),e.memoizedState=a,0===e.lanes&&(e.updateQueue.baseState=a)}yo.useEffectEvent=Wi;var wo={enqueueSetState:function(e,t,a){e=e._reactInternals;var r=$c(),n=ys(r);n.payload=t,void 0!==a&&null!==a&&(n.callback=a),null!==(t=bs(e,n,r))&&(Yc(t,e,r),ws(t,e,r))},enqueueReplaceState:function(e,t,a){e=e._reactInternals;var r=$c(),n=ys(r);n.tag=1,n.payload=t,void 0!==a&&null!==a&&(n.callback=a),null!==(t=bs(e,n,r))&&(Yc(t,e,r),ws(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var a=$c(),r=ys(a);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=bs(e,r,a))&&(Yc(t,e,a),ws(t,e,a))}};function xo(e,t,a,r,n,s,i){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,s,i):!t.prototype||!t.prototype.isPureReactComponent||(!Qa(a,r)||!Qa(n,s))}function ko(e,t,a,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(a,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(a,r),t.state!==e&&wo.enqueueReplaceState(t,t.state,null)}function So(e,t){var a=t;if("ref"in t)for(var r in a={},t)"ref"!==r&&(a[r]=t[r]);if(e=e.defaultProps)for(var n in a===t&&(a=h({},a)),e)void 0===a[n]&&(a[n]=e[n]);return a}function Eo(e){Tr(e)}function To(e){console.error(e)}function No(e){Tr(e)}function jo(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(a){setTimeout(function(){throw a})}}function Co(e,t,a){try{(0,e.onCaughtError)(a.value,{componentStack:a.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(r){setTimeout(function(){throw r})}}function _o(e,t,a){return(a=ys(a)).tag=3,a.payload={element:null},a.callback=function(){jo(e,t)},a}function Ao(e){return(e=ys(e)).tag=3,e}function Po(e,t,a,r){var n=a.type.getDerivedStateFromError;if("function"===typeof n){var s=r.value;e.payload=function(){return n(s)},e.callback=function(){Co(t,a,r)}}var i=a.stateNode;null!==i&&"function"===typeof i.componentDidCatch&&(e.callback=function(){Co(t,a,r),"function"!==typeof n&&(null===Ic?Ic=new Set([this]):Ic.add(this));var e=r.stack;this.componentDidCatch(r.value,{componentStack:null!==e?e:""})})}var Ro=Error(i(461)),Oo=!1;function Do(e,t,a,r){t.child=null===e?ms(t,null,a,r):hs(t,e.child,a,r)}function Fo(e,t,a,r,n){a=a.render;var s=t.ref;if("ref"in r){var i={};for(var o in r)"ref"!==o&&(i[o]=r[o])}else i=r;return Pn(t),r=ei(e,t,a,i,s,n),o=ni(),null===e||Oo?(dn&&o&&sn(t),t.flags|=1,Do(e,t,r,n),t.child):(si(e,t,n),nl(e,t,n))}function Io(e,t,a,r,n){if(null===e){var s=a.type;return"function"!==typeof s||Mr(s)||void 0!==s.defaultProps||null!==a.compare?((e=Br(a.type,null,r,t,t.mode,n)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,Lo(e,t,s,r,n))}if(s=e.child,!sl(e,n)){var i=s.memoizedProps;if((a=null!==(a=a.compare)?a:Qa)(i,r)&&e.ref===t.ref)return nl(e,t,n)}return t.flags|=1,(e=zr(s,r)).ref=t.ref,e.return=t,t.child=e}function Lo(e,t,a,r,n){if(null!==e){var s=e.memoizedProps;if(Qa(s,r)&&e.ref===t.ref){if(Oo=!1,t.pendingProps=r=s,!sl(e,n))return t.lanes=e.lanes,nl(e,t,n);0!==(131072&e.flags)&&(Oo=!0)}}return Vo(e,t,a,r,n)}function Mo(e,t,a,r){var n=r.children,s=null!==e?e.memoizedState:null;if(null===e&&null===t.stateNode&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),"hidden"===r.mode){if(0!==(128&t.flags)){if(s=null!==s?s.baseLanes|a:a,null!==e){for(r=t.child=e.child,n=0;null!==r;)n=n|r.lanes|r.childLanes,r=r.sibling;r=n&~s}else r=0,t.child=null;return Uo(e,t,s,a,r)}if(0===(536870912&a))return r=t.lanes=536870912,Uo(e,t,null!==s?s.baseLanes|a:a,a,r);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&Xn(0,null!==s?s.cachePool:null),null!==s?_s(t,s):As(),Is(t)}else null!==s?(Xn(0,s.cachePool),_s(t,s),Ls(),t.memoizedState=null):(null!==e&&Xn(0,null),As(),Ls());return Do(e,t,n,a),t.child}function zo(e,t){return null!==e&&22===e.tag||null!==t.stateNode||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function Uo(e,t,a,r,n){var s=Yn();return s=null===s?null:{parent:Mn._currentValue,pool:s},t.memoizedState={baseLanes:a,cachePool:s},null!==e&&Xn(0,null),As(),Is(t),null!==e&&_n(e,t,r,!0),t.childLanes=n,null}function Bo(e,t){return(t=Zo({mode:t.mode,children:t.children},e.mode)).ref=e.ref,e.child=t,t.return=e,t}function Wo(e,t,a){return hs(t,e.child,null,a),(e=Bo(t,t.pendingProps)).flags|=2,Ms(t),t.memoizedState=null,e}function Ho(e,t){var a=t.ref;if(null===a)null!==e&&null!==e.ref&&(t.flags|=4194816);else{if("function"!==typeof a&&"object"!==typeof a)throw Error(i(284));null!==e&&e.ref===a||(t.flags|=4194816)}}function Vo(e,t,a,r,n){return Pn(t),a=ei(e,t,a,r,void 0,n),r=ni(),null===e||Oo?(dn&&r&&sn(t),t.flags|=1,Do(e,t,a,n),t.child):(si(e,t,n),nl(e,t,n))}function Go(e,t,a,r,n,s){return Pn(t),t.updateQueue=null,a=ai(t,r,a,n),ti(e),r=ni(),null===e||Oo?(dn&&r&&sn(t),t.flags|=1,Do(e,t,a,s),t.child):(si(e,t,s),nl(e,t,s))}function $o(e,t,a,r,n){if(Pn(t),null===t.stateNode){var s=Fr,i=a.contextType;"object"===typeof i&&null!==i&&(s=Rn(i)),s=new a(r,s),t.memoizedState=null!==s.state&&void 0!==s.state?s.state:null,s.updater=wo,t.stateNode=s,s._reactInternals=t,(s=t.stateNode).props=r,s.state=t.memoizedState,s.refs={},gs(t),i=a.contextType,s.context="object"===typeof i&&null!==i?Rn(i):Fr,s.state=t.memoizedState,"function"===typeof(i=a.getDerivedStateFromProps)&&(bo(t,a,i,r),s.state=t.memoizedState),"function"===typeof a.getDerivedStateFromProps||"function"===typeof s.getSnapshotBeforeUpdate||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||(i=s.state,"function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount(),i!==s.state&&wo.enqueueReplaceState(s,s.state,null),Es(t,r,s,n),Ss(),s.state=t.memoizedState),"function"===typeof s.componentDidMount&&(t.flags|=4194308),r=!0}else if(null===e){s=t.stateNode;var o=t.memoizedProps,l=So(a,o);s.props=l;var c=s.context,u=a.contextType;i=Fr,"object"===typeof u&&null!==u&&(i=Rn(u));var d=a.getDerivedStateFromProps;u="function"===typeof d||"function"===typeof s.getSnapshotBeforeUpdate,o=t.pendingProps!==o,u||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(o||c!==i)&&ko(t,s,r,i),ps=!1;var f=t.memoizedState;s.state=f,Es(t,r,s,n),Ss(),c=t.memoizedState,o||f!==c||ps?("function"===typeof d&&(bo(t,a,d,r),c=t.memoizedState),(l=ps||xo(t,a,l,r,f,c,i))?(u||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(t.flags|=4194308)):("function"===typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),s.props=r,s.state=c,s.context=i,r=l):("function"===typeof s.componentDidMount&&(t.flags|=4194308),r=!1)}else{s=t.stateNode,vs(e,t),u=So(a,i=t.memoizedProps),s.props=u,d=t.pendingProps,f=s.context,c=a.contextType,l=Fr,"object"===typeof c&&null!==c&&(l=Rn(c)),(c="function"===typeof(o=a.getDerivedStateFromProps)||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(i!==d||f!==l)&&ko(t,s,r,l),ps=!1,f=t.memoizedState,s.state=f,Es(t,r,s,n),Ss();var h=t.memoizedState;i!==d||f!==h||ps||null!==e&&null!==e.dependencies&&An(e.dependencies)?("function"===typeof o&&(bo(t,a,o,r),h=t.memoizedState),(u=ps||xo(t,a,u,r,f,h,l)||null!==e&&null!==e.dependencies&&An(e.dependencies))?(c||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(r,h,l),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(r,h,l)),"function"===typeof s.componentDidUpdate&&(t.flags|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof s.componentDidUpdate||i===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||i===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=h),s.props=r,s.state=h,s.context=l,r=u):("function"!==typeof s.componentDidUpdate||i===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||i===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),r=!1)}return s=r,Ho(e,t),r=0!==(128&t.flags),s||r?(s=t.stateNode,a=r&&"function"!==typeof a.getDerivedStateFromError?null:s.render(),t.flags|=1,null!==e&&r?(t.child=hs(t,e.child,null,n),t.child=hs(t,null,a,n)):Do(e,t,a,n),t.memoizedState=s.state,e=t.child):e=nl(e,t,n),e}function qo(e,t,a,r){return bn(),t.flags|=256,Do(e,t,a,r),t.child}var Yo={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Xo(e){return{baseLanes:e,cachePool:Kn()}}function Ko(e,t,a){return e=null!==e?e.childLanes&~a:0,t&&(e|=jc),e}function Jo(e,t,a){var r,n=t.pendingProps,s=!1,o=0!==(128&t.flags);if((r=o)||(r=(null===e||null!==e.memoizedState)&&0!==(2&zs.current)),r&&(s=!0,t.flags&=-129),r=0!==(32&t.flags),t.flags&=-33,null===e){if(dn){if(s?Ds(t):Ls(),(e=un)?null!==(e=null!==(e=Ad(e,hn))&&"&"!==e.data?e:null)&&(t.memoizedState={dehydrated:e,treeContext:null!==en?{id:tn,overflow:an}:null,retryLane:536870912,hydrationErrors:null},(a=Vr(e)).return=t,t.child=a,cn=t,un=null):e=null,null===e)throw pn(t);return Rd(e)?t.lanes=32:t.lanes=536870912,null}var l=n.children;return n=n.fallback,s?(Ls(),l=Zo({mode:"hidden",children:l},s=t.mode),n=Wr(n,s,a,null),l.return=t,n.return=t,l.sibling=n,t.child=l,(n=t.child).memoizedState=Xo(a),n.childLanes=Ko(e,r,a),t.memoizedState=Yo,zo(null,n)):(Ds(t),Qo(t,l))}var c=e.memoizedState;if(null!==c&&null!==(l=c.dehydrated)){if(o)256&t.flags?(Ds(t),t.flags&=-257,t=el(e,t,a)):null!==t.memoizedState?(Ls(),t.child=e.child,t.flags|=128,t=null):(Ls(),l=n.fallback,s=t.mode,n=Zo({mode:"visible",children:n.children},s),(l=Wr(l,s,a,null)).flags|=2,n.return=t,l.return=t,n.sibling=l,t.child=n,hs(t,e.child,null,a),(n=t.child).memoizedState=Xo(a),n.childLanes=Ko(e,r,a),t.memoizedState=Yo,t=zo(null,n));else if(Ds(t),Rd(l)){if(r=l.nextSibling&&l.nextSibling.dataset)var u=r.dgst;r=u,(n=Error(i(419))).stack="",n.digest=r,xn({value:n,source:null,stack:null}),t=el(e,t,a)}else if(Oo||_n(e,t,a,!1),r=0!==(a&e.childLanes),Oo||r){if(null!==(r=mc)&&(0!==(n=Fe(r,a))&&n!==c.retryLane))throw c.retryLane=n,Rr(e,n),Yc(r,e,n),Ro;Pd(l)||iu(),t=el(e,t,a)}else Pd(l)?(t.flags|=192,t.child=e.child,t=null):(e=c.treeContext,un=Od(l.nextSibling),cn=t,dn=!0,fn=null,hn=!1,null!==e&&ln(t,e),(t=Qo(t,n.children)).flags|=4096);return t}return s?(Ls(),l=n.fallback,s=t.mode,u=(c=e.child).sibling,(n=zr(c,{mode:"hidden",children:n.children})).subtreeFlags=65011712&c.subtreeFlags,null!==u?l=zr(u,l):(l=Wr(l,s,a,null)).flags|=2,l.return=t,n.return=t,n.sibling=l,t.child=n,zo(null,n),n=t.child,null===(l=e.child.memoizedState)?l=Xo(a):(null!==(s=l.cachePool)?(c=Mn._currentValue,s=s.parent!==c?{parent:c,pool:c}:s):s=Kn(),l={baseLanes:l.baseLanes|a,cachePool:s}),n.memoizedState=l,n.childLanes=Ko(e,r,a),t.memoizedState=Yo,zo(e.child,n)):(Ds(t),e=(a=e.child).sibling,(a=zr(a,{mode:"visible",children:n.children})).return=t,a.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=a,t.memoizedState=null,a)}function Qo(e,t){return(t=Zo({mode:"visible",children:t},e.mode)).return=e,e.child=t}function Zo(e,t){return(e=Lr(22,e,null,t)).lanes=0,e}function el(e,t,a){return hs(t,e.child,null,a),(e=Qo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function tl(e,t,a){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),jn(e.return,t,a)}function al(e,t,a,r,n,s){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:a,tailMode:n,treeForkCount:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=a,i.tailMode=n,i.treeForkCount=s)}function rl(e,t,a){var r=t.pendingProps,n=r.revealOrder,s=r.tail;r=r.children;var i=zs.current,o=0!==(2&i);if(o?(i=1&i|2,t.flags|=128):i&=1,B(zs,i),Do(e,t,r,a),r=dn?Jr:0,!o&&null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&tl(e,a,t);else if(19===e.tag)tl(e,a,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(n){case"forwards":for(a=t.child,n=null;null!==a;)null!==(e=a.alternate)&&null===Us(e)&&(n=a),a=a.sibling;null===(a=n)?(n=t.child,t.child=null):(n=a.sibling,a.sibling=null),al(t,!1,n,a,s,r);break;case"backwards":case"unstable_legacy-backwards":for(a=null,n=t.child,t.child=null;null!==n;){if(null!==(e=n.alternate)&&null===Us(e)){t.child=n;break}e=n.sibling,n.sibling=a,a=n,n=e}al(t,!0,a,null,s,r);break;case"together":al(t,!1,null,null,void 0,r);break;default:t.memoizedState=null}return t.child}function nl(e,t,a){if(null!==e&&(t.dependencies=e.dependencies),Ec|=t.lanes,0===(a&t.childLanes)){if(null===e)return null;if(_n(e,t,a,!1),0===(a&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(a=zr(e=t.child,e.pendingProps),t.child=a,a.return=t;null!==e.sibling;)e=e.sibling,(a=a.sibling=zr(e,e.pendingProps)).return=t;a.sibling=null}return t.child}function sl(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!An(e))}function il(e,t,a){if(null!==e)if(e.memoizedProps!==t.pendingProps)Oo=!0;else{if(!sl(e,a)&&0===(128&t.flags))return Oo=!1,function(e,t,a){switch(t.tag){case 3:Y(t,t.stateNode.containerInfo),Tn(0,Mn,e.memoizedState.cache),bn();break;case 27:case 5:K(t);break;case 4:Y(t,t.stateNode.containerInfo);break;case 10:Tn(0,t.type,t.memoizedProps.value);break;case 31:if(null!==t.memoizedState)return t.flags|=128,Fs(t),null;break;case 13:var r=t.memoizedState;if(null!==r)return null!==r.dehydrated?(Ds(t),t.flags|=128,null):0!==(a&t.child.childLanes)?Jo(e,t,a):(Ds(t),null!==(e=nl(e,t,a))?e.sibling:null);Ds(t);break;case 19:var n=0!==(128&e.flags);if((r=0!==(a&t.childLanes))||(_n(e,t,a,!1),r=0!==(a&t.childLanes)),n){if(r)return rl(e,t,a);t.flags|=128}if(null!==(n=t.memoizedState)&&(n.rendering=null,n.tail=null,n.lastEffect=null),B(zs,zs.current),r)break;return null;case 22:return t.lanes=0,Mo(e,t,a,t.pendingProps);case 24:Tn(0,Mn,e.memoizedState.cache)}return nl(e,t,a)}(e,t,a);Oo=0!==(131072&e.flags)}else Oo=!1,dn&&0!==(1048576&t.flags)&&nn(t,Jr,t.index);switch(t.lanes=0,t.tag){case 16:e:{var r=t.pendingProps;if(e=rs(t.elementType),t.type=e,"function"!==typeof e){if(void 0!==e&&null!==e){var n=e.$$typeof;if(n===k){t.tag=11,t=Fo(null,t,e,r,a);break e}if(n===T){t.tag=14,t=Io(null,t,e,r,a);break e}}throw t=R(e)||e,Error(i(306,t,""))}Mr(e)?(r=So(e,r),t.tag=1,t=$o(null,t,e,r,a)):(t.tag=0,t=Vo(null,t,e,r,a))}return t;case 0:return Vo(e,t,t.type,t.pendingProps,a);case 1:return $o(e,t,r=t.type,n=So(r,t.pendingProps),a);case 3:e:{if(Y(t,t.stateNode.containerInfo),null===e)throw Error(i(387));r=t.pendingProps;var s=t.memoizedState;n=s.element,vs(e,t),Es(t,r,null,a);var o=t.memoizedState;if(r=o.cache,Tn(0,Mn,r),r!==s.cache&&Cn(t,[Mn],a,!0),Ss(),r=o.element,s.isDehydrated){if(s={element:r,isDehydrated:!1,cache:o.cache},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=qo(e,t,r,a);break e}if(r!==n){xn(n=qr(Error(i(424)),t)),t=qo(e,t,r,a);break e}if(9===(e=t.stateNode.containerInfo).nodeType)e=e.body;else e="HTML"===e.nodeName?e.ownerDocument.body:e;for(un=Od(e.firstChild),cn=t,dn=!0,fn=null,hn=!0,a=ms(t,null,r,a),t.child=a;a;)a.flags=-3&a.flags|4096,a=a.sibling}else{if(bn(),r===n){t=nl(e,t,a);break e}Do(e,t,r,a)}t=t.child}return t;case 26:return Ho(e,t),null===e?(a=Gd(t.type,null,t.pendingProps,null))?t.memoizedState=a:dn||(a=t.type,e=t.pendingProps,(r=gd($.current).createElement(a))[Be]=t,r[We]=e,fd(r,a,e),et(r),t.stateNode=r):t.memoizedState=Gd(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return K(t),null===e&&dn&&(r=t.stateNode=Ld(t.type,t.pendingProps,$.current),cn=t,hn=!0,n=un,Nd(t.type)?(Dd=n,un=Od(r.firstChild)):un=n),Do(e,t,t.pendingProps.children,a),Ho(e,t),null===e&&(t.flags|=4194304),t.child;case 5:return null===e&&dn&&((n=r=un)&&(null!==(r=function(e,t,a,r){for(;1===e.nodeType;){var n=a;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!r&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(r){if(!e[Ye])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(s=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(s!==n.rel||e.getAttribute("href")!==(null==n.href||""===n.href?null:n.href)||e.getAttribute("crossorigin")!==(null==n.crossOrigin?null:n.crossOrigin)||e.getAttribute("title")!==(null==n.title?null:n.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((s=e.getAttribute("src"))!==(null==n.src?null:n.src)||e.getAttribute("type")!==(null==n.type?null:n.type)||e.getAttribute("crossorigin")!==(null==n.crossOrigin?null:n.crossOrigin))&&s&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var s=null==n.name?null:""+n.name;if("hidden"===n.type&&e.getAttribute("name")===s)return e}if(null===(e=Od(e.nextSibling)))break}return null}(r,t.type,t.pendingProps,hn))?(t.stateNode=r,cn=t,un=Od(r.firstChild),hn=!1,n=!0):n=!1),n||pn(t)),K(t),n=t.type,s=t.pendingProps,o=null!==e?e.memoizedProps:null,r=s.children,bd(n,s)?r=null:null!==o&&bd(n,o)&&(t.flags|=32),null!==t.memoizedState&&(n=ei(e,t,ri,null,null,a),df._currentValue=n),Ho(e,t),Do(e,t,r,a),t.child;case 6:return null===e&&dn&&((e=a=un)&&(null!==(a=function(e,t,a){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!a)return null;if(null===(e=Od(e.nextSibling)))return null}return e}(a,t.pendingProps,hn))?(t.stateNode=a,cn=t,un=null,e=!0):e=!1),e||pn(t)),null;case 13:return Jo(e,t,a);case 4:return Y(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=hs(t,null,r,a):Do(e,t,r,a),t.child;case 11:return Fo(e,t,t.type,t.pendingProps,a);case 7:return Do(e,t,t.pendingProps,a),t.child;case 8:case 12:return Do(e,t,t.pendingProps.children,a),t.child;case 10:return r=t.pendingProps,Tn(0,t.type,r.value),Do(e,t,r.children,a),t.child;case 9:return n=t.type._context,r=t.pendingProps.children,Pn(t),r=r(n=Rn(n)),t.flags|=1,Do(e,t,r,a),t.child;case 14:return Io(e,t,t.type,t.pendingProps,a);case 15:return Lo(e,t,t.type,t.pendingProps,a);case 19:return rl(e,t,a);case 31:return function(e,t,a){var r=t.pendingProps,n=0!==(128&t.flags);if(t.flags&=-129,null===e){if(dn){if("hidden"===r.mode)return e=Bo(t,r),t.lanes=536870912,zo(null,e);if(Fs(t),(e=un)?null!==(e=null!==(e=Ad(e,hn))&&"&"===e.data?e:null)&&(t.memoizedState={dehydrated:e,treeContext:null!==en?{id:tn,overflow:an}:null,retryLane:536870912,hydrationErrors:null},(a=Vr(e)).return=t,t.child=a,cn=t,un=null):e=null,null===e)throw pn(t);return t.lanes=536870912,null}return Bo(t,r)}var s=e.memoizedState;if(null!==s){var o=s.dehydrated;if(Fs(t),n)if(256&t.flags)t.flags&=-257,t=Wo(e,t,a);else{if(null===t.memoizedState)throw Error(i(558));t.child=e.child,t.flags|=128,t=null}else if(Oo||_n(e,t,a,!1),n=0!==(a&e.childLanes),Oo||n){if(null!==(r=mc)&&0!==(o=Fe(r,a))&&o!==s.retryLane)throw s.retryLane=o,Rr(e,o),Yc(r,e,o),Ro;iu(),t=Wo(e,t,a)}else e=s.treeContext,un=Od(o.nextSibling),cn=t,dn=!0,fn=null,hn=!1,null!==e&&ln(t,e),(t=Bo(t,r)).flags|=4096;return t}return(e=zr(e.child,{mode:r.mode,children:r.children})).ref=t.ref,t.child=e,e.return=t,e}(e,t,a);case 22:return Mo(e,t,a,t.pendingProps);case 24:return Pn(t),r=Rn(Mn),null===e?(null===(n=Yn())&&(n=mc,s=zn(),n.pooledCache=s,s.refCount++,null!==s&&(n.pooledCacheLanes|=a),n=s),t.memoizedState={parent:r,cache:n},gs(t),Tn(0,Mn,n)):(0!==(e.lanes&a)&&(vs(e,t),Es(t,null,null,a),Ss()),n=e.memoizedState,s=t.memoizedState,n.parent!==r?(n={parent:r,cache:r},t.memoizedState=n,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=n),Tn(0,Mn,r)):(r=s.cache,Tn(0,Mn,r),r!==n.cache&&Cn(t,[Mn],a,!0))),Do(e,t,t.pendingProps.children,a),t.child;case 29:throw t.pendingProps}throw Error(i(156,t.tag))}function ol(e){e.flags|=4}function ll(e,t,a,r,n){if((t=0!==(32&e.mode))&&(t=!1),t){if(e.flags|=16777216,(335544128&n)===n)if(e.stateNode.complete)e.flags|=8192;else{if(!ru())throw ns=es,Qn;e.flags|=8192}}else e.flags&=-16777217}function cl(e,t){if("stylesheet"!==t.type||0!==(4&t.state.loading))e.flags&=-16777217;else if(e.flags|=16777216,!nf(t)){if(!ru())throw ns=es,Qn;e.flags|=8192}}function ul(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?Ae():536870912,e.lanes|=t,Cc|=t)}function dl(e,t){if(!dn)switch(e.tailMode){case"hidden":t=e.tail;for(var a=null;null!==t;)null!==t.alternate&&(a=t),t=t.sibling;null===a?e.tail=null:a.sibling=null;break;case"collapsed":a=e.tail;for(var r=null;null!==a;)null!==a.alternate&&(r=a),a=a.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function fl(e){var t=null!==e.alternate&&e.alternate.child===e.child,a=0,r=0;if(t)for(var n=e.child;null!==n;)a|=n.lanes|n.childLanes,r|=65011712&n.subtreeFlags,r|=65011712&n.flags,n.return=e,n=n.sibling;else for(n=e.child;null!==n;)a|=n.lanes|n.childLanes,r|=n.subtreeFlags,r|=n.flags,n.return=e,n=n.sibling;return e.subtreeFlags|=r,e.childLanes=a,t}function hl(e,t,a){var r=t.pendingProps;switch(on(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return fl(t),null;case 3:return a=t.stateNode,r=null,null!==e&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),Nn(Mn),X(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),null!==e&&null!==e.child||(yn(t)?ol(t):null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,wn())),fl(t),null;case 26:var n=t.type,s=t.memoizedState;return null===e?(ol(t),null!==s?(fl(t),cl(t,s)):(fl(t),ll(t,n,0,0,a))):s?s!==e.memoizedState?(ol(t),fl(t),cl(t,s)):(fl(t),t.flags&=-16777217):((e=e.memoizedProps)!==r&&ol(t),fl(t),ll(t,n,0,0,a)),null;case 27:if(J(t),a=$.current,n=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==r&&ol(t);else{if(!r){if(null===t.stateNode)throw Error(i(166));return fl(t),null}e=V.current,yn(t)?gn(t):(e=Ld(n,r,a),t.stateNode=e,ol(t))}return fl(t),null;case 5:if(J(t),n=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==r&&ol(t);else{if(!r){if(null===t.stateNode)throw Error(i(166));return fl(t),null}if(s=V.current,yn(t))gn(t);else{var o=gd($.current);switch(s){case 1:s=o.createElementNS("http://www.w3.org/2000/svg",n);break;case 2:s=o.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;default:switch(n){case"svg":s=o.createElementNS("http://www.w3.org/2000/svg",n);break;case"math":s=o.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;case"script":(s=o.createElement("div")).innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s="string"===typeof r.is?o.createElement("select",{is:r.is}):o.createElement("select"),r.multiple?s.multiple=!0:r.size&&(s.size=r.size);break;default:s="string"===typeof r.is?o.createElement(n,{is:r.is}):o.createElement(n)}}s[Be]=t,s[We]=r;e:for(o=t.child;null!==o;){if(5===o.tag||6===o.tag)s.appendChild(o.stateNode);else if(4!==o.tag&&27!==o.tag&&null!==o.child){o.child.return=o,o=o.child;continue}if(o===t)break e;for(;null===o.sibling;){if(null===o.return||o.return===t)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}t.stateNode=s;e:switch(fd(s,n,r),n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}r&&ol(t)}}return fl(t),ll(t,t.type,null===e||e.memoizedProps,t.pendingProps,a),null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==r&&ol(t);else{if("string"!==typeof r&&null===t.stateNode)throw Error(i(166));if(e=$.current,yn(t)){if(e=t.stateNode,a=t.memoizedProps,r=null,null!==(n=cn))switch(n.tag){case 27:case 5:r=n.memoizedProps}e[Be]=t,(e=!!(e.nodeValue===a||null!==r&&!0===r.suppressHydrationWarning||cd(e.nodeValue,a)))||pn(t,!0)}else(e=gd(e).createTextNode(r))[Be]=t,t.stateNode=e}return fl(t),null;case 31:if(a=t.memoizedState,null===e||null!==e.memoizedState){if(r=yn(t),null!==a){if(null===e){if(!r)throw Error(i(318));if(!(e=null!==(e=t.memoizedState)?e.dehydrated:null))throw Error(i(557));e[Be]=t}else bn(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;fl(t),e=!1}else a=wn(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=a),e=!0;if(!e)return 256&t.flags?(Ms(t),t):(Ms(t),null);if(0!==(128&t.flags))throw Error(i(558))}return fl(t),null;case 13:if(r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(n=yn(t),null!==r&&null!==r.dehydrated){if(null===e){if(!n)throw Error(i(318));if(!(n=null!==(n=t.memoizedState)?n.dehydrated:null))throw Error(i(317));n[Be]=t}else bn(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;fl(t),n=!1}else n=wn(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=n),n=!0;if(!n)return 256&t.flags?(Ms(t),t):(Ms(t),null)}return Ms(t),0!==(128&t.flags)?(t.lanes=a,t):(a=null!==r,e=null!==e&&null!==e.memoizedState,a&&(n=null,null!==(r=t.child).alternate&&null!==r.alternate.memoizedState&&null!==r.alternate.memoizedState.cachePool&&(n=r.alternate.memoizedState.cachePool.pool),s=null,null!==r.memoizedState&&null!==r.memoizedState.cachePool&&(s=r.memoizedState.cachePool.pool),s!==n&&(r.flags|=2048)),a!==e&&a&&(t.child.flags|=8192),ul(t,t.updateQueue),fl(t),null);case 4:return X(),null===e&&Zu(t.stateNode.containerInfo),fl(t),null;case 10:return Nn(t.type),fl(t),null;case 19:if(U(zs),null===(r=t.memoizedState))return fl(t),null;if(n=0!==(128&t.flags),null===(s=r.rendering))if(n)dl(r,!1);else{if(0!==Sc||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(s=Us(e))){for(t.flags|=128,dl(r,!1),e=s.updateQueue,t.updateQueue=e,ul(t,e),t.subtreeFlags=0,e=a,a=t.child;null!==a;)Ur(a,e),a=a.sibling;return B(zs,1&zs.current|2),dn&&rn(t,r.treeForkCount),t.child}e=e.sibling}null!==r.tail&&le()>Dc&&(t.flags|=128,n=!0,dl(r,!1),t.lanes=4194304)}else{if(!n)if(null!==(e=Us(s))){if(t.flags|=128,n=!0,e=e.updateQueue,t.updateQueue=e,ul(t,e),dl(r,!0),null===r.tail&&"hidden"===r.tailMode&&!s.alternate&&!dn)return fl(t),null}else 2*le()-r.renderingStartTime>Dc&&536870912!==a&&(t.flags|=128,n=!0,dl(r,!1),t.lanes=4194304);r.isBackwards?(s.sibling=t.child,t.child=s):(null!==(e=r.last)?e.sibling=s:t.child=s,r.last=s)}return null!==r.tail?(e=r.tail,r.rendering=e,r.tail=e.sibling,r.renderingStartTime=le(),e.sibling=null,a=zs.current,B(zs,n?1&a|2:1&a),dn&&rn(t,r.treeForkCount),e):(fl(t),null);case 22:case 23:return Ms(t),Ps(),r=null!==t.memoizedState,null!==e?null!==e.memoizedState!==r&&(t.flags|=8192):r&&(t.flags|=8192),r?0!==(536870912&a)&&0===(128&t.flags)&&(fl(t),6&t.subtreeFlags&&(t.flags|=8192)):fl(t),null!==(a=t.updateQueue)&&ul(t,a.retryQueue),a=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(a=e.memoizedState.cachePool.pool),r=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(r=t.memoizedState.cachePool.pool),r!==a&&(t.flags|=2048),null!==e&&U(qn),null;case 24:return a=null,null!==e&&(a=e.memoizedState.cache),t.memoizedState.cache!==a&&(t.flags|=2048),Nn(Mn),fl(t),null;case 25:case 30:return null}throw Error(i(156,t.tag))}function ml(e,t){switch(on(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Nn(Mn),X(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return J(t),null;case 31:if(null!==t.memoizedState){if(Ms(t),null===t.alternate)throw Error(i(340));bn()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 13:if(Ms(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(i(340));bn()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return U(zs),null;case 4:return X(),null;case 10:return Nn(t.type),null;case 22:case 23:return Ms(t),Ps(),null!==e&&U(qn),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return Nn(Mn),null;default:return null}}function pl(e,t){switch(on(t),t.tag){case 3:Nn(Mn),X();break;case 26:case 27:case 5:J(t);break;case 4:X();break;case 31:null!==t.memoizedState&&Ms(t);break;case 13:Ms(t);break;case 19:U(zs);break;case 10:Nn(t.type);break;case 22:case 23:Ms(t),Ps(),null!==e&&U(qn);break;case 24:Nn(Mn)}}function gl(e,t){try{var a=t.updateQueue,r=null!==a?a.lastEffect:null;if(null!==r){var n=r.next;a=n;do{if((a.tag&e)===e){r=void 0;var s=a.create,i=a.inst;r=s(),i.destroy=r}a=a.next}while(a!==n)}}catch(o){Su(t,t.return,o)}}function vl(e,t,a){try{var r=t.updateQueue,n=null!==r?r.lastEffect:null;if(null!==n){var s=n.next;r=s;do{if((r.tag&e)===e){var i=r.inst,o=i.destroy;if(void 0!==o){i.destroy=void 0,n=t;var l=a,c=o;try{c()}catch(u){Su(n,l,u)}}}r=r.next}while(r!==s)}}catch(u){Su(t,t.return,u)}}function yl(e){var t=e.updateQueue;if(null!==t){var a=e.stateNode;try{Ns(t,a)}catch(r){Su(e,e.return,r)}}}function bl(e,t,a){a.props=So(e.type,e.memoizedProps),a.state=e.memoizedState;try{a.componentWillUnmount()}catch(r){Su(e,t,r)}}function wl(e,t){try{var a=e.ref;if(null!==a){switch(e.tag){case 26:case 27:case 5:var r=e.stateNode;break;default:r=e.stateNode}"function"===typeof a?e.refCleanup=a(r):a.current=r}}catch(n){Su(e,t,n)}}function xl(e,t){var a=e.ref,r=e.refCleanup;if(null!==a)if("function"===typeof r)try{r()}catch(n){Su(e,t,n)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"===typeof a)try{a(null)}catch(s){Su(e,t,s)}else a.current=null}function kl(e){var t=e.type,a=e.memoizedProps,r=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":a.autoFocus&&r.focus();break e;case"img":a.src?r.src=a.src:a.srcSet&&(r.srcset=a.srcSet)}}catch(n){Su(e,e.return,n)}}function Sl(e,t,a){try{var r=e.stateNode;!function(e,t,a,r){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var n=null,s=null,o=null,l=null,c=null,u=null,d=null;for(m in a){var f=a[m];if(a.hasOwnProperty(m)&&null!=f)switch(m){case"checked":case"value":break;case"defaultValue":c=f;default:r.hasOwnProperty(m)||ud(e,t,m,null,r,f)}}for(var h in r){var m=r[h];if(f=a[h],r.hasOwnProperty(h)&&(null!=m||null!=f))switch(h){case"type":s=m;break;case"name":n=m;break;case"checked":u=m;break;case"defaultChecked":d=m;break;case"value":o=m;break;case"defaultValue":l=m;break;case"children":case"dangerouslySetInnerHTML":if(null!=m)throw Error(i(137,t));break;default:m!==f&&ud(e,t,h,m,r,f)}}return void yt(e,o,l,c,u,d,s,n);case"select":for(s in m=o=l=h=null,a)if(c=a[s],a.hasOwnProperty(s)&&null!=c)switch(s){case"value":break;case"multiple":m=c;default:r.hasOwnProperty(s)||ud(e,t,s,null,r,c)}for(n in r)if(s=r[n],c=a[n],r.hasOwnProperty(n)&&(null!=s||null!=c))switch(n){case"value":h=s;break;case"defaultValue":l=s;break;case"multiple":o=s;default:s!==c&&ud(e,t,n,s,r,c)}return t=l,a=o,r=m,void(null!=h?xt(e,!!a,h,!1):!!r!==!!a&&(null!=t?xt(e,!!a,t,!0):xt(e,!!a,a?[]:"",!1)));case"textarea":for(l in m=h=null,a)if(n=a[l],a.hasOwnProperty(l)&&null!=n&&!r.hasOwnProperty(l))switch(l){case"value":case"children":break;default:ud(e,t,l,null,r,n)}for(o in r)if(n=r[o],s=a[o],r.hasOwnProperty(o)&&(null!=n||null!=s))switch(o){case"value":h=n;break;case"defaultValue":m=n;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=n)throw Error(i(91));break;default:n!==s&&ud(e,t,o,n,r,s)}return void kt(e,h,m);case"option":for(var p in a)if(h=a[p],a.hasOwnProperty(p)&&null!=h&&!r.hasOwnProperty(p))if("selected"===p)e.selected=!1;else ud(e,t,p,null,r,h);for(c in r)if(h=r[c],m=a[c],r.hasOwnProperty(c)&&h!==m&&(null!=h||null!=m))if("selected"===c)e.selected=h&&"function"!==typeof h&&"symbol"!==typeof h;else ud(e,t,c,h,r,m);return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var g in a)h=a[g],a.hasOwnProperty(g)&&null!=h&&!r.hasOwnProperty(g)&&ud(e,t,g,null,r,h);for(u in r)if(h=r[u],m=a[u],r.hasOwnProperty(u)&&h!==m&&(null!=h||null!=m))switch(u){case"children":case"dangerouslySetInnerHTML":if(null!=h)throw Error(i(137,t));break;default:ud(e,t,u,h,r,m)}return;default:if(Ct(t)){for(var v in a)h=a[v],a.hasOwnProperty(v)&&void 0!==h&&!r.hasOwnProperty(v)&&dd(e,t,v,void 0,r,h);for(d in r)h=r[d],m=a[d],!r.hasOwnProperty(d)||h===m||void 0===h&&void 0===m||dd(e,t,d,h,r,m);return}}for(var y in a)h=a[y],a.hasOwnProperty(y)&&null!=h&&!r.hasOwnProperty(y)&&ud(e,t,y,null,r,h);for(f in r)h=r[f],m=a[f],!r.hasOwnProperty(f)||h===m||null==h&&null==m||ud(e,t,f,h,r,m)}(r,e.type,a,t),r[We]=t}catch(n){Su(e,e.return,n)}}function El(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag&&Nd(e.type)||4===e.tag}function Tl(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||El(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(27===e.tag&&Nd(e.type))continue e;if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function Nl(e,t,a){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?(9===a.nodeType?a.body:"HTML"===a.nodeName?a.ownerDocument.body:a).insertBefore(e,t):((t=9===a.nodeType?a.body:"HTML"===a.nodeName?a.ownerDocument.body:a).appendChild(e),null!==(a=a._reactRootContainer)&&void 0!==a||null!==t.onclick||(t.onclick=Rt));else if(4!==r&&(27===r&&Nd(e.type)&&(a=e.stateNode,t=null),null!==(e=e.child)))for(Nl(e,t,a),e=e.sibling;null!==e;)Nl(e,t,a),e=e.sibling}function jl(e,t,a){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?a.insertBefore(e,t):a.appendChild(e);else if(4!==r&&(27===r&&Nd(e.type)&&(a=e.stateNode),null!==(e=e.child)))for(jl(e,t,a),e=e.sibling;null!==e;)jl(e,t,a),e=e.sibling}function Cl(e){var t=e.stateNode,a=e.memoizedProps;try{for(var r=e.type,n=t.attributes;n.length;)t.removeAttributeNode(n[0]);fd(t,r,a),t[Be]=e,t[We]=a}catch(s){Su(e,e.return,s)}}var _l=!1,Al=!1,Pl=!1,Rl="function"===typeof WeakSet?WeakSet:Set,Ol=null;function Dl(e,t,a){var r=a.flags;switch(a.tag){case 0:case 11:case 15:Yl(e,a),4&r&&gl(5,a);break;case 1:if(Yl(e,a),4&r)if(e=a.stateNode,null===t)try{e.componentDidMount()}catch(i){Su(a,a.return,i)}else{var n=So(a.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(n,t,e.__reactInternalSnapshotBeforeUpdate)}catch(o){Su(a,a.return,o)}}64&r&&yl(a),512&r&&wl(a,a.return);break;case 3:if(Yl(e,a),64&r&&null!==(e=a.updateQueue)){if(t=null,null!==a.child)switch(a.child.tag){case 27:case 5:case 1:t=a.child.stateNode}try{Ns(e,t)}catch(i){Su(a,a.return,i)}}break;case 27:null===t&&4&r&&Cl(a);case 26:case 5:Yl(e,a),null===t&&4&r&&kl(a),512&r&&wl(a,a.return);break;case 12:Yl(e,a);break;case 31:Yl(e,a),4&r&&Ul(e,a);break;case 13:Yl(e,a),4&r&&Bl(e,a),64&r&&(null!==(e=a.memoizedState)&&(null!==(e=e.dehydrated)&&function(e,t){var a=e.ownerDocument;if("$~"===e.data)e._reactRetry=t;else if("$?"!==e.data||"loading"!==a.readyState)t();else{var r=function(){t(),a.removeEventListener("DOMContentLoaded",r)};a.addEventListener("DOMContentLoaded",r),e._reactRetry=r}}(e,a=ju.bind(null,a))));break;case 22:if(!(r=null!==a.memoizedState||_l)){t=null!==t&&null!==t.memoizedState||Al,n=_l;var s=Al;_l=r,(Al=t)&&!s?Kl(e,a,0!==(8772&a.subtreeFlags)):Yl(e,a),_l=n,Al=s}break;case 30:break;default:Yl(e,a)}}function Fl(e){var t=e.alternate;null!==t&&(e.alternate=null,Fl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&Xe(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Il=null,Ll=!1;function Ml(e,t,a){for(a=a.child;null!==a;)zl(e,t,a),a=a.sibling}function zl(e,t,a){if(ye&&"function"===typeof ye.onCommitFiberUnmount)try{ye.onCommitFiberUnmount(ve,a)}catch(s){}switch(a.tag){case 26:Al||xl(a,t),Ml(e,t,a),a.memoizedState?a.memoizedState.count--:a.stateNode&&(a=a.stateNode).parentNode.removeChild(a);break;case 27:Al||xl(a,t);var r=Il,n=Ll;Nd(a.type)&&(Il=a.stateNode,Ll=!1),Ml(e,t,a),Md(a.stateNode),Il=r,Ll=n;break;case 5:Al||xl(a,t);case 6:if(r=Il,n=Ll,Il=null,Ml(e,t,a),Ll=n,null!==(Il=r))if(Ll)try{(9===Il.nodeType?Il.body:"HTML"===Il.nodeName?Il.ownerDocument.body:Il).removeChild(a.stateNode)}catch(i){Su(a,t,i)}else try{Il.removeChild(a.stateNode)}catch(i){Su(a,t,i)}break;case 18:null!==Il&&(Ll?(jd(9===(e=Il).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,a.stateNode),Gf(e)):jd(Il,a.stateNode));break;case 4:r=Il,n=Ll,Il=a.stateNode.containerInfo,Ll=!0,Ml(e,t,a),Il=r,Ll=n;break;case 0:case 11:case 14:case 15:vl(2,a,t),Al||vl(4,a,t),Ml(e,t,a);break;case 1:Al||(xl(a,t),"function"===typeof(r=a.stateNode).componentWillUnmount&&bl(a,t,r)),Ml(e,t,a);break;case 21:Ml(e,t,a);break;case 22:Al=(r=Al)||null!==a.memoizedState,Ml(e,t,a),Al=r;break;default:Ml(e,t,a)}}function Ul(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&null!==(e=e.memoizedState))){e=e.dehydrated;try{Gf(e)}catch(a){Su(t,t.return,a)}}}function Bl(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&(null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))))try{Gf(e)}catch(a){Su(t,t.return,a)}}function Wl(e,t){var a=function(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new Rl),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new Rl),t;default:throw Error(i(435,e.tag))}}(e);t.forEach(function(t){if(!a.has(t)){a.add(t);var r=Cu.bind(null,e,t);t.then(r,r)}})}function Hl(e,t){var a=t.deletions;if(null!==a)for(var r=0;r<a.length;r++){var n=a[r],s=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 27:if(Nd(l.type)){Il=l.stateNode,Ll=!1;break e}break;case 5:Il=l.stateNode,Ll=!1;break e;case 3:case 4:Il=l.stateNode.containerInfo,Ll=!0;break e}l=l.return}if(null===Il)throw Error(i(160));zl(s,o,n),Il=null,Ll=!1,null!==(s=n.alternate)&&(s.return=null),n.return=null}if(13886&t.subtreeFlags)for(t=t.child;null!==t;)Gl(t,e),t=t.sibling}var Vl=null;function Gl(e,t){var a=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Hl(t,e),$l(e),4&r&&(vl(3,e,e.return),gl(3,e),vl(5,e,e.return));break;case 1:Hl(t,e),$l(e),512&r&&(Al||null===a||xl(a,a.return)),64&r&&_l&&(null!==(e=e.updateQueue)&&(null!==(r=e.callbacks)&&(a=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===a?r:a.concat(r))));break;case 26:var n=Vl;if(Hl(t,e),$l(e),512&r&&(Al||null===a||xl(a,a.return)),4&r){var s=null!==a?a.memoizedState:null;if(r=e.memoizedState,null===a)if(null===r)if(null===e.stateNode){e:{r=e.type,a=e.memoizedProps,n=n.ownerDocument||n;t:switch(r){case"title":(!(s=n.getElementsByTagName("title")[0])||s[Ye]||s[Be]||"http://www.w3.org/2000/svg"===s.namespaceURI||s.hasAttribute("itemprop"))&&(s=n.createElement(r),n.head.insertBefore(s,n.querySelector("head > title"))),fd(s,r,a),s[Be]=e,et(s),r=s;break e;case"link":var o=af("link","href",n).get(r+(a.href||""));if(o)for(var l=0;l<o.length;l++)if((s=o[l]).getAttribute("href")===(null==a.href||""===a.href?null:a.href)&&s.getAttribute("rel")===(null==a.rel?null:a.rel)&&s.getAttribute("title")===(null==a.title?null:a.title)&&s.getAttribute("crossorigin")===(null==a.crossOrigin?null:a.crossOrigin)){o.splice(l,1);break t}fd(s=n.createElement(r),r,a),n.head.appendChild(s);break;case"meta":if(o=af("meta","content",n).get(r+(a.content||"")))for(l=0;l<o.length;l++)if((s=o[l]).getAttribute("content")===(null==a.content?null:""+a.content)&&s.getAttribute("name")===(null==a.name?null:a.name)&&s.getAttribute("property")===(null==a.property?null:a.property)&&s.getAttribute("http-equiv")===(null==a.httpEquiv?null:a.httpEquiv)&&s.getAttribute("charset")===(null==a.charSet?null:a.charSet)){o.splice(l,1);break t}fd(s=n.createElement(r),r,a),n.head.appendChild(s);break;default:throw Error(i(468,r))}s[Be]=e,et(s),r=s}e.stateNode=r}else rf(n,e.type,e.stateNode);else e.stateNode=Jd(n,r,e.memoizedProps);else s!==r?(null===s?null!==a.stateNode&&(a=a.stateNode).parentNode.removeChild(a):s.count--,null===r?rf(n,e.type,e.stateNode):Jd(n,r,e.memoizedProps)):null===r&&null!==e.stateNode&&Sl(e,e.memoizedProps,a.memoizedProps)}break;case 27:Hl(t,e),$l(e),512&r&&(Al||null===a||xl(a,a.return)),null!==a&&4&r&&Sl(e,e.memoizedProps,a.memoizedProps);break;case 5:if(Hl(t,e),$l(e),512&r&&(Al||null===a||xl(a,a.return)),32&e.flags){n=e.stateNode;try{Et(n,"")}catch(p){Su(e,e.return,p)}}4&r&&null!=e.stateNode&&Sl(e,n=e.memoizedProps,null!==a?a.memoizedProps:n),1024&r&&(Pl=!0);break;case 6:if(Hl(t,e),$l(e),4&r){if(null===e.stateNode)throw Error(i(162));r=e.memoizedProps,a=e.stateNode;try{a.nodeValue=r}catch(p){Su(e,e.return,p)}}break;case 3:if(tf=null,n=Vl,Vl=Bd(t.containerInfo),Hl(t,e),Vl=n,$l(e),4&r&&null!==a&&a.memoizedState.isDehydrated)try{Gf(t.containerInfo)}catch(p){Su(e,e.return,p)}Pl&&(Pl=!1,ql(e));break;case 4:r=Vl,Vl=Bd(e.stateNode.containerInfo),Hl(t,e),$l(e),Vl=r;break;case 12:default:Hl(t,e),$l(e);break;case 31:case 19:Hl(t,e),$l(e),4&r&&(null!==(r=e.updateQueue)&&(e.updateQueue=null,Wl(e,r)));break;case 13:Hl(t,e),$l(e),8192&e.child.flags&&null!==e.memoizedState!==(null!==a&&null!==a.memoizedState)&&(Rc=le()),4&r&&(null!==(r=e.updateQueue)&&(e.updateQueue=null,Wl(e,r)));break;case 22:n=null!==e.memoizedState;var c=null!==a&&null!==a.memoizedState,u=_l,d=Al;if(_l=u||n,Al=d||c,Hl(t,e),Al=d,_l=u,$l(e),8192&r)e:for(t=e.stateNode,t._visibility=n?-2&t._visibility:1|t._visibility,n&&(null===a||c||_l||Al||Xl(e)),a=null,t=e;;){if(5===t.tag||26===t.tag){if(null===a){c=a=t;try{if(s=c.stateNode,n)"function"===typeof(o=s.style).setProperty?o.setProperty("display","none","important"):o.display="none";else{l=c.stateNode;var f=c.memoizedProps.style,h=void 0!==f&&null!==f&&f.hasOwnProperty("display")?f.display:null;l.style.display=null==h||"boolean"===typeof h?"":(""+h).trim()}}catch(p){Su(c,c.return,p)}}}else if(6===t.tag){if(null===a){c=t;try{c.stateNode.nodeValue=n?"":c.memoizedProps}catch(p){Su(c,c.return,p)}}}else if(18===t.tag){if(null===a){c=t;try{var m=c.stateNode;n?Cd(m,!0):Cd(c.stateNode,!1)}catch(p){Su(c,c.return,p)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;a===t&&(a=null),t=t.return}a===t&&(a=null),t.sibling.return=t.return,t=t.sibling}4&r&&(null!==(r=e.updateQueue)&&(null!==(a=r.retryQueue)&&(r.retryQueue=null,Wl(e,a))));case 30:case 21:}}function $l(e){var t=e.flags;if(2&t){try{for(var a,r=e.return;null!==r;){if(El(r)){a=r;break}r=r.return}if(null==a)throw Error(i(160));switch(a.tag){case 27:var n=a.stateNode;jl(e,Tl(e),n);break;case 5:var s=a.stateNode;32&a.flags&&(Et(s,""),a.flags&=-33),jl(e,Tl(e),s);break;case 3:case 4:var o=a.stateNode.containerInfo;Nl(e,Tl(e),o);break;default:throw Error(i(161))}}catch(l){Su(e,e.return,l)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function ql(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;ql(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function Yl(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)Dl(e,t.alternate,t),t=t.sibling}function Xl(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:vl(4,t,t.return),Xl(t);break;case 1:xl(t,t.return);var a=t.stateNode;"function"===typeof a.componentWillUnmount&&bl(t,t.return,a),Xl(t);break;case 27:Md(t.stateNode);case 26:case 5:xl(t,t.return),Xl(t);break;case 22:null===t.memoizedState&&Xl(t);break;default:Xl(t)}e=e.sibling}}function Kl(e,t,a){for(a=a&&0!==(8772&t.subtreeFlags),t=t.child;null!==t;){var r=t.alternate,n=e,s=t,i=s.flags;switch(s.tag){case 0:case 11:case 15:Kl(n,s,a),gl(4,s);break;case 1:if(Kl(n,s,a),"function"===typeof(n=(r=s).stateNode).componentDidMount)try{n.componentDidMount()}catch(c){Su(r,r.return,c)}if(null!==(n=(r=s).updateQueue)){var o=r.stateNode;try{var l=n.shared.hiddenCallbacks;if(null!==l)for(n.shared.hiddenCallbacks=null,n=0;n<l.length;n++)Ts(l[n],o)}catch(c){Su(r,r.return,c)}}a&&64&i&&yl(s),wl(s,s.return);break;case 27:Cl(s);case 26:case 5:Kl(n,s,a),a&&null===r&&4&i&&kl(s),wl(s,s.return);break;case 12:Kl(n,s,a);break;case 31:Kl(n,s,a),a&&4&i&&Ul(n,s);break;case 13:Kl(n,s,a),a&&4&i&&Bl(n,s);break;case 22:null===s.memoizedState&&Kl(n,s,a),wl(s,s.return);break;case 30:break;default:Kl(n,s,a)}t=t.sibling}}function Jl(e,t){var a=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(a=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==a&&(null!=e&&e.refCount++,null!=a&&Un(a))}function Ql(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Un(e))}function Zl(e,t,a,r){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)ec(e,t,a,r),t=t.sibling}function ec(e,t,a,r){var n=t.flags;switch(t.tag){case 0:case 11:case 15:Zl(e,t,a,r),2048&n&&gl(9,t);break;case 1:case 31:case 13:default:Zl(e,t,a,r);break;case 3:Zl(e,t,a,r),2048&n&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Un(e)));break;case 12:if(2048&n){Zl(e,t,a,r),e=t.stateNode;try{var s=t.memoizedProps,i=s.id,o=s.onPostCommit;"function"===typeof o&&o(i,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(l){Su(t,t.return,l)}}else Zl(e,t,a,r);break;case 23:break;case 22:s=t.stateNode,i=t.alternate,null!==t.memoizedState?2&s._visibility?Zl(e,t,a,r):ac(e,t):2&s._visibility?Zl(e,t,a,r):(s._visibility|=2,tc(e,t,a,r,0!==(10256&t.subtreeFlags)||!1)),2048&n&&Jl(i,t);break;case 24:Zl(e,t,a,r),2048&n&&Ql(t.alternate,t)}}function tc(e,t,a,r,n){for(n=n&&(0!==(10256&t.subtreeFlags)||!1),t=t.child;null!==t;){var s=e,i=t,o=a,l=r,c=i.flags;switch(i.tag){case 0:case 11:case 15:tc(s,i,o,l,n),gl(8,i);break;case 23:break;case 22:var u=i.stateNode;null!==i.memoizedState?2&u._visibility?tc(s,i,o,l,n):ac(s,i):(u._visibility|=2,tc(s,i,o,l,n)),n&&2048&c&&Jl(i.alternate,i);break;case 24:tc(s,i,o,l,n),n&&2048&c&&Ql(i.alternate,i);break;default:tc(s,i,o,l,n)}t=t.sibling}}function ac(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var a=e,r=t,n=r.flags;switch(r.tag){case 22:ac(a,r),2048&n&&Jl(r.alternate,r);break;case 24:ac(a,r),2048&n&&Ql(r.alternate,r);break;default:ac(a,r)}t=t.sibling}}var rc=8192;function nc(e,t,a){if(e.subtreeFlags&rc)for(e=e.child;null!==e;)sc(e,t,a),e=e.sibling}function sc(e,t,a){switch(e.tag){case 26:nc(e,t,a),e.flags&rc&&null!==e.memoizedState&&function(e,t,a,r){if("stylesheet"===a.type&&("string"!==typeof r.media||!1!==matchMedia(r.media).matches)&&0===(4&a.state.loading)){if(null===a.instance){var n=$d(r.href),s=t.querySelector(qd(n));if(s)return null!==(t=s._p)&&"object"===typeof t&&"function"===typeof t.then&&(e.count++,e=of.bind(e),t.then(e,e)),a.state.loading|=4,a.instance=s,void et(s);s=t.ownerDocument||t,r=Yd(r),(n=zd.get(n))&&Zd(r,n),et(s=s.createElement("link"));var i=s;i._p=new Promise(function(e,t){i.onload=e,i.onerror=t}),fd(s,"link",r),a.instance=s}null===e.stylesheets&&(e.stylesheets=new Map),e.stylesheets.set(a,t),(t=a.state.preload)&&0===(3&a.state.loading)&&(e.count++,a=of.bind(e),t.addEventListener("load",a),t.addEventListener("error",a))}}(a,Vl,e.memoizedState,e.memoizedProps);break;case 5:default:nc(e,t,a);break;case 3:case 4:var r=Vl;Vl=Bd(e.stateNode.containerInfo),nc(e,t,a),Vl=r;break;case 22:null===e.memoizedState&&(null!==(r=e.alternate)&&null!==r.memoizedState?(r=rc,rc=16777216,nc(e,t,a),rc=r):nc(e,t,a))}}function ic(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function oc(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var a=0;a<t.length;a++){var r=t[a];Ol=r,uc(r,e)}ic(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)lc(e),e=e.sibling}function lc(e){switch(e.tag){case 0:case 11:case 15:oc(e),2048&e.flags&&vl(9,e,e.return);break;case 3:case 12:default:oc(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&2&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-3,cc(e)):oc(e)}}function cc(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var a=0;a<t.length;a++){var r=t[a];Ol=r,uc(r,e)}ic(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:vl(8,t,t.return),cc(t);break;case 22:2&(a=t.stateNode)._visibility&&(a._visibility&=-3,cc(t));break;default:cc(t)}e=e.sibling}}function uc(e,t){for(;null!==Ol;){var a=Ol;switch(a.tag){case 0:case 11:case 15:vl(8,a,t);break;case 23:case 22:if(null!==a.memoizedState&&null!==a.memoizedState.cachePool){var r=a.memoizedState.cachePool.pool;null!=r&&r.refCount++}break;case 24:Un(a.memoizedState.cache)}if(null!==(r=a.child))r.return=a,Ol=r;else e:for(a=e;null!==Ol;){var n=(r=Ol).sibling,s=r.return;if(Fl(r),r===a){Ol=null;break e}if(null!==n){n.return=s,Ol=n;break e}Ol=s}}}var dc={getCacheForType:function(e){var t=Rn(Mn),a=t.data.get(e);return void 0===a&&(a=e(),t.data.set(e,a)),a},cacheSignal:function(){return Rn(Mn).controller.signal}},fc="function"===typeof WeakMap?WeakMap:Map,hc=0,mc=null,pc=null,gc=0,vc=0,yc=null,bc=!1,wc=!1,xc=!1,kc=0,Sc=0,Ec=0,Tc=0,Nc=0,jc=0,Cc=0,_c=null,Ac=null,Pc=!1,Rc=0,Oc=0,Dc=1/0,Fc=null,Ic=null,Lc=0,Mc=null,zc=null,Uc=0,Bc=0,Wc=null,Hc=null,Vc=0,Gc=null;function $c(){return 0!==(2&hc)&&0!==gc?gc&-gc:null!==D.T?Wu():Me()}function qc(){if(0===jc)if(0===(536870912&gc)||dn){var e=Ee;0===(3932160&(Ee<<=1))&&(Ee=262144),jc=e}else jc=536870912;return null!==(e=Rs.current)&&(e.flags|=32),jc}function Yc(e,t,a){(e!==mc||2!==vc&&9!==vc)&&null===e.cancelPendingCommit||(tu(e,0),Qc(e,gc,jc,!1)),Re(e,a),0!==(2&hc)&&e===mc||(e===mc&&(0===(2&hc)&&(Tc|=a),4===Sc&&Qc(e,gc,jc,!1)),Fu(e))}function Xc(e,t,a){if(0!==(6&hc))throw Error(i(327));for(var r=!a&&0===(127&t)&&0===(t&e.expiredLanes)||Ce(e,t),n=r?function(e,t){var a=hc;hc|=2;var r=nu(),n=su();mc!==e||gc!==t?(Fc=null,Dc=le()+500,tu(e,t)):wc=Ce(e,t);e:for(;;)try{if(0!==vc&&null!==pc){t=pc;var s=yc;t:switch(vc){case 1:vc=0,yc=null,fu(e,t,s,1);break;case 2:case 9:if(ts(s)){vc=0,yc=null,du(t);break}t=function(){2!==vc&&9!==vc||mc!==e||(vc=7),Fu(e)},s.then(t,t);break e;case 3:vc=7;break e;case 4:vc=5;break e;case 7:ts(s)?(vc=0,yc=null,du(t)):(vc=0,yc=null,fu(e,t,s,7));break;case 5:var o=null;switch(pc.tag){case 26:o=pc.memoizedState;case 5:case 27:var l=pc;if(o?nf(o):l.stateNode.complete){vc=0,yc=null;var c=l.sibling;if(null!==c)pc=c;else{var u=l.return;null!==u?(pc=u,hu(u)):pc=null}break t}}vc=0,yc=null,fu(e,t,s,5);break;case 6:vc=0,yc=null,fu(e,t,s,6);break;case 8:eu(),Sc=6;break e;default:throw Error(i(462))}}cu();break}catch(d){au(e,d)}return En=Sn=null,D.H=r,D.A=n,hc=a,null!==pc?0:(mc=null,gc=0,_r(),Sc)}(e,t):ou(e,t,!0),s=r;;){if(0===n){wc&&!r&&Qc(e,t,0,!1);break}if(a=e.current.alternate,!s||Jc(a)){if(2===n){if(s=t,e.errorRecoveryDisabledLanes&s)var o=0;else o=0!==(o=-536870913&e.pendingLanes)?o:536870912&o?536870912:0;if(0!==o){t=o;e:{var l=e;n=_c;var c=l.current.memoizedState.isDehydrated;if(c&&(tu(l,o).flags|=256),2!==(o=ou(l,o,!1))){if(xc&&!c){l.errorRecoveryDisabledLanes|=s,Tc|=s,n=4;break e}s=Ac,Ac=n,null!==s&&(null===Ac?Ac=s:Ac.push.apply(Ac,s))}n=o}if(s=!1,2!==n)continue}}if(1===n){tu(e,0),Qc(e,t,0,!0);break}e:{switch(r=e,s=n){case 0:case 1:throw Error(i(345));case 4:if((4194048&t)!==t)break;case 6:Qc(r,t,jc,!bc);break e;case 2:Ac=null;break;case 3:case 5:break;default:throw Error(i(329))}if((62914560&t)===t&&10<(n=Rc+300-le())){if(Qc(r,t,jc,!bc),0!==je(r,0,!0))break e;Uc=t,r.timeoutHandle=xd(Kc.bind(null,r,a,Ac,Fc,Pc,t,jc,Tc,Cc,bc,s,"Throttled",-0,0),n)}else Kc(r,a,Ac,Fc,Pc,t,jc,Tc,Cc,bc,s,null,-0,0)}break}n=ou(e,t,!1),s=!1}Fu(e)}function Kc(e,t,a,r,n,s,i,o,l,c,u,d,f,h){if(e.timeoutHandle=-1,8192&(d=t.subtreeFlags)||16785408===(16785408&d)){sc(t,s,d={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Rt});var m=(62914560&s)===s?Rc-le():(4194048&s)===s?Oc-le():0;if(null!==(m=function(e,t){return e.stylesheets&&0===e.count&&cf(e,e.stylesheets),0<e.count||0<e.imgCount?function(a){var r=setTimeout(function(){if(e.stylesheets&&cf(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}},6e4+t);0<e.imgBytes&&0===sf&&(sf=62500*function(){if("function"===typeof performance.getEntriesByType){for(var e=0,t=0,a=performance.getEntriesByType("resource"),r=0;r<a.length;r++){var n=a[r],s=n.transferSize,i=n.initiatorType,o=n.duration;if(s&&o&&hd(i)){for(i=0,o=n.responseEnd,r+=1;r<a.length;r++){var l=a[r],c=l.startTime;if(c>o)break;var u=l.transferSize,d=l.initiatorType;u&&hd(d)&&(i+=u*((l=l.responseEnd)<o?1:(o-c)/(l-c)))}if(--r,t+=8*(s+i)/(n.duration/1e3),10<++e)break}}if(0<e)return t/e/1e6}return navigator.connection&&"number"===typeof(e=navigator.connection.downlink)?e:5}());var n=setTimeout(function(){if(e.waitingForImages=!1,0===e.count&&(e.stylesheets&&cf(e,e.stylesheets),e.unsuspend)){var t=e.unsuspend;e.unsuspend=null,t()}},(e.imgBytes>sf?50:800)+t);return e.unsuspend=a,function(){e.unsuspend=null,clearTimeout(r),clearTimeout(n)}}:null}(d,m)))return Uc=s,e.cancelPendingCommit=m(pu.bind(null,e,t,s,a,r,n,i,o,l,u,d,null,f,h)),void Qc(e,s,i,!c)}pu(e,t,s,a,r,n,i,o,l)}function Jc(e){for(var t=e;;){var a=t.tag;if((0===a||11===a||15===a)&&16384&t.flags&&(null!==(a=t.updateQueue)&&null!==(a=a.stores)))for(var r=0;r<a.length;r++){var n=a[r],s=n.getSnapshot;n=n.value;try{if(!Ja(s(),n))return!1}catch(i){return!1}}if(a=t.child,16384&t.subtreeFlags&&null!==a)a.return=t,t=a;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Qc(e,t,a,r){t&=~Nc,t&=~Tc,e.suspendedLanes|=t,e.pingedLanes&=~t,r&&(e.warmLanes|=t),r=e.expirationTimes;for(var n=t;0<n;){var s=31-we(n),i=1<<s;r[s]=-1,n&=~i}0!==a&&Oe(e,a,t)}function Zc(){return 0!==(6&hc)||(Iu(0,!1),!1)}function eu(){if(null!==pc){if(0===vc)var e=pc.return;else En=Sn=null,ii(e=pc),os=null,ls=0,e=pc;for(;null!==e;)pl(e.alternate,e),e=e.return;pc=null}}function tu(e,t){var a=e.timeoutHandle;-1!==a&&(e.timeoutHandle=-1,kd(a)),null!==(a=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,a()),Uc=0,eu(),mc=e,pc=a=zr(e.current,null),gc=t,vc=0,yc=null,bc=!1,wc=Ce(e,t),xc=!1,Cc=jc=Nc=Tc=Ec=Sc=0,Ac=_c=null,Pc=!1,0!==(8&t)&&(t|=32&t);var r=e.entangledLanes;if(0!==r)for(e=e.entanglements,r&=t;0<r;){var n=31-we(r),s=1<<n;t|=e[n],r&=~s}return kc=t,_r(),a}function au(e,t){Ws=null,D.H=po,t===Jn||t===Zn?(t=ss(),vc=3):t===Qn?(t=ss(),vc=4):vc=t===Ro?8:null!==t&&"object"===typeof t&&"function"===typeof t.then?6:1,yc=t,null===pc&&(Sc=1,jo(e,qr(t,e.current)))}function ru(){var e=Rs.current;return null===e||((4194048&gc)===gc?null===Os:((62914560&gc)===gc||0!==(536870912&gc))&&e===Os)}function nu(){var e=D.H;return D.H=po,null===e?po:e}function su(){var e=D.A;return D.A=dc,e}function iu(){Sc=4,bc||(4194048&gc)!==gc&&null!==Rs.current||(wc=!0),0===(134217727&Ec)&&0===(134217727&Tc)||null===mc||Qc(mc,gc,jc,!1)}function ou(e,t,a){var r=hc;hc|=2;var n=nu(),s=su();mc===e&&gc===t||(Fc=null,tu(e,t)),t=!1;var i=Sc;e:for(;;)try{if(0!==vc&&null!==pc){var o=pc,l=yc;switch(vc){case 8:eu(),i=6;break e;case 3:case 2:case 9:case 6:null===Rs.current&&(t=!0);var c=vc;if(vc=0,yc=null,fu(e,o,l,c),a&&wc){i=0;break e}break;default:c=vc,vc=0,yc=null,fu(e,o,l,c)}}lu(),i=Sc;break}catch(u){au(e,u)}return t&&e.shellSuspendCounter++,En=Sn=null,hc=r,D.H=n,D.A=s,null===pc&&(mc=null,gc=0,_r()),i}function lu(){for(;null!==pc;)uu(pc)}function cu(){for(;null!==pc&&!ie();)uu(pc)}function uu(e){var t=il(e.alternate,e,kc);e.memoizedProps=e.pendingProps,null===t?hu(e):pc=t}function du(e){var t=e,a=t.alternate;switch(t.tag){case 15:case 0:t=Go(a,t,t.pendingProps,t.type,void 0,gc);break;case 11:t=Go(a,t,t.pendingProps,t.type.render,t.ref,gc);break;case 5:ii(t);default:pl(a,t),t=il(a,t=pc=Ur(t,kc),kc)}e.memoizedProps=e.pendingProps,null===t?hu(e):pc=t}function fu(e,t,a,r){En=Sn=null,ii(t),os=null,ls=0;var n=t.return;try{if(function(e,t,a,r,n){if(a.flags|=32768,null!==r&&"object"===typeof r&&"function"===typeof r.then){if(null!==(t=a.alternate)&&_n(t,a,n,!0),null!==(a=Rs.current)){switch(a.tag){case 31:case 13:return null===Os?iu():null===a.alternate&&0===Sc&&(Sc=3),a.flags&=-257,a.flags|=65536,a.lanes=n,r===es?a.flags|=16384:(null===(t=a.updateQueue)?a.updateQueue=new Set([r]):t.add(r),Eu(e,r,n)),!1;case 22:return a.flags|=65536,r===es?a.flags|=16384:(null===(t=a.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([r])},a.updateQueue=t):null===(a=t.retryQueue)?t.retryQueue=new Set([r]):a.add(r),Eu(e,r,n)),!1}throw Error(i(435,a.tag))}return Eu(e,r,n),iu(),!1}if(dn)return null!==(t=Rs.current)?(0===(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=n,r!==mn&&xn(qr(e=Error(i(422),{cause:r}),a))):(r!==mn&&xn(qr(t=Error(i(423),{cause:r}),a)),(e=e.current.alternate).flags|=65536,n&=-n,e.lanes|=n,r=qr(r,a),xs(e,n=_o(e.stateNode,r,n)),4!==Sc&&(Sc=2)),!1;var s=Error(i(520),{cause:r});if(s=qr(s,a),null===_c?_c=[s]:_c.push(s),4!==Sc&&(Sc=2),null===t)return!0;r=qr(r,a),a=t;do{switch(a.tag){case 3:return a.flags|=65536,e=n&-n,a.lanes|=e,xs(a,e=_o(a.stateNode,r,e)),!1;case 1:if(t=a.type,s=a.stateNode,0===(128&a.flags)&&("function"===typeof t.getDerivedStateFromError||null!==s&&"function"===typeof s.componentDidCatch&&(null===Ic||!Ic.has(s))))return a.flags|=65536,n&=-n,a.lanes|=n,Po(n=Ao(n),e,a,r),xs(a,n),!1}a=a.return}while(null!==a);return!1}(e,n,t,a,gc))return Sc=1,jo(e,qr(a,e.current)),void(pc=null)}catch(s){if(null!==n)throw pc=n,s;return Sc=1,jo(e,qr(a,e.current)),void(pc=null)}32768&t.flags?(dn||1===r?e=!0:wc||0!==(536870912&gc)?e=!1:(bc=e=!0,(2===r||9===r||3===r||6===r)&&(null!==(r=Rs.current)&&13===r.tag&&(r.flags|=16384))),mu(t,e)):hu(t)}function hu(e){var t=e;do{if(0!==(32768&t.flags))return void mu(t,bc);e=t.return;var a=hl(t.alternate,t,kc);if(null!==a)return void(pc=a);if(null!==(t=t.sibling))return void(pc=t);pc=t=e}while(null!==t);0===Sc&&(Sc=5)}function mu(e,t){do{var a=ml(e.alternate,e);if(null!==a)return a.flags&=32767,void(pc=a);if(null!==(a=e.return)&&(a.flags|=32768,a.subtreeFlags=0,a.deletions=null),!t&&null!==(e=e.sibling))return void(pc=e);pc=e=a}while(null!==e);Sc=6,pc=null}function pu(e,t,a,r,n,s,o,l,c){e.cancelPendingCommit=null;do{wu()}while(0!==Lc);if(0!==(6&hc))throw Error(i(327));if(null!==t){if(t===e.current)throw Error(i(177));if(s=t.lanes|t.childLanes,function(e,t,a,r,n,s){var i=e.pendingLanes;e.pendingLanes=a,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=a,e.entangledLanes&=a,e.errorRecoveryDisabledLanes&=a,e.shellSuspendCounter=0;var o=e.entanglements,l=e.expirationTimes,c=e.hiddenUpdates;for(a=i&~a;0<a;){var u=31-we(a),d=1<<u;o[u]=0,l[u]=-1;var f=c[u];if(null!==f)for(c[u]=null,u=0;u<f.length;u++){var h=f[u];null!==h&&(h.lane&=-536870913)}a&=~d}0!==r&&Oe(e,r,0),0!==s&&0===n&&0!==e.tag&&(e.suspendedLanes|=s&~(i&~t))}(e,a,s|=Cr,o,l,c),e===mc&&(pc=mc=null,gc=0),zc=t,Mc=e,Uc=a,Bc=s,Wc=n,Hc=r,0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?(e.callbackNode=null,e.callbackPriority=0,ne(fe,function(){return xu(),null})):(e.callbackNode=null,e.callbackPriority=0),r=0!==(13878&t.flags),0!==(13878&t.subtreeFlags)||r){r=D.T,D.T=null,n=F.p,F.p=2,o=hc,hc|=4;try{!function(e,t){if(e=e.containerInfo,md=wf,rr(e=ar(e))){if("selectionStart"in e)var a={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(a=(a=e.ownerDocument)&&a.defaultView||window).getSelection&&a.getSelection();if(r&&0!==r.rangeCount){a=r.anchorNode;var n=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{a.nodeType,s.nodeType}catch(g){a=null;break e}var o=0,l=-1,c=-1,u=0,d=0,f=e,h=null;t:for(;;){for(var m;f!==a||0!==n&&3!==f.nodeType||(l=o+n),f!==s||0!==r&&3!==f.nodeType||(c=o+r),3===f.nodeType&&(o+=f.nodeValue.length),null!==(m=f.firstChild);)h=f,f=m;for(;;){if(f===e)break t;if(h===a&&++u===n&&(l=o),h===s&&++d===r&&(c=o),null!==(m=f.nextSibling))break;h=(f=h).parentNode}f=m}a=-1===l||-1===c?null:{start:l,end:c}}else a=null}a=a||{start:0,end:0}}else a=null;for(pd={focusedElem:e,selectionRange:a},wf=!1,Ol=t;null!==Ol;)if(e=(t=Ol).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Ol=e;else for(;null!==Ol;){switch(s=(t=Ol).alternate,e=t.flags,t.tag){case 0:if(0!==(4&e)&&null!==(e=null!==(e=t.updateQueue)?e.events:null))for(a=0;a<e.length;a++)(n=e[a]).ref.impl=n.nextImpl;break;case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(0!==(1024&e)&&null!==s){e=void 0,a=t,n=s.memoizedProps,s=s.memoizedState,r=a.stateNode;try{var p=So(a.type,n);e=r.getSnapshotBeforeUpdate(p,s),r.__reactInternalSnapshotBeforeUpdate=e}catch(v){Su(a,a.return,v)}}break;case 3:if(0!==(1024&e))if(9===(a=(e=t.stateNode.containerInfo).nodeType))_d(e);else if(1===a)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":_d(e);break;default:e.textContent=""}break;default:if(0!==(1024&e))throw Error(i(163))}if(null!==(e=t.sibling)){e.return=t.return,Ol=e;break}Ol=t.return}}(e,t)}finally{hc=o,F.p=n,D.T=r}}Lc=1,gu(),vu(),yu()}}function gu(){if(1===Lc){Lc=0;var e=Mc,t=zc,a=0!==(13878&t.flags);if(0!==(13878&t.subtreeFlags)||a){a=D.T,D.T=null;var r=F.p;F.p=2;var n=hc;hc|=4;try{Gl(t,e);var s=pd,i=ar(e.containerInfo),o=s.focusedElem,l=s.selectionRange;if(i!==o&&o&&o.ownerDocument&&tr(o.ownerDocument.documentElement,o)){if(null!==l&&rr(o)){var c=l.start,u=l.end;if(void 0===u&&(u=c),"selectionStart"in o)o.selectionStart=c,o.selectionEnd=Math.min(u,o.value.length);else{var d=o.ownerDocument||document,f=d&&d.defaultView||window;if(f.getSelection){var h=f.getSelection(),m=o.textContent.length,p=Math.min(l.start,m),g=void 0===l.end?p:Math.min(l.end,m);!h.extend&&p>g&&(i=g,g=p,p=i);var v=er(o,p),y=er(o,g);if(v&&y&&(1!==h.rangeCount||h.anchorNode!==v.node||h.anchorOffset!==v.offset||h.focusNode!==y.node||h.focusOffset!==y.offset)){var b=d.createRange();b.setStart(v.node,v.offset),h.removeAllRanges(),p>g?(h.addRange(b),h.extend(y.node,y.offset)):(b.setEnd(y.node,y.offset),h.addRange(b))}}}}for(d=[],h=o;h=h.parentNode;)1===h.nodeType&&d.push({element:h,left:h.scrollLeft,top:h.scrollTop});for("function"===typeof o.focus&&o.focus(),o=0;o<d.length;o++){var w=d[o];w.element.scrollLeft=w.left,w.element.scrollTop=w.top}}wf=!!md,pd=md=null}finally{hc=n,F.p=r,D.T=a}}e.current=t,Lc=2}}function vu(){if(2===Lc){Lc=0;var e=Mc,t=zc,a=0!==(8772&t.flags);if(0!==(8772&t.subtreeFlags)||a){a=D.T,D.T=null;var r=F.p;F.p=2;var n=hc;hc|=4;try{Dl(e,t.alternate,t)}finally{hc=n,F.p=r,D.T=a}}Lc=3}}function yu(){if(4===Lc||3===Lc){Lc=0,oe();var e=Mc,t=zc,a=Uc,r=Hc;0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?Lc=5:(Lc=0,zc=Mc=null,bu(e,e.pendingLanes));var n=e.pendingLanes;if(0===n&&(Ic=null),Le(a),t=t.stateNode,ye&&"function"===typeof ye.onCommitFiberRoot)try{ye.onCommitFiberRoot(ve,t,void 0,128===(128&t.current.flags))}catch(l){}if(null!==r){t=D.T,n=F.p,F.p=2,D.T=null;try{for(var s=e.onRecoverableError,i=0;i<r.length;i++){var o=r[i];s(o.value,{componentStack:o.stack})}}finally{D.T=t,F.p=n}}0!==(3&Uc)&&wu(),Fu(e),n=e.pendingLanes,0!==(261930&a)&&0!==(42&n)?e===Gc?Vc++:(Vc=0,Gc=e):Vc=0,Iu(0,!1)}}function bu(e,t){0===(e.pooledCacheLanes&=t)&&(null!=(t=e.pooledCache)&&(e.pooledCache=null,Un(t)))}function wu(){return gu(),vu(),yu(),xu()}function xu(){if(5!==Lc)return!1;var e=Mc,t=Bc;Bc=0;var a=Le(Uc),r=D.T,n=F.p;try{F.p=32>a?32:a,D.T=null,a=Wc,Wc=null;var s=Mc,o=Uc;if(Lc=0,zc=Mc=null,Uc=0,0!==(6&hc))throw Error(i(331));var l=hc;if(hc|=4,lc(s.current),ec(s,s.current,o,a),hc=l,Iu(0,!1),ye&&"function"===typeof ye.onPostCommitFiberRoot)try{ye.onPostCommitFiberRoot(ve,s)}catch(c){}return!0}finally{F.p=n,D.T=r,bu(e,t)}}function ku(e,t,a){t=qr(a,t),null!==(e=bs(e,t=_o(e.stateNode,t,2),2))&&(Re(e,2),Fu(e))}function Su(e,t,a){if(3===e.tag)ku(e,e,a);else for(;null!==t;){if(3===t.tag){ku(t,e,a);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Ic||!Ic.has(r))){e=qr(a,e),null!==(r=bs(t,a=Ao(2),2))&&(Po(a,r,t,e),Re(r,2),Fu(r));break}}t=t.return}}function Eu(e,t,a){var r=e.pingCache;if(null===r){r=e.pingCache=new fc;var n=new Set;r.set(t,n)}else void 0===(n=r.get(t))&&(n=new Set,r.set(t,n));n.has(a)||(xc=!0,n.add(a),e=Tu.bind(null,e,t,a),t.then(e,e))}function Tu(e,t,a){var r=e.pingCache;null!==r&&r.delete(t),e.pingedLanes|=e.suspendedLanes&a,e.warmLanes&=~a,mc===e&&(gc&a)===a&&(4===Sc||3===Sc&&(62914560&gc)===gc&&300>le()-Rc?0===(2&hc)&&tu(e,0):Nc|=a,Cc===gc&&(Cc=0)),Fu(e)}function Nu(e,t){0===t&&(t=Ae()),null!==(e=Rr(e,t))&&(Re(e,t),Fu(e))}function ju(e){var t=e.memoizedState,a=0;null!==t&&(a=t.retryLane),Nu(e,a)}function Cu(e,t){var a=0;switch(e.tag){case 31:case 13:var r=e.stateNode,n=e.memoizedState;null!==n&&(a=n.retryLane);break;case 19:r=e.stateNode;break;case 22:r=e.stateNode._retryCache;break;default:throw Error(i(314))}null!==r&&r.delete(t),Nu(e,a)}var _u=null,Au=null,Pu=!1,Ru=!1,Ou=!1,Du=0;function Fu(e){e!==Au&&null===e.next&&(null===Au?_u=Au=e:Au=Au.next=e),Ru=!0,Pu||(Pu=!0,Ed(function(){0!==(6&hc)?ne(ue,Lu):Mu()}))}function Iu(e,t){if(!Ou&&Ru){Ou=!0;do{for(var a=!1,r=_u;null!==r;){if(!t)if(0!==e){var n=r.pendingLanes;if(0===n)var s=0;else{var i=r.suspendedLanes,o=r.pingedLanes;s=(1<<31-we(42|e)+1)-1,s=201326741&(s&=n&~(i&~o))?201326741&s|1:s?2|s:0}0!==s&&(a=!0,Bu(r,s))}else s=gc,0===(3&(s=je(r,r===mc?s:0,null!==r.cancelPendingCommit||-1!==r.timeoutHandle)))||Ce(r,s)||(a=!0,Bu(r,s));r=r.next}}while(a);Ou=!1}}function Lu(){Mu()}function Mu(){Ru=Pu=!1;var e=0;0!==Du&&function(){var e=window.event;if(e&&"popstate"===e.type)return e!==wd&&(wd=e,!0);return wd=null,!1}()&&(e=Du);for(var t=le(),a=null,r=_u;null!==r;){var n=r.next,s=zu(r,t);0===s?(r.next=null,null===a?_u=n:a.next=n,null===n&&(Au=a)):(a=r,(0!==e||0!==(3&s))&&(Ru=!0)),r=n}0!==Lc&&5!==Lc||Iu(e,!1),0!==Du&&(Du=0)}function zu(e,t){for(var a=e.suspendedLanes,r=e.pingedLanes,n=e.expirationTimes,s=-62914561&e.pendingLanes;0<s;){var i=31-we(s),o=1<<i,l=n[i];-1===l?0!==(o&a)&&0===(o&r)||(n[i]=_e(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}if(a=gc,a=je(e,e===(t=mc)?a:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle),r=e.callbackNode,0===a||e===t&&(2===vc||9===vc)||null!==e.cancelPendingCommit)return null!==r&&null!==r&&se(r),e.callbackNode=null,e.callbackPriority=0;if(0===(3&a)||Ce(e,a)){if((t=a&-a)===e.callbackPriority)return t;switch(null!==r&&se(r),Le(a)){case 2:case 8:a=de;break;case 32:default:a=fe;break;case 268435456:a=me}return r=Uu.bind(null,e),a=ne(a,r),e.callbackPriority=t,e.callbackNode=a,t}return null!==r&&null!==r&&se(r),e.callbackPriority=2,e.callbackNode=null,2}function Uu(e,t){if(0!==Lc&&5!==Lc)return e.callbackNode=null,e.callbackPriority=0,null;var a=e.callbackNode;if(wu()&&e.callbackNode!==a)return null;var r=gc;return 0===(r=je(e,e===mc?r:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle))?null:(Xc(e,r,t),zu(e,le()),null!=e.callbackNode&&e.callbackNode===a?Uu.bind(null,e):null)}function Bu(e,t){if(wu())return null;Xc(e,t,!0)}function Wu(){if(0===Du){var e=Hn;0===e&&(e=Se,0===(261888&(Se<<=1))&&(Se=256)),Du=e}return Du}function Hu(e){return null==e||"symbol"===typeof e||"boolean"===typeof e?null:"function"===typeof e?e:Pt(""+e)}function Vu(e,t){var a=t.ownerDocument.createElement("input");return a.name=t.name,a.value=t.value,e.id&&a.setAttribute("form",e.id),t.parentNode.insertBefore(a,t),e=new FormData(e),a.parentNode.removeChild(a),e}for(var Gu=0;Gu<Sr.length;Gu++){var $u=Sr[Gu];Er($u.toLowerCase(),"on"+($u[0].toUpperCase()+$u.slice(1)))}Er(pr,"onAnimationEnd"),Er(gr,"onAnimationIteration"),Er(vr,"onAnimationStart"),Er("dblclick","onDoubleClick"),Er("focusin","onFocus"),Er("focusout","onBlur"),Er(yr,"onTransitionRun"),Er(br,"onTransitionStart"),Er(wr,"onTransitionCancel"),Er(xr,"onTransitionEnd"),nt("onMouseEnter",["mouseout","mouseover"]),nt("onMouseLeave",["mouseout","mouseover"]),nt("onPointerEnter",["pointerout","pointerover"]),nt("onPointerLeave",["pointerout","pointerover"]),rt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),rt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),rt("onBeforeInput",["compositionend","keypress","textInput","paste"]),rt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),rt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),rt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var qu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Yu=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(qu));function Xu(e,t){t=0!==(4&t);for(var a=0;a<e.length;a++){var r=e[a],n=r.event;r=r.listeners;e:{var s=void 0;if(t)for(var i=r.length-1;0<=i;i--){var o=r[i],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&n.isPropagationStopped())break e;s=o,n.currentTarget=c;try{s(n)}catch(u){Tr(u)}n.currentTarget=null,s=l}else for(i=0;i<r.length;i++){if(l=(o=r[i]).instance,c=o.currentTarget,o=o.listener,l!==s&&n.isPropagationStopped())break e;s=o,n.currentTarget=c;try{s(n)}catch(u){Tr(u)}n.currentTarget=null,s=l}}}}function Ku(e,t){var a=t[Ve];void 0===a&&(a=t[Ve]=new Set);var r=e+"__bubble";a.has(r)||(ed(t,e,2,!1),a.add(r))}function Ju(e,t,a){var r=0;t&&(r|=4),ed(a,e,r,t)}var Qu="_reactListening"+Math.random().toString(36).slice(2);function Zu(e){if(!e[Qu]){e[Qu]=!0,tt.forEach(function(t){"selectionchange"!==t&&(Yu.has(t)||Ju(t,!1,e),Ju(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Qu]||(t[Qu]=!0,Ju("selectionchange",!1,t))}}function ed(e,t,a,r){switch(jf(t)){case 2:var n=xf;break;case 8:n=kf;break;default:n=Sf}a=n.bind(null,t,a,e),n=void 0,!Wt||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(n=!0),r?void 0!==n?e.addEventListener(t,a,{capture:!0,passive:n}):e.addEventListener(t,a,!0):void 0!==n?e.addEventListener(t,a,{passive:n}):e.addEventListener(t,a,!1)}function td(e,t,a,r,n){var s=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var i=r.tag;if(3===i||4===i){var o=r.stateNode.containerInfo;if(o===n)break;if(4===i)for(i=r.return;null!==i;){var c=i.tag;if((3===c||4===c)&&i.stateNode.containerInfo===n)return;i=i.return}for(;null!==o;){if(null===(i=Ke(o)))return;if(5===(c=i.tag)||6===c||26===c||27===c){r=s=i;continue e}o=o.parentNode}}r=r.return}zt(function(){var r=s,n=Dt(a),i=[];e:{var o=kr.get(e);if(void 0!==o){var c=aa,u=e;switch(e){case"keypress":if(0===Yt(a))break e;case"keydown":case"keyup":c=va;break;case"focusin":u="focus",c=la;break;case"focusout":u="blur",c=la;break;case"beforeblur":case"afterblur":c=la;break;case"click":if(2===a.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=ia;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=oa;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=ba;break;case pr:case gr:case vr:c=ca;break;case xr:c=wa;break;case"scroll":case"scrollend":c=na;break;case"wheel":c=xa;break;case"copy":case"cut":case"paste":c=ua;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=ya;break;case"toggle":case"beforetoggle":c=ka}var d=0!==(4&t),f=!d&&("scroll"===e||"scrollend"===e),h=d?null!==o?o+"Capture":null:o;d=[];for(var m,p=r;null!==p;){var g=p;if(m=g.stateNode,5!==(g=g.tag)&&26!==g&&27!==g||null===m||null===h||null!=(g=Ut(p,h))&&d.push(ad(p,g,m)),f)break;p=p.return}0<d.length&&(o=new c(o,u,null,a,n),i.push({event:o,listeners:d}))}}if(0===(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||a===Ot||!(u=a.relatedTarget||a.fromElement)||!Ke(u)&&!u[He])&&(c||o)&&(o=n.window===n?n:(o=n.ownerDocument)?o.defaultView||o.parentWindow:window,c?(c=r,null!==(u=(u=a.relatedTarget||a.toElement)?Ke(u):null)&&(f=l(u),d=u.tag,u!==f||5!==d&&27!==d&&6!==d)&&(u=null)):(c=null,u=r),c!==u)){if(d=ia,g="onMouseLeave",h="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(d=ya,g="onPointerLeave",h="onPointerEnter",p="pointer"),f=null==c?o:Qe(c),m=null==u?o:Qe(u),(o=new d(g,p+"leave",c,a,n)).target=f,o.relatedTarget=m,g=null,Ke(n)===r&&((d=new d(h,p+"enter",u,a,n)).target=m,d.relatedTarget=f,g=d),f=g,c&&u)e:{for(d=nd,p=u,m=0,g=h=c;g;g=d(g))m++;g=0;for(var v=p;v;v=d(v))g++;for(;0<m-g;)h=d(h),m--;for(;0<g-m;)p=d(p),g--;for(;m--;){if(h===p||null!==p&&h===p.alternate){d=h;break e}h=d(h),p=d(p)}d=null}else d=null;null!==c&&sd(i,o,c,d,!1),null!==u&&null!==f&&sd(i,f,u,d,!0)}if("select"===(c=(o=r?Qe(r):window).nodeName&&o.nodeName.toLowerCase())||"input"===c&&"file"===o.type)var y=Ua;else if(Da(o))if(Ba)y=Ka;else{y=Ya;var b=qa}else!(c=o.nodeName)||"input"!==c.toLowerCase()||"checkbox"!==o.type&&"radio"!==o.type?r&&Ct(r.elementType)&&(y=Ua):y=Xa;switch(y&&(y=y(e,r))?Fa(i,y,a,n):(b&&b(e,o,r),"focusout"===e&&r&&"number"===o.type&&null!=r.memoizedProps.value&&wt(o,"number",o.value)),b=r?Qe(r):window,e){case"focusin":(Da(b)||"true"===b.contentEditable)&&(sr=b,ir=r,or=null);break;case"focusout":or=ir=sr=null;break;case"mousedown":lr=!0;break;case"contextmenu":case"mouseup":case"dragend":lr=!1,cr(i,a,n);break;case"selectionchange":if(nr)break;case"keydown":case"keyup":cr(i,a,n)}var w;if(Ea)e:{switch(e){case"compositionstart":var x="onCompositionStart";break e;case"compositionend":x="onCompositionEnd";break e;case"compositionupdate":x="onCompositionUpdate";break e}x=void 0}else Ra?Aa(e,a)&&(x="onCompositionEnd"):"keydown"===e&&229===a.keyCode&&(x="onCompositionStart");x&&(ja&&"ko"!==a.locale&&(Ra||"onCompositionStart"!==x?"onCompositionEnd"===x&&Ra&&(w=qt()):(Gt="value"in(Vt=n)?Vt.value:Vt.textContent,Ra=!0)),0<(b=rd(r,x)).length&&(x=new da(x,e,null,a,n),i.push({event:x,listeners:b}),w?x.data=w:null!==(w=Pa(a))&&(x.data=w))),(w=Na?function(e,t){switch(e){case"compositionend":return Pa(t);case"keypress":return 32!==t.which?null:(_a=!0,Ca);case"textInput":return(e=t.data)===Ca&&_a?null:e;default:return null}}(e,a):function(e,t){if(Ra)return"compositionend"===e||!Ea&&Aa(e,t)?(e=qt(),$t=Gt=Vt=null,Ra=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return ja&&"ko"!==t.locale?null:t.data}}(e,a))&&(0<(x=rd(r,"onBeforeInput")).length&&(b=new da("onBeforeInput","beforeinput",null,a,n),i.push({event:b,listeners:x}),b.data=w)),function(e,t,a,r,n){if("submit"===t&&a&&a.stateNode===n){var s=Hu((n[We]||null).action),i=r.submitter;i&&null!==(t=(t=i[We]||null)?Hu(t.formAction):i.getAttribute("formAction"))&&(s=t,i=null);var o=new aa("action","action",null,r,n);e.push({event:o,listeners:[{instance:null,listener:function(){if(r.defaultPrevented){if(0!==Du){var e=i?Vu(n,i):new FormData(n);eo(a,{pending:!0,data:e,method:n.method,action:s},null,e)}}else"function"===typeof s&&(o.preventDefault(),e=i?Vu(n,i):new FormData(n),eo(a,{pending:!0,data:e,method:n.method,action:s},s,e))},currentTarget:n}]})}}(i,e,r,a,n)}Xu(i,t)})}function ad(e,t,a){return{instance:e,listener:t,currentTarget:a}}function rd(e,t){for(var a=t+"Capture",r=[];null!==e;){var n=e,s=n.stateNode;if(5!==(n=n.tag)&&26!==n&&27!==n||null===s||(null!=(n=Ut(e,a))&&r.unshift(ad(e,n,s)),null!=(n=Ut(e,t))&&r.push(ad(e,n,s))),3===e.tag)return r;e=e.return}return[]}function nd(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function sd(e,t,a,r,n){for(var s=t._reactName,i=[];null!==a&&a!==r;){var o=a,l=o.alternate,c=o.stateNode;if(o=o.tag,null!==l&&l===r)break;5!==o&&26!==o&&27!==o||null===c||(l=c,n?null!=(c=Ut(a,s))&&i.unshift(ad(a,c,l)):n||null!=(c=Ut(a,s))&&i.push(ad(a,c,l))),a=a.return}0!==i.length&&e.push({event:t,listeners:i})}var id=/\r\n?/g,od=/\u0000|\uFFFD/g;function ld(e){return("string"===typeof e?e:""+e).replace(id,"\n").replace(od,"")}function cd(e,t){return t=ld(t),ld(e)===t}function ud(e,t,a,r,n,s){switch(a){case"children":"string"===typeof r?"body"===t||"textarea"===t&&""===r||Et(e,r):("number"===typeof r||"bigint"===typeof r)&&"body"!==t&&Et(e,""+r);break;case"className":ct(e,"class",r);break;case"tabIndex":ct(e,"tabindex",r);break;case"dir":case"role":case"viewBox":case"width":case"height":ct(e,a,r);break;case"style":jt(e,r,s);break;case"data":if("object"!==t){ct(e,"data",r);break}case"src":case"href":if(""===r&&("a"!==t||"href"!==a)){e.removeAttribute(a);break}if(null==r||"function"===typeof r||"symbol"===typeof r||"boolean"===typeof r){e.removeAttribute(a);break}r=Pt(""+r),e.setAttribute(a,r);break;case"action":case"formAction":if("function"===typeof r){e.setAttribute(a,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"===typeof s&&("formAction"===a?("input"!==t&&ud(e,t,"name",n.name,n,null),ud(e,t,"formEncType",n.formEncType,n,null),ud(e,t,"formMethod",n.formMethod,n,null),ud(e,t,"formTarget",n.formTarget,n,null)):(ud(e,t,"encType",n.encType,n,null),ud(e,t,"method",n.method,n,null),ud(e,t,"target",n.target,n,null))),null==r||"symbol"===typeof r||"boolean"===typeof r){e.removeAttribute(a);break}r=Pt(""+r),e.setAttribute(a,r);break;case"onClick":null!=r&&(e.onclick=Rt);break;case"onScroll":null!=r&&Ku("scroll",e);break;case"onScrollEnd":null!=r&&Ku("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=r){if("object"!==typeof r||!("__html"in r))throw Error(i(61));if(null!=(a=r.__html)){if(null!=n.children)throw Error(i(60));e.innerHTML=a}}break;case"multiple":e.multiple=r&&"function"!==typeof r&&"symbol"!==typeof r;break;case"muted":e.muted=r&&"function"!==typeof r&&"symbol"!==typeof r;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==r||"function"===typeof r||"boolean"===typeof r||"symbol"===typeof r){e.removeAttribute("xlink:href");break}a=Pt(""+r),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",a);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(a,""+r):e.removeAttribute(a);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(a,""):e.removeAttribute(a);break;case"capture":case"download":!0===r?e.setAttribute(a,""):!1!==r&&null!=r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(a,r):e.removeAttribute(a);break;case"cols":case"rows":case"size":case"span":null!=r&&"function"!==typeof r&&"symbol"!==typeof r&&!isNaN(r)&&1<=r?e.setAttribute(a,r):e.removeAttribute(a);break;case"rowSpan":case"start":null==r||"function"===typeof r||"symbol"===typeof r||isNaN(r)?e.removeAttribute(a):e.setAttribute(a,r);break;case"popover":Ku("beforetoggle",e),Ku("toggle",e),lt(e,"popover",r);break;case"xlinkActuate":ut(e,"http://www.w3.org/1999/xlink","xlink:actuate",r);break;case"xlinkArcrole":ut(e,"http://www.w3.org/1999/xlink","xlink:arcrole",r);break;case"xlinkRole":ut(e,"http://www.w3.org/1999/xlink","xlink:role",r);break;case"xlinkShow":ut(e,"http://www.w3.org/1999/xlink","xlink:show",r);break;case"xlinkTitle":ut(e,"http://www.w3.org/1999/xlink","xlink:title",r);break;case"xlinkType":ut(e,"http://www.w3.org/1999/xlink","xlink:type",r);break;case"xmlBase":ut(e,"http://www.w3.org/XML/1998/namespace","xml:base",r);break;case"xmlLang":ut(e,"http://www.w3.org/XML/1998/namespace","xml:lang",r);break;case"xmlSpace":ut(e,"http://www.w3.org/XML/1998/namespace","xml:space",r);break;case"is":lt(e,"is",r);break;case"innerText":case"textContent":break;default:(!(2<a.length)||"o"!==a[0]&&"O"!==a[0]||"n"!==a[1]&&"N"!==a[1])&&lt(e,a=_t.get(a)||a,r)}}function dd(e,t,a,r,n,s){switch(a){case"style":jt(e,r,s);break;case"dangerouslySetInnerHTML":if(null!=r){if("object"!==typeof r||!("__html"in r))throw Error(i(61));if(null!=(a=r.__html)){if(null!=n.children)throw Error(i(60));e.innerHTML=a}}break;case"children":"string"===typeof r?Et(e,r):("number"===typeof r||"bigint"===typeof r)&&Et(e,""+r);break;case"onScroll":null!=r&&Ku("scroll",e);break;case"onScrollEnd":null!=r&&Ku("scrollend",e);break;case"onClick":null!=r&&(e.onclick=Rt);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:at.hasOwnProperty(a)||("o"!==a[0]||"n"!==a[1]||(n=a.endsWith("Capture"),t=a.slice(2,n?a.length-7:void 0),"function"===typeof(s=null!=(s=e[We]||null)?s[a]:null)&&e.removeEventListener(t,s,n),"function"!==typeof r)?a in e?e[a]=r:!0===r?e.setAttribute(a,""):lt(e,a,r):("function"!==typeof s&&null!==s&&(a in e?e[a]=null:e.hasAttribute(a)&&e.removeAttribute(a)),e.addEventListener(t,r,n)))}}function fd(e,t,a){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ku("error",e),Ku("load",e);var r,n=!1,s=!1;for(r in a)if(a.hasOwnProperty(r)){var o=a[r];if(null!=o)switch(r){case"src":n=!0;break;case"srcSet":s=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,t));default:ud(e,t,r,o,a,null)}}return s&&ud(e,t,"srcSet",a.srcSet,a,null),void(n&&ud(e,t,"src",a.src,a,null));case"input":Ku("invalid",e);var l=r=o=s=null,c=null,u=null;for(n in a)if(a.hasOwnProperty(n)){var d=a[n];if(null!=d)switch(n){case"name":s=d;break;case"type":o=d;break;case"checked":c=d;break;case"defaultChecked":u=d;break;case"value":r=d;break;case"defaultValue":l=d;break;case"children":case"dangerouslySetInnerHTML":if(null!=d)throw Error(i(137,t));break;default:ud(e,t,n,d,a,null)}}return void bt(e,r,l,c,u,o,s,!1);case"select":for(s in Ku("invalid",e),n=o=r=null,a)if(a.hasOwnProperty(s)&&null!=(l=a[s]))switch(s){case"value":r=l;break;case"defaultValue":o=l;break;case"multiple":n=l;default:ud(e,t,s,l,a,null)}return t=r,a=o,e.multiple=!!n,void(null!=t?xt(e,!!n,t,!1):null!=a&&xt(e,!!n,a,!0));case"textarea":for(o in Ku("invalid",e),r=s=n=null,a)if(a.hasOwnProperty(o)&&null!=(l=a[o]))switch(o){case"value":n=l;break;case"defaultValue":s=l;break;case"children":r=l;break;case"dangerouslySetInnerHTML":if(null!=l)throw Error(i(91));break;default:ud(e,t,o,l,a,null)}return void St(e,n,s,r);case"option":for(c in a)if(a.hasOwnProperty(c)&&null!=(n=a[c]))if("selected"===c)e.selected=n&&"function"!==typeof n&&"symbol"!==typeof n;else ud(e,t,c,n,a,null);return;case"dialog":Ku("beforetoggle",e),Ku("toggle",e),Ku("cancel",e),Ku("close",e);break;case"iframe":case"object":Ku("load",e);break;case"video":case"audio":for(n=0;n<qu.length;n++)Ku(qu[n],e);break;case"image":Ku("error",e),Ku("load",e);break;case"details":Ku("toggle",e);break;case"embed":case"source":case"link":Ku("error",e),Ku("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(u in a)if(a.hasOwnProperty(u)&&null!=(n=a[u]))switch(u){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,t));default:ud(e,t,u,n,a,null)}return;default:if(Ct(t)){for(d in a)a.hasOwnProperty(d)&&(void 0!==(n=a[d])&&dd(e,t,d,n,a,void 0));return}}for(l in a)a.hasOwnProperty(l)&&(null!=(n=a[l])&&ud(e,t,l,n,a,null))}function hd(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}var md=null,pd=null;function gd(e){return 9===e.nodeType?e:e.ownerDocument}function vd(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function yd(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function bd(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"bigint"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var wd=null;var xd="function"===typeof setTimeout?setTimeout:void 0,kd="function"===typeof clearTimeout?clearTimeout:void 0,Sd="function"===typeof Promise?Promise:void 0,Ed="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof Sd?function(e){return Sd.resolve(null).then(e).catch(Td)}:xd;function Td(e){setTimeout(function(){throw e})}function Nd(e){return"head"===e}function jd(e,t){var a=t,r=0;do{var n=a.nextSibling;if(e.removeChild(a),n&&8===n.nodeType)if("/$"===(a=n.data)||"/&"===a){if(0===r)return e.removeChild(n),void Gf(t);r--}else if("$"===a||"$?"===a||"$~"===a||"$!"===a||"&"===a)r++;else if("html"===a)Md(e.ownerDocument.documentElement);else if("head"===a){Md(a=e.ownerDocument.head);for(var s=a.firstChild;s;){var i=s.nextSibling,o=s.nodeName;s[Ye]||"SCRIPT"===o||"STYLE"===o||"LINK"===o&&"stylesheet"===s.rel.toLowerCase()||a.removeChild(s),s=i}}else"body"===a&&Md(e.ownerDocument.body);a=n}while(a);Gf(t)}function Cd(e,t){var a=e;e=0;do{var r=a.nextSibling;if(1===a.nodeType?t?(a._stashedDisplay=a.style.display,a.style.display="none"):(a.style.display=a._stashedDisplay||"",""===a.getAttribute("style")&&a.removeAttribute("style")):3===a.nodeType&&(t?(a._stashedText=a.nodeValue,a.nodeValue=""):a.nodeValue=a._stashedText||""),r&&8===r.nodeType)if("/$"===(a=r.data)){if(0===e)break;e--}else"$"!==a&&"$?"!==a&&"$~"!==a&&"$!"!==a||e++;a=r}while(a)}function _d(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var a=t;switch(t=t.nextSibling,a.nodeName){case"HTML":case"HEAD":case"BODY":_d(a),Xe(a);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===a.rel.toLowerCase())continue}e.removeChild(a)}}function Ad(e,t){for(;8!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!t)return null;if(null===(e=Od(e.nextSibling)))return null}return e}function Pd(e){return"$?"===e.data||"$~"===e.data}function Rd(e){return"$!"===e.data||"$?"===e.data&&"loading"!==e.ownerDocument.readyState}function Od(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"$~"===t||"&"===t||"F!"===t||"F"===t)break;if("/$"===t||"/&"===t)return null}}return e}var Dd=null;function Fd(e){e=e.nextSibling;for(var t=0;e;){if(8===e.nodeType){var a=e.data;if("/$"===a||"/&"===a){if(0===t)return Od(e.nextSibling);t--}else"$"!==a&&"$!"!==a&&"$?"!==a&&"$~"!==a&&"&"!==a||t++}e=e.nextSibling}return null}function Id(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var a=e.data;if("$"===a||"$!"===a||"$?"===a||"$~"===a||"&"===a){if(0===t)return e;t--}else"/$"!==a&&"/&"!==a||t++}e=e.previousSibling}return null}function Ld(e,t,a){switch(t=gd(a),e){case"html":if(!(e=t.documentElement))throw Error(i(452));return e;case"head":if(!(e=t.head))throw Error(i(453));return e;case"body":if(!(e=t.body))throw Error(i(454));return e;default:throw Error(i(451))}}function Md(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Xe(e)}var zd=new Map,Ud=new Set;function Bd(e){return"function"===typeof e.getRootNode?e.getRootNode():9===e.nodeType?e:e.ownerDocument}var Wd=F.d;F.d={f:function(){var e=Wd.f(),t=Zc();return e||t},r:function(e){var t=Je(e);null!==t&&5===t.tag&&"form"===t.type?ao(t):Wd.r(e)},D:function(e){Wd.D(e),Vd("dns-prefetch",e,null)},C:function(e,t){Wd.C(e,t),Vd("preconnect",e,t)},L:function(e,t,a){Wd.L(e,t,a);var r=Hd;if(r&&e&&t){var n='link[rel="preload"][as="'+vt(t)+'"]';"image"===t&&a&&a.imageSrcSet?(n+='[imagesrcset="'+vt(a.imageSrcSet)+'"]',"string"===typeof a.imageSizes&&(n+='[imagesizes="'+vt(a.imageSizes)+'"]')):n+='[href="'+vt(e)+'"]';var s=n;switch(t){case"style":s=$d(e);break;case"script":s=Xd(e)}zd.has(s)||(e=h({rel:"preload",href:"image"===t&&a&&a.imageSrcSet?void 0:e,as:t},a),zd.set(s,e),null!==r.querySelector(n)||"style"===t&&r.querySelector(qd(s))||"script"===t&&r.querySelector(Kd(s))||(fd(t=r.createElement("link"),"link",e),et(t),r.head.appendChild(t)))}},m:function(e,t){Wd.m(e,t);var a=Hd;if(a&&e){var r=t&&"string"===typeof t.as?t.as:"script",n='link[rel="modulepreload"][as="'+vt(r)+'"][href="'+vt(e)+'"]',s=n;switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":s=Xd(e)}if(!zd.has(s)&&(e=h({rel:"modulepreload",href:e},t),zd.set(s,e),null===a.querySelector(n))){switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(a.querySelector(Kd(s)))return}fd(r=a.createElement("link"),"link",e),et(r),a.head.appendChild(r)}}},X:function(e,t){Wd.X(e,t);var a=Hd;if(a&&e){var r=Ze(a).hoistableScripts,n=Xd(e),s=r.get(n);s||((s=a.querySelector(Kd(n)))||(e=h({src:e,async:!0},t),(t=zd.get(n))&&ef(e,t),et(s=a.createElement("script")),fd(s,"link",e),a.head.appendChild(s)),s={type:"script",instance:s,count:1,state:null},r.set(n,s))}},S:function(e,t,a){Wd.S(e,t,a);var r=Hd;if(r&&e){var n=Ze(r).hoistableStyles,s=$d(e);t=t||"default";var i=n.get(s);if(!i){var o={loading:0,preload:null};if(i=r.querySelector(qd(s)))o.loading=5;else{e=h({rel:"stylesheet",href:e,"data-precedence":t},a),(a=zd.get(s))&&Zd(e,a);var l=i=r.createElement("link");et(l),fd(l,"link",e),l._p=new Promise(function(e,t){l.onload=e,l.onerror=t}),l.addEventListener("load",function(){o.loading|=1}),l.addEventListener("error",function(){o.loading|=2}),o.loading|=4,Qd(i,t,r)}i={type:"stylesheet",instance:i,count:1,state:o},n.set(s,i)}}},M:function(e,t){Wd.M(e,t);var a=Hd;if(a&&e){var r=Ze(a).hoistableScripts,n=Xd(e),s=r.get(n);s||((s=a.querySelector(Kd(n)))||(e=h({src:e,async:!0,type:"module"},t),(t=zd.get(n))&&ef(e,t),et(s=a.createElement("script")),fd(s,"link",e),a.head.appendChild(s)),s={type:"script",instance:s,count:1,state:null},r.set(n,s))}}};var Hd="undefined"===typeof document?null:document;function Vd(e,t,a){var r=Hd;if(r&&"string"===typeof t&&t){var n=vt(t);n='link[rel="'+e+'"][href="'+n+'"]',"string"===typeof a&&(n+='[crossorigin="'+a+'"]'),Ud.has(n)||(Ud.add(n),e={rel:e,crossOrigin:a,href:t},null===r.querySelector(n)&&(fd(t=r.createElement("link"),"link",e),et(t),r.head.appendChild(t)))}}function Gd(e,t,a,r){var n,s,o,l,c=(c=$.current)?Bd(c):null;if(!c)throw Error(i(446));switch(e){case"meta":case"title":return null;case"style":return"string"===typeof a.precedence&&"string"===typeof a.href?(t=$d(a.href),(r=(a=Ze(c).hoistableStyles).get(t))||(r={type:"style",instance:null,count:0,state:null},a.set(t,r)),r):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===a.rel&&"string"===typeof a.href&&"string"===typeof a.precedence){e=$d(a.href);var u=Ze(c).hoistableStyles,d=u.get(e);if(d||(c=c.ownerDocument||c,d={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},u.set(e,d),(u=c.querySelector(qd(e)))&&!u._p&&(d.instance=u,d.state.loading=5),zd.has(e)||(a={rel:"preload",as:"style",href:a.href,crossOrigin:a.crossOrigin,integrity:a.integrity,media:a.media,hrefLang:a.hrefLang,referrerPolicy:a.referrerPolicy},zd.set(e,a),u||(n=c,s=e,o=a,l=d.state,n.querySelector('link[rel="preload"][as="style"]['+s+"]")?l.loading=1:(s=n.createElement("link"),l.preload=s,s.addEventListener("load",function(){return l.loading|=1}),s.addEventListener("error",function(){return l.loading|=2}),fd(s,"link",o),et(s),n.head.appendChild(s))))),t&&null===r)throw Error(i(528,""));return d}if(t&&null!==r)throw Error(i(529,""));return null;case"script":return t=a.async,"string"===typeof(a=a.src)&&t&&"function"!==typeof t&&"symbol"!==typeof t?(t=Xd(a),(r=(a=Ze(c).hoistableScripts).get(t))||(r={type:"script",instance:null,count:0,state:null},a.set(t,r)),r):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,e))}}function $d(e){return'href="'+vt(e)+'"'}function qd(e){return'link[rel="stylesheet"]['+e+"]"}function Yd(e){return h({},e,{"data-precedence":e.precedence,precedence:null})}function Xd(e){return'[src="'+vt(e)+'"]'}function Kd(e){return"script[async]"+e}function Jd(e,t,a){if(t.count++,null===t.instance)switch(t.type){case"style":var r=e.querySelector('style[data-href~="'+vt(a.href)+'"]');if(r)return t.instance=r,et(r),r;var n=h({},a,{"data-href":a.href,"data-precedence":a.precedence,href:null,precedence:null});return et(r=(e.ownerDocument||e).createElement("style")),fd(r,"style",n),Qd(r,a.precedence,e),t.instance=r;case"stylesheet":n=$d(a.href);var s=e.querySelector(qd(n));if(s)return t.state.loading|=4,t.instance=s,et(s),s;r=Yd(a),(n=zd.get(n))&&Zd(r,n),et(s=(e.ownerDocument||e).createElement("link"));var o=s;return o._p=new Promise(function(e,t){o.onload=e,o.onerror=t}),fd(s,"link",r),t.state.loading|=4,Qd(s,a.precedence,e),t.instance=s;case"script":return s=Xd(a.src),(n=e.querySelector(Kd(s)))?(t.instance=n,et(n),n):(r=a,(n=zd.get(s))&&ef(r=h({},a),n),et(n=(e=e.ownerDocument||e).createElement("script")),fd(n,"link",r),e.head.appendChild(n),t.instance=n);case"void":return null;default:throw Error(i(443,t.type))}else"stylesheet"===t.type&&0===(4&t.state.loading)&&(r=t.instance,t.state.loading|=4,Qd(r,a.precedence,e));return t.instance}function Qd(e,t,a){for(var r=a.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),n=r.length?r[r.length-1]:null,s=n,i=0;i<r.length;i++){var o=r[i];if(o.dataset.precedence===t)s=o;else if(s!==n)break}s?s.parentNode.insertBefore(e,s.nextSibling):(t=9===a.nodeType?a.head:a).insertBefore(e,t.firstChild)}function Zd(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function ef(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var tf=null;function af(e,t,a){if(null===tf){var r=new Map,n=tf=new Map;n.set(a,r)}else(r=(n=tf).get(a))||(r=new Map,n.set(a,r));if(r.has(e))return r;for(r.set(e,null),a=a.getElementsByTagName(e),n=0;n<a.length;n++){var s=a[n];if(!(s[Ye]||s[Be]||"link"===e&&"stylesheet"===s.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==s.namespaceURI){var i=s.getAttribute(t)||"";i=e+i;var o=r.get(i);o?o.push(s):r.set(i,[s])}}return r}function rf(e,t,a){(e=e.ownerDocument||e).head.insertBefore(a,"title"===t?e.querySelector("head > title"):null)}function nf(e){return"stylesheet"!==e.type||0!==(3&e.state.loading)}var sf=0;function of(){if(this.count--,0===this.count&&(0===this.imgCount||!this.waitingForImages))if(this.stylesheets)cf(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}var lf=null;function cf(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,lf=new Map,t.forEach(uf,e),lf=null,of.call(e))}function uf(e,t){if(!(4&t.state.loading)){var a=lf.get(e);if(a)var r=a.get(null);else{a=new Map,lf.set(e,a);for(var n=e.querySelectorAll("link[data-precedence],style[data-precedence]"),s=0;s<n.length;s++){var i=n[s];"LINK"!==i.nodeName&&"not all"===i.getAttribute("media")||(a.set(i.dataset.precedence,i),r=i)}r&&a.set(null,r)}i=(n=t.instance).getAttribute("data-precedence"),(s=a.get(i)||r)===r&&a.set(null,n),a.set(i,n),this.count++,r=of.bind(this),n.addEventListener("load",r),n.addEventListener("error",r),s?s.parentNode.insertBefore(n,s.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(n,e.firstChild),t.state.loading|=4}}var df={$$typeof:x,Provider:null,Consumer:null,_currentValue:I,_currentValue2:I,_threadCount:0};function ff(e,t,a,r,n,s,i,o,l){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Pe(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Pe(0),this.hiddenUpdates=Pe(null),this.identifierPrefix=r,this.onUncaughtError=n,this.onCaughtError=s,this.onRecoverableError=i,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=l,this.incompleteTransitions=new Map}function hf(e,t,a,r,n,s,i,o,l,c,u,d){return e=new ff(e,t,a,i,l,c,u,d,o),t=1,!0===s&&(t|=24),s=Lr(3,null,null,t),e.current=s,s.stateNode=e,(t=zn()).refCount++,e.pooledCache=t,t.refCount++,s.memoizedState={element:r,isDehydrated:a,cache:t},gs(s),e}function mf(e){return e?e=Fr:Fr}function pf(e,t,a,r,n,s){n=mf(n),null===r.context?r.context=n:r.pendingContext=n,(r=ys(t)).payload={element:a},null!==(s=void 0===s?null:s)&&(r.callback=s),null!==(a=bs(e,r,t))&&(Yc(a,0,t),ws(a,e,t))}function gf(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var a=e.retryLane;e.retryLane=0!==a&&a<t?a:t}}function vf(e,t){gf(e,t),(e=e.alternate)&&gf(e,t)}function yf(e){if(13===e.tag||31===e.tag){var t=Rr(e,67108864);null!==t&&Yc(t,0,67108864),vf(e,67108864)}}function bf(e){if(13===e.tag||31===e.tag){var t=$c(),a=Rr(e,t=Ie(t));null!==a&&Yc(a,0,t),vf(e,t)}}var wf=!0;function xf(e,t,a,r){var n=D.T;D.T=null;var s=F.p;try{F.p=2,Sf(e,t,a,r)}finally{F.p=s,D.T=n}}function kf(e,t,a,r){var n=D.T;D.T=null;var s=F.p;try{F.p=8,Sf(e,t,a,r)}finally{F.p=s,D.T=n}}function Sf(e,t,a,r){if(wf){var n=Ef(r);if(null===n)td(e,t,r,Tf,a),If(e,r);else if(function(e,t,a,r,n){switch(t){case"focusin":return _f=Lf(_f,e,t,a,r,n),!0;case"dragenter":return Af=Lf(Af,e,t,a,r,n),!0;case"mouseover":return Pf=Lf(Pf,e,t,a,r,n),!0;case"pointerover":var s=n.pointerId;return Rf.set(s,Lf(Rf.get(s)||null,e,t,a,r,n)),!0;case"gotpointercapture":return s=n.pointerId,Of.set(s,Lf(Of.get(s)||null,e,t,a,r,n)),!0}return!1}(n,e,t,a,r))r.stopPropagation();else if(If(e,r),4&t&&-1<Ff.indexOf(e)){for(;null!==n;){var s=Je(n);if(null!==s)switch(s.tag){case 3:if((s=s.stateNode).current.memoizedState.isDehydrated){var i=Ne(s.pendingLanes);if(0!==i){var o=s;for(o.pendingLanes|=2,o.entangledLanes|=2;i;){var l=1<<31-we(i);o.entanglements[1]|=l,i&=~l}Fu(s),0===(6&hc)&&(Dc=le()+500,Iu(0,!1))}}break;case 31:case 13:null!==(o=Rr(s,2))&&Yc(o,0,2),Zc(),vf(s,2)}if(null===(s=Ef(r))&&td(e,t,r,Tf,a),s===n)break;n=s}null!==n&&r.stopPropagation()}else td(e,t,r,null,a)}}function Ef(e){return Nf(e=Dt(e))}var Tf=null;function Nf(e){if(Tf=null,null!==(e=Ke(e))){var t=l(e);if(null===t)e=null;else{var a=t.tag;if(13===a){if(null!==(e=c(t)))return e;e=null}else if(31===a){if(null!==(e=u(t)))return e;e=null}else if(3===a){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return Tf=e,null}function jf(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ce()){case ue:return 2;case de:return 8;case fe:case he:return 32;case me:return 268435456;default:return 32}default:return 32}}var Cf=!1,_f=null,Af=null,Pf=null,Rf=new Map,Of=new Map,Df=[],Ff="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function If(e,t){switch(e){case"focusin":case"focusout":_f=null;break;case"dragenter":case"dragleave":Af=null;break;case"mouseover":case"mouseout":Pf=null;break;case"pointerover":case"pointerout":Rf.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Of.delete(t.pointerId)}}function Lf(e,t,a,r,n,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:a,eventSystemFlags:r,nativeEvent:s,targetContainers:[n]},null!==t&&(null!==(t=Je(t))&&yf(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==n&&-1===t.indexOf(n)&&t.push(n),e)}function Mf(e){var t=Ke(e.target);if(null!==t){var a=l(t);if(null!==a)if(13===(t=a.tag)){if(null!==(t=c(a)))return e.blockedOn=t,void ze(e.priority,function(){bf(a)})}else if(31===t){if(null!==(t=u(a)))return e.blockedOn=t,void ze(e.priority,function(){bf(a)})}else if(3===t&&a.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===a.tag?a.stateNode.containerInfo:null)}e.blockedOn=null}function zf(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var a=Ef(e.nativeEvent);if(null!==a)return null!==(t=Je(a))&&yf(t),e.blockedOn=a,!1;var r=new(a=e.nativeEvent).constructor(a.type,a);Ot=r,a.target.dispatchEvent(r),Ot=null,t.shift()}return!0}function Uf(e,t,a){zf(e)&&a.delete(t)}function Bf(){Cf=!1,null!==_f&&zf(_f)&&(_f=null),null!==Af&&zf(Af)&&(Af=null),null!==Pf&&zf(Pf)&&(Pf=null),Rf.forEach(Uf),Of.forEach(Uf)}function Wf(e,t){e.blockedOn===t&&(e.blockedOn=null,Cf||(Cf=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Bf)))}var Hf=null;function Vf(e){Hf!==e&&(Hf=e,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){Hf===e&&(Hf=null);for(var t=0;t<e.length;t+=3){var a=e[t],r=e[t+1],n=e[t+2];if("function"!==typeof r){if(null===Nf(r||a))continue;break}var s=Je(a);null!==s&&(e.splice(t,3),t-=3,eo(s,{pending:!0,data:n,method:a.method,action:r},r,n))}}))}function Gf(e){function t(t){return Wf(t,e)}null!==_f&&Wf(_f,e),null!==Af&&Wf(Af,e),null!==Pf&&Wf(Pf,e),Rf.forEach(t),Of.forEach(t);for(var a=0;a<Df.length;a++){var r=Df[a];r.blockedOn===e&&(r.blockedOn=null)}for(;0<Df.length&&null===(a=Df[0]).blockedOn;)Mf(a),null===a.blockedOn&&Df.shift();if(null!=(a=(e.ownerDocument||e).$$reactFormReplay))for(r=0;r<a.length;r+=3){var n=a[r],s=a[r+1],i=n[We]||null;if("function"===typeof s)i||Vf(a);else if(i){var o=null;if(s&&s.hasAttribute("formAction")){if(n=s,i=s[We]||null)o=i.formAction;else if(null!==Nf(n))continue}else o=i.action;"function"===typeof o?a[r+1]=o:(a.splice(r,3),r-=3),Vf(a)}}}function $f(){function e(e){e.canIntercept&&"react-transition"===e.info&&e.intercept({handler:function(){return new Promise(function(e){return n=e})},focusReset:"manual",scroll:"manual"})}function t(){null!==n&&(n(),n=null),r||setTimeout(a,20)}function a(){if(!r&&!navigation.transition){var e=navigation.currentEntry;e&&null!=e.url&&navigation.navigate(e.url,{state:e.getState(),info:"react-transition",history:"replace"})}}if("object"===typeof navigation){var r=!1,n=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(a,100),function(){r=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),null!==n&&(n(),n=null)}}}function qf(e){this._internalRoot=e}function Yf(e){this._internalRoot=e}Yf.prototype.render=qf.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(i(409));pf(t.current,$c(),e,t,null,null)},Yf.prototype.unmount=qf.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;pf(e.current,2,null,e,null,null),Zc(),t[He]=null}},Yf.prototype.unstable_scheduleHydration=function(e){if(e){var t=Me();e={blockedOn:null,target:e,priority:t};for(var a=0;a<Df.length&&0!==t&&t<Df[a].priority;a++);Df.splice(a,0,e),0===a&&Mf(e)}};var Xf=n.version;if("19.2.0"!==Xf)throw Error(i(527,Xf,"19.2.0"));F.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(i(188));throw e=Object.keys(e).join(","),Error(i(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=l(e)))throw Error(i(188));return t!==e?null:e}for(var a=e,r=t;;){var n=a.return;if(null===n)break;var s=n.alternate;if(null===s){if(null!==(r=n.return)){a=r;continue}break}if(n.child===s.child){for(s=n.child;s;){if(s===a)return d(n),e;if(s===r)return d(n),t;s=s.sibling}throw Error(i(188))}if(a.return!==r.return)a=n,r=s;else{for(var o=!1,c=n.child;c;){if(c===a){o=!0,a=n,r=s;break}if(c===r){o=!0,r=n,a=s;break}c=c.sibling}if(!o){for(c=s.child;c;){if(c===a){o=!0,a=s,r=n;break}if(c===r){o=!0,r=s,a=n;break}c=c.sibling}if(!o)throw Error(i(189))}}if(a.alternate!==r)throw Error(i(190))}if(3!==a.tag)throw Error(i(188));return a.stateNode.current===a?e:t}(t),e=null===(e=null!==e?f(e):null)?null:e.stateNode};var Kf={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:D,reconcilerVersion:"19.2.0"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Jf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Jf.isDisabled&&Jf.supportsFiber)try{ve=Jf.inject(Kf),ye=Jf}catch(Zf){}}t.createRoot=function(e,t){if(!o(e))throw Error(i(299));var a=!1,r="",n=Eo,s=To,l=No;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(a=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onUncaughtError&&(n=t.onUncaughtError),void 0!==t.onCaughtError&&(s=t.onCaughtError),void 0!==t.onRecoverableError&&(l=t.onRecoverableError)),t=hf(e,1,!1,null,0,a,r,null,n,s,l,$f),e[He]=t.current,Zu(e),new qf(t)},t.hydrateRoot=function(e,t,a){if(!o(e))throw Error(i(299));var r=!1,n="",s=Eo,l=To,c=No,u=null;return null!==a&&void 0!==a&&(!0===a.unstable_strictMode&&(r=!0),void 0!==a.identifierPrefix&&(n=a.identifierPrefix),void 0!==a.onUncaughtError&&(s=a.onUncaughtError),void 0!==a.onCaughtError&&(l=a.onCaughtError),void 0!==a.onRecoverableError&&(c=a.onRecoverableError),void 0!==a.formState&&(u=a.formState)),(t=hf(e,1,!0,t,0,r,n,u,s,l,c,$f)).context=mf(null),a=t.current,(n=ys(r=Ie(r=$c()))).callback=null,bs(a,n,r),a=r,t.current.lanes=a,Re(t,a),Fu(t),e[He]=t.current,Zu(e),new Yf(t)},t.version="19.2.0"},43:(e,t,a)=>{e.exports=a(288)},288:(e,t)=>{var a=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),h=Symbol.for("react.activity"),m=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,v={};function y(e,t,a){this.props=e,this.context=t,this.refs=v,this.updater=a||p}function b(){}function w(e,t,a){this.props=e,this.context=t,this.refs=v,this.updater=a||p}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},b.prototype=y.prototype;var x=w.prototype=new b;x.constructor=w,g(x,y.prototype),x.isPureReactComponent=!0;var k=Array.isArray;function S(){}var E={H:null,A:null,T:null,S:null},T=Object.prototype.hasOwnProperty;function N(e,t,r){var n=r.ref;return{$$typeof:a,type:e,key:t,ref:void 0!==n?n:null,props:r}}function j(e){return"object"===typeof e&&null!==e&&e.$$typeof===a}var C=/\/+/g;function _(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function A(e,t,n,s,i){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l,c,u=!1;if(null===e)u=!0;else switch(o){case"bigint":case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case a:case r:u=!0;break;case f:return A((u=e._init)(e._payload),t,n,s,i)}}if(u)return i=i(e),u=""===s?"."+_(e,0):s,k(i)?(n="",null!=u&&(n=u.replace(C,"$&/")+"/"),A(i,t,n,"",function(e){return e})):null!=i&&(j(i)&&(l=i,c=n+(null==i.key||e&&e.key===i.key?"":(""+i.key).replace(C,"$&/")+"/")+u,i=N(l.type,c,l.props)),t.push(i)),1;u=0;var d,h=""===s?".":s+":";if(k(e))for(var p=0;p<e.length;p++)u+=A(s=e[p],t,n,o=h+_(s,p),i);else if("function"===typeof(p=null===(d=e)||"object"!==typeof d?null:"function"===typeof(d=m&&d[m]||d["@@iterator"])?d:null))for(e=p.call(e),p=0;!(s=e.next()).done;)u+=A(s=s.value,t,n,o=h+_(s,p++),i);else if("object"===o){if("function"===typeof e.then)return A(function(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch("string"===typeof e.status?e.then(S,S):(e.status="pending",e.then(function(t){"pending"===e.status&&(e.status="fulfilled",e.value=t)},function(t){"pending"===e.status&&(e.status="rejected",e.reason=t)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}(e),t,n,s,i);throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return u}function P(e,t,a){if(null==e)return e;var r=[],n=0;return A(e,r,"","",function(e){return t.call(a,e,n++)}),r}function R(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var O="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)},D={map:P,forEach:function(e,t,a){P(e,function(){t.apply(this,arguments)},a)},count:function(e){var t=0;return P(e,function(){t++}),t},toArray:function(e){return P(e,function(e){return e})||[]},only:function(e){if(!j(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};t.Activity=h,t.Children=D,t.Component=y,t.Fragment=n,t.Profiler=i,t.PureComponent=w,t.StrictMode=s,t.Suspense=u,t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=E,t.__COMPILER_RUNTIME={__proto__:null,c:function(e){return E.H.useMemoCache(e)}},t.cache=function(e){return function(){return e.apply(null,arguments)}},t.cacheSignal=function(){return null},t.cloneElement=function(e,t,a){if(null===e||void 0===e)throw Error("The argument must be a React element, but you passed "+e+".");var r=g({},e.props),n=e.key;if(null!=t)for(s in void 0!==t.key&&(n=""+t.key),t)!T.call(t,s)||"key"===s||"__self"===s||"__source"===s||"ref"===s&&void 0===t.ref||(r[s]=t[s]);var s=arguments.length-2;if(1===s)r.children=a;else if(1<s){for(var i=Array(s),o=0;o<s;o++)i[o]=arguments[o+2];r.children=i}return N(e.type,n,r)},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider=e,e.Consumer={$$typeof:o,_context:e},e},t.createElement=function(e,t,a){var r,n={},s=null;if(null!=t)for(r in void 0!==t.key&&(s=""+t.key),t)T.call(t,r)&&"key"!==r&&"__self"!==r&&"__source"!==r&&(n[r]=t[r]);var i=arguments.length-2;if(1===i)n.children=a;else if(1<i){for(var o=Array(i),l=0;l<i;l++)o[l]=arguments[l+2];n.children=o}if(e&&e.defaultProps)for(r in i=e.defaultProps)void 0===n[r]&&(n[r]=i[r]);return N(e,s,n)},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=j,t.lazy=function(e){return{$$typeof:f,_payload:{_status:-1,_result:e},_init:R}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=E.T,a={};E.T=a;try{var r=e(),n=E.S;null!==n&&n(a,r),"object"===typeof r&&null!==r&&"function"===typeof r.then&&r.then(S,O)}catch(s){O(s)}finally{null!==t&&null!==a.types&&(t.types=a.types),E.T=t}},t.unstable_useCacheRefresh=function(){return E.H.useCacheRefresh()},t.use=function(e){return E.H.use(e)},t.useActionState=function(e,t,a){return E.H.useActionState(e,t,a)},t.useCallback=function(e,t){return E.H.useCallback(e,t)},t.useContext=function(e){return E.H.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e,t){return E.H.useDeferredValue(e,t)},t.useEffect=function(e,t){return E.H.useEffect(e,t)},t.useEffectEvent=function(e){return E.H.useEffectEvent(e)},t.useId=function(){return E.H.useId()},t.useImperativeHandle=function(e,t,a){return E.H.useImperativeHandle(e,t,a)},t.useInsertionEffect=function(e,t){return E.H.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return E.H.useLayoutEffect(e,t)},t.useMemo=function(e,t){return E.H.useMemo(e,t)},t.useOptimistic=function(e,t){return E.H.useOptimistic(e,t)},t.useReducer=function(e,t,a){return E.H.useReducer(e,t,a)},t.useRef=function(e){return E.H.useRef(e)},t.useState=function(e){return E.H.useState(e)},t.useSyncExternalStore=function(e,t,a){return E.H.useSyncExternalStore(e,t,a)},t.useTransition=function(){return E.H.useTransition()},t.version="19.2.0"},391:(e,t,a)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=a(4)},579:(e,t,a)=>{e.exports=a(799)},672:(e,t,a)=>{var r=a(43);function n(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var a=2;a<arguments.length;a++)t+="&args[]="+encodeURIComponent(arguments[a])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(){}var i={d:{f:s,r:function(){throw Error(n(522))},D:s,C:s,L:s,m:s,X:s,S:s,M:s},p:0,findDOMNode:null},o=Symbol.for("react.portal");var l=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(e,t){return"font"===e?"":"string"===typeof t?"use-credentials"===t?t:"":void 0}t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,t.createPortal=function(e,t){var a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)throw Error(n(299));return function(e,t,a){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:o,key:null==r?null:""+r,children:e,containerInfo:t,implementation:a}}(e,t,null,a)},t.flushSync=function(e){var t=l.T,a=i.p;try{if(l.T=null,i.p=2,e)return e()}finally{l.T=t,i.p=a,i.d.f()}},t.preconnect=function(e,t){"string"===typeof e&&(t?t="string"===typeof(t=t.crossOrigin)?"use-credentials"===t?t:"":void 0:t=null,i.d.C(e,t))},t.prefetchDNS=function(e){"string"===typeof e&&i.d.D(e)},t.preinit=function(e,t){if("string"===typeof e&&t&&"string"===typeof t.as){var a=t.as,r=c(a,t.crossOrigin),n="string"===typeof t.integrity?t.integrity:void 0,s="string"===typeof t.fetchPriority?t.fetchPriority:void 0;"style"===a?i.d.S(e,"string"===typeof t.precedence?t.precedence:void 0,{crossOrigin:r,integrity:n,fetchPriority:s}):"script"===a&&i.d.X(e,{crossOrigin:r,integrity:n,fetchPriority:s,nonce:"string"===typeof t.nonce?t.nonce:void 0})}},t.preinitModule=function(e,t){if("string"===typeof e)if("object"===typeof t&&null!==t){if(null==t.as||"script"===t.as){var a=c(t.as,t.crossOrigin);i.d.M(e,{crossOrigin:a,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0})}}else null==t&&i.d.M(e)},t.preload=function(e,t){if("string"===typeof e&&"object"===typeof t&&null!==t&&"string"===typeof t.as){var a=t.as,r=c(a,t.crossOrigin);i.d.L(e,a,{crossOrigin:r,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0,type:"string"===typeof t.type?t.type:void 0,fetchPriority:"string"===typeof t.fetchPriority?t.fetchPriority:void 0,referrerPolicy:"string"===typeof t.referrerPolicy?t.referrerPolicy:void 0,imageSrcSet:"string"===typeof t.imageSrcSet?t.imageSrcSet:void 0,imageSizes:"string"===typeof t.imageSizes?t.imageSizes:void 0,media:"string"===typeof t.media?t.media:void 0})}},t.preloadModule=function(e,t){if("string"===typeof e)if(t){var a=c(t.as,t.crossOrigin);i.d.m(e,{as:"string"===typeof t.as&&"script"!==t.as?t.as:void 0,crossOrigin:a,integrity:"string"===typeof t.integrity?t.integrity:void 0})}else i.d.m(e)},t.requestFormReset=function(e){i.d.r(e)},t.unstable_batchedUpdates=function(e,t){return e(t)},t.useFormState=function(e,t,a){return l.H.useFormState(e,t,a)},t.useFormStatus=function(){return l.H.useHostTransitionStatus()},t.version="19.2.0"},799:(e,t)=>{var a=Symbol.for("react.transitional.element"),r=Symbol.for("react.fragment");function n(e,t,r){var n=null;if(void 0!==r&&(n=""+r),void 0!==t.key&&(n=""+t.key),"key"in t)for(var s in r={},t)"key"!==s&&(r[s]=t[s]);else r=t;return t=r.ref,{$$typeof:a,type:e,key:n,ref:void 0!==t?t:null,props:r}}t.Fragment=r,t.jsx=n,t.jsxs=n},853:(e,t,a)=>{e.exports=a(896)},896:(e,t)=>{function a(e,t){var a=e.length;e.push(t);e:for(;0<a;){var r=a-1>>>1,n=e[r];if(!(0<s(n,t)))break e;e[r]=t,e[a]=n,a=r}}function r(e){return 0===e.length?null:e[0]}function n(e){if(0===e.length)return null;var t=e[0],a=e.pop();if(a!==t){e[0]=a;e:for(var r=0,n=e.length,i=n>>>1;r<i;){var o=2*(r+1)-1,l=e[o],c=o+1,u=e[c];if(0>s(l,a))c<n&&0>s(u,l)?(e[r]=u,e[c]=a,r=c):(e[r]=l,e[o]=a,r=o);else{if(!(c<n&&0>s(u,a)))break e;e[r]=u,e[c]=a,r=c}}}return t}function s(e,t){var a=e.sortIndex-t.sortIndex;return 0!==a?a:e.id-t.id}if(t.unstable_now=void 0,"object"===typeof performance&&"function"===typeof performance.now){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,f=null,h=3,m=!1,p=!1,g=!1,v=!1,y="function"===typeof setTimeout?setTimeout:null,b="function"===typeof clearTimeout?clearTimeout:null,w="undefined"!==typeof setImmediate?setImmediate:null;function x(e){for(var t=r(u);null!==t;){if(null===t.callback)n(u);else{if(!(t.startTime<=e))break;n(u),t.sortIndex=t.expirationTime,a(c,t)}t=r(u)}}function k(e){if(g=!1,x(e),!p)if(null!==r(c))p=!0,E||(E=!0,S());else{var t=r(u);null!==t&&R(k,t.startTime-e)}}var S,E=!1,T=-1,N=5,j=-1;function C(){return!!v||!(t.unstable_now()-j<N)}function _(){if(v=!1,E){var e=t.unstable_now();j=e;var a=!0;try{e:{p=!1,g&&(g=!1,b(T),T=-1),m=!0;var s=h;try{t:{for(x(e),f=r(c);null!==f&&!(f.expirationTime>e&&C());){var i=f.callback;if("function"===typeof i){f.callback=null,h=f.priorityLevel;var o=i(f.expirationTime<=e);if(e=t.unstable_now(),"function"===typeof o){f.callback=o,x(e),a=!0;break t}f===r(c)&&n(c),x(e)}else n(c);f=r(c)}if(null!==f)a=!0;else{var l=r(u);null!==l&&R(k,l.startTime-e),a=!1}}break e}finally{f=null,h=s,m=!1}a=void 0}}finally{a?S():E=!1}}}if("function"===typeof w)S=function(){w(_)};else if("undefined"!==typeof MessageChannel){var A=new MessageChannel,P=A.port2;A.port1.onmessage=_,S=function(){P.postMessage(null)}}else S=function(){y(_,0)};function R(e,a){T=y(function(){e(t.unstable_now())},a)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_next=function(e){switch(h){case 1:case 2:case 3:var t=3;break;default:t=h}var a=h;h=t;try{return e()}finally{h=a}},t.unstable_requestPaint=function(){v=!0},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var a=h;h=e;try{return t()}finally{h=a}},t.unstable_scheduleCallback=function(e,n,s){var i=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?i+s:i:s=i,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:d++,callback:n,priorityLevel:e,startTime:s,expirationTime:o=s+o,sortIndex:-1},s>i?(e.sortIndex=s,a(u,e),null===r(c)&&e===r(u)&&(g?(b(T),T=-1):g=!0,R(k,s-i))):(e.sortIndex=o,a(c,e),p||m||(p=!0,E||(E=!0,S()))),e},t.unstable_shouldYield=C,t.unstable_wrapCallback=function(e){var t=h;return function(){var a=h;h=t;try{return e.apply(this,arguments)}finally{h=a}}}},950:(e,t,a)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=a(672)}},t={};function a(r){var n=t[r];if(void 0!==n)return n.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,a),s.exports}var r=a(43),n=a(391);function s(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;a[r]=e[r]}return a}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)a=s[r],-1===t.indexOf(a)&&{}.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function o(e){var t=function(e,t){if("object"!=i(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var r=a.call(e,t||"default");if("object"!=i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==i(t)?t:t+""}function l(e,t,a){return(t=o(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function c(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,r)}return a}function u(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?c(Object(a),!0).forEach(function(t){l(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}const d=["sri"],f=["page"],h=["page","matches"],m=["onClick","discover","prefetch","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],p=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],g=["discover","fetcherKey","navigate","reloadDocument","replace","state","method","action","onSubmit","relative","preventScrollReset","viewTransition"];var v="popstate";function y(){return T(function(e,t){let{pathname:a,search:r,hash:n}=e.location;return k("",{pathname:a,search:r,hash:n},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"===typeof t?t:S(t)},null,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}function b(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function w(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(a){}}}function x(e,t){return{usr:e.state,key:e.key,idx:t}}function k(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return u(u({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?E(t):t),{},{state:a,key:t&&t.key||r||Math.random().toString(36).substring(2,10)})}function S(e){let{pathname:t="/",search:a="",hash:r=""}=e;return a&&"?"!==a&&(t+="?"===a.charAt(0)?a:"?"+a),r&&"#"!==r&&(t+="#"===r.charAt(0)?r:"#"+r),t}function E(e){let t={};if(e){let a=e.indexOf("#");a>=0&&(t.hash=e.substring(a),e=e.substring(0,a));let r=e.indexOf("?");r>=0&&(t.search=e.substring(r),e=e.substring(0,r)),e&&(t.pathname=e)}return t}function T(e,t,a){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},{window:n=document.defaultView,v5Compat:s=!1}=r,i=n.history,o="POP",l=null,c=d();function d(){return(i.state||{idx:null}).idx}function f(){o="POP";let e=d(),t=null==e?null:e-c;c=e,l&&l({action:o,location:m.location,delta:t})}function h(e){return N(e)}null==c&&(c=0,i.replaceState(u(u({},i.state),{},{idx:c}),""));let m={get action(){return o},get location(){return e(n,i)},listen(e){if(l)throw new Error("A history only accepts one active listener");return n.addEventListener(v,f),l=e,()=>{n.removeEventListener(v,f),l=null}},createHref:e=>t(n,e),createURL:h,encodeLocation(e){let t=h(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){o="PUSH";let r=k(m.location,e,t);a&&a(r,e),c=d()+1;let u=x(r,c),f=m.createHref(r);try{i.pushState(u,"",f)}catch(h){if(h instanceof DOMException&&"DataCloneError"===h.name)throw h;n.location.assign(f)}s&&l&&l({action:o,location:m.location,delta:1})},replace:function(e,t){o="REPLACE";let r=k(m.location,e,t);a&&a(r,e),c=d();let n=x(r,c),u=m.createHref(r);i.replaceState(n,"",u),s&&l&&l({action:o,location:m.location,delta:0})},go:e=>i.go(e)};return m}function N(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a="http://localhost";"undefined"!==typeof window&&(a="null"!==window.location.origin?window.location.origin:window.location.href),b(a,"No window.location.(origin|href) available to create URL");let r="string"===typeof e?e:S(e);return r=r.replace(/ $/,"%20"),!t&&r.startsWith("//")&&(r=a+r),new URL(r,a)}new WeakMap;function j(e,t){return C(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/",!1)}function C(e,t,a,r){let n=H(("string"===typeof t?E(t):t).pathname||"/",a);if(null==n)return null;let s=_(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let a=e.length===t.length&&e.slice(0,-1).every((e,a)=>e===t[a]);return a?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(s);let i=null;for(let o=0;null==i&&o<s.length;++o){let e=W(n);i=z(s[o],e,r)}return i}function _(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",n=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=function(e,s){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n,o=arguments.length>3?arguments[3]:void 0,l={relativePath:void 0===o?e.path||"":o,caseSensitive:!0===e.caseSensitive,childrenIndex:s,route:e};if(l.relativePath.startsWith("/")){if(!l.relativePath.startsWith(r)&&i)return;b(l.relativePath.startsWith(r),'Absolute route path "'.concat(l.relativePath,'" nested under path "').concat(r,'" is not valid. An absolute child route path must start with the combined path of all its parent routes.')),l.relativePath=l.relativePath.slice(r.length)}let c=X([r,l.relativePath]),u=a.concat(l);e.children&&e.children.length>0&&(b(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'.concat(c,'".')),_(e.children,t,u,c,i)),(null!=e.path||e.index)&&t.push({path:c,score:M(c,e.index),routesMeta:u})};return e.forEach((e,t)=>{var a;if(""!==e.path&&null!==(a=e.path)&&void 0!==a&&a.includes("?"))for(let r of A(e.path))s(e,t,!0,r);else s(e,t)}),t}function A(e){let t=e.split("/");if(0===t.length)return[];let[a,...r]=t,n=a.endsWith("?"),s=a.replace(/\?$/,"");if(0===r.length)return n?[s,""]:[s];let i=A(r.join("/")),o=[];return o.push(...i.map(e=>""===e?s:[s,e].join("/"))),n&&o.push(...i),o.map(t=>e.startsWith("/")&&""===t?"/":t)}var P=/^:[\w-]+$/,R=3,O=2,D=1,F=10,I=-2,L=e=>"*"===e;function M(e,t){let a=e.split("/"),r=a.length;return a.some(L)&&(r+=I),t&&(r+=O),a.filter(e=>!L(e)).reduce((e,t)=>e+(P.test(t)?R:""===t?D:F),r)}function z(e,t){let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{routesMeta:r}=e,n={},s="/",i=[];for(let o=0;o<r.length;++o){let e=r[o],l=o===r.length-1,c="/"===s?t:t.slice(s.length)||"/",u=U({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),d=e.route;if(!u&&l&&a&&!r[r.length-1].route.index&&(u=U({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!u)return null;Object.assign(n,u.params),i.push({params:n,pathname:X([s,u.pathname]),pathnameBase:K(X([s,u.pathnameBase])),route:d}),"/"!==u.pathnameBase&&(s=X([s,u.pathnameBase]))}return i}function U(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[a,r]=B(e.path,e.caseSensitive,e.end),n=t.match(a);if(!n)return null;let s=n[0],i=s.replace(/(.)\/+$/,"$1"),o=n.slice(1);return{params:r.reduce((e,t,a)=>{let{paramName:r,isOptional:n}=t;if("*"===r){let e=o[a]||"";i=s.slice(0,s.length-e.length).replace(/(.)\/+$/,"$1")}const l=o[a];return e[r]=n&&!l?void 0:(l||"").replace(/%2F/g,"/"),e},{}),pathname:s,pathnameBase:i,pattern:e}}function B(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];w("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'.concat(e,'" will be treated as if it were "').concat(e.replace(/\*$/,"/*"),'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "').concat(e.replace(/\*$/,"/*"),'".'));let r=[],n="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,a)=>(r.push({paramName:t,isOptional:null!=a}),a?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(r.push({paramName:"*"}),n+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):a?n+="\\/*$":""!==e&&"/"!==e&&(n+="(?:(?=\\/|$))"),[new RegExp(n,t?void 0:"i"),r]}function W(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return w(!1,'The URL path "'.concat(e,'" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (').concat(t,").")),e}}function H(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let a=t.endsWith("/")?t.length-1:t.length,r=e.charAt(a);return r&&"/"!==r?null:e.slice(a)||"/"}function V(e,t,a,r){return"Cannot include a '".concat(e,"' character in a manually specified `to.").concat(t,"` field [").concat(JSON.stringify(r),"].  Please separate it out to the `to.").concat(a,'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.')}function G(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}function q(e){let t=G(e);return t.map((e,a)=>a===t.length-1?e.pathname:e.pathnameBase)}function Y(e,t,a){let r,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];"string"===typeof e?r=E(e):(r=u({},e),b(!r.pathname||!r.pathname.includes("?"),V("?","pathname","search",r)),b(!r.pathname||!r.pathname.includes("#"),V("#","pathname","hash",r)),b(!r.search||!r.search.includes("#"),V("#","search","hash",r)));let s,i=""===e||""===r.pathname,o=i?"/":r.pathname;if(null==o)s=a;else{let e=t.length-1;if(!n&&o.startsWith("..")){let t=o.split("/");for(;".."===t[0];)t.shift(),e-=1;r.pathname=t.join("/")}s=e>=0?t[e]:"/"}let l=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",{pathname:a,search:r="",hash:n=""}="string"===typeof e?E(e):e,s=a?a.startsWith("/")?a:function(e,t){let a=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?a.length>1&&a.pop():"."!==e&&a.push(e)}),a.length>1?a.join("/"):"/"}(a,t):t;return{pathname:s,search:J(r),hash:Q(n)}}(r,s),c=o&&"/"!==o&&o.endsWith("/"),d=(i||"."===o)&&a.endsWith("/");return l.pathname.endsWith("/")||!c&&!d||(l.pathname+="/"),l}var X=e=>e.join("/").replace(/\/\/+/g,"/"),K=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),J=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",Q=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";function Z(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}var ee=["POST","PUT","PATCH","DELETE"],te=(new Set(ee),["GET",...ee]);new Set(te),Symbol("ResetLoaderData");var ae=r.createContext(null);ae.displayName="DataRouter";var re=r.createContext(null);re.displayName="DataRouterState";var ne=r.createContext(!1);var se=r.createContext({isTransitioning:!1});se.displayName="ViewTransition";var ie=r.createContext(new Map);ie.displayName="Fetchers";var oe=r.createContext(null);oe.displayName="Await";var le=r.createContext(null);le.displayName="Navigation";var ce=r.createContext(null);ce.displayName="Location";var ue=r.createContext({outlet:null,matches:[],isDataRoute:!1});ue.displayName="Route";var de=r.createContext(null);de.displayName="RouteError";function fe(){return null!=r.useContext(ce)}function he(){return b(fe(),"useLocation() may be used only in the context of a <Router> component."),r.useContext(ce).location}var me="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function pe(e){r.useContext(le).static||r.useLayoutEffect(e)}function ge(){let{isDataRoute:e}=r.useContext(ue);return e?function(){let{router:e}=Ne("useNavigate"),t=Ce("useNavigate"),a=r.useRef(!1);pe(()=>{a.current=!0});let n=r.useCallback(async function(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};w(a.current,me),a.current&&("number"===typeof r?e.navigate(r):await e.navigate(r,u({fromRouteId:t},n)))},[e,t]);return n}():function(){b(fe(),"useNavigate() may be used only in the context of a <Router> component.");let e=r.useContext(ae),{basename:t,navigator:a}=r.useContext(le),{matches:n}=r.useContext(ue),{pathname:s}=he(),i=JSON.stringify(q(n)),o=r.useRef(!1);pe(()=>{o.current=!0});let l=r.useCallback(function(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(w(o.current,me),!o.current)return;if("number"===typeof r)return void a.go(r);let l=Y(r,JSON.parse(i),s,"path"===n.relative);null==e&&"/"!==t&&(l.pathname="/"===l.pathname?t:X([t,l.pathname])),(n.replace?a.replace:a.push)(l,n.state,n)},[t,a,i,s,e]);return l}()}r.createContext(null);function ve(){let{matches:e}=r.useContext(ue),t=e[e.length-1];return t?t.params:{}}function ye(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{matches:a}=r.useContext(ue),{pathname:n}=he(),s=JSON.stringify(q(a));return r.useMemo(()=>Y(e,JSON.parse(s),n,"path"===t),[e,s,n,t])}function be(e,t,a,n,s){b(fe(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=r.useContext(le),{matches:o}=r.useContext(ue),l=o[o.length-1],c=l?l.params:{},d=l?l.pathname:"/",f=l?l.pathnameBase:"/",h=l&&l.route;{let e=h&&h.path||"";Pe(d,!h||e.endsWith("*")||e.endsWith("*?"),'You rendered descendant <Routes> (or called `useRoutes()`) at "'.concat(d,'" (under <Route path="').concat(e,'">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won\'t match anymore and therefore the child routes will never render.\n\nPlease change the parent <Route path="').concat(e,'"> to <Route path="').concat("/"===e?"*":"".concat(e,"/*"),'">.'))}let m,p=he();if(t){var g;let e="string"===typeof t?E(t):t;b("/"===f||(null===(g=e.pathname)||void 0===g?void 0:g.startsWith(f)),'When overriding the location using `<Routes location>` or `useRoutes(routes, location)`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "'.concat(f,'" but pathname "').concat(e.pathname,'" was given in the `location` prop.')),m=e}else m=p;let v=m.pathname||"/",y=v;if("/"!==f){let e=f.replace(/^\//,"").split("/");y="/"+v.replace(/^\//,"").split("/").slice(e.length).join("/")}let x=j(e,{pathname:y});w(h||null!=x,'No routes matched location "'.concat(m.pathname).concat(m.search).concat(m.hash,'" ')),w(null==x||void 0!==x[x.length-1].route.element||void 0!==x[x.length-1].route.Component||void 0!==x[x.length-1].route.lazy,'Matched leaf route at location "'.concat(m.pathname).concat(m.search).concat(m.hash,'" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.'));let k=Ee(x&&x.map(e=>Object.assign({},e,{params:Object.assign({},c,e.params),pathname:X([f,i.encodeLocation?i.encodeLocation(e.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?f:X([f,i.encodeLocation?i.encodeLocation(e.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:e.pathnameBase])})),o,a,n,s);return t&&k?r.createElement(ce.Provider,{value:{location:u({pathname:"/",search:"",hash:"",state:null,key:"default"},m),navigationType:"POP"}},k):k}function we(){let e=_e(),t=Z(e)?"".concat(e.status," ").concat(e.statusText):e instanceof Error?e.message:JSON.stringify(e),a=e instanceof Error?e.stack:null,n="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:n},i={padding:"2px 4px",backgroundColor:n},o=null;return console.error("Error handled by React Router default ErrorBoundary:",e),o=r.createElement(r.Fragment,null,r.createElement("p",null,"\ud83d\udcbf Hey developer \ud83d\udc4b"),r.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",r.createElement("code",{style:i},"ErrorBoundary")," or"," ",r.createElement("code",{style:i},"errorElement")," prop on your route.")),r.createElement(r.Fragment,null,r.createElement("h2",null,"Unexpected Application Error!"),r.createElement("h3",{style:{fontStyle:"italic"}},t),a?r.createElement("pre",{style:s},a):null,o)}var xe=r.createElement(we,null),ke=class extends r.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.unstable_onError?this.props.unstable_onError(e,t):console.error("React Router caught the following error during render",e)}render(){return void 0!==this.state.error?r.createElement(ue.Provider,{value:this.props.routeContext},r.createElement(de.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function Se(e){let{routeContext:t,match:a,children:n}=e,s=r.useContext(ae);return s&&s.static&&s.staticContext&&(a.route.errorElement||a.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=a.route.id),r.createElement(ue.Provider,{value:t},n)}function Ee(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(null==e){if(!a)return null;if(a.errors)e=a.matches;else{if(0!==t.length||a.initialized||!(a.matches.length>0))return null;e=a.matches}}let s=e,i=null===a||void 0===a?void 0:a.errors;if(null!=i){let e=s.findIndex(e=>e.route.id&&void 0!==(null===i||void 0===i?void 0:i[e.route.id]));b(e>=0,"Could not find a matching route for errors on route IDs: ".concat(Object.keys(i).join(","))),s=s.slice(0,Math.min(s.length,e+1))}let o=!1,l=-1;if(a)for(let r=0;r<s.length;r++){let e=s[r];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(l=r),e.route.id){let{loaderData:t,errors:r}=a,n=e.route.loader&&!t.hasOwnProperty(e.route.id)&&(!r||void 0===r[e.route.id]);if(e.route.lazy||n){o=!0,s=l>=0?s.slice(0,l+1):[s[0]];break}}}return s.reduceRight((e,c,u)=>{let d,f=!1,h=null,m=null;a&&(d=i&&c.route.id?i[c.route.id]:void 0,h=c.route.errorElement||xe,o&&(l<0&&0===u?(Pe("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),f=!0,m=null):l===u&&(f=!0,m=c.route.hydrateFallbackElement||null)));let p=t.concat(s.slice(0,u+1)),g=()=>{let t;return t=d?h:f?m:c.route.Component?r.createElement(c.route.Component,null):c.route.element?c.route.element:e,r.createElement(Se,{match:c,routeContext:{outlet:e,matches:p,isDataRoute:null!=a},children:t})};return a&&(c.route.ErrorBoundary||c.route.errorElement||0===u)?r.createElement(ke,{location:a.location,revalidation:a.revalidation,component:h,error:d,children:g(),routeContext:{outlet:null,matches:p,isDataRoute:!0},unstable_onError:n}):g()},null)}function Te(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function Ne(e){let t=r.useContext(ae);return b(t,Te(e)),t}function je(e){let t=r.useContext(re);return b(t,Te(e)),t}function Ce(e){let t=function(e){let t=r.useContext(ue);return b(t,Te(e)),t}(e),a=t.matches[t.matches.length-1];return b(a.route.id,"".concat(e,' can only be used on routes that contain a unique "id"')),a.route.id}function _e(){var e;let t=r.useContext(de),a=je("useRouteError"),n=Ce("useRouteError");return void 0!==t?t:null===(e=a.errors)||void 0===e?void 0:e[n]}var Ae={};function Pe(e,t,a){t||Ae[e]||(Ae[e]=!0,w(!1,a))}var Re={};function Oe(e,t){e||Re[t]||(Re[t]=!0,console.warn(t))}r.memo(function(e){let{routes:t,future:a,state:r,unstable_onError:n}=e;return be(t,void 0,r,n,a)});function De(e){let{to:t,replace:a,state:n,relative:s}=e;b(fe(),"<Navigate> may be used only in the context of a <Router> component.");let{static:i}=r.useContext(le);w(!i,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=r.useContext(ue),{pathname:l}=he(),c=ge(),u=Y(t,q(o),l,"path"===s),d=JSON.stringify(u);return r.useEffect(()=>{c(JSON.parse(d),{replace:a,state:n,relative:s})},[c,d,s,a,n]),null}function Fe(e){b(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Ie(e){let{basename:t="/",children:a=null,location:n,navigationType:s="POP",navigator:i,static:o=!1}=e;b(!fe(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=t.replace(/^\/*/,"/"),c=r.useMemo(()=>({basename:l,navigator:i,static:o,future:{}}),[l,i,o]);"string"===typeof n&&(n=E(n));let{pathname:u="/",search:d="",hash:f="",state:h=null,key:m="default"}=n,p=r.useMemo(()=>{let e=H(u,l);return null==e?null:{location:{pathname:e,search:d,hash:f,state:h,key:m},navigationType:s}},[l,u,d,f,h,m,s]);return w(null!=p,'<Router basename="'.concat(l,'"> is not able to match the URL "').concat(u).concat(d).concat(f,"\" because it does not start with the basename, so the <Router> won't render anything.")),null==p?null:r.createElement(le.Provider,{value:c},r.createElement(ce.Provider,{children:a,value:p}))}function Le(e){let{children:t,location:a}=e;return be(Me(t),a)}r.Component;function Me(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=[];return r.Children.forEach(e,(e,n)=>{if(!r.isValidElement(e))return;let s=[...t,n];if(e.type===r.Fragment)return void a.push.apply(a,Me(e.props.children,s));b(e.type===Fe,"[".concat("string"===typeof e.type?e.type:e.type.name,"] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>")),b(!e.props.index||!e.props.children,"An index route cannot have child routes.");let i={id:e.props.id||s.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,middleware:e.props.middleware,loader:e.props.loader,action:e.props.action,hydrateFallbackElement:e.props.hydrateFallbackElement,HydrateFallback:e.props.HydrateFallback,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:!0===e.props.hasErrorBoundary||null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(i.children=Me(e.props.children,s)),a.push(i)}),a}var ze="get",Ue="application/x-www-form-urlencoded";function Be(e){return null!=e&&"string"===typeof e.tagName}function We(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return new URLSearchParams("string"===typeof e||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,a)=>{let r=e[a];return t.concat(Array.isArray(r)?r.map(e=>[a,e]):[[a,r]])},[]))}var He=null;var Ve=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Ge(e){return null==e||Ve.has(e)?e:(w(!1,'"'.concat(e,'" is not a valid `encType` for `<Form>`/`<fetcher.Form>` and will default to "').concat(Ue,'"')),null)}function $e(e,t){let a,r,n,s,i;if(Be(o=e)&&"form"===o.tagName.toLowerCase()){let i=e.getAttribute("action");r=i?H(i,t):null,a=e.getAttribute("method")||ze,n=Ge(e.getAttribute("enctype"))||Ue,s=new FormData(e)}else if(function(e){return Be(e)&&"button"===e.tagName.toLowerCase()}(e)||function(e){return Be(e)&&"input"===e.tagName.toLowerCase()}(e)&&("submit"===e.type||"image"===e.type)){let i=e.form;if(null==i)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let o=e.getAttribute("formaction")||i.getAttribute("action");if(r=o?H(o,t):null,a=e.getAttribute("formmethod")||i.getAttribute("method")||ze,n=Ge(e.getAttribute("formenctype"))||Ge(i.getAttribute("enctype"))||Ue,s=new FormData(i,e),!function(){if(null===He)try{new FormData(document.createElement("form"),0),He=!1}catch(e){He=!0}return He}()){let{name:t,type:a,value:r}=e;if("image"===a){let e=t?"".concat(t,"."):"";s.append("".concat(e,"x"),"0"),s.append("".concat(e,"y"),"0")}else t&&s.append(t,r)}}else{if(Be(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');a=ze,r=null,n=Ue,i=e}var o;return s&&"text/plain"===n&&(i=s,s=void 0),{action:r,method:a.toLowerCase(),encType:n,formData:s,body:i}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");"undefined"!==typeof window?window:"undefined"!==typeof globalThis&&globalThis;function qe(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}Symbol("SingleFetchRedirect");function Ye(e,t,a){let r="string"===typeof e?new URL(e,"undefined"===typeof window?"server://singlefetch/":window.location.origin):e;return"/"===r.pathname?r.pathname="_root.".concat(a):t&&"/"===H(r.pathname,t)?r.pathname="".concat(t.replace(/\/$/,""),"/_root.").concat(a):r.pathname="".concat(r.pathname.replace(/\/$/,""),".").concat(a),r}async function Xe(e,t){if(e.id in t)return t[e.id];try{let a=await import(e.module);return t[e.id]=a,a}catch(a){return console.error("Error loading route module `".concat(e.module,"`, reloading page...")),console.error(a),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Ke(e){return null!=e&&"string"===typeof e.page}function Je(e){return null!=e&&(null==e.href?"preload"===e.rel&&"string"===typeof e.imageSrcSet&&"string"===typeof e.imageSizes:"string"===typeof e.rel&&"string"===typeof e.href)}function Qe(e,t,a,r,n,s){let i=(e,t)=>!a[t]||e.route.id!==a[t].route.id,o=(e,t)=>{var r;return a[t].pathname!==e.pathname||(null===(r=a[t].route.path)||void 0===r?void 0:r.endsWith("*"))&&a[t].params["*"]!==e.params["*"]};return"assets"===s?t.filter((e,t)=>i(e,t)||o(e,t)):"data"===s?t.filter((t,s)=>{let l=r.routes[t.route.id];if(!l||!l.hasLoader)return!1;if(i(t,s)||o(t,s))return!0;if(t.route.shouldRevalidate){var c;let r=t.route.shouldRevalidate({currentUrl:new URL(n.pathname+n.search+n.hash,window.origin),currentParams:(null===(c=a[0])||void 0===c?void 0:c.params)||{},nextUrl:new URL(e,window.origin),nextParams:t.params,defaultShouldRevalidate:!0});if("boolean"===typeof r)return r}return!0}):[]}function Ze(e,t){let{includeHydrateFallback:a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r=e.map(e=>{let r=t.routes[e.route.id];if(!r)return[];let n=[r.module];return r.clientActionModule&&(n=n.concat(r.clientActionModule)),r.clientLoaderModule&&(n=n.concat(r.clientLoaderModule)),a&&r.hydrateFallbackModule&&(n=n.concat(r.hydrateFallbackModule)),r.imports&&(n=n.concat(r.imports)),n}).flat(1),[...new Set(r)];var r}function et(e,t){let a=new Set,r=new Set(t);return e.reduce((e,n)=>{if(t&&!Ke(n)&&"script"===n.as&&n.href&&r.has(n.href))return e;let s=JSON.stringify(function(e){let t={},a=Object.keys(e).sort();for(let r of a)t[r]=e[r];return t}(n));return a.has(s)||(a.add(s),e.push({key:s,link:n})),e},[])}function tt(e,t){return"lazy"===e.mode&&!0===t}function at(){let e=r.useContext(ae);return qe(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function rt(){let e=r.useContext(re);return qe(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var nt=r.createContext(void 0);function st(){let e=r.useContext(nt);return qe(e,"You must render this element inside a <HydratedRouter> element"),e}function it(e,t){return a=>{e&&e(a),a.defaultPrevented||t(a)}}function ot(e,t,a){if(a&&!dt)return[e[0]];if(t){let a=e.findIndex(e=>void 0!==t[e.route.id]);return e.slice(0,a+1)}return e}nt.displayName="FrameworkContext";function lt(e){let{page:t}=e,a=s(e,f),{router:n}=at(),i=r.useMemo(()=>j(n.routes,t,n.basename),[n.routes,t,n.basename]);return i?r.createElement(ut,u({page:t,matches:i},a)):null}function ct(e){let{manifest:t,routeModules:a}=st(),[n,s]=r.useState([]);return r.useEffect(()=>{let r=!1;return async function(e,t,a){return et((await Promise.all(e.map(async e=>{let r=t.routes[e.route.id];if(r){let e=await Xe(r,a);return e.links?e.links():[]}return[]}))).flat(1).filter(Je).filter(e=>"stylesheet"===e.rel||"preload"===e.rel).map(e=>"stylesheet"===e.rel?u(u({},e),{},{rel:"prefetch",as:"style"}):u(u({},e),{},{rel:"prefetch"})))}(e,t,a).then(e=>{r||s(e)}),()=>{r=!0}},[e,t,a]),n}function ut(e){let{page:t,matches:a}=e,n=s(e,h),i=he(),{manifest:o,routeModules:l}=st(),{basename:c}=at(),{loaderData:d,matches:f}=rt(),m=r.useMemo(()=>Qe(t,a,f,o,i,"data"),[t,a,f,o,i]),p=r.useMemo(()=>Qe(t,a,f,o,i,"assets"),[t,a,f,o,i]),g=r.useMemo(()=>{if(t===i.pathname+i.search+i.hash)return[];let e=new Set,r=!1;if(a.forEach(t=>{var a;let n=o.routes[t.route.id];n&&n.hasLoader&&(!m.some(e=>e.route.id===t.route.id)&&t.route.id in d&&null!==(a=l[t.route.id])&&void 0!==a&&a.shouldRevalidate||n.hasClientLoader?r=!0:e.add(t.route.id))}),0===e.size)return[];let n=Ye(t,c,"data");return r&&e.size>0&&n.searchParams.set("_routes",a.filter(t=>e.has(t.route.id)).map(e=>e.route.id).join(",")),[n.pathname+n.search]},[c,d,i,o,m,a,t,l]),v=r.useMemo(()=>Ze(p,o),[p,o]),y=ct(p);return r.createElement(r.Fragment,null,g.map(e=>r.createElement("link",u({key:e,rel:"prefetch",as:"fetch",href:e},n))),v.map(e=>r.createElement("link",u({key:e,rel:"modulepreload",href:e},n))),y.map(e=>{let{key:t,link:a}=e;return r.createElement("link",u({key:t,nonce:n.nonce},a))}))}var dt=!1;function ft(e){let{manifest:t,serverHandoffString:a,isSpaMode:n,renderMeta:i,routeDiscovery:o,ssr:l}=st(),{router:c,static:f,staticContext:h}=at(),{matches:m}=rt(),p=r.useContext(ne),g=tt(o,l);i&&(i.didRenderScripts=!0);let v=ot(m,null,n);r.useEffect(()=>{dt=!0},[]);let y=r.useMemo(()=>{var n;if(p)return null;let i=h?"window.__reactRouterContext = ".concat(a,";").concat("window.__reactRouterContext.stream = new ReadableStream({start(controller){window.__reactRouterContext.streamController = controller;}}).pipeThrough(new TextEncoderStream());"):" ",o=f?"".concat(null!==(n=t.hmr)&&void 0!==n&&n.runtime?"import ".concat(JSON.stringify(t.hmr.runtime),";"):"").concat(g?"":"import ".concat(JSON.stringify(t.url)),";\n").concat(v.map((e,a)=>{let r="route".concat(a),n=t.routes[e.route.id];qe(n,"Route ".concat(e.route.id," not found in manifest"));let{clientActionModule:s,clientLoaderModule:i,clientMiddlewareModule:o,hydrateFallbackModule:l,module:c}=n,u=[...s?[{module:s,varName:"".concat(r,"_clientAction")}]:[],...i?[{module:i,varName:"".concat(r,"_clientLoader")}]:[],...o?[{module:o,varName:"".concat(r,"_clientMiddleware")}]:[],...l?[{module:l,varName:"".concat(r,"_HydrateFallback")}]:[],{module:c,varName:"".concat(r,"_main")}];return 1===u.length?"import * as ".concat(r," from ").concat(JSON.stringify(c),";"):[u.map(e=>"import * as ".concat(e.varName,' from "').concat(e.module,'";')).join("\n"),"const ".concat(r," = {").concat(u.map(e=>"...".concat(e.varName)).join(","),"};")].join("\n")}).join("\n"),"\n  ").concat(g?"window.__reactRouterManifest = ".concat(JSON.stringify(function(e,t){let{sri:a}=e,r=s(e,d),n=new Set(t.state.matches.map(e=>e.route.id)),i=t.state.location.pathname.split("/").filter(Boolean),o=["/"];for(i.pop();i.length>0;)o.push("/".concat(i.join("/"))),i.pop();o.forEach(e=>{let a=j(t.routes,e,t.basename);a&&a.forEach(e=>n.add(e.route.id))});let l=[...n].reduce((e,t)=>Object.assign(e,{[t]:r.routes[t]}),{});return u(u({},r),{},{routes:l,sri:!!a||void 0})}(t,c),null,2),";"):"","\n  window.__reactRouterRouteModules = {").concat(v.map((e,t)=>"".concat(JSON.stringify(e.route.id),":route").concat(t)).join(","),"};\n\nimport(").concat(JSON.stringify(t.entry.module),");"):" ";return r.createElement(r.Fragment,null,r.createElement("script",u(u({},e),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:i},type:void 0})),r.createElement("script",u(u({},e),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:o},type:"module",async:!0})))},[]),b=dt||p?[]:(w=t.entry.imports.concat(Ze(v,t,{includeHydrateFallback:!0})),[...new Set(w)]);var w;let x="object"===typeof t.sri?t.sri:{};return Oe(!p,"The <Scripts /> element is a no-op when using RSC and can be safely removed."),dt||p?null:r.createElement(r.Fragment,null,"object"===typeof t.sri?r.createElement("script",{"rr-importmap":"",type:"importmap",suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:JSON.stringify({integrity:x})}}):null,g?null:r.createElement("link",{rel:"modulepreload",href:t.url,crossOrigin:e.crossOrigin,integrity:x[t.url],suppressHydrationWarning:!0}),r.createElement("link",{rel:"modulepreload",href:t.entry.module,crossOrigin:e.crossOrigin,integrity:x[t.entry.module],suppressHydrationWarning:!0}),b.map(t=>r.createElement("link",{key:t,rel:"modulepreload",href:t,crossOrigin:e.crossOrigin,integrity:x[t],suppressHydrationWarning:!0})),y)}function ht(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return e=>{t.forEach(t=>{"function"===typeof t?t(e):null!=t&&(t.current=e)})}}r.Component;function mt(e){let{error:t,isOutsideRemixApp:a}=e;console.error(t);let n,s=r.createElement("script",{dangerouslySetInnerHTML:{__html:'\n        console.log(\n          "\ud83d\udcbf Hey developer \ud83d\udc4b. You can provide a way better UX than this when your app throws errors. Check out https://reactrouter.com/how-to/error-boundary for more information."\n        );\n      '}});if(Z(t))return r.createElement(pt,{title:"Unhandled Thrown Response!"},r.createElement("h1",{style:{fontSize:"24px"}},t.status," ",t.statusText),s);if(t instanceof Error)n=t;else{let e=null==t?"Unknown Error":"object"===typeof t&&"toString"in t?t.toString():JSON.stringify(t);n=new Error(e)}return r.createElement(pt,{title:"Application Error!",isOutsideRemixApp:a},r.createElement("h1",{style:{fontSize:"24px"}},"Application Error"),r.createElement("pre",{style:{padding:"2rem",background:"hsla(10, 50%, 50%, 0.1)",color:"red",overflow:"auto"}},n.stack),s)}function pt(e){var t;let{title:a,renderScripts:n,isOutsideRemixApp:s,children:i}=e,{routeModules:o}=st();return null!==(t=o.root)&&void 0!==t&&t.Layout&&!s?i:r.createElement("html",{lang:"en"},r.createElement("head",null,r.createElement("meta",{charSet:"utf-8"}),r.createElement("meta",{name:"viewport",content:"width=device-width,initial-scale=1,viewport-fit=cover"}),r.createElement("title",null,a)),r.createElement("body",null,r.createElement("main",{style:{fontFamily:"system-ui, sans-serif",padding:"2rem"}},i,n?r.createElement(ft,null):null)))}var gt="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement;try{gt&&(window.__reactRouterVersion="7.9.4")}catch(Ig){}function vt(e){let{basename:t,children:a,window:n}=e,s=r.useRef();null==s.current&&(s.current=y({window:n,v5Compat:!0}));let i=s.current,[o,l]=r.useState({action:i.action,location:i.location}),c=r.useCallback(e=>{r.startTransition(()=>l(e))},[l]);return r.useLayoutEffect(()=>i.listen(c),[i,c]),r.createElement(Ie,{basename:t,children:a,location:o.location,navigationType:o.action,navigator:i})}var yt=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,bt=r.forwardRef(function(e,t){let a,{onClick:n,discover:i="render",prefetch:o="none",relative:l,reloadDocument:c,replace:d,state:f,target:h,to:p,preventScrollReset:g,viewTransition:v}=e,y=s(e,m),{basename:x}=r.useContext(le),k="string"===typeof p&&yt.test(p),E=!1;if("string"===typeof p&&k&&(a=p,gt))try{let e=new URL(window.location.href),t=p.startsWith("//")?new URL(e.protocol+p):new URL(p),a=H(t.pathname,x);t.origin===e.origin&&null!=a?p=a+t.search+t.hash:E=!0}catch(Ig){w(!1,'<Link to="'.concat(p,'"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.'))}let T=function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};b(fe(),"useHref() may be used only in the context of a <Router> component.");let{basename:a,navigator:n}=r.useContext(le),{hash:s,pathname:i,search:o}=ye(e,{relative:t}),l=i;return"/"!==a&&(l="/"===i?a:X([a,i])),n.createHref({pathname:l,search:o,hash:s})}(p,{relative:l}),[N,j,C]=function(e,t){let a=r.useContext(nt),[n,s]=r.useState(!1),[i,o]=r.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:u,onMouseLeave:d,onTouchStart:f}=t,h=r.useRef(null);r.useEffect(()=>{if("render"===e&&o(!0),"viewport"===e){let e=new IntersectionObserver(e=>{e.forEach(e=>{o(e.isIntersecting)})},{threshold:.5});return h.current&&e.observe(h.current),()=>{e.disconnect()}}},[e]),r.useEffect(()=>{if(n){let e=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(e)}}},[n]);let m=()=>{s(!0)},p=()=>{s(!1),o(!1)};return a?"intent"!==e?[i,h,{}]:[i,h,{onFocus:it(l,m),onBlur:it(c,p),onMouseEnter:it(u,m),onMouseLeave:it(d,p),onTouchStart:it(f,m)}]:[!1,h,{}]}(o,y),_=function(e){let{target:t,replace:a,state:n,preventScrollReset:s,relative:i,viewTransition:o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=ge(),c=he(),u=ye(e,{relative:i});return r.useCallback(r=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(r,t)){r.preventDefault();let t=void 0!==a?a:S(c)===S(u);l(e,{replace:t,state:n,preventScrollReset:s,relative:i,viewTransition:o})}},[c,l,u,a,n,t,e,s,i,o])}(p,{replace:d,state:f,target:h,preventScrollReset:g,relative:l,viewTransition:v});let A=r.createElement("a",u(u(u({},y),C),{},{href:a||T,onClick:E||c?n:function(e){n&&n(e),e.defaultPrevented||_(e)},ref:ht(t,j),target:h,"data-discover":k||"render"!==i?void 0:"true"}));return N&&!k?r.createElement(r.Fragment,null,A,r.createElement(lt,{page:T})):A});bt.displayName="Link",r.forwardRef(function(e,t){let{"aria-current":a="page",caseSensitive:n=!1,className:i="",end:o=!1,style:l,to:c,viewTransition:d,children:f}=e,h=s(e,p),m=ye(c,{relative:h.relative}),g=he(),v=r.useContext(re),{navigator:y,basename:w}=r.useContext(le),x=null!=v&&function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=r.useContext(se);b(null!=a,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=kt("useViewTransitionState"),s=ye(e,{relative:t});if(!a.isTransitioning)return!1;let i=H(a.currentLocation.pathname,n)||a.currentLocation.pathname,o=H(a.nextLocation.pathname,n)||a.nextLocation.pathname;return null!=U(s.pathname,o)||null!=U(s.pathname,i)}(m)&&!0===d,k=y.encodeLocation?y.encodeLocation(m).pathname:m.pathname,S=g.pathname,E=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;n||(S=S.toLowerCase(),E=E?E.toLowerCase():null,k=k.toLowerCase()),E&&w&&(E=H(E,w)||E);const T="/"!==k&&k.endsWith("/")?k.length-1:k.length;let N,j=S===k||!o&&S.startsWith(k)&&"/"===S.charAt(T),C=null!=E&&(E===k||!o&&E.startsWith(k)&&"/"===E.charAt(k.length)),_={isActive:j,isPending:C,isTransitioning:x},A=j?a:void 0;N="function"===typeof i?i(_):[i,j?"active":null,C?"pending":null,x?"transitioning":null].filter(Boolean).join(" ");let P="function"===typeof l?l(_):l;return r.createElement(bt,u(u({},h),{},{"aria-current":A,className:N,ref:t,style:P,to:c,viewTransition:d}),"function"===typeof f?f(_):f)}).displayName="NavLink";var wt=r.forwardRef((e,t)=>{let{discover:a="render",fetcherKey:n,navigate:i,reloadDocument:o,replace:l,state:c,method:d=ze,action:f,onSubmit:h,relative:m,preventScrollReset:p,viewTransition:v}=e,y=s(e,g),w=Nt(),x=function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{basename:a}=r.useContext(le),n=r.useContext(ue);b(n,"useFormAction must be used inside a RouteContext");let[s]=n.matches.slice(-1),i=u({},ye(e||".",{relative:t})),o=he();if(null==e){i.search=o.search;let e=new URLSearchParams(i.search),t=e.getAll("index");if(t.some(e=>""===e)){e.delete("index"),t.filter(e=>e).forEach(t=>e.append("index",t));let a=e.toString();i.search=a?"?".concat(a):""}}e&&"."!==e||!s.route.index||(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index");"/"!==a&&(i.pathname="/"===i.pathname?a:X([a,i.pathname]));return S(i)}(f,{relative:m}),k="get"===d.toLowerCase()?"get":"post",E="string"===typeof f&&yt.test(f);return r.createElement("form",u(u({ref:t,method:k,action:x,onSubmit:o?h:e=>{if(h&&h(e),e.defaultPrevented)return;e.preventDefault();let t=e.nativeEvent.submitter,a=(null===t||void 0===t?void 0:t.getAttribute("formmethod"))||d;w(t||e.currentTarget,{fetcherKey:n,method:a,navigate:i,replace:l,state:c,relative:m,preventScrollReset:p,viewTransition:v})}},y),{},{"data-discover":E||"render"!==a?void 0:"true"}))});function xt(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function kt(e){let t=r.useContext(ae);return b(t,xt(e)),t}function St(e){w("undefined"!==typeof URLSearchParams,"You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let t=r.useRef(We(e)),a=r.useRef(!1),n=he(),s=r.useMemo(()=>function(e,t){let a=We(e);return t&&t.forEach((e,r)=>{a.has(r)||t.getAll(r).forEach(e=>{a.append(r,e)})}),a}(n.search,a.current?null:t.current),[n.search]),i=ge(),o=r.useCallback((e,t)=>{const r=We("function"===typeof e?e(new URLSearchParams(s)):e);a.current=!0,i("?"+r,t)},[i,s]);return[s,o]}wt.displayName="Form";var Et=0,Tt=()=>"__".concat(String(++Et),"__");function Nt(){let{router:e}=kt("useSubmit"),{basename:t}=r.useContext(le),a=Ce("useRouteId");return r.useCallback(async function(r){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{action:s,method:i,encType:o,formData:l,body:c}=$e(r,t);if(!1===n.navigate){let t=n.fetcherKey||Tt();await e.fetch(t,a,n.action||s,{preventScrollReset:n.preventScrollReset,formData:l,body:c,formMethod:n.method||i,formEncType:n.encType||o,flushSync:n.flushSync})}else await e.navigate(n.action||s,{preventScrollReset:n.preventScrollReset,formData:l,body:c,formMethod:n.method||i,formEncType:n.encType||o,replace:n.replace,state:n.state,fromRouteId:a,flushSync:n.flushSync,viewTransition:n.viewTransition})},[e,t,a])}const jt=new class{constructor(){let e="https://thoughtprob2b.thoughthealer.org/api/v1";e.endsWith("/v1")||e.endsWith("/v1/")||(e=e.endsWith("/")?e+"v1":e+"/v1"),this.config={apiBaseUrl:e,appName:"ThoughtPro B2B",version:"1.0.0",environment:"development",enableAnalytics:!1,debugMode:!0,disableApi:!1,mockMode:!1,offlineMode:!1}}get(e){return this.config[e]}getApiUrl(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return"".concat(this.config.apiBaseUrl).concat(e)}isProduction(){return"production"===this.config.environment}isDevelopment(){return"development"===this.config.environment}isApiDisabled(){return this.config.disableApi||this.config.offlineMode}isMockMode(){return this.config.mockMode||this.config.offlineMode}shouldUseOfflineMode(){return this.config.offlineMode}};class Ct extends Error{constructor(e,t,a){super(e),this.name="ApiError",this.status=t,this.response=a}}const _t=new class{constructor(){this.baseURL=jt.getApiUrl(),this.isOnline=!0,this.offlineMode=jt.shouldUseOfflineMode(),this.disableApi=jt.isApiDisabled();const e=jt.isMockMode();(this.disableApi||this.offlineMode||e)&&(console.log("API Service: Starting in offline/mock mode"),this.offlineMode=!0)}setOfflineMode(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.offlineMode=e,console.log("API Service: ".concat(e?"Offline":"Online"," mode activated"))}isApiDisabled(){return this.disableApi||this.offlineMode}getHeaders(){const e=localStorage.getItem("token")||localStorage.getItem("authToken")||localStorage.getItem("jwt_token");return u({"Content-Type":"application/json"},e&&{Authorization:"Bearer ".concat(e)})}async request(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.isApiDisabled())throw new Error("API is disabled or in offline mode");const a=e.startsWith("/")?e:"/".concat(e),r=this.baseURL.endsWith("/")?this.baseURL.slice(0,-1):this.baseURL,n="".concat(r).concat(a),s=u(u({},t),{},{headers:u(u({},this.getHeaders()),t.headers)});try{const e=await fetch(n,s);return await(async e=>{if(!e.ok){let a="HTTP ".concat(e.status,": ").concat(e.statusText),r=null;try{const t=await e.json();a=t.message||t.error||a,r=t.details||t}catch(t){console.warn("Failed to parse error response:",t)}switch(e.status){case 401:a="Authentication required. Please login again.";break;case 403:a="Access denied. You do not have permission to access this resource.";break;case 404:a="Resource not found. The requested endpoint may not be available.";break;case 500:a="Server error. The API service may be temporarily unavailable.";break;case 502:case 503:case 504:a="Service temporarily unavailable. Please try again later."}const n=new Ct(a,e.status,e);throw n.details=r,n}try{return await e.json()}catch(t){throw new Ct("Invalid JSON response",e.status,e)}})(e)}catch(i){const e=(e=>e instanceof Ct?{message:e.message,status:e.status,type:"api_error"}:"TypeError"===e.name&&e.message.includes("fetch")?{message:"Network error - please check your connection",status:0,type:"network_error"}:{message:e.message||"An unexpected error occurred",status:500,type:"unknown_error"})(i);throw e.status>=500&&console.warn("Server error detected, API may be unavailable:",e.message),console.error("API request failed:",e),i}}async requestWithRetry(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;for(let n=1;n<=t;n++)try{return await e()}catch(r){if(n===t)throw r;if(r instanceof Ct){if(r.status>=400&&r.status<500)throw r;if(500===r.status&&1===n){console.warn("Server error (500), retrying attempt ".concat(n+1,"/").concat(t,"...")),await new Promise(e=>setTimeout(e,2*a));continue}if(r.status>=500){console.warn("Server error (".concat(r.status,"), retrying attempt ").concat(n+1,"/").concat(t,"...")),await new Promise(e=>setTimeout(e,a*n));continue}}await new Promise(e=>setTimeout(e,a*n))}}(()=>this.request(e,t),arguments.length>2&&void 0!==arguments[2]?arguments[2]:2)}get(e){return this[arguments.length>1&&void 0!==arguments[1]&&arguments[1]?"requestWithRetry":"request"](e,{method:"GET"})}post(e,t){return this[arguments.length>2&&void 0!==arguments[2]&&arguments[2]?"requestWithRetry":"request"](e,{method:"POST",body:JSON.stringify(t)})}put(e,t){return this[arguments.length>2&&void 0!==arguments[2]&&arguments[2]?"requestWithRetry":"request"](e,{method:"PUT",body:JSON.stringify(t)})}delete(e){return this[arguments.length>1&&void 0!==arguments[1]&&arguments[1]?"requestWithRetry":"request"](e,{method:"DELETE"})}async healthCheck(){try{const e=await this.get("/health");return this.isOnline=!0,u({success:!0},e)}catch(e){return this.isOnline=!1,{success:!1,error:"Health check failed",details:e.message}}}async testConnection(){if(this.isApiDisabled())return{success:!1,offline:!0};try{const e=new AbortController,t=setTimeout(()=>e.abort(),3e3),a=await fetch("".concat(this.baseURL,"/health"),{method:"GET",headers:this.getHeaders(),signal:e.signal});clearTimeout(t);return a.ok?(this.isOnline=!0,{success:!0,status:a.status}):(this.isOnline=!1,{success:!1,status:a.status})}catch(e){return this.isOnline=!1,{success:!1,error:"AbortError"===e.name?"Timeout":e.message}}}};const At=new class{async registerProfile(e){try{return await _t.post("/auth/supabase/register-profile",e)}catch(r){var t,a;throw new Error((null===(t=r.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||"Failed to register profile")}}async createCredentials(e){try{return await _t.post("/auth/supabase/create-credentials",e)}catch(r){var t,a;throw new Error((null===(t=r.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||"Failed to create credentials")}}async getUserProfileFromAPI(){try{return await _t.get("/auth/supabase/profile")}catch(a){var e,t;throw new Error((null===(e=a.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||"Failed to fetch user profile")}}async adminLogin(e,t){try{console.log("AdminLogin: Attempting admin login for:",e);const a=await _t.post("/auth/admin-login",{email:e,password:t});if(console.log("AdminLogin: API response:",a),a.success&&a.token&&a.user){const t=a.user;console.log("AdminLogin: Login successful, storing data..."),localStorage.setItem("token",a.token),localStorage.setItem("authToken",a.token),localStorage.setItem("jwt_token",a.token),console.log("AdminLogin: Token stored");const r={id:t.id,email:t.email||e,name:t.name||"System Administrator",role:"admin",is_active:!0,permissions:["*"]};return localStorage.setItem("user",JSON.stringify(r)),console.log("AdminLogin: Admin user stored:",r),localStorage.setItem("userProfile",JSON.stringify({role:"admin",email:t.email||e,name:t.name||"System Administrator",permissions:["*"],isAdmin:!0})),console.log("AdminLogin: Admin profile stored"),a}if(a.success&&a.data){const t=a.data.user||a.data;if(a.data.token||a.token){const e=a.data.token||a.token;localStorage.setItem("token",e),localStorage.setItem("authToken",e),localStorage.setItem("jwt_token",e)}const r={id:t.id,email:t.email||e,name:t.name||"System Administrator",role:"admin",is_active:!0,permissions:["*"]};return localStorage.setItem("user",JSON.stringify(r)),localStorage.setItem("userProfile",JSON.stringify({role:"admin",email:t.email||e,name:t.name||"System Administrator",permissions:["*"],isAdmin:!0})),{success:!0,token:a.data.token||a.token,user:r}}return console.log("AdminLogin: Login failed - invalid response format"),{success:!1,error:"Invalid admin credentials"}}catch(r){if(console.error("AdminLogin: Error occurred:",r),r.response){var a;const e=r.response.status,t=(null===(a=r.response.data)||void 0===a?void 0:a.message)||r.message;throw 401===e?new Error("Invalid admin credentials. Please check your email and password."):403===e?new Error("Access denied. This account does not have admin privileges."):e>=500?new Error("Server error. Please try again later."):new Error(t||"Admin authentication failed")}throw"NETWORK_ERROR"===r.code||r.message.includes("fetch")?new Error("Network error. Please check your internet connection."):new Error(r.message||"Admin authentication failed")}}async superAdminLogin(e,t){try{console.log("SuperAdminLogin: Attempting super admin login for:",e);const a=await _t.post("/auth/super-admin-login",{email:e,password:t});if(console.log("SuperAdminLogin: API response:",a),a.success&&a.token&&a.user){const t=a.user;console.log("SuperAdminLogin: Login successful, storing data..."),localStorage.setItem("token",a.token),localStorage.setItem("authToken",a.token),localStorage.setItem("jwt_token",a.token),console.log("SuperAdminLogin: Token stored");const r={id:t.id,email:t.email||e,name:t.name||"Super Administrator",role:"super_admin",is_active:!0,permissions:["*"]};return localStorage.setItem("user",JSON.stringify(r)),console.log("SuperAdminLogin: Super admin user stored:",r),localStorage.setItem("userProfile",JSON.stringify({role:"super_admin",email:t.email||e,name:t.name||"Super Administrator",permissions:["*"],isSuperAdmin:!0})),console.log("SuperAdminLogin: Super admin profile stored"),a}if(a.success&&a.data){const t=a.data.user||a.data;if(a.data.token||a.token){const e=a.data.token||a.token;localStorage.setItem("token",e),localStorage.setItem("authToken",e),localStorage.setItem("jwt_token",e)}const r={id:t.id,email:t.email||e,name:t.name||"Super Administrator",role:"super_admin",is_active:!0,permissions:["*"]};return localStorage.setItem("user",JSON.stringify(r)),localStorage.setItem("userProfile",JSON.stringify({role:"super_admin",email:t.email||e,name:t.name||"Super Administrator",permissions:["*"],isSuperAdmin:!0})),{success:!0,token:a.data.token||a.token,user:r}}return console.log("SuperAdminLogin: Login failed - invalid response format"),{success:!1,error:"Invalid super admin credentials"}}catch(a){throw console.error("SuperAdminLogin: Error occurred:",a),a.message&&(a.message.includes("Invalid credentials")||a.message.includes("401")||a.message.includes("Unauthorized"))?new Error("Invalid super admin email or password. Please check your credentials."):a.message&&(a.message.includes("403")||a.message.includes("Access denied")||a.message.includes("not authorized"))?new Error("This account does not have super admin privileges."):a.message&&a.message.includes("500")?new Error("Server error. Please try again later."):"NETWORK_ERROR"===a.code||a.message.includes("fetch")?new Error("Network error. Please check your internet connection."):new Error(a.message||"Super admin authentication failed")}}async companyLogin(e,t){try{const a=await _t.post("/auth/supabase/login",{email:e,password:t});if(console.log("Raw API Response:",a),a.success&&a.token&&a.user){const t=a.user;console.log("Login response:",a),console.log("User data:",t),a.token&&(localStorage.setItem("token",a.token),localStorage.setItem("authToken",a.token),localStorage.setItem("jwt_token",a.token),console.log("Token stored:",a.token.substring(0,20)+"...")),t.company&&(localStorage.setItem("company_id",t.company),localStorage.setItem("companyId",t.company),console.log("Company ID stored:",t.company));const r={id:t.id,email:t.email||e,name:t.name,role:t.role||"company",company_id:t.company,phone:t.phone,plan_type:t.planType,validityDays:t.validityDays,productId:t.productId,isFirstLogin:t.isFirstLogin,requiresPasswordChange:t.requiresPasswordChange,is_active:!0};localStorage.setItem("user",JSON.stringify(r)),console.log("User stored:",r),localStorage.setItem("userProfile",JSON.stringify({role:t.role||"company",company_id:t.company,email:t.email||e,name:t.name,permissions:"admin"===t.role?["*"]:["view_employees","manage_employees","create_employees","manage_subscriptions"]}))}return a}catch(u){var a,r,n,s,i,o,l,c;if(console.error("Company login error:",u),401===(null===(a=u.response)||void 0===a?void 0:a.status)&&(null!==(r=u.response)&&void 0!==r&&null!==(n=r.data)&&void 0!==n&&null!==(s=n.message)&&void 0!==s&&s.includes("temporary")||null!==(i=u.response)&&void 0!==i&&null!==(o=i.data)&&void 0!==o&&o.requiresPasswordChange))return{success:!1,requiresPasswordSetup:!0,message:"Please set your new password to continue"};throw new Error((null===(l=u.response)||void 0===l||null===(c=l.data)||void 0===c?void 0:c.message)||"Company authentication failed")}}async employeeLogin(e,t){try{const s=await _t.post("/auth/supabase/login",{email:e,password:t,role:"employee"});var a,r,n;if(s.success&&s.data)s.data.token&&localStorage.setItem("token",s.data.token),s.data.employee&&(localStorage.setItem("user",JSON.stringify({id:s.data.employee.id,email:e,name:s.data.employee.name,role:"employee"})),localStorage.setItem("employee",JSON.stringify(s.data.employee))),localStorage.setItem("userProfile",JSON.stringify({role:"employee",employee_id:null===(a=s.data.employee)||void 0===a?void 0:a.id,company_id:null===(r=s.data.employee)||void 0===r?void 0:r.company_id,name:null===(n=s.data.employee)||void 0===n?void 0:n.name,email:e,permissions:["view_bookings","create_bookings","view_psychologists","view_profile"]}));return s}catch(s){throw new Error("Employee authentication failed")}}async login(e,t){return e.toLowerCase().includes("admin")||e.toLowerCase().includes("thoughtpro")||e.toLowerCase().includes("syneptlabs@gmail.com")?this.adminLogin(e,t):this.companyLogin(e,t)}async loginWithTemporary(e,t){try{const a=await _t.post("/auth/supabase/login-temp",{email:e,tempPassword:t});if(a.success&&a.data){if(a.data.token&&localStorage.setItem("token",a.data.token),a.data.requiresPasswordChange||a.data.isFirstLogin)return{success:!1,requiresPasswordChange:!0,isFirstLogin:a.data.isFirstLogin,token:a.data.token,user:a.data.user,message:"Password change required"};const t=a.data.user;localStorage.setItem("user",JSON.stringify({id:t.id,email:e,name:t.name,role:t.role,company_id:t.company_id})),localStorage.setItem("userProfile",JSON.stringify({role:t.role,company_id:t.company_id,email:e,name:t.name,permissions:"admin"===t.role?["*"]:["view_employees","manage_employees"]}))}return a}catch(n){var a,r;throw new Error((null===(a=n.response)||void 0===a||null===(r=a.data)||void 0===r?void 0:r.message)||"Temporary login failed")}}async logout(){try{await _t.post("/auth/logout"),this.clearUserData()}catch(e){console.error("Logout error:",e),this.clearUserData()}}clearUserData(){localStorage.removeItem("token"),localStorage.removeItem("jwt_token"),localStorage.removeItem("company_id"),localStorage.removeItem("user"),localStorage.removeItem("userProfile")}async register(e){try{return await _t.post("/auth/register",e)}catch(t){throw new Error("Registration failed")}}async validateToken(){try{return await _t.get("/auth/validate")}catch(e){return null}}async refreshToken(){try{const e=await _t.post("/auth/refresh");return e.success&&e.data.token&&localStorage.setItem("token",e.data.token),e}catch(e){throw new Error("Token refresh failed")}}async forgotPasswordCompany(e){try{return await _t.post("/companies/forgot-password/personal-email",{email:e})}catch(r){var t,a;console.error("Forgot password error details:",r);const e=r.message||(null===(t=r.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||"Failed to send password reset email";throw new Error(e)}}async forgotPassword(e){try{return await _t.post("/auth/forgot-password",{email:e})}catch(t){throw new Error("Failed to send password reset email")}}async resetPassword(e,t){try{return await _t.post("/auth/reset-password",{token:e,password:t})}catch(a){throw new Error("Failed to reset password")}}async changePassword(e,t){try{return await _t.post("/auth/change-password",{currentPassword:e,newPassword:t})}catch(a){throw new Error("Failed to change password")}}async verifyEmail(e){try{return await _t.post("/auth/verify-email",{token:e})}catch(t){throw new Error("Failed to verify email")}}async resendVerificationEmail(e){try{return await _t.post("/auth/resend-verification",{email:e})}catch(t){throw new Error("Failed to resend verification email")}}async sendTemporaryPassword(e){try{return await _t.post("/auth/send-temp-password",{employeeId:e})}catch(t){throw new Error("Failed to send temporary password")}}async validateTemporaryPassword(e,t){try{return await _t.post("/auth/validate-temp-password",{tempPassword:e,employeeId:t})}catch(a){throw new Error("Invalid temporary password")}}async updateTemporaryPassword(e,t){try{const a=await _t.put("/auth/supabase/update-temp-password",{newPassword:e,confirmPassword:t});return a.success&&a.data&&(a.data.user&&localStorage.setItem("user",JSON.stringify(a.data.user)),a.data.token&&localStorage.setItem("token",a.data.token)),a}catch(n){var a,r;throw new Error((null===(a=n.response)||void 0===a||null===(r=a.data)||void 0===r?void 0:r.message)||"Failed to update password")}}async setupPassword(e,t,a){try{return await _t.post("/auth/setup-password",{tempPassword:e,newPassword:t,employeeId:a})}catch(r){throw new Error("Failed to setup password")}}getCurrentUser(){const e=localStorage.getItem("user");return e?JSON.parse(e):null}getUserProfile(){const e=localStorage.getItem("userProfile");return e?JSON.parse(e):null}getToken(){return localStorage.getItem("token")}getJwtToken(){return localStorage.getItem("jwt_token")}getStoredCompanyId(){return localStorage.getItem("company_id")||localStorage.getItem("companyId")||this.getCompanyId()}isAuthenticated(){return!!this.getToken()}getUserRole(){const e=this.getUserProfile(),t=this.getCurrentUser();return"admin"===(null===e||void 0===e?void 0:e.role)||"admin"===(null===t||void 0===t?void 0:t.role)?"admin":null!==e&&void 0!==e&&e.company_id||null!==t&&void 0!==t&&t.company_id?"company":"employee"}getCompanyId(){const e=this.getUserProfile(),t=this.getCurrentUser();return(null===e||void 0===e?void 0:e.company_id)||(null===t||void 0===t?void 0:t.company_id)||null}isAdmin(){return"admin"===this.getUserRole()}isCompanyUser(){return"company"===this.getUserRole()}isEmployee(){return"employee"===this.getUserRole()}canAccessCompanyData(){return this.isAdmin()||this.isCompanyUser()}canManagePsychologists(){return this.isAdmin()}canCreateCompanies(){return this.isAdmin()}hasRole(e){return this.getUserRole()===e}hasPermission(e){var t,a;const r=this.getCurrentUser(),n=this.getUserProfile();if(null!==r&&void 0!==r&&null!==(t=r.permissions)&&void 0!==t&&t.includes(e))return!0;if(null!==n&&void 0!==n&&null!==(a=n.permissions)&&void 0!==a&&a.includes(e))return!0;const s={admin:["*"],company:["view_employees","manage_employees"],employee:["view_own_profile","book_sessions","view_own_bookings"]}[this.getUserRole()]||[];return s.includes("*")||s.includes(e)}};var Pt=a(579);const Rt=(0,r.createContext)(null),Ot=e=>{let{children:t}=e;const[a,n]=(0,r.useState)(null),[s,i]=(0,r.useState)(null),[o,l]=(0,r.useState)(!1),[c,u]=(0,r.useState)(null),[d,f]=(0,r.useState)(null),[h,m]=(0,r.useState)(!0),[p,g]=(0,r.useState)(!1);(0,r.useEffect)(()=>{const e=localStorage.getItem("user"),t=localStorage.getItem("userProfile"),a=localStorage.getItem("token");if(e&&a){const a=JSON.parse(e),r=t?JSON.parse(t):null;n(a),i(r),l(!0),u(At.getUserRole()),f(At.getCompanyId())}m(!1)},[]);const v={user:a,userProfile:s,isAuthenticated:o,userRole:c,companyId:d,loading:h,requiresPasswordSetup:p,login:async function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"company";try{let r;if(m(!0),r="admin"===a?await At.adminLogin(e,t):"company"===a?await At.companyLogin(e,t):await At.employeeLogin(e,t),r&&r.requiresPasswordSetup)return g(!0),{success:!1,requiresPasswordSetup:!0,requiresPasswordChange:!0,email:e,message:r.message||"Password setup required"};if(r.success&&r.token&&r.user){console.log("AuthContext: Login response:",r);const e=localStorage.getItem("user"),t=localStorage.getItem("userProfile");if(e){const a=JSON.parse(e),r=t?JSON.parse(t):null;return n(a),i(r),l(!0),u(At.getUserRole()),f(At.getCompanyId()),g(!1),console.log("AuthContext: Login successful, user set:",a),{success:!0,user:a,profile:r}}}return!r.success&&r.requiresPasswordSetup?(g(!0),{success:!1,requiresPasswordSetup:!0,requiresPasswordChange:!0,email:e,message:r.message||"Password setup required for first login"}):r||{success:!1,error:"Login failed - invalid credentials or server error"}}catch(d){var r,s,o,c;if(console.error("Login error:",d),null!==(r=d.message)&&void 0!==r&&r.includes("temporary")||null!==(s=d.message)&&void 0!==s&&s.includes("requiresPasswordChange")||null!==(o=d.response)&&void 0!==o&&null!==(c=o.data)&&void 0!==c&&c.requiresPasswordChange)return g(!0),{success:!1,requiresPasswordSetup:!0,requiresPasswordChange:!0,email:e,message:d.message||"First time login - password setup required"};throw d}finally{m(!1)}},loginWithTemporaryPassword:async(e,t)=>{try{m(!0);const a=await At.loginWithTemporary(e,t);if(a.success){if(a.requiresPasswordChange)return g(!0),{success:!1,requiresPasswordSetup:!0,email:e,temporaryPassword:t,message:"Please set your new password"};const r=a.user;return n(r),l(!0),u(At.getUserRole()),f(At.getCompanyId()),g(!1),{success:!0,user:r}}throw new Error(a.message||"Temporary login failed")}catch(a){throw console.error("Temporary login error:",a),a}finally{m(!1)}},logout:()=>{At.clearUserData(),n(null),i(null),l(!1),u(null),f(null),g(!1)},isAdmin:()=>"admin"===c,isCompanyUser:()=>"company"===c,canAccessCompanyData:()=>"admin"===c||"company"===c,getUserRole:()=>c,getCompanyId:()=>d,setRequiresPasswordSetup:g};return(0,Pt.jsx)(Rt.Provider,{value:v,children:t})},Dt=(0,r.createContext)(null),Ft=e=>{let{children:t}=e;const[a,n]=(0,r.useState)("Xyz Company"),[s,i]=(0,r.useState)({showProductivity:!0,showPhoneUsageWeekdays:!0,showPhoneUsageWork:!0});(0,r.useEffect)(()=>{const e=localStorage.getItem("companyName"),t=localStorage.getItem("dashboardSettings");e&&n(e),t&&i(JSON.parse(t))},[]);const o={companyName:a,updateCompanyName:e=>{n(e),localStorage.setItem("companyName",e)},settings:s,updateSettings:e=>{i(e),localStorage.setItem("dashboardSettings",JSON.stringify(e))}};return(0,Pt.jsx)(Dt.Provider,{value:o,children:t})},It=()=>{const e=(0,r.useContext)(Rt);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e},Lt=()=>{const e=ge();return(0,r.useEffect)(()=>{e("/company/login",{replace:!0})},[e]),null},Mt=e=>{const t=(e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,a)=>a?a.toUpperCase():t.toLowerCase()))(e);return t.charAt(0).toUpperCase()+t.slice(1)},zt=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter((e,t,a)=>Boolean(e)&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim()};var Ut={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Bt=["color","size","strokeWidth","absoluteStrokeWidth","className","children","iconNode"],Wt=(0,r.forwardRef)((e,t)=>{let{color:a="currentColor",size:n=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:l="",children:c,iconNode:d}=e,f=s(e,Bt);return(0,r.createElement)("svg",u(u(u({ref:t},Ut),{},{width:n,height:n,stroke:a,strokeWidth:o?24*Number(i)/Number(n):i,className:zt("lucide",l)},!c&&!(e=>{for(const t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(f)&&{"aria-hidden":"true"}),f),[...d.map(e=>{let[t,a]=e;return(0,r.createElement)(t,a)}),...Array.isArray(c)?c:[c]])}),Ht=["className"],Vt=(e,t)=>{const a=(0,r.forwardRef)((a,n)=>{let{className:i}=a,o=s(a,Ht);return(0,r.createElement)(Wt,u({ref:n,iconNode:t,className:zt("lucide-".concat((l=Mt(e),l.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase())),"lucide-".concat(e),i)},o));var l});return a.displayName=Mt(e),a},Gt=Vt("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]),$t=Vt("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),qt=Vt("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Yt=Vt("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),Xt=Vt("chart-column",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),Kt=e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e),Jt=()=>{const[e,t]=(0,r.useState)(""),[a,n]=(0,r.useState)(""),[s,i]=(0,r.useState)(""),[o,l]=(0,r.useState)(!1),[c,u]=(0,r.useState)(!1),{login:d}=It(),f=ge();return(0,Pt.jsx)("div",{className:"login-container",children:(0,Pt.jsxs)("div",{className:"login-card admin-login",children:[(0,Pt.jsxs)("div",{className:"login-header",children:[(0,Pt.jsx)("div",{className:"logo admin-logo",children:(0,Pt.jsx)(Gt,{size:40})}),(0,Pt.jsx)("h1",{className:"login-title",children:"Admin Portal"}),(0,Pt.jsx)("p",{className:"login-subtitle",children:"Secure administrative access"})]}),(0,Pt.jsxs)("form",{onSubmit:async t=>{if(t.preventDefault(),i(""),e&&a)if(Kt(e)){l(!0);try{console.log("AdminLoginPage: Attempting login for admin:",e);const t=await d(e,a,"admin");console.log("AdminLoginPage: Login result:",t),t.success?(console.log("AdminLoginPage: Login successful, redirecting to admin dashboard..."),setTimeout(()=>{f("/admin/dashboard")},100)):(console.log("AdminLoginPage: Login failed:",t.error),i(t.error||t.message||"Admin login failed. Please check your credentials."))}catch(r){console.error("AdminLoginPage: Login error:",r),r.message.includes("Invalid admin credentials")||r.message.includes("401")||r.message.includes("Unauthorized")?i("Invalid credentials. Please check your email and password."):r.message.includes("Access denied")||r.message.includes("403")?i("Access denied. This account does not have admin privileges."):r.message.includes("Network error")||r.message.includes("NETWORK_ERROR")?i("Network connection error. Please check your internet connection and try again."):r.message.includes("Server error")||r.message.includes("500")?i("Server temporarily unavailable. Please try again in a few moments."):i("Invalid credentials. Please check your email and password.")}finally{l(!1)}}else i("Please enter a valid email address");else i("Please fill in all fields")},className:"login-form",children:[(0,Pt.jsxs)("div",{className:"input-group",children:[(0,Pt.jsx)("label",{className:"label",children:"Admin Email"}),(0,Pt.jsx)("input",{type:"email",value:e,onChange:e=>t(e.target.value),placeholder:"Enter admin email",className:"input",disabled:o,autoComplete:"email"})]}),(0,Pt.jsxs)("div",{className:"input-group",children:[(0,Pt.jsx)("label",{className:"label",children:"Password"}),(0,Pt.jsxs)("div",{className:"password-input-wrapper",children:[(0,Pt.jsx)("input",{type:c?"text":"password",value:a,onChange:e=>n(e.target.value),placeholder:"Enter admin password",className:"input",disabled:o,autoComplete:"current-password"}),(0,Pt.jsx)("button",{type:"button",className:"password-toggle-btn",onClick:()=>u(!c),disabled:o,"aria-label":c?"Hide password":"Show password",children:c?(0,Pt.jsx)($t,{size:20}):(0,Pt.jsx)(qt,{size:20})})]})]}),s&&(0,Pt.jsxs)("div",{className:"error",children:[(0,Pt.jsx)(Yt,{size:16}),s]}),(0,Pt.jsx)("button",{type:"submit",className:"primary-button admin-button",disabled:o,children:o?"Signing in...":"Admin Sign In"})]}),(0,Pt.jsx)("div",{className:"login-footer",children:(0,Pt.jsxs)("div",{className:"login-switch",children:[(0,Pt.jsx)("p",{children:"Not an admin?"}),(0,Pt.jsxs)(bt,{to:"/login",className:"switch-link",children:[(0,Pt.jsx)(Xt,{size:16}),"Company Login"]})]})})]})})},Qt=Vt("shield-check",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),Zt=()=>{const[e,t]=(0,r.useState)(""),[a,n]=(0,r.useState)(""),[s,i]=(0,r.useState)(""),[o,l]=(0,r.useState)(!1),[c,u]=(0,r.useState)(!1),d=ge();return(0,Pt.jsx)("div",{className:"login-container",children:(0,Pt.jsxs)("div",{className:"login-card admin-login",children:[(0,Pt.jsxs)("div",{className:"login-header",children:[(0,Pt.jsx)("div",{className:"logo admin-logo",children:(0,Pt.jsx)(Qt,{size:40})}),(0,Pt.jsx)("h1",{className:"login-title",children:"Super Admin Portal"}),(0,Pt.jsx)("p",{className:"login-subtitle",children:"Maximum security access"})]}),(0,Pt.jsxs)("form",{onSubmit:async t=>{if(t.preventDefault(),i(""),e&&a)if(Kt(e)){l(!0);try{console.log("SuperAdminLoginPage: Attempting login for super admin:",e);const t=await At.superAdminLogin(e,a);console.log("SuperAdminLoginPage: Login result:",t),t.success?(console.log("SuperAdminLoginPage: Login successful, redirecting to super admin dashboard..."),setTimeout(()=>{d("/super-admin/dashboard")},100)):(console.log("SuperAdminLoginPage: Login failed:",t.error),i(t.error||t.message||"Super admin login failed. Please check your credentials."))}catch(r){console.error("SuperAdminLoginPage: Login error:",r),r.message.includes("Invalid super admin credentials")?i("Invalid super admin email or password. Please verify your credentials."):r.message.includes("Access denied")?i("This account does not have super admin privileges."):r.message.includes("Network error")?i("Network connection error. Please check your internet connection and try again."):r.message.includes("Server error")?i("Server temporarily unavailable. Please try again in a few moments."):i(r.message||"Super admin login failed. Please try again.")}finally{l(!1)}}else i("Please enter a valid email address");else i("Please fill in all fields")},className:"login-form",children:[(0,Pt.jsxs)("div",{className:"input-group",children:[(0,Pt.jsx)("label",{className:"label",children:"Super Admin Email"}),(0,Pt.jsx)("input",{type:"email",value:e,onChange:e=>t(e.target.value),placeholder:"Enter super admin email",className:"input",disabled:o,autoComplete:"email"})]}),(0,Pt.jsxs)("div",{className:"input-group",children:[(0,Pt.jsx)("label",{className:"label",children:"Password"}),(0,Pt.jsxs)("div",{className:"password-input-wrapper",children:[(0,Pt.jsx)("input",{type:c?"text":"password",value:a,onChange:e=>n(e.target.value),placeholder:"Enter super admin password",className:"input",disabled:o,autoComplete:"current-password"}),(0,Pt.jsx)("button",{type:"button",className:"password-toggle-btn",onClick:()=>u(!c),disabled:o,"aria-label":c?"Hide password":"Show password",children:c?(0,Pt.jsx)($t,{size:20}):(0,Pt.jsx)(qt,{size:20})})]})]}),s&&(0,Pt.jsxs)("div",{className:"error",children:[(0,Pt.jsx)(Yt,{size:16}),s]}),(0,Pt.jsx)("button",{type:"submit",className:"primary-button admin-button",disabled:o,children:o?"Signing in...":"Super Admin Sign In"})]}),(0,Pt.jsx)("div",{className:"login-footer",children:(0,Pt.jsxs)("div",{className:"login-switch",children:[(0,Pt.jsx)("p",{children:"Switch login type:"}),(0,Pt.jsxs)(bt,{to:"/admin/login",className:"switch-link",children:[(0,Pt.jsx)(Xt,{size:16}),"Admin Login"]}),(0,Pt.jsxs)(bt,{to:"/login",className:"switch-link",children:[(0,Pt.jsx)(Xt,{size:16}),"Company Login"]})]})})]})})},ea=Vt("building-2",[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]]),ta=()=>{const e=(0,r.useContext)(Dt);if(!e)throw new Error("useSettings must be used within a SettingsProvider");return e},aa=()=>{const[e,t]=(0,r.useState)(""),[a,n]=(0,r.useState)(""),[s,i]=(0,r.useState)(""),[o,l]=(0,r.useState)(!1),[c,u]=(0,r.useState)(!1),{login:d}=It(),{updateCompanyName:f}=ta(),h=ge();return(0,Pt.jsx)("div",{className:"login-container",children:(0,Pt.jsxs)("div",{className:"login-card company-login",children:[(0,Pt.jsxs)("div",{className:"login-header",children:[(0,Pt.jsx)("div",{className:"logo company-logo",children:(0,Pt.jsx)(ea,{size:40})}),(0,Pt.jsx)("h1",{className:"login-title",children:"Company Portal"}),(0,Pt.jsx)("p",{className:"login-subtitle",children:"Manage your company's wellness"})]}),(0,Pt.jsxs)("form",{onSubmit:async t=>{if(t.preventDefault(),i(""),!e||!a)return void i("Please fill in all fields");let r=e;if(e.includes("@")){if(!Kt(e))return void i("Please enter a valid email address")}else{if(!/^[a-zA-Z0-9][a-zA-Z0-9-_.]*[a-zA-Z0-9]\.[a-zA-Z]{2,}$/.test(e))return void i("Please enter a valid company domain (e.g., yourcompany.com)");r="company@"}l(!0);try{let t,s="Your Company";if(t=e.includes("@")?e.split("@")[1]:e,t){const e=t.split(".")[0];s=e.charAt(0).toUpperCase()+e.slice(1)+" Company"}f(s);const o=await d(r,a,"company");if(o.success)h("/dashboard");else if(o.requiresPasswordSetup||o.requiresPasswordChange)h("/company/set-password",{state:{email:r,temporaryPassword:a,isFirstLogin:o.isFirstLogin||!0,message:o.message||"Welcome! Please set your new password to continue accessing your company portal."}});else try{const e=await At.loginWithTemporary(r,a);e.requiresPasswordChange||e.isFirstLogin?h("/company/set-password",{state:{email:r,temporaryPassword:a,isFirstLogin:e.isFirstLogin,token:e.token,message:"This is your first login. Please set a new password to continue."}}):e.success?h("/dashboard"):i("Invalid credentials. Please check your email and password or contact your administrator.")}catch(n){i(o.error||o.message||"Invalid company credentials. Please check your email and password or contact your administrator for assistance.")}}catch(s){console.error("Company login error:",s),s.message?s.message.includes("Authentication required")||s.message.includes("401")||s.message.includes("Unauthorized")||s.message.includes("Invalid credentials")?i("Invalid credentials. Please check your email and password."):s.message.includes("temporary")||s.message.includes("first")||s.message.includes("setup")?h("/company/set-password",{state:{email:r,temporaryPassword:a,isFirstLogin:!0,message:"First time login detected. Please set your new password to continue."}}):s.message.includes("password")&&s.message.includes("change")?h("/company/set-password",{state:{email:r,temporaryPassword:a,message:"Password change required. Please set your new password."}}):s.message.includes("Network error")||s.message.includes("NETWORK_ERROR")?i("Network connection error. Please check your internet connection."):s.message.includes("Server error")||s.message.includes("500")?i("Server temporarily unavailable. Please try again later."):i("Invalid credentials. Please check your email and password."):i("Invalid credentials. Please check your email and password.")}finally{l(!1)}},className:"login-form",children:[(0,Pt.jsxs)("div",{className:"input-group",children:[(0,Pt.jsx)("label",{className:"label",children:"Company Domain or Email"}),(0,Pt.jsx)("input",{type:"text",value:e,onChange:e=>t(e.target.value),placeholder:"company@gmail.com",className:"input",disabled:o})]}),(0,Pt.jsxs)("div",{className:"input-group",children:[(0,Pt.jsx)("label",{className:"label",children:"Password"}),(0,Pt.jsxs)("div",{className:"password-input-wrapper",children:[(0,Pt.jsx)("input",{type:c?"text":"password",value:a,onChange:e=>n(e.target.value),placeholder:"Enter company password",className:"input",disabled:o}),(0,Pt.jsx)("button",{type:"button",className:"password-toggle-btn",onClick:()=>u(!c),disabled:o,children:c?(0,Pt.jsx)($t,{size:20}):(0,Pt.jsx)(qt,{size:20})})]})]}),s&&(0,Pt.jsxs)("div",{className:"error",children:[(0,Pt.jsx)(Yt,{size:16}),s]}),(0,Pt.jsx)("button",{type:"submit",className:"primary-button company-button",disabled:o,children:o?"Signing in...":"Company Sign In"})]}),(0,Pt.jsx)("div",{className:"login-footer",children:(0,Pt.jsxs)("div",{className:"login-switch",children:[(0,Pt.jsx)("p",{children:"System administrator?"}),(0,Pt.jsxs)(bt,{to:"/admin/login",className:"switch-link",children:[(0,Pt.jsx)(Gt,{size:16}),"Admin Login"]})]})})]})})},ra=()=>{var e,t,a;const n=ge(),s=he(),{login:i}=(()=>{const e=(0,r.useContext)(Rt);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e})(),[o,l]=(0,r.useState)({email:(null===(e=s.state)||void 0===e?void 0:e.email)||"",temporaryPassword:(null===(t=s.state)||void 0===t?void 0:t.temporaryPassword)||"",newPassword:"",confirmPassword:""}),[c,d]=(0,r.useState)(!1),[f,h]=(0,r.useState)(""),[m,p]=(0,r.useState)({temp:!1,new:!1,confirm:!1});(0,r.useEffect)(()=>{var e,t;const a=(null===(e=s.state)||void 0===e?void 0:e.email)||new URLSearchParams(s.search).get("email"),r=null===(t=s.state)||void 0===t?void 0:t.temporaryPassword;a&&l(e=>u(u({},e),{},{email:a,temporaryPassword:r||e.temporaryPassword}))},[s]);const g=e=>{const{name:t,value:a}=e.target;l(e=>u(u({},e),{},{[t]:a})),f&&h("")},v=e=>{p(t=>u(u({},t),{},{[e]:!t[e]}))};return(0,Pt.jsx)("div",{className:"set-password-container",children:(0,Pt.jsxs)("div",{className:"set-password-card",children:[(0,Pt.jsxs)("div",{className:"set-password-header",children:[(0,Pt.jsx)("h2",{children:"Set New Password"}),(0,Pt.jsx)("p",{children:(null===(a=s.state)||void 0===a?void 0:a.message)||"Welcome! Please set your new password to continue."})]}),(0,Pt.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),d(!0),h("");try{if(!o.email||!o.temporaryPassword||!o.newPassword||!o.confirmPassword)throw new Error("All fields are required");if(o.newPassword!==o.confirmPassword)throw new Error("New passwords do not match");if(!(e=>{const t=/[A-Z]/.test(e),a=/[a-z]/.test(e),r=/\d/.test(e),n=/\W/.test(e);return e.length>=8&&t&&a&&r&&n})(o.newPassword))throw new Error("Password must be at least 8 characters long and contain uppercase, lowercase, numbers, and special characters");const e=await At.loginWithTemporary(o.email,o.temporaryPassword);if(!e.success&&!e.requiresPasswordChange)throw new Error("Invalid temporary credentials");{const e=await At.updateTemporaryPassword(o.newPassword,o.confirmPassword);if(!e.success)throw new Error(e.message||"Failed to update password");if(!(await i(o.email,o.newPassword,"company")).success)throw new Error("Failed to login with new password");n("/dashboard")}}catch(f){h(f.message||"Failed to set new password")}finally{d(!1)}},className:"set-password-form",children:[(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsx)("label",{htmlFor:"email",children:"Email Address"}),(0,Pt.jsx)("input",{type:"email",id:"email",name:"email",value:o.email,onChange:g,required:!0,disabled:c,placeholder:"your-email@company.com"})]}),(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsx)("label",{htmlFor:"temporaryPassword",children:"Temporary Password"}),(0,Pt.jsxs)("div",{className:"password-input-group",children:[(0,Pt.jsx)("input",{type:m.temp?"text":"password",id:"temporaryPassword",name:"temporaryPassword",value:o.temporaryPassword,onChange:g,required:!0,disabled:c,placeholder:"Enter temporary password"}),(0,Pt.jsx)("button",{type:"button",className:"password-toggle",onClick:()=>v("temp"),tabIndex:"-1",children:m.temp?"\ud83d\udc41\ufe0f":"\ud83d\udc41\ufe0f\u200d\ud83d\udde8\ufe0f"})]}),(0,Pt.jsx)("small",{className:"form-hint",children:"Enter the temporary password provided by your administrator"})]}),(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsx)("label",{htmlFor:"newPassword",children:"New Password"}),(0,Pt.jsxs)("div",{className:"password-input-group",children:[(0,Pt.jsx)("input",{type:m.new?"text":"password",id:"newPassword",name:"newPassword",value:o.newPassword,onChange:g,required:!0,disabled:c,placeholder:"Enter new password"}),(0,Pt.jsx)("button",{type:"button",className:"password-toggle",onClick:()=>v("new"),tabIndex:"-1",children:m.new?"\ud83d\udc41\ufe0f":"\ud83d\udc41\ufe0f\u200d\ud83d\udde8\ufe0f"})]}),(0,Pt.jsx)("small",{className:"form-hint",children:"Password must be at least 8 characters with uppercase, lowercase, numbers, and special characters"})]}),(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsx)("label",{htmlFor:"confirmPassword",children:"Confirm New Password"}),(0,Pt.jsxs)("div",{className:"password-input-group",children:[(0,Pt.jsx)("input",{type:m.confirm?"text":"password",id:"confirmPassword",name:"confirmPassword",value:o.confirmPassword,onChange:g,required:!0,disabled:c,placeholder:"Confirm new password"}),(0,Pt.jsx)("button",{type:"button",className:"password-toggle",onClick:()=>v("confirm"),tabIndex:"-1",children:m.confirm?"\ud83d\udc41\ufe0f":"\ud83d\udc41\ufe0f\u200d\ud83d\udde8\ufe0f"})]})]}),f&&(0,Pt.jsx)("div",{className:"error-message",children:f}),(0,Pt.jsxs)("div",{className:"form-actions",children:[(0,Pt.jsx)("button",{type:"button",onClick:()=>{n("/company/login")},className:"btn-secondary",disabled:c,children:"Back to Login"}),(0,Pt.jsx)("button",{type:"submit",className:"btn-primary",disabled:c,children:c?"Setting Password...":"Set Password"})]})]})]})})},na=Vt("target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),sa=Vt("smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]),ia=Vt("house",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]]),oa=Vt("brain",[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]]),la=Vt("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]),ca=Vt("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),ua=Vt("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),da=Vt("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),fa=Vt("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),ha=Vt("menu",[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]]),ma=Vt("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]),pa=()=>{var e;const{user:t,logout:a}=It(),{companyName:n}=ta(),{userRole:s,isAdmin:i,isCompanyUser:o,userProfile:l}=(0,r.useContext)(Rt),c=ge(),u=he(),[d,f]=(0,r.useState)(!1),h=(()=>{const e=[{path:"/dashboard",icon:ia,label:"Dashboard"}];return i()?[...e,{path:"/companies",icon:ea,label:"Companies"},{path:"/psychologists",icon:oa,label:"Psychologists"},{path:"/employee-list",icon:la,label:"All Employees"},{path:"/bookings",icon:ca,label:"All Bookings"},{path:"/settings",icon:ua,label:"Settings"}]:o()?[...e,{path:"/employees",icon:la,label:"Employees"}]:[...e,{path:"/bookings",icon:ca,label:"My Bookings"},{path:"/profile",icon:da,label:"Profile"}]})(),m=e=>u.pathname===e;return(0,Pt.jsxs)("header",{className:"header",children:[(0,Pt.jsxs)("div",{className:"header-content",children:[(0,Pt.jsx)("div",{className:"header-left",children:(0,Pt.jsxs)("button",{onClick:()=>c("/dashboard"),className:"home-button",title:n||"ThoughtPro B2B",children:[(0,Pt.jsx)(ia,{size:24,className:"header-icon"}),(0,Pt.jsxs)("div",{className:"company-info",children:[(0,Pt.jsx)("h1",{className:"header-title",children:n||"ThoughtPro B2B"}),n&&n.length>30&&(0,Pt.jsx)("span",{className:"company-subtitle",children:"Executive Dashboard"})]})]})}),(0,Pt.jsxs)("nav",{className:"header-nav",children:[(0,Pt.jsx)("div",{className:"nav-items",children:h.map(e=>{const t=e.icon;return(0,Pt.jsxs)("button",{onClick:()=>c(e.path),className:"nav-item ".concat(m(e.path)?"active":""),children:[(0,Pt.jsx)(t,{size:20}),(0,Pt.jsx)("span",{children:e.label})]},e.path)})}),(0,Pt.jsx)("button",{className:"mobile-menu-toggle",onClick:()=>f(!d),children:d?(0,Pt.jsx)(fa,{size:24}):(0,Pt.jsx)(ha,{size:24})})]}),(0,Pt.jsxs)("div",{className:"header-right",children:[(0,Pt.jsxs)("div",{className:"user-info",children:[(0,Pt.jsx)("span",{className:"user-name",children:(null===t||void 0===t?void 0:t.name)||(null===t||void 0===t||null===(e=t.email)||void 0===e?void 0:e.split("@")[0])||"User"}),(0,Pt.jsxs)("div",{className:"user-details",children:[(0,Pt.jsx)("span",{className:"user-role",children:"admin"===s?"Administrator":"company"===s?"Company User":"Employee"}),(null===l||void 0===l?void 0:l.company_name)&&(0,Pt.jsx)("span",{className:"user-company",children:l.company_name})]})]}),(0,Pt.jsxs)("button",{onClick:()=>{a(),c("/login")},className:"logout-button",children:[(0,Pt.jsx)(ma,{size:20}),(0,Pt.jsx)("span",{children:"Logout"})]})]})]}),d&&(0,Pt.jsx)("div",{className:"mobile-nav",children:h.map(e=>{const t=e.icon;return(0,Pt.jsxs)("button",{onClick:()=>{c(e.path),f(!1)},className:"mobile-nav-item ".concat(m(e.path)?"active":""),children:[(0,Pt.jsx)(t,{size:20}),(0,Pt.jsx)("span",{children:e.label})]},e.path)})})]})},ga=Vt("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]),va=Vt("trending-down",[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]]),ya={primary:"#D27AD5",secondary:"#C841CC",disabled:"#C0C0C0",background:"#0A0A0A",cardBg:"#1A1A1A",text:"#FFFFFF",textSecondary:"#A0A0A0",border:"#2A2A2A",success:"#10B981",warning:"#F59E0B",error:"#EF4444"},ba=e=>{let{value:t,period:a,trend:r,trendValue:n}=e;const s="up"===r;return(0,Pt.jsxs)("div",{className:"metric-card",children:[(0,Pt.jsx)("div",{className:"metric-value",children:t}),(0,Pt.jsx)("div",{className:"metric-period",children:a}),r&&(0,Pt.jsxs)("div",{className:"metric-trend",style:{color:s?ya.success:ya.warning},children:[s?(0,Pt.jsx)(ga,{size:16}):(0,Pt.jsx)(va,{size:16}),(0,Pt.jsx)("span",{className:"trend-value",children:n})]})]})},wa=Vt("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),xa=()=>{const{companyName:e,updateCompanyName:t,settings:a,updateSettings:n}=ta(),[s,i]=(0,r.useState)(e),[o,l]=(0,r.useState)(a),[c,d]=(0,r.useState)(!1);return(0,Pt.jsxs)("div",{className:"custom-dashboard",children:[(0,Pt.jsxs)("div",{className:"settings-header",children:[(0,Pt.jsx)(ua,{size:28,className:"settings-icon"}),(0,Pt.jsx)("h2",{className:"settings-title",children:"Dashboard Settings"})]}),(0,Pt.jsxs)("div",{className:"settings-section",children:[(0,Pt.jsx)("h3",{className:"settings-section-title",children:"Company Information"}),(0,Pt.jsxs)("div",{className:"setting-card",children:[(0,Pt.jsx)("label",{className:"setting-label",children:"Company Name"}),(0,Pt.jsx)("input",{type:"text",value:s,onChange:e=>i(e.target.value),className:"setting-input",placeholder:"Enter company name"}),(0,Pt.jsx)("p",{className:"setting-description",children:"This name will appear in the header"})]})]}),(0,Pt.jsxs)("div",{className:"settings-section",children:[(0,Pt.jsx)("h3",{className:"settings-section-title",children:"Visible Metrics"}),(0,Pt.jsxs)("div",{className:"setting-card",children:[(0,Pt.jsxs)("label",{className:"checkbox-label",children:[(0,Pt.jsx)("input",{type:"checkbox",checked:o.showProductivity,onChange:e=>l(u(u({},o),{},{showProductivity:e.target.checked})),className:"checkbox"}),(0,Pt.jsx)("span",{children:"Show Productivity Score"})]}),(0,Pt.jsxs)("label",{className:"checkbox-label",children:[(0,Pt.jsx)("input",{type:"checkbox",checked:o.showPhoneUsageWeekdays,onChange:e=>l(u(u({},o),{},{showPhoneUsageWeekdays:e.target.checked})),className:"checkbox"}),(0,Pt.jsx)("span",{children:"Show Phone Usage (Weekdays)"})]}),(0,Pt.jsxs)("label",{className:"checkbox-label",children:[(0,Pt.jsx)("input",{type:"checkbox",checked:o.showPhoneUsageWork,onChange:e=>l(u(u({},o),{},{showPhoneUsageWork:e.target.checked})),className:"checkbox"}),(0,Pt.jsx)("span",{children:"Show Phone Usage (Work Hours)"})]})]})]}),(0,Pt.jsxs)("button",{onClick:()=>{t(s),n(o),d(!0),setTimeout(()=>d(!1),2e3)},className:"save-button",children:[(0,Pt.jsx)(wa,{size:20}),(0,Pt.jsx)("span",{children:c?"Saved!":"Save Changes"})]})]})},ka=Vt("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),Sa=Vt("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),Ea=Vt("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),Ta=()=>{const{user:e,logout:t}=It(),[a,n]=(0,r.useState)(!1),s=(0,r.useRef)(null);(0,r.useEffect)(()=>{const e=e=>{s.current&&!s.current.contains(e.target)&&n(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]);return(0,Pt.jsxs)("header",{className:"admin-header",children:[(0,Pt.jsxs)("div",{className:"header-left",children:[(0,Pt.jsx)("h1",{className:"header-title",children:"ThoughtPro"}),(0,Pt.jsx)("span",{className:"header-subtitle",children:"System Administration"})]}),(0,Pt.jsx)("div",{className:"header-right",children:(0,Pt.jsxs)("div",{className:"header-item user-menu",ref:s,children:[(0,Pt.jsxs)("button",{className:"user-menu-btn",onClick:()=>n(!a),children:[(0,Pt.jsx)("div",{className:"user-avatar",children:(0,Pt.jsx)(Sa,{size:20})}),(0,Pt.jsxs)("div",{className:"user-info",children:[(0,Pt.jsx)("span",{className:"user-name",children:(null===e||void 0===e?void 0:e.name)||"System Admin"}),(0,Pt.jsx)("span",{className:"user-role",children:"Administrator"})]}),(0,Pt.jsx)(Ea,{size:16,className:"chevron ".concat(a?"open":"")})]}),a&&(0,Pt.jsxs)("div",{className:"user-dropdown",children:[(0,Pt.jsxs)("div",{className:"dropdown-header",children:[(0,Pt.jsx)("div",{className:"user-avatar large",children:(0,Pt.jsx)(Sa,{size:24})}),(0,Pt.jsxs)("div",{className:"user-details",children:[(0,Pt.jsx)("div",{className:"name",children:(null===e||void 0===e?void 0:e.name)||"System Admin"}),(0,Pt.jsx)("div",{className:"email",children:(null===e||void 0===e?void 0:e.email)||"syneptlabs@gmail.com"})]})]}),(0,Pt.jsx)("div",{className:"dropdown-divider"}),(0,Pt.jsx)("div",{className:"dropdown-menu",children:(0,Pt.jsxs)("button",{className:"dropdown-item logout",onClick:()=>{t()},children:[(0,Pt.jsx)(ma,{size:16}),"Sign Out"]})})]})]})})]})},Na=()=>{const e=ge(),[t,a]=(0,r.useState)({totalCompanies:0,totalEmployees:0,totalPsychologists:0,totalBookings:0,activeSubscriptions:0,lastUpdated:null}),[n,s]=(0,r.useState)(!0);(0,r.useEffect)(()=>{i()},[]);const i=async()=>{try{s(!0),a({totalCompanies:0,totalEmployees:0,totalPsychologists:0,totalBookings:0,activeSubscriptions:0,lastUpdated:new Date})}catch(e){console.error("Error loading dashboard data:",e)}finally{s(!1)}},o=e=>{let{icon:t,title:a,value:r,color:n}=e;return(0,Pt.jsxs)("div",{className:"stat-card ".concat(n),children:[(0,Pt.jsx)("div",{className:"stat-icon",children:(0,Pt.jsx)(t,{size:24})}),(0,Pt.jsxs)("div",{className:"stat-content",children:[(0,Pt.jsx)("h3",{children:r}),(0,Pt.jsx)("p",{children:a})]})]})},l=e=>{let{icon:t,title:a,description:r,onClick:n}=e;return(0,Pt.jsxs)("div",{className:"quick-action",onClick:n,children:[(0,Pt.jsx)("div",{className:"action-icon",children:(0,Pt.jsx)(t,{size:20})}),(0,Pt.jsxs)("div",{className:"action-content",children:[(0,Pt.jsx)("h4",{children:a}),(0,Pt.jsx)("p",{children:r})]})]})};return(0,Pt.jsxs)("div",{className:"admin-dashboard",children:[(0,Pt.jsx)(Ta,{}),(0,Pt.jsxs)("div",{className:"dashboard-content",children:[(0,Pt.jsxs)("div",{className:"dashboard-header",children:[(0,Pt.jsx)("h1",{children:"Admin Dashboard"}),(0,Pt.jsx)("p",{children:"Manage the entire ThoughtPro B2B platform"})]}),(0,Pt.jsxs)("div",{className:"stats-grid",children:[(0,Pt.jsx)(o,{icon:ea,title:"Total Companies",value:n?"...":t.totalCompanies,color:"blue"}),(0,Pt.jsx)(o,{icon:la,title:"Total Employees",value:n?"...":t.totalEmployees,color:"green"}),(0,Pt.jsx)(o,{icon:oa,title:"Psychologists",value:n?"...":t.totalPsychologists,color:"purple"}),(0,Pt.jsx)(o,{icon:ca,title:"Total Bookings",value:n?"...":t.totalBookings,color:"orange"})]}),(0,Pt.jsxs)("div",{className:"dashboard-section",children:[(0,Pt.jsx)("h2",{children:"Quick Actions"}),(0,Pt.jsxs)("div",{className:"quick-actions-grid",children:[(0,Pt.jsx)(l,{icon:ka,title:"Company Management",description:"Register a new company to the platform",onClick:()=>e("/admin/companies/add")}),(0,Pt.jsx)(l,{icon:oa,title:"Psychologist Management",description:"Add a new psychologist to the network",onClick:()=>e("/admin/psychologists/add")})]})]}),(0,Pt.jsxs)("div",{className:"dashboard-section",children:[(0,Pt.jsx)("h2",{children:"Recent Activities"}),(0,Pt.jsxs)("div",{className:"activity-list",children:[(0,Pt.jsxs)("div",{className:"activity-item",children:[(0,Pt.jsx)("div",{className:"activity-icon blue",children:(0,Pt.jsx)(ea,{size:16})}),(0,Pt.jsxs)("div",{className:"activity-content",children:[(0,Pt.jsxs)("p",{children:[(0,Pt.jsx)("strong",{children:"New company registered:"})," Tech Solutions Inc"]}),(0,Pt.jsx)("span",{className:"activity-time",children:"2 hours ago"})]})]}),(0,Pt.jsxs)("div",{className:"activity-item",children:[(0,Pt.jsx)("div",{className:"activity-icon green",children:(0,Pt.jsx)(ca,{size:16})}),(0,Pt.jsxs)("div",{className:"activity-content",children:[(0,Pt.jsxs)("p",{children:[(0,Pt.jsx)("strong",{children:"Booking completed:"})," Employee session with Dr. Smith"]}),(0,Pt.jsx)("span",{className:"activity-time",children:"4 hours ago"})]})]}),(0,Pt.jsxs)("div",{className:"activity-item",children:[(0,Pt.jsx)("div",{className:"activity-icon purple",children:(0,Pt.jsx)(oa,{size:16})}),(0,Pt.jsxs)("div",{className:"activity-content",children:[(0,Pt.jsxs)("p",{children:[(0,Pt.jsx)("strong",{children:"New psychologist added:"})," Dr. Sarah Johnson"]}),(0,Pt.jsx)("span",{className:"activity-time",children:"1 day ago"})]})]})]})]})]})]})};const ja=new class{getMockDashboardData(){return{productivity:{daily:{value:"4",period:"Daily",trend:"down",trendValue:"-2%"},weekly:{value:"9.2",period:"Weekly",trend:"down",trendValue:"-3%"},today:{value:"8.8",period:"Today",trend:"down",trendValue:"-1%"},yesterday:{value:"4.7",period:"Yesterday",trend:"down",trendValue:"-2%"},thisWeek:{value:"3.5",period:"This Week",trend:"down",trendValue:"-4%"}},phoneUsageWeekdays:{daily:{value:"3.45",period:"Daily",trend:"down",trendValue:"-3%"},weekly:{value:"5.26",period:"Weekly",trend:"down",trendValue:"-5%"},today:{value:"2.79",period:"Today",trend:"down",trendValue:"-8%"},yesterday:{value:"4.77",period:"Yesterday",trend:"down",trendValue:"-2%"},thisWeek:{value:"4.60",period:"This Week",trend:"down",trendValue:"-6%"}},phoneUsageWork:{daily:{value:"2.45",period:"Daily",trend:"down",trendValue:"-4%"},weekly:{value:"2.94",period:"Weekly",trend:"down",trendValue:"-3%"},today:{value:"1.64",period:"Today",trend:"down",trendValue:"-7%"},yesterday:{value:"1.42",period:"Yesterday",trend:"down",trendValue:"-5%"},thisWeek:{value:"1.61",period:"This Week",trend:"down",trendValue:"-6%"}}}}async fetchMockData(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:500;return new Promise(t=>{setTimeout(()=>{t(this.getMockDashboardData())},e)})}},Ca=()=>{const[e,t]=(0,r.useState)(null),[a,n]=(0,r.useState)(!0),[s,i]=(0,r.useState)(null),o=async()=>{try{n(!0);const e=await ja.fetchMockData();t(e),i(null)}catch(e){i(e.message),console.error("Error fetching dashboard data:",e)}finally{n(!1)}};return(0,r.useEffect)(()=>{o()},[]),{data:e,loading:a,error:s,refetch:o}};new class{async getDashboardData(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{const t=new URLSearchParams;e&&t.append("companyId",e);return await _t.get("/dashboard/executive-metrics?".concat(t),!1)}catch(t){throw console.error("Failed to fetch dashboard data:",t.message),new Error("Failed to fetch dashboard data")}}async getProductivityMetrics(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"week",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{const a=new URLSearchParams;a.append("range",e),t&&a.append("companyId",t);return await _t.get("/dashboard/productivity?".concat(a))}catch(a){throw console.error("Failed to fetch productivity metrics:",a.message),new Error("Failed to fetch productivity metrics")}}async getPhoneUsageMetrics(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"week",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{const a=new URLSearchParams;a.append("range",e),t&&a.append("companyId",t);return await _t.get("/dashboard/phone-usage?".concat(a))}catch(a){throw console.error("Failed to fetch phone usage metrics:",a.message),new Error("Failed to fetch phone usage metrics")}}async getApplicationsData(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{const t=new URLSearchParams;e&&t.append("companyId",e);return await _t.get("/dashboard/applications?".concat(t))}catch(t){throw console.error("Failed to fetch applications data:",t.message),new Error("Failed to fetch applications data")}}async getExecutiveOverview(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{const t=new URLSearchParams;e&&t.append("companyId",e);return await _t.get("/dashboard/executive-overview?".concat(t))}catch(t){throw console.error("Failed to fetch executive overview:",t.message),new Error("Failed to fetch executive overview")}}async getEmployeeMetrics(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{const t=new URLSearchParams;e&&t.append("companyId",e);return await _t.get("/dashboard/employee-metrics?".concat(t))}catch(t){throw console.error("Failed to fetch employee metrics:",t.message),new Error("Failed to fetch employee metrics")}}async getProductivityInsights(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"week";try{const a=new URLSearchParams;e&&a.append("employee_id",e),a.append("range",t);return await _t.get("/dashboard/productivity-insights?".concat(a))}catch(a){throw console.error("Failed to fetch productivity insights:",a.message),new Error("Failed to fetch productivity insights")}}async getCompanyDashboard(e){try{return await _t.get("/dashboard/company/".concat(e))}catch(t){throw console.error("Failed to fetch company dashboard:",t.message),new Error("Failed to fetch company dashboard")}}async getWellnessMetrics(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"month";try{const a=new URLSearchParams;a.append("period",t),e&&a.append("companyId",e);return await _t.get("/dashboard/wellness?".concat(a))}catch(a){throw console.error("Failed to fetch wellness metrics:",a.message),new Error("Failed to fetch wellness metrics")}}async getBookingAnalytics(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"month";try{const a=new URLSearchParams;a.append("period",t),e&&a.append("companyId",e);return await _t.get("/dashboard/booking-analytics?".concat(a))}catch(a){throw console.error("Failed to fetch booking analytics:",a.message),new Error("Failed to fetch booking analytics")}}async getSubscriptionAnalytics(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"month";try{const a=new URLSearchParams;a.append("period",t),e&&a.append("companyId",e);return await _t.get("/dashboard/subscription-analytics?".concat(a))}catch(a){throw console.error("Failed to fetch subscription analytics:",a.message),new Error("Failed to fetch subscription analytics")}}async getRealtimeStats(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{const t=new URLSearchParams;e&&t.append("companyId",e);return await _t.get("/dashboard/realtime?".concat(t))}catch(t){throw console.error("Failed to fetch realtime stats:",t.message),new Error("Failed to fetch realtime stats")}}async getComprehensiveDashboard(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{const[t,a,r,n,s,i,o,l]=await Promise.allSettled([this.getExecutiveOverview(e),this.getProductivityMetrics("month",e),this.getPhoneUsageMetrics("month",e),this.getWellnessMetrics(e,"month"),this.getBookingAnalytics(e,"month"),this.getSubscriptionAnalytics(e,"month"),this.getEmployeeMetrics(e),this.getRealtimeStats(e)]);return{overview:"fulfilled"===t.status?t.value:null,productivity:"fulfilled"===a.status?a.value:null,phoneUsage:"fulfilled"===r.status?r.value:null,wellness:"fulfilled"===n.status?n.value:null,bookings:"fulfilled"===s.status?s.value:null,subscriptions:"fulfilled"===i.status?i.value:null,employees:"fulfilled"===o.status?o.value:null,realtime:"fulfilled"===l.status?l.value:null,errors:[t,a,r,n,s,i,o,l].filter(e=>"rejected"===e.status).map(e=>{var t;return(null===(t=e.reason)||void 0===t?void 0:t.message)||"Unknown error"})}}catch(t){throw new Error("Failed to fetch comprehensive dashboard data")}}async exportDashboardData(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"pdf",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"month";try{const r=new URLSearchParams;r.append("format",t),r.append("dateRange",a),e&&r.append("companyId",e);return await _t.get("/dashboard/export?".concat(r))}catch(r){throw new Error("Failed to export dashboard data")}}};const _a=()=>{const e="https://thoughtprob2b.thoughthealer.org/api/v1";console.log("\ud83d\udd0d Dashboard Integration Validation"),console.log("\ud83d\udccd Base URL:",e),console.log("\ud83d\udd11 Has Auth Token:",!!localStorage.getItem("token"));const t=["/dashboard/executive-metrics","/dashboard/productivity","/dashboard/phone-usage","/dashboard/applications","/dashboard/executive-overview","/dashboard/employee-metrics"];return console.log("\ud83d\udccb Expected API endpoints:"),t.forEach(t=>{console.log("   \u2022 ".concat(e).concat(t))}),{baseUrl:e,endpoints:t,hasToken:!!localStorage.getItem("token")}},Aa=()=>{const[e,t]=(0,r.useState)("standard"),{data:a,loading:n,error:s}=Ca(),{settings:i}=ta();return(0,r.useEffect)(()=>{_a()},[]),n?(0,Pt.jsxs)("div",{className:"dashboard-container",children:[(0,Pt.jsx)(pa,{}),(0,Pt.jsxs)("div",{className:"loading-container",children:[(0,Pt.jsx)("div",{className:"loading-spinner"}),(0,Pt.jsx)("p",{children:"Loading dashboard data..."})]})]}):s?(0,Pt.jsxs)("div",{className:"dashboard-container",children:[(0,Pt.jsx)(pa,{}),(0,Pt.jsx)("div",{className:"error-container",children:(0,Pt.jsxs)("p",{children:["Error loading dashboard: ",s]})})]}):(0,Pt.jsxs)("div",{className:"dashboard-container",children:[(0,Pt.jsx)(pa,{}),(0,Pt.jsxs)("div",{className:"dashboard-content",children:[(0,Pt.jsx)("div",{className:"dashboard-header",children:(0,Pt.jsxs)("div",{className:"dashboard-header-left",children:[(0,Pt.jsx)("h2",{className:"dashboard-title",children:"Executive Dashboard"}),(0,Pt.jsxs)("div",{className:"dashboard-tabs",children:[(0,Pt.jsx)("button",{onClick:()=>t("standard"),className:"standard"===e?"tab active":"tab",children:"Standard Dashboard"}),(0,Pt.jsx)("button",{onClick:()=>t("custom"),className:"custom"===e?"tab active":"tab",children:"Custom Dashboard"})]})]})}),"custom"===e?(0,Pt.jsx)(xa,{}):(0,Pt.jsxs)(Pt.Fragment,{children:[i.showProductivity&&(0,Pt.jsxs)("div",{className:"section",children:[(0,Pt.jsxs)("div",{className:"section-header",children:[(0,Pt.jsx)(na,{size:24,className:"section-icon"}),(0,Pt.jsx)("div",{className:"section-header-content",children:(0,Pt.jsx)("h3",{className:"section-title",children:"Productivity Score Average"})})]}),(0,Pt.jsxs)("div",{className:"metrics-grid",children:[(0,Pt.jsx)(ba,u({},null===a||void 0===a?void 0:a.productivity.daily)),(0,Pt.jsx)(ba,u({},null===a||void 0===a?void 0:a.productivity.weekly)),(0,Pt.jsx)(ba,u({},null===a||void 0===a?void 0:a.productivity.today)),(0,Pt.jsx)(ba,u({},null===a||void 0===a?void 0:a.productivity.yesterday)),(0,Pt.jsx)(ba,u({},null===a||void 0===a?void 0:a.productivity.thisWeek))]})]}),i.showPhoneUsageWeekdays&&(0,Pt.jsxs)("div",{className:"section",children:[(0,Pt.jsxs)("div",{className:"section-header",children:[(0,Pt.jsx)(sa,{size:24,className:"section-icon"}),(0,Pt.jsx)("div",{className:"section-header-content",children:(0,Pt.jsx)("h3",{className:"section-title",children:"Average Phone Usage on Weekdays"})})]}),(0,Pt.jsxs)("div",{className:"metrics-grid",children:[(0,Pt.jsx)(ba,u({},null===a||void 0===a?void 0:a.phoneUsageWeekdays.daily)),(0,Pt.jsx)(ba,u({},null===a||void 0===a?void 0:a.phoneUsageWeekdays.weekly)),(0,Pt.jsx)(ba,u({},null===a||void 0===a?void 0:a.phoneUsageWeekdays.today)),(0,Pt.jsx)(ba,u({},null===a||void 0===a?void 0:a.phoneUsageWeekdays.yesterday)),(0,Pt.jsx)(ba,u({},null===a||void 0===a?void 0:a.phoneUsageWeekdays.thisWeek))]})]}),i.showPhoneUsageWork&&(0,Pt.jsxs)("div",{className:"section",children:[(0,Pt.jsxs)("div",{className:"section-header",children:[(0,Pt.jsx)(sa,{size:24,className:"section-icon"}),(0,Pt.jsx)("div",{className:"section-header-content",children:(0,Pt.jsx)("h3",{className:"section-title",children:"Average Phone Usage on Work Timings"})})]}),(0,Pt.jsxs)("div",{className:"metrics-grid",children:[(0,Pt.jsx)(ba,u({},null===a||void 0===a?void 0:a.phoneUsageWork.daily)),(0,Pt.jsx)(ba,u({},null===a||void 0===a?void 0:a.phoneUsageWork.weekly)),(0,Pt.jsx)(ba,u({},null===a||void 0===a?void 0:a.phoneUsageWork.today)),(0,Pt.jsx)(ba,u({},null===a||void 0===a?void 0:a.phoneUsageWork.yesterday)),(0,Pt.jsx)(ba,u({},null===a||void 0===a?void 0:a.phoneUsageWork.thisWeek))]})]})]})]})]})},Pa=()=>{const[e,t]=(0,r.useState)("standard"),{data:a,loading:n,error:s}=Ca(),{settings:i}=ta(),{isAdmin:o,isCompanyUser:l}=(0,r.useContext)(Rt);return(0,r.useEffect)(()=>{_a()},[]),n?(0,Pt.jsxs)("div",{className:"dashboard-container",children:[(0,Pt.jsx)(pa,{}),(0,Pt.jsxs)("div",{className:"loading-container",children:[(0,Pt.jsx)("div",{className:"loading-spinner"}),(0,Pt.jsx)("p",{children:"Loading dashboard data..."})]})]}):s?(0,Pt.jsxs)("div",{className:"dashboard-container",children:[(0,Pt.jsx)(pa,{}),(0,Pt.jsx)("div",{className:"error-container",children:(0,Pt.jsxs)("p",{children:["Error loading dashboard: ",s]})})]}):o()?(0,Pt.jsx)(Na,{}):l()?(0,Pt.jsx)(Aa,{}):(0,Pt.jsxs)("div",{className:"dashboard-container",children:[(0,Pt.jsx)(pa,{}),(0,Pt.jsxs)("div",{className:"dashboard-content",children:[(0,Pt.jsx)("div",{className:"dashboard-header",children:(0,Pt.jsxs)("div",{className:"dashboard-header-left",children:[(0,Pt.jsx)("h2",{className:"dashboard-title",children:"Executive Dashboard"}),(0,Pt.jsxs)("div",{className:"dashboard-tabs",children:[(0,Pt.jsx)("button",{onClick:()=>t("standard"),className:"standard"===e?"tab active":"tab",children:"Standard Dashboard"}),(0,Pt.jsx)("button",{onClick:()=>t("custom"),className:"custom"===e?"tab active":"tab",children:"Custom Dashboard"})]})]})}),"custom"===e?(0,Pt.jsx)(xa,{}):(0,Pt.jsxs)(Pt.Fragment,{children:[i.showProductivity&&(0,Pt.jsxs)("div",{className:"section",children:[(0,Pt.jsxs)("div",{className:"section-header",children:[(0,Pt.jsx)(na,{size:24,className:"section-icon"}),(0,Pt.jsx)("div",{className:"section-header-content",children:(0,Pt.jsx)("h3",{className:"section-title",children:"Productivity Score Average"})})]}),(0,Pt.jsxs)("div",{className:"metrics-grid",children:[(0,Pt.jsx)(ba,u(u({},null===a||void 0===a?void 0:a.productivity.daily),{},{period:"Daily"})),(0,Pt.jsx)(ba,u(u({},null===a||void 0===a?void 0:a.productivity.weekly),{},{period:"Weekly"})),(0,Pt.jsx)(ba,u(u({},null===a||void 0===a?void 0:a.productivity.today),{},{period:"Today"})),(0,Pt.jsx)(ba,u(u({},null===a||void 0===a?void 0:a.productivity.yesterday),{},{period:"Yesterday"})),(0,Pt.jsx)(ba,u(u({},null===a||void 0===a?void 0:a.productivity.thisWeek),{},{period:"This Week"}))]})]}),i.showPhoneUsageWeekdays&&(0,Pt.jsxs)("div",{className:"section",children:[(0,Pt.jsxs)("div",{className:"section-header",children:[(0,Pt.jsx)(sa,{size:24,className:"section-icon"}),(0,Pt.jsx)("div",{className:"section-header-content",children:(0,Pt.jsx)("h3",{className:"section-title",children:"Average Phone Usage on Weekdays"})})]}),(0,Pt.jsxs)("div",{className:"metrics-grid",children:[(0,Pt.jsx)(ba,u(u({},null===a||void 0===a?void 0:a.phoneUsageWeekdays.daily),{},{period:"Daily"})),(0,Pt.jsx)(ba,u(u({},null===a||void 0===a?void 0:a.phoneUsageWeekdays.weekly),{},{period:"Weekly"})),(0,Pt.jsx)(ba,u(u({},null===a||void 0===a?void 0:a.phoneUsageWeekdays.today),{},{period:"Today"})),(0,Pt.jsx)(ba,u(u({},null===a||void 0===a?void 0:a.phoneUsageWeekdays.yesterday),{},{period:"Yesterday"})),(0,Pt.jsx)(ba,u(u({},null===a||void 0===a?void 0:a.phoneUsageWeekdays.thisWeek),{},{period:"This Week"}))]})]}),i.showPhoneUsageWork&&(0,Pt.jsxs)("div",{className:"section",children:[(0,Pt.jsxs)("div",{className:"section-header",children:[(0,Pt.jsx)(sa,{size:24,className:"section-icon"}),(0,Pt.jsx)("div",{className:"section-header-content",children:(0,Pt.jsx)("h3",{className:"section-title",children:"Average Phone Usage on Work Timings"})})]}),(0,Pt.jsxs)("div",{className:"metrics-grid",children:[(0,Pt.jsx)(ba,u(u({},null===a||void 0===a?void 0:a.phoneUsageWork.daily),{},{period:"Daily"})),(0,Pt.jsx)(ba,u(u({},null===a||void 0===a?void 0:a.phoneUsageWork.weekly),{},{period:"Weekly"})),(0,Pt.jsx)(ba,u(u({},null===a||void 0===a?void 0:a.phoneUsageWork.today),{},{period:"Today"})),(0,Pt.jsx)(ba,u(u({},null===a||void 0===a?void 0:a.phoneUsageWork.yesterday),{},{period:"Yesterday"})),(0,Pt.jsx)(ba,u(u({},null===a||void 0===a?void 0:a.phoneUsageWork.thisWeek),{},{period:"This Week"}))]})]})]})]})]})},Ra=Vt("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);const Oa=new class{async getAllEmployees(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{const r=new URLSearchParams;r.append("page",e),r.append("limit",t),Object.keys(a).forEach(e=>{a[e]&&r.append(e,a[e])});return await _t.get("/employees?".concat(r))}catch(r){throw console.error("Failed to fetch employees:",r.message),new Error("Failed to fetch employees")}}async getEmployeeById(e){try{return await _t.get("/employees/".concat(e))}catch(t){throw new Error("Failed to fetch employee details")}}async createEmployee(e){try{return await _t.post("/employees",e)}catch(t){throw new Error("Failed to create employee")}}async createEmployeeForCompany(e,t){try{return await _t.post("/companies/".concat(e,"/employees"),t)}catch(a){throw console.error("Employee creation error:",a),400===a.status?a.message&&a.message.includes("duplicate")?new Error("duplicate_email"):a.message&&a.message.includes("validation")?new Error("validation_failed"):new Error("invalid_data"):401===a.status?new Error("unauthorized"):403===a.status?new Error("permission_denied"):a.status>=500?new Error("server_error"):"TypeError"===a.name&&a.message.includes("fetch")?new Error("network_error"):new Error("unknown_error")}}async bulkCreateEmployeesForCompany(e,t){try{return await _t.post("/companies/".concat(e,"/employees/bulk"),{employees:t})}catch(a){throw new Error("Failed to bulk create employees for company")}}async resendEmployeeCredentials(e,t,a){try{return await _t.post("/companies/".concat(e,"/employees/").concat(t,"/resend-credentials"),{personalEmail:a})}catch(r){throw console.error("Resend credentials error:",r),400===r.status?new Error("invalid_email"):401===r.status?new Error("unauthorized"):404===r.status?new Error("employee_not_found"):r.status>=500?new Error("server_error"):"TypeError"===r.name&&r.message.includes("fetch")?new Error("network_error"):new Error("unknown_error")}}async updateEmployee(e,t){try{return await _t.put("/employees/".concat(e),t)}catch(a){throw new Error("Failed to update employee")}}async deleteEmployee(e){try{return await _t.delete("/employees/".concat(e))}catch(t){throw new Error("Failed to delete employee")}}async getEmployeeProfile(e){try{return await _t.get("/employees/".concat(e,"/profile"))}catch(t){throw new Error("Failed to fetch employee profile")}}async updateEmployeeProfile(e,t){try{return await _t.put("/employees/".concat(e,"/profile"),t)}catch(a){throw new Error("Failed to update employee profile")}}async getEmployeeBookings(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all";try{const a=new URLSearchParams;"all"!==t&&a.append("status",t);return await _t.get("/employees/".concat(e,"/bookings?").concat(a))}catch(a){throw new Error("Failed to fetch employee bookings")}}async getEmployeeSubscription(e){try{return await _t.get("/employees/".concat(e,"/subscription"))}catch(t){throw new Error("Failed to fetch employee subscription")}}async getEmployeesByCompany(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100;try{const n=new URLSearchParams;n.append("page",t),n.append("limit",a);const s=await _t.get("/companies/".concat(e,"/employees?").concat(n));if(console.log("Raw API response for employees:",s),s.success&&s.data&&s.data.data){const n={success:!0,data:s.data.data,total:s.data.total,page:s.data.page,limit:s.data.limit,pages:s.data.pages};if(s.data.pages>1&&1===t){console.log("Fetching additional pages: ".concat(s.data.pages-1," more pages"));const t=[...s.data.data];for(let n=2;n<=s.data.pages;n++)try{const r=await this.getEmployeesByCompany(e,n,a);r.success&&r.data&&t.push(...r.data)}catch(r){console.warn("Failed to fetch page ".concat(n,":"),r)}n.data=t,n.total=t.length,console.log("Fetched all employees: ".concat(t.length," total"))}return n}return s}catch(n){throw console.error("Error fetching employees by company:",n),new Error("Failed to fetch employees for company")}}async assignEmployeeToCompany(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"employee";try{return await _t.post("/employees/".concat(e,"/assign-company"),{companyId:t,role:a})}catch(r){throw new Error("Failed to assign employee to company")}}async removeEmployeeFromCompany(e,t){try{return await _t.delete("/companies/".concat(t,"/employees/").concat(e))}catch(a){throw console.error("Error removing employee from company:",a),a}}async bulkCreateEmployees(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{const r=t.map(e=>({name:e.name||"".concat(e.firstName||""," ").concat(e.lastName||"").trim(),personalEmail:e.email,role:e.role||"employee",department:e.department,position:e.position||e.designation,phone:e.phone,employee_id:e.employee_id||e.employeeId,startDate:e.startDate||e.joiningDate,dob:e.dob,gender:e.gender}));if(r.length>20)return this.processBulkEmployeesInBatches(e,r,a);a&&a(30);const n=await _t.post("/companies/".concat(e,"/employees/bulk"),{employees:r});return a&&a(100),n}catch(r){throw console.error("Bulk create employees error:",r),400===r.status?r.message&&r.message.includes("duplicate")?new Error("duplicate_employees"):r.message&&r.message.includes("validation")?new Error("validation_failed"):new Error("invalid_data"):401===r.status?new Error("unauthorized"):403===r.status?new Error("permission_denied"):r.status>=500?new Error("server_error"):"TypeError"===r.name&&r.message.includes("fetch")?new Error("network_error"):new Error("bulk_create_failed")}}async processBulkEmployeesInBatches(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const r=[];for(let i=0;i<t.length;i+=10)r.push(t.slice(i,i+10));const n={success:!0,data:{successful:[],failed:[],total:t.length}};for(let i=0;i<r.length;i++){const t=r[i],o=Math.round((i+1)/r.length*80)+10;a&&a(o);try{const a=await _t.post("/companies/".concat(e,"/employees/bulk"),{employees:t});a.success&&a.data&&(a.data.successful&&n.data.successful.push(...a.data.successful),a.data.failed&&n.data.failed.push(...a.data.failed))}catch(s){console.error("Batch ".concat(i+1," failed:"),s),t.forEach(e=>{n.data.failed.push({employee:e,error:s.message||"Processing failed"})})}i<r.length-1&&await new Promise(e=>setTimeout(e,200))}return a&&a(100),n}async bulkImportEmployees(e,t){try{return await _t.post("/employees/bulk-import",{companyId:e,employees:t})}catch(a){throw new Error("Failed to bulk import employees")}}async exportEmployees(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"csv";try{return await _t.get("/employees/export?companyId=".concat(e,"&format=").concat(t))}catch(a){throw new Error("Failed to export employees")}}async sendTemporaryPassword(e){try{return await _t.post("/employees/".concat(e,"/send-temp-password"))}catch(t){throw new Error("Failed to send temporary password")}}async resetEmployeePassword(e){try{return await _t.post("/employees/".concat(e,"/reset-password"))}catch(t){throw new Error("Failed to reset employee password")}}},Da=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"general";const a=((null===e||void 0===e?void 0:e.message)||e||"").toLowerCase();if(a.includes("network")||a.includes("connection")||a.includes("fetch"))return"Network connection failed. Please check your internet connection and try again.";if(a.includes("unauthorized")||a.includes("401"))return"Session expired. Please log in again to continue.";if(a.includes("permission")||a.includes("forbidden")||a.includes("403"))return"You do not have permission to perform this action.";if(a.includes("validation")||a.includes("invalid"))return"Please check that all required fields are filled correctly.";if(a.includes("duplicate")||a.includes("already exists")||a.includes("conflict"))switch(t){case"employee":return"An employee with this email already exists. Please use a different email.";case"company":return"A company with this name or email already exists. Please use different details.";default:return"This record already exists. Please check your information."}if(a.includes("server")||a.includes("500")||a.includes("503"))return"Server is temporarily unavailable. Please try again in a few minutes.";if(a.includes("not found")||a.includes("404"))return"The requested information could not be found.";if(a.includes("rate limit")||a.includes("too many requests"))return"Too many requests. Please wait a moment and try again.";switch(t){case"employee":return"Unable to process employee request. Please try again or contact support.";case"company":return"Unable to process company request. Please try again or contact support.";case"login":return"Login failed. Please check your credentials and try again.";case"loading":return"Unable to load data. Please try refreshing the page.";case"resend_credentials":return a.includes("invalid_email")?"Invalid email address. Please verify the employee email and try again.":a.includes("employee_not_found")?"Employee not found. Please refresh the page and try again.":"Unable to resend credentials. Please try again or contact support.";case"bulk_create":return a.includes("duplicate_employees")||a.includes("duplicate")?"Some employees already exist with the provided email addresses. Please check for duplicates and try again.":a.includes("validation_failed")?"Invalid employee data. Please check all required fields are properly filled.":a.includes("bulk_create_failed")?"Unable to create employees in bulk. Please try again or create them individually.":"Unable to create employees. Please check your data and try again.";default:return"An unexpected error occurred. Please try again or contact support if the issue persists."}},Fa=["Executive","Engineering","Product","Design","Marketing","Sales","HR","Finance","Operations","Customer Support","Legal","Other"],Ia=Vt("phone",[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]]),La=[{code:"+1",country:"US",flag:"\ud83c\uddfa\ud83c\uddf8",name:"United States"},{code:"+44",country:"GB",flag:"\ud83c\uddec\ud83c\udde7",name:"United Kingdom"},{code:"+91",country:"IN",flag:"\ud83c\uddee\ud83c\uddf3",name:"India"},{code:"+86",country:"CN",flag:"\ud83c\udde8\ud83c\uddf3",name:"China"},{code:"+49",country:"DE",flag:"\ud83c\udde9\ud83c\uddea",name:"Germany"},{code:"+33",country:"FR",flag:"\ud83c\uddeb\ud83c\uddf7",name:"France"},{code:"+81",country:"JP",flag:"\ud83c\uddef\ud83c\uddf5",name:"Japan"},{code:"+82",country:"KR",flag:"\ud83c\uddf0\ud83c\uddf7",name:"South Korea"},{code:"+61",country:"AU",flag:"\ud83c\udde6\ud83c\uddfa",name:"Australia"},{code:"+55",country:"BR",flag:"\ud83c\udde7\ud83c\uddf7",name:"Brazil"},{code:"+7",country:"RU",flag:"\ud83c\uddf7\ud83c\uddfa",name:"Russia"},{code:"+34",country:"ES",flag:"\ud83c\uddea\ud83c\uddf8",name:"Spain"},{code:"+39",country:"IT",flag:"\ud83c\uddee\ud83c\uddf9",name:"Italy"},{code:"+31",country:"NL",flag:"\ud83c\uddf3\ud83c\uddf1",name:"Netherlands"},{code:"+41",country:"CH",flag:"\ud83c\udde8\ud83c\udded",name:"Switzerland"},{code:"+46",country:"SE",flag:"\ud83c\uddf8\ud83c\uddea",name:"Sweden"},{code:"+47",country:"NO",flag:"\ud83c\uddf3\ud83c\uddf4",name:"Norway"},{code:"+45",country:"DK",flag:"\ud83c\udde9\ud83c\uddf0",name:"Denmark"},{code:"+358",country:"FI",flag:"\ud83c\uddeb\ud83c\uddee",name:"Finland"},{code:"+971",country:"AE",flag:"\ud83c\udde6\ud83c\uddea",name:"UAE"},{code:"+966",country:"SA",flag:"\ud83c\uddf8\ud83c\udde6",name:"Saudi Arabia"},{code:"+65",country:"SG",flag:"\ud83c\uddf8\ud83c\uddec",name:"Singapore"},{code:"+852",country:"HK",flag:"\ud83c\udded\ud83c\uddf0",name:"Hong Kong"},{code:"+60",country:"MY",flag:"\ud83c\uddf2\ud83c\uddfe",name:"Malaysia"},{code:"+66",country:"TH",flag:"\ud83c\uddf9\ud83c\udded",name:"Thailand"}],Ma=e=>{let{value:t="",onChange:a,onBlur:n,placeholder:s="Enter phone number",className:i="",error:o="",required:l=!1,disabled:c=!1,name:u="phone",id:d="phone"}=e;const f=e=>{if(!e)return{countryCode:"+1",phoneNumber:""};const t=String(e);if(t.startsWith("+")){const e=La.find(e=>t.startsWith(e.code));if(e)return{countryCode:e.code,phoneNumber:t.substring(e.code.length).replace(/\D/g,"")}}return{countryCode:"+1",phoneNumber:t.replace(/\D/g,"")}},{countryCode:h,phoneNumber:m}=f(t),[p,g]=(0,r.useState)(h),[v,y]=(0,r.useState)(m);r.useEffect(()=>{const{countryCode:e,phoneNumber:a}=f(t);g(e),y(a)},[t]);const b=e=>{a&&(1===a.length?a(e):a({target:{name:u,value:e}}))},w=e=>e?e.length<=3?e:e.length<=6?"".concat(e.slice(0,3),"-").concat(e.slice(3)):"".concat(e.slice(0,3),"-").concat(e.slice(3,6),"-").concat(e.slice(6,10)):"",x=La.find(e=>e.code===p)||La[0];return(0,Pt.jsxs)("div",{className:"phone-input-container ".concat(i," ").concat(o?"error":""," ").concat(c?"disabled":""),children:[(0,Pt.jsxs)("div",{className:"phone-input-wrapper",children:[(0,Pt.jsxs)("div",{className:"country-code-selector",children:[(0,Pt.jsx)("div",{className:"country-display",children:(0,Pt.jsx)("span",{className:"country-code",children:x.code})}),(0,Pt.jsx)("select",{value:p,onChange:e=>(e=>{g(e);const t=v?"".concat(e).concat(v):"";b(t)})(e.target.value),className:"country-code-select",disabled:c,"aria-label":"Country code",children:La.map(e=>(0,Pt.jsxs)("option",{value:e.code,children:[e.code," ",e.name]},e.code))})]}),(0,Pt.jsx)("div",{className:"separator"}),(0,Pt.jsxs)("div",{className:"phone-number-input",children:[(0,Pt.jsx)("input",{id:d,name:u,type:"tel",value:w(v),onChange:e=>{const t=e.target.value.replace(/\D/g,"").slice(0,10);y(t);const a=t?"".concat(p).concat(t):"";b(a)},onKeyPress:e=>{/[0-9]/.test(e.key)||["Backspace","Delete","Tab","Escape","Enter","ArrowLeft","ArrowRight"].includes(e.key)||e.preventDefault()},onBlur:n,placeholder:s,className:"phone-number-field",disabled:c,required:l,maxLength:12,autoComplete:"tel","aria-describedby":o?"".concat(d,"-error"):void 0}),(0,Pt.jsx)(Ia,{size:16,className:"phone-icon"})]})]}),v&&v.length>=10&&(0,Pt.jsxs)("div",{className:"phone-preview",children:[(0,Pt.jsx)("span",{className:"preview-label",children:"Full number:"}),(0,Pt.jsxs)("span",{className:"preview-number",children:[p," ",w(v)]})]}),o&&(0,Pt.jsx)("div",{id:"".concat(d,"-error"),className:"phone-input-error",role:"alert",children:o}),!o&&(0,Pt.jsx)("div",{className:"phone-input-help",children:"Enter up to 10 digits"})]})},za=()=>{const[e,t]=(0,r.useState)(""),[a,n]=(0,r.useState)(""),[s,i]=(0,r.useState)(""),[o,l]=(0,r.useState)(""),[c,d]=(0,r.useState)(""),[f,h]=(0,r.useState)(!1),[m,p]=(0,r.useState)(!1),[g,v]=(0,r.useState)(!1),[y,b]=(0,r.useState)(null),w=ge(),[x]=St();(0,r.useEffect)(()=>{const e=x.get("id");if(e){const a=JSON.parse(localStorage.getItem("employees")||"[]").find(t=>t.id===e);a&&(t(a.name),n(a.email||""),i(a.department||""),l(a.phone||""),v(!0),b(e))}},[x]);return(0,Pt.jsxs)("div",{className:"add-employee-container",children:[(0,Pt.jsx)(pa,{}),(0,Pt.jsxs)("div",{className:"add-employee-content",children:[(0,Pt.jsxs)("div",{className:"add-employee-header",children:[(0,Pt.jsxs)("button",{onClick:()=>{w("/employee-list")},className:"back-button",children:[(0,Pt.jsx)(Ra,{size:20}),(0,Pt.jsx)("span",{children:"Back to Employee List"})]}),(0,Pt.jsxs)("div",{className:"page-title-section",children:[(0,Pt.jsx)(da,{size:32,className:"page-icon"}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("h1",{className:"page-title",children:g?"Edit Employee":"Add New Employee"}),(0,Pt.jsx)("p",{className:"page-subtitle",children:g?"Update employee information below":"Enter employee information below"})]})]})]}),(0,Pt.jsx)("div",{className:"employee-form-container",children:(0,Pt.jsxs)("form",{onSubmit:async r=>{if(r.preventDefault(),d(""),p(!1),!e.trim())return void d("Please enter employee name");if(!a.trim())return void d("Please enter employee email");if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a))return void d("Please enter a valid email address");if(!s.trim())return void d("Please select a department");let c=o.replace(/\D/g,"");if(c.length>10&&(c=c.slice(-10)),c&&0!==c.length)if(10===c.length){h(!0);try{const r=At.getStoredCompanyId();if(!r)return void d("Company ID not found. Please login again.");const c={name:e.trim(),personalEmail:a.trim(),role:"employee",department:s.trim(),position:s.trim(),employee_id:"EMP".concat(Date.now()),phone:o.replace(/\D/g,"")};if(g&&y){const t=JSON.parse(localStorage.getItem("employees")||"[]").map(t=>t.id===y?u(u({},t),{},{name:e.trim(),email:a.trim(),department:s.trim(),phone:o.replace(/\D/g,"")}):t);localStorage.setItem("employees",JSON.stringify(t))}else try{const e=await Oa.createEmployeeForCompany(r,c);console.log("Employee created successfully:",e)}catch(f){console.warn("API call failed:",f.message);const e=Da(f,"employee");return void d(e)}p(!0),g||(t(""),n(""),i(""),l("")),setTimeout(()=>{w("/employee-list")},1500)}catch(m){console.error("Employee creation error:",m),d("Failed to create employee. Please try again.")}finally{h(!1)}}else d("Phone number must be exactly 10 digits (currently ".concat(c.length," digits)"));else d("Please enter phone number")},className:"employee-form",children:[(0,Pt.jsxs)("div",{className:"input-group",children:[(0,Pt.jsx)("label",{className:"label",children:"Employee Name"}),(0,Pt.jsx)("input",{type:"text",value:e,onChange:e=>t(e.target.value),placeholder:"Enter full name",className:"input",disabled:f,maxLength:50})]}),(0,Pt.jsxs)("div",{className:"input-group",children:[(0,Pt.jsx)("label",{className:"label",children:"Email"}),(0,Pt.jsx)("input",{type:"email",value:a,onChange:e=>n(e.target.value),placeholder:"Enter email address",className:"input",disabled:f})]}),(0,Pt.jsxs)("div",{className:"input-group",children:[(0,Pt.jsx)("label",{className:"label",children:"Phone Number"}),(0,Pt.jsx)(Ma,{value:o,onChange:l,disabled:f,placeholder:"Enter phone number"}),c&&c.includes("phone")&&(0,Pt.jsx)("div",{className:"field-error",children:c})]}),(0,Pt.jsxs)("div",{className:"input-group",children:[(0,Pt.jsx)("label",{className:"label",children:"Department"}),(0,Pt.jsxs)("select",{value:s,onChange:e=>i(e.target.value),className:"input",disabled:f,children:[(0,Pt.jsx)("option",{value:"",children:"Select Department"}),Fa.map(e=>(0,Pt.jsx)("option",{value:e,children:e},e))]})]}),c&&!c.includes("phone")&&(0,Pt.jsx)("div",{className:"error-message",children:c}),m&&(0,Pt.jsxs)("div",{className:"success-message",children:["Employee ",g?"updated":"created"," successfully! Redirecting to employee list"]}),(0,Pt.jsxs)("button",{type:"submit",className:"submit-button",disabled:f||m,children:[(0,Pt.jsx)(wa,{size:20}),(0,Pt.jsx)("span",{children:f?g?"Updating Employee...":"Creating Employee...":g?"Update Employee":"Create Employee"})]})]})})]})]})},Ua=Vt("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),Ba=Vt("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),Wa=Vt("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]),Ha=Vt("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]),Va=Vt("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]),Ga=Vt("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]),$a=Vt("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),qa=Vt("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),Ya=Vt("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]),Xa=Vt("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);var Ka={version:"0.18.5"},Ja=1200,Qa=1252,Za=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],er={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},tr=function(e){-1!=Za.indexOf(e)&&(Qa=er[0]=e)};var ar=function(e){Ja=e,tr(e)};function rr(){ar(1200),tr(1252)}function nr(e){for(var t=[],a=0,r=e.length;a<r;++a)t[a]=e.charCodeAt(a);return t}function sr(e){for(var t=[],a=0;a<e.length>>1;++a)t[a]=String.fromCharCode(e.charCodeAt(2*a+1)+(e.charCodeAt(2*a)<<8));return t.join("")}var ir,or=function(e){var t=e.charCodeAt(0),a=e.charCodeAt(1);return 255==t&&254==a?function(e){for(var t=[],a=0;a<e.length>>1;++a)t[a]=String.fromCharCode(e.charCodeAt(2*a)+(e.charCodeAt(2*a+1)<<8));return t.join("")}(e.slice(2)):254==t&&255==a?sr(e.slice(2)):65279==t?e.slice(1):e},lr=function(e){return String.fromCharCode(e)},cr=function(e){return String.fromCharCode(e)};var ur="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function dr(e){for(var t="",a=0,r=0,n=0,s=0,i=0,o=0,l=0,c=0;c<e.length;)s=(a=e.charCodeAt(c++))>>2,i=(3&a)<<4|(r=e.charCodeAt(c++))>>4,o=(15&r)<<2|(n=e.charCodeAt(c++))>>6,l=63&n,isNaN(r)?o=l=64:isNaN(n)&&(l=64),t+=ur.charAt(s)+ur.charAt(i)+ur.charAt(o)+ur.charAt(l);return t}function fr(e){var t="",a=0,r=0,n=0,s=0,i=0,o=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<e.length;)a=ur.indexOf(e.charAt(l++))<<2|(s=ur.indexOf(e.charAt(l++)))>>4,t+=String.fromCharCode(a),r=(15&s)<<4|(i=ur.indexOf(e.charAt(l++)))>>2,64!==i&&(t+=String.fromCharCode(r)),n=(3&i)<<6|(o=ur.indexOf(e.charAt(l++))),64!==o&&(t+=String.fromCharCode(n));return t}var hr=function(){return"undefined"!==typeof Buffer&&"undefined"!==typeof process&&"undefined"!==typeof process.versions&&!!process.versions.node}(),mr=function(){if("undefined"!==typeof Buffer){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch(Ig){e=!0}return e?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function pr(e){return hr?Buffer.alloc?Buffer.alloc(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}function gr(e){return hr?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}var vr=function(e){return hr?mr(e,"binary"):e.split("").map(function(e){return 255&e.charCodeAt(0)})};function yr(e){if("undefined"===typeof ArrayBuffer)return vr(e);for(var t=new ArrayBuffer(e.length),a=new Uint8Array(t),r=0;r!=e.length;++r)a[r]=255&e.charCodeAt(r);return t}function br(e){if(Array.isArray(e))return e.map(function(e){return String.fromCharCode(e)}).join("");for(var t=[],a=0;a<e.length;++a)t[a]=String.fromCharCode(e[a]);return t.join("")}function wr(e){if("undefined"==typeof ArrayBuffer)throw new Error("Unsupported");if(e instanceof ArrayBuffer)return wr(new Uint8Array(e));for(var t=new Array(e.length),a=0;a<e.length;++a)t[a]=e[a];return t}var xr=hr?function(e){return Buffer.concat(e.map(function(e){return Buffer.isBuffer(e)?e:mr(e)}))}:function(e){if("undefined"!==typeof Uint8Array){var t=0,a=0;for(t=0;t<e.length;++t)a+=e[t].length;var r=new Uint8Array(a),n=0;for(t=0,a=0;t<e.length;a+=n,++t)if(n=e[t].length,e[t]instanceof Uint8Array)r.set(e[t],a);else{if("string"==typeof e[t])throw"wtf";r.set(new Uint8Array(e[t]),a)}return r}return[].concat.apply([],e.map(function(e){return Array.isArray(e)?e:[].slice.call(e)}))};var kr=/\u0000/g,Sr=/[\u0001-\u0006]/g;function Er(e){for(var t="",a=e.length-1;a>=0;)t+=e.charAt(a--);return t}function Tr(e,t){var a=""+e;return a.length>=t?a:Un("0",t-a.length)+a}function Nr(e,t){var a=""+e;return a.length>=t?a:Un(" ",t-a.length)+a}function jr(e,t){var a=""+e;return a.length>=t?a:a+Un(" ",t-a.length)}var Cr=Math.pow(2,32);function _r(e,t){return e>Cr||e<-Cr?function(e,t){var a=""+Math.round(e);return a.length>=t?a:Un("0",t-a.length)+a}(e,t):function(e,t){var a=""+e;return a.length>=t?a:Un("0",t-a.length)+a}(Math.round(e),t)}function Ar(e,t){return t=t||0,e.length>=7+t&&103===(32|e.charCodeAt(t))&&101===(32|e.charCodeAt(t+1))&&110===(32|e.charCodeAt(t+2))&&101===(32|e.charCodeAt(t+3))&&114===(32|e.charCodeAt(t+4))&&97===(32|e.charCodeAt(t+5))&&108===(32|e.charCodeAt(t+6))}var Pr=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Rr=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];var Or={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "'},Dr={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Fr={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Ir(e,t,a){for(var r=e<0?-1:1,n=e*r,s=0,i=1,o=0,l=1,c=0,u=0,d=Math.floor(n);c<t&&(o=(d=Math.floor(n))*i+s,u=d*c+l,!(n-d<5e-8));)n=1/(n-d),s=i,i=o,l=c,c=u;if(u>t&&(c>t?(u=l,o=s):(u=c,o=i)),!a)return[0,r*o,u];var f=Math.floor(r*o/u);return[f,r*o-f*u,u]}function Lr(e,t,a){if(e>2958465||e<0)return null;var r=0|e,n=Math.floor(86400*(e-r)),s=0,i=[],o={D:r,T:n,u:86400*(e-r)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(r+=1462),o.u>.9999&&(o.u=0,86400==++n&&(o.T=n=0,++r,++o.D)),60===r)i=a?[1317,10,29]:[1900,2,29],s=3;else if(0===r)i=a?[1317,8,29]:[1900,1,0],s=6;else{r>60&&--r;var l=new Date(1900,0,1);l.setDate(l.getDate()+r-1),i=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),r<60&&(s=(s+6)%7),a&&(s=function(e,t){t[0]-=581;var a=e.getDay();e<60&&(a=(a+6)%7);return a}(l,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=n%60,n=Math.floor(n/60),o.M=n%60,n=Math.floor(n/60),o.H=n,o.q=s,o}var Mr=new Date(1899,11,31,0,0,0),zr=Mr.getTime(),Ur=new Date(1900,2,1,0,0,0);function Br(e,t){var a=e.getTime();return t?a-=1262304e5:e>=Ur&&(a+=864e5),(a-(zr+6e4*(e.getTimezoneOffset()-Mr.getTimezoneOffset())))/864e5}function Wr(e){return-1==e.indexOf(".")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Hr(e){var t,a=Math.floor(Math.log(Math.abs(e))*Math.LOG10E);return t=a>=-4&&a<=-1?e.toPrecision(10+a):Math.abs(a)<=9?function(e){var t=e<0?12:11,a=Wr(e.toFixed(12));return a.length<=t||(a=e.toPrecision(10)).length<=t?a:e.toExponential(5)}(e):10===a?e.toFixed(10).substr(0,12):function(e){var t=Wr(e.toFixed(11));return t.length>(e<0?12:11)||"0"===t||"-0"===t?e.toPrecision(6):t}(e),Wr(function(e){return-1==e.indexOf("E")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}(t.toUpperCase()))}function Vr(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):Hr(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return fn(14,Br(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Gr(e,t,a,r){var n,s="",i=0,o=0,l=a.y,c=0;switch(e){case 98:l=a.y+543;case 121:switch(t.length){case 1:case 2:n=l%100,c=2;break;default:n=l%1e4,c=4}break;case 109:switch(t.length){case 1:case 2:n=a.m,c=t.length;break;case 3:return Rr[a.m-1][1];case 5:return Rr[a.m-1][0];default:return Rr[a.m-1][2]}break;case 100:switch(t.length){case 1:case 2:n=a.d,c=t.length;break;case 3:return Pr[a.q][0];default:return Pr[a.q][1]}break;case 104:switch(t.length){case 1:case 2:n=1+(a.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:n=a.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:n=a.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==a.u||"s"!=t&&"ss"!=t?(o=r>=2?3===r?1e3:100:1===r?10:1,(i=Math.round(o*(a.S+a.u)))>=60*o&&(i=0),"s"===t?0===i?"0":""+i/o:(s=Tr(i,2+r),"ss"===t?s.substr(0,2):"."+s.substr(2,t.length-1))):Tr(a.S,t.length);case 90:switch(t){case"[h]":case"[hh]":n=24*a.D+a.H;break;case"[m]":case"[mm]":n=60*(24*a.D+a.H)+a.M;break;case"[s]":case"[ss]":n=60*(60*(24*a.D+a.H)+a.M)+Math.round(a.S+a.u);break;default:throw"bad abstime format: "+t}c=3===t.length?1:2;break;case 101:n=l,c=1}return c>0?Tr(n,c):""}function $r(e){if(e.length<=3)return e;for(var t=e.length%3,a=e.substr(0,t);t!=e.length;t+=3)a+=(a.length>0?",":"")+e.substr(t,3);return a}var qr=/%/g;function Yr(e,t){var a,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+Yr(e,-t);var n=e.indexOf(".");-1===n&&(n=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%n;if(s<0&&(s+=n),-1===(a=(t/Math.pow(10,s)).toPrecision(r+1+(n+s)%n)).indexOf("e")){var i=Math.floor(Math.log(t)*Math.LOG10E);for(-1===a.indexOf(".")?a=a.charAt(0)+"."+a.substr(1)+"E+"+(i-a.length+s):a+="E+"+(i-s);"0."===a.substr(0,2);)a=(a=a.charAt(0)+a.substr(2,n)+"."+a.substr(2+n)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,a,r){return t+a+r.substr(0,(n+s)%n)+"."+r.substr(s)+"E"})}else a=t.toExponential(r);return e.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),e.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}var Xr=/# (\?+)( ?)\/( ?)(\d+)/;var Kr=/^#*0*\.([0#]+)/,Jr=/\).*[0#]/,Qr=/\(###\) ###\\?-####/;function Zr(e){for(var t,a="",r=0;r!=e.length;++r)switch(t=e.charCodeAt(r)){case 35:break;case 63:a+=" ";break;case 48:a+="0";break;default:a+=String.fromCharCode(t)}return a}function en(e,t){var a=Math.pow(10,t);return""+Math.round(e*a)/a}function tn(e,t){var a=e-Math.floor(e),r=Math.pow(10,t);return t<(""+Math.round(a*r)).length?0:Math.round(a*r)}function an(e,t,a){if(40===e.charCodeAt(0)&&!t.match(Jr)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return a>=0?an("n",r,a):"("+an("n",r,-a)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,a){for(var r=t.length-1;44===t.charCodeAt(r-1);)--r;return sn(e,t.substr(0,r),a/Math.pow(10,3*(t.length-r)))}(e,t,a);if(-1!==t.indexOf("%"))return function(e,t,a){var r=t.replace(qr,""),n=t.length-r.length;return sn(e,r,a*Math.pow(10,2*n))+Un("%",n)}(e,t,a);if(-1!==t.indexOf("E"))return Yr(t,a);if(36===t.charCodeAt(0))return"$"+an(e,t.substr(" "==t.charAt(1)?2:1),a);var n,s,i,o,l=Math.abs(a),c=a<0?"-":"";if(t.match(/^00+$/))return c+_r(l,t.length);if(t.match(/^[#?]+$/))return"0"===(n=_r(a,0))&&(n=""),n.length>t.length?n:Zr(t.substr(0,t.length-n.length))+n;if(s=t.match(Xr))return function(e,t,a){var r=parseInt(e[4],10),n=Math.round(t*r),s=Math.floor(n/r),i=n-s*r,o=r;return a+(0===s?"":""+s)+" "+(0===i?Un(" ",e[1].length+1+e[4].length):Nr(i,e[1].length)+e[2]+"/"+e[3]+Tr(o,e[4].length))}(s,l,c);if(t.match(/^#+0+$/))return c+_r(l,t.length-t.indexOf("0"));if(s=t.match(Kr))return n=en(a,s[1].length).replace(/^([^\.]+)$/,"$1."+Zr(s[1])).replace(/\.$/,"."+Zr(s[1])).replace(/\.(\d*)$/,function(e,t){return"."+t+Un("0",Zr(s[1]).length-t.length)}),-1!==t.indexOf("0.")?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+en(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+$r(_r(l,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return a<0?"-"+an(e,t,-a):$r(""+(Math.floor(a)+function(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}(a,s[1].length)))+"."+Tr(tn(a,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return an(e,t.replace(/^#,#*,/,""),a);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Er(an(e,t.replace(/[\\-]/g,""),a)),i=0,Er(Er(t.replace(/\\/g,"")).replace(/[0#]/g,function(e){return i<n.length?n.charAt(i++):"0"===e?"0":""}));if(t.match(Qr))return"("+(n=an(e,"##########",a)).substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=Ir(l,Math.pow(10,i)-1,!1),n=""+c," "==(u=sn("n",s[1],o[1])).charAt(u.length-1)&&(u=u.substr(0,u.length-1)+"0"),n+=u+s[2]+"/"+s[3],(u=jr(o[2],i)).length<s[4].length&&(u=Zr(s[4].substr(s[4].length-u.length))+u),n+=u;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),c+((o=Ir(l,Math.pow(10,i)-1,!0))[0]||(o[1]?"":"0"))+" "+(o[1]?Nr(o[1],i)+s[2]+"/"+s[3]+jr(o[2],i):Un(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return n=_r(a,0),t.length<=n.length?n:Zr(t.substr(0,t.length-n.length))+n;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){n=""+a.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=n.indexOf(".");var d=t.indexOf(".")-i,f=t.length-n.length-d;return Zr(t.substr(0,d)+n+t.substr(t.length-f))}if(s=t.match(/^00,000\.([#0]*0)$/))return i=tn(a,s[1].length),a<0?"-"+an(e,t,-a):$r(function(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}(a)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?Tr(0,3-e.length):"")+e})+"."+Tr(i,s[1].length);switch(t){case"###,##0.00":return an(e,"#,##0.00",a);case"###,###":case"##,###":case"#,###":var h=$r(_r(l,0));return"0"!==h?c+h:"";case"###,###.00":return an(e,"###,##0.00",a).replace(/^0\./,".");case"#,###.00":return an(e,"#,##0.00",a).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function rn(e,t){var a,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+rn(e,-t);var n=e.indexOf(".");-1===n&&(n=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%n;if(s<0&&(s+=n),!(a=(t/Math.pow(10,s)).toPrecision(r+1+(n+s)%n)).match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);-1===a.indexOf(".")?a=a.charAt(0)+"."+a.substr(1)+"E+"+(i-a.length+s):a+="E+"+(i-s),a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,a,r){return t+a+r.substr(0,(n+s)%n)+"."+r.substr(s)+"E"})}else a=t.toExponential(r);return e.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),e.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}function nn(e,t,a){if(40===e.charCodeAt(0)&&!t.match(Jr)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return a>=0?nn("n",r,a):"("+nn("n",r,-a)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,a){for(var r=t.length-1;44===t.charCodeAt(r-1);)--r;return sn(e,t.substr(0,r),a/Math.pow(10,3*(t.length-r)))}(e,t,a);if(-1!==t.indexOf("%"))return function(e,t,a){var r=t.replace(qr,""),n=t.length-r.length;return sn(e,r,a*Math.pow(10,2*n))+Un("%",n)}(e,t,a);if(-1!==t.indexOf("E"))return rn(t,a);if(36===t.charCodeAt(0))return"$"+nn(e,t.substr(" "==t.charAt(1)?2:1),a);var n,s,i,o,l=Math.abs(a),c=a<0?"-":"";if(t.match(/^00+$/))return c+Tr(l,t.length);if(t.match(/^[#?]+$/))return n=""+a,0===a&&(n=""),n.length>t.length?n:Zr(t.substr(0,t.length-n.length))+n;if(s=t.match(Xr))return function(e,t,a){return a+(0===t?"":""+t)+Un(" ",e[1].length+2+e[4].length)}(s,l,c);if(t.match(/^#+0+$/))return c+Tr(l,t.length-t.indexOf("0"));if(s=t.match(Kr))return n=(n=(""+a).replace(/^([^\.]+)$/,"$1."+Zr(s[1])).replace(/\.$/,"."+Zr(s[1]))).replace(/\.(\d*)$/,function(e,t){return"."+t+Un("0",Zr(s[1]).length-t.length)}),-1!==t.indexOf("0.")?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+$r(""+l);if(s=t.match(/^#,##0\.([#0]*0)$/))return a<0?"-"+nn(e,t,-a):$r(""+a)+"."+Un("0",s[1].length);if(s=t.match(/^#,#*,#0/))return nn(e,t.replace(/^#,#*,/,""),a);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Er(nn(e,t.replace(/[\\-]/g,""),a)),i=0,Er(Er(t.replace(/\\/g,"")).replace(/[0#]/g,function(e){return i<n.length?n.charAt(i++):"0"===e?"0":""}));if(t.match(Qr))return"("+(n=nn(e,"##########",a)).substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=Ir(l,Math.pow(10,i)-1,!1),n=""+c," "==(u=sn("n",s[1],o[1])).charAt(u.length-1)&&(u=u.substr(0,u.length-1)+"0"),n+=u+s[2]+"/"+s[3],(u=jr(o[2],i)).length<s[4].length&&(u=Zr(s[4].substr(s[4].length-u.length))+u),n+=u;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),c+((o=Ir(l,Math.pow(10,i)-1,!0))[0]||(o[1]?"":"0"))+" "+(o[1]?Nr(o[1],i)+s[2]+"/"+s[3]+jr(o[2],i):Un(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return n=""+a,t.length<=n.length?n:Zr(t.substr(0,t.length-n.length))+n;if(s=t.match(/^([#0]+)\.([#0]+)$/)){n=""+a.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=n.indexOf(".");var d=t.indexOf(".")-i,f=t.length-n.length-d;return Zr(t.substr(0,d)+n+t.substr(t.length-f))}if(s=t.match(/^00,000\.([#0]*0)$/))return a<0?"-"+nn(e,t,-a):$r(""+a).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?Tr(0,3-e.length):"")+e})+"."+Tr(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var h=$r(""+l);return"0"!==h?c+h:"";default:if(t.match(/\.[0#?]*$/))return nn(e,t.slice(0,t.lastIndexOf(".")),a)+Zr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function sn(e,t,a){return(0|a)===a?nn(e,t,a):an(e,t,a)}var on=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function ln(e){for(var t=0,a="",r="";t<e.length;)switch(a=e.charAt(t)){case"G":Ar(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;);++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4e0a":if("A/P"===e.substr(t,3).toUpperCase())return!0;if("AM/PM"===e.substr(t,5).toUpperCase())return!0;if("\u4e0a\u5348/\u4e0b\u5348"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(r=a;"]"!==e.charAt(t++)&&t<e.length;)r+=e.charAt(t);if(r.match(on))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(a=e.charAt(++t))>-1||"\\"==a&&"-"==e.charAt(t+1)&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===a;);break;case"*":++t," "!=e.charAt(t)&&"*"!=e.charAt(t)||++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;default:++t}return!1}var cn=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function un(e,t){if(null==t)return!1;var a=parseFloat(t[2]);switch(t[1]){case"=":if(e==a)return!0;break;case">":if(e>a)return!0;break;case"<":if(e<a)return!0;break;case"<>":if(e!=a)return!0;break;case">=":if(e>=a)return!0;break;case"<=":if(e<=a)return!0}return!1}function dn(e,t){var a=function(e){for(var t=[],a=!1,r=0,n=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:a=!a;break;case 95:case 42:case 92:++r;break;case 59:t[t.length]=e.substr(n,r-n),n=r+1}if(t[t.length]=e.substr(n),!0===a)throw new Error("Format |"+e+"| unterminated string ");return t}(e),r=a.length,n=a[r-1].indexOf("@");if(r<4&&n>-1&&--r,a.length>4)throw new Error("cannot find right format for |"+a.join("|")+"|");if("number"!==typeof t)return[4,4===a.length||n>-1?a[a.length-1]:"@"];switch(a.length){case 1:a=n>-1?["General","General","General",a[0]]:[a[0],a[0],a[0],"@"];break;case 2:a=n>-1?[a[0],a[0],a[0],a[1]]:[a[0],a[1],a[0],"@"];break;case 3:a=n>-1?[a[0],a[1],a[0],a[2]]:[a[0],a[1],a[2],"@"]}var s=t>0?a[0]:t<0?a[1]:a[2];if(-1===a[0].indexOf("[")&&-1===a[1].indexOf("["))return[r,s];if(null!=a[0].match(/\[[=<>]/)||null!=a[1].match(/\[[=<>]/)){var i=a[0].match(cn),o=a[1].match(cn);return un(t,i)?[r,a[0]]:un(t,o)?[r,a[1]]:[r,a[null!=i&&null!=o?2:1]]}return[r,s]}function fn(e,t,a){null==a&&(a={});var r="";switch(typeof e){case"string":r="m/d/yy"==e&&a.dateNF?a.dateNF:e;break;case"number":null==(r=14==e&&a.dateNF?a.dateNF:(null!=a.table?a.table:Or)[e])&&(r=a.table&&a.table[Dr[e]]||Or[Dr[e]]),null==r&&(r=Fr[e]||"General")}if(Ar(r,0))return Vr(t,a);t instanceof Date&&(t=Br(t,a.date1904));var n=dn(r,t);if(Ar(n[1]))return Vr(t,a);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else if(""===t||null==t)return"";return function(e,t,a,r){for(var n,s,i,o=[],l="",c=0,u="",d="t",f="H";c<e.length;)switch(u=e.charAt(c)){case"G":if(!Ar(e,c))throw new Error("unrecognized character "+u+" in "+e);o[o.length]={t:"G",v:"General"},c+=7;break;case'"':for(l="";34!==(i=e.charCodeAt(++c))&&c<e.length;)l+=String.fromCharCode(i);o[o.length]={t:"t",v:l},++c;break;case"\\":var h=e.charAt(++c),m="("===h||")"===h?h:"t";o[o.length]={t:m,v:h},++c;break;case"_":o[o.length]={t:"t",v:" "},c+=2;break;case"@":o[o.length]={t:"T",v:t},++c;break;case"B":case"b":if("1"===e.charAt(c+1)||"2"===e.charAt(c+1)){if(null==n&&null==(n=Lr(t,a,"2"===e.charAt(c+1))))return"";o[o.length]={t:"X",v:e.substr(c,2)},d=u,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0)return"";if(null==n&&null==(n=Lr(t,a)))return"";for(l=u;++c<e.length&&e.charAt(c).toLowerCase()===u;)l+=u;"m"===u&&"h"===d.toLowerCase()&&(u="M"),"h"===u&&(u=f),o[o.length]={t:u,v:l},d=u;break;case"A":case"a":case"\u4e0a":var p={t:u,v:u};if(null==n&&(n=Lr(t,a)),"A/P"===e.substr(c,3).toUpperCase()?(null!=n&&(p.v=n.H>=12?"P":"A"),p.t="T",f="h",c+=3):"AM/PM"===e.substr(c,5).toUpperCase()?(null!=n&&(p.v=n.H>=12?"PM":"AM"),p.t="T",c+=5,f="h"):"\u4e0a\u5348/\u4e0b\u5348"===e.substr(c,5).toUpperCase()?(null!=n&&(p.v=n.H>=12?"\u4e0b\u5348":"\u4e0a\u5348"),p.t="T",c+=5,f="h"):(p.t="t",++c),null==n&&"T"===p.t)return"";o[o.length]=p,d=u;break;case"[":for(l=u;"]"!==e.charAt(c++)&&c<e.length;)l+=e.charAt(c);if("]"!==l.slice(-1))throw'unterminated "[" block: |'+l+"|";if(l.match(on)){if(null==n&&null==(n=Lr(t,a)))return"";o[o.length]={t:"Z",v:l.toLowerCase()},d=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",ln(e)||(o[o.length]={t:"t",v:l}));break;case".":if(null!=n){for(l=u;++c<e.length&&"0"===(u=e.charAt(c));)l+=u;o[o.length]={t:"s",v:l};break}case"0":case"#":for(l=u;++c<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(c))>-1;)l+=u;o[o.length]={t:"n",v:l};break;case"?":for(l=u;e.charAt(++c)===u;)l+=u;o[o.length]={t:u,v:l},d=u;break;case"*":++c," "!=e.charAt(c)&&"*"!=e.charAt(c)||++c;break;case"(":case")":o[o.length]={t:1===r?"t":u,v:u},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=u;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)l+=e.charAt(c);o[o.length]={t:"D",v:l};break;case" ":o[o.length]={t:u,v:u},++c;break;case"$":o[o.length]={t:"t",v:"$"},++c;break;default:if(-1===",$-+/():!^&'~{}<>=\u20acacfijklopqrtuvwxzP".indexOf(u))throw new Error("unrecognized character "+u+" in "+e);o[o.length]={t:"t",v:u},++c}var g,v=0,y=0;for(c=o.length-1,d="t";c>=0;--c)switch(o[c].t){case"h":case"H":o[c].t=f,d="h",v<1&&(v=1);break;case"s":(g=o[c].v.match(/\.0+$/))&&(y=Math.max(y,g[0].length-1)),v<3&&(v=3);case"d":case"y":case"M":case"e":d=o[c].t;break;case"m":"s"===d&&(o[c].t="M",v<2&&(v=2));break;case"X":break;case"Z":v<1&&o[c].v.match(/[Hh]/)&&(v=1),v<2&&o[c].v.match(/[Mm]/)&&(v=2),v<3&&o[c].v.match(/[Ss]/)&&(v=3)}switch(v){case 0:break;case 1:n.u>=.5&&(n.u=0,++n.S),n.S>=60&&(n.S=0,++n.M),n.M>=60&&(n.M=0,++n.H);break;case 2:n.u>=.5&&(n.u=0,++n.S),n.S>=60&&(n.S=0,++n.M)}var b,w="";for(c=0;c<o.length;++c)switch(o[c].t){case"t":case"T":case" ":case"D":break;case"X":o[c].v="",o[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":o[c].v=Gr(o[c].t.charCodeAt(0),o[c].v,n,y),o[c].t="t";break;case"n":case"?":for(b=c+1;null!=o[b]&&("?"===(u=o[b].t)||"D"===u||(" "===u||"t"===u)&&null!=o[b+1]&&("?"===o[b+1].t||"t"===o[b+1].t&&"/"===o[b+1].v)||"("===o[c].t&&(" "===u||"n"===u||")"===u)||"t"===u&&("/"===o[b].v||" "===o[b].v&&null!=o[b+1]&&"?"==o[b+1].t));)o[c].v+=o[b].v,o[b]={v:"",t:";"},++b;w+=o[c].v,c=b-1;break;case"G":o[c].t="t",o[c].v=Vr(t,a)}var x,k,S="";if(w.length>0){40==w.charCodeAt(0)?(x=t<0&&45===w.charCodeAt(0)?-t:t,k=sn("n",w,x)):(k=sn("n",w,x=t<0&&r>1?-t:t),x<0&&o[0]&&"t"==o[0].t&&(k=k.substr(1),o[0].v="-"+o[0].v)),b=k.length-1;var E=o.length;for(c=0;c<o.length;++c)if(null!=o[c]&&"t"!=o[c].t&&o[c].v.indexOf(".")>-1){E=c;break}var T=o.length;if(E===o.length&&-1===k.indexOf("E")){for(c=o.length-1;c>=0;--c)null!=o[c]&&-1!=="n?".indexOf(o[c].t)&&(b>=o[c].v.length-1?(b-=o[c].v.length,o[c].v=k.substr(b+1,o[c].v.length)):b<0?o[c].v="":(o[c].v=k.substr(0,b+1),b=-1),o[c].t="t",T=c);b>=0&&T<o.length&&(o[T].v=k.substr(0,b+1)+o[T].v)}else if(E!==o.length&&-1===k.indexOf("E")){for(b=k.indexOf(".")-1,c=E;c>=0;--c)if(null!=o[c]&&-1!=="n?".indexOf(o[c].t)){for(s=o[c].v.indexOf(".")>-1&&c===E?o[c].v.indexOf(".")-1:o[c].v.length-1,S=o[c].v.substr(s+1);s>=0;--s)b>=0&&("0"===o[c].v.charAt(s)||"#"===o[c].v.charAt(s))&&(S=k.charAt(b--)+S);o[c].v=S,o[c].t="t",T=c}for(b>=0&&T<o.length&&(o[T].v=k.substr(0,b+1)+o[T].v),b=k.indexOf(".")+1,c=E;c<o.length;++c)if(null!=o[c]&&(-1!=="n?(".indexOf(o[c].t)||c===E)){for(s=o[c].v.indexOf(".")>-1&&c===E?o[c].v.indexOf(".")+1:0,S=o[c].v.substr(0,s);s<o[c].v.length;++s)b<k.length&&(S+=k.charAt(b++));o[c].v=S,o[c].t="t",T=c}}}for(c=0;c<o.length;++c)null!=o[c]&&"n?".indexOf(o[c].t)>-1&&(x=r>1&&t<0&&c>0&&"-"===o[c-1].v?-t:t,o[c].v=sn(o[c].t,o[c].v,x),o[c].t="t");var N="";for(c=0;c!==o.length;++c)null!=o[c]&&(N+=o[c].v);return N}(n[1],t,a,n[0])}function hn(e,t){if("number"!=typeof t){t=+t||-1;for(var a=0;a<392;++a)if(void 0!=Or[a]){if(Or[a]==e){t=a;break}}else t<0&&(t=a);t<0&&(t=391)}return Or[t]=e,t}function mn(e){for(var t=0;392!=t;++t)void 0!==e[t]&&hn(e[t],t)}function pn(){var e;e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "',Or=e}var gn={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},vn=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;var yn=function(){var e={};e.version="1.2.0";var t=function(){for(var e=0,t=new Array(256),a=0;256!=a;++a)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=a)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1,t[a]=e;return"undefined"!==typeof Int32Array?new Int32Array(t):t}();var a=function(e){var t=0,a=0,r=0,n="undefined"!==typeof Int32Array?new Int32Array(4096):new Array(4096);for(r=0;256!=r;++r)n[r]=e[r];for(r=0;256!=r;++r)for(a=e[r],t=256+r;t<4096;t+=256)a=n[t]=a>>>8^e[255&a];var s=[];for(r=1;16!=r;++r)s[r-1]="undefined"!==typeof Int32Array?n.subarray(256*r,256*r+256):n.slice(256*r,256*r+256);return s}(t),r=a[0],n=a[1],s=a[2],i=a[3],o=a[4],l=a[5],c=a[6],u=a[7],d=a[8],f=a[9],h=a[10],m=a[11],p=a[12],g=a[13],v=a[14];return e.table=t,e.bstr=function(e,a){for(var r=-1^a,n=0,s=e.length;n<s;)r=r>>>8^t[255&(r^e.charCodeAt(n++))];return~r},e.buf=function(e,a){for(var y=-1^a,b=e.length-15,w=0;w<b;)y=v[e[w++]^255&y]^g[e[w++]^y>>8&255]^p[e[w++]^y>>16&255]^m[e[w++]^y>>>24]^h[e[w++]]^f[e[w++]]^d[e[w++]]^u[e[w++]]^c[e[w++]]^l[e[w++]]^o[e[w++]]^i[e[w++]]^s[e[w++]]^n[e[w++]]^r[e[w++]]^t[e[w++]];for(b+=15;w<b;)y=y>>>8^t[255&(y^e[w++])];return~y},e.str=function(e,a){for(var r=-1^a,n=0,s=e.length,i=0,o=0;n<s;)(i=e.charCodeAt(n++))<128?r=r>>>8^t[255&(r^i)]:i<2048?r=(r=r>>>8^t[255&(r^(192|i>>6&31))])>>>8^t[255&(r^(128|63&i))]:i>=55296&&i<57344?(i=64+(1023&i),o=1023&e.charCodeAt(n++),r=(r=(r=(r=r>>>8^t[255&(r^(240|i>>8&7))])>>>8^t[255&(r^(128|i>>2&63))])>>>8^t[255&(r^(128|o>>6&15|(3&i)<<4))])>>>8^t[255&(r^(128|63&o))]):r=(r=(r=r>>>8^t[255&(r^(224|i>>12&15))])>>>8^t[255&(r^(128|i>>6&63))])>>>8^t[255&(r^(128|63&i))];return~r},e}(),bn=function(){var e,t={};function a(e){if("/"==e.charAt(e.length-1))return-1===e.slice(0,-1).indexOf("/")?e:a(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(0,t+1)}function r(e){if("/"==e.charAt(e.length-1))return r(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(t+1)}function n(e,t){"string"===typeof t&&(t=new Date(t));var a=t.getHours();a=(a=a<<6|t.getMinutes())<<5|t.getSeconds()>>>1,e.write_shift(2,a);var r=t.getFullYear()-1980;r=(r=r<<4|t.getMonth()+1)<<5|t.getDate(),e.write_shift(2,r)}function s(e){Wi(e,0);for(var t={},a=0;e.l<=e.length-4;){var r=e.read_shift(2),n=e.read_shift(2),s=e.l+n,i={};if(21589===r)1&(a=e.read_shift(1))&&(i.mtime=e.read_shift(4)),n>5&&(2&a&&(i.atime=e.read_shift(4)),4&a&&(i.ctime=e.read_shift(4))),i.mtime&&(i.mt=new Date(1e3*i.mtime));e.l=s,t[r]=i}return t}function i(){return e||(e={})}function o(e,t){if(80==e[0]&&75==e[1])return re(e,t);if(109==(32|e[0])&&105==(32|e[1]))return function(e,t){if("mime-version:"!=k(e.slice(0,13)).toLowerCase())throw new Error("Unsupported MAD header");var a=t&&t.root||"",r=(hr&&Buffer.isBuffer(e)?e.toString("binary"):k(e)).split("\r\n"),n=0,s="";for(n=0;n<r.length;++n)if(s=r[n],/^Content-Location:/i.test(s)&&(s=s.slice(s.indexOf("file")),a||(a=s.slice(0,s.lastIndexOf("/")+1)),s.slice(0,a.length)!=a))for(;a.length>0&&(a=(a=a.slice(0,a.length-1)).slice(0,a.lastIndexOf("/")+1),s.slice(0,a.length)!=a););var i=(r[1]||"").match(/boundary="(.*?)"/);if(!i)throw new Error("MAD cannot find boundary");var o="--"+(i[1]||""),l=[],c=[],u={FileIndex:l,FullPaths:c};f(u);var d,h=0;for(n=0;n<r.length;++n){var m=r[n];m!==o&&m!==o+"--"||(h++&&ce(u,r.slice(d,n),a),d=n)}return u}(e,t);if(e.length<512)throw new Error("CFB file size "+e.length+" < 512");var a,r,n,s,i,o,h=512,m=[],p=e.slice(0,512);Wi(p,0);var g=function(e){if(80==e[e.l]&&75==e[e.l+1])return[0,0];e.chk(y,"Header Signature: "),e.l+=16;var t=e.read_shift(2,"u");return[e.read_shift(2,"u"),t]}(p);switch(a=g[0]){case 3:h=512;break;case 4:h=4096;break;case 0:if(0==g[1])return re(e,t);default:throw new Error("Major Version: Expected 3 or 4 saw "+a)}512!==h&&Wi(p=e.slice(0,h),28);var b=e.slice(0,h);!function(e,t){var a=9;switch(e.l+=2,a=e.read_shift(2)){case 9:if(3!=t)throw new Error("Sector Shift: Expected 9 saw "+a);break;case 12:if(4!=t)throw new Error("Sector Shift: Expected 12 saw "+a);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+a)}e.chk("0600","Mini Sector Shift: "),e.chk("000000000000","Reserved: ")}(p,a);var w=p.read_shift(4,"i");if(3===a&&0!==w)throw new Error("# Directory Sectors: Expected 0 saw "+w);p.l+=4,s=p.read_shift(4,"i"),p.l+=4,p.chk("00100000","Mini Stream Cutoff Size: "),i=p.read_shift(4,"i"),r=p.read_shift(4,"i"),o=p.read_shift(4,"i"),n=p.read_shift(4,"i");for(var x=-1,S=0;S<109&&!((x=p.read_shift(4,"i"))<0);++S)m[S]=x;var E=function(e,t){for(var a=Math.ceil(e.length/t)-1,r=[],n=1;n<a;++n)r[n-1]=e.slice(n*t,(n+1)*t);return r[a-1]=e.slice(a*t),r}(e,h);c(o,n,E,h,m);var T=function(e,t,a,r){var n=e.length,s=[],i=[],o=[],l=[],c=r-1,u=0,d=0,f=0,h=0;for(u=0;u<n;++u)if(o=[],(f=u+t)>=n&&(f-=n),!i[f]){l=[];var m=[];for(d=f;d>=0;){m[d]=!0,i[d]=!0,o[o.length]=d,l.push(e[d]);var p=a[Math.floor(4*d/r)];if(r<4+(h=4*d&c))throw new Error("FAT boundary crossed: "+d+" 4 "+r);if(!e[p])break;if(m[d=Di(e[p],h)])break}s[f]={nodes:o,data:ci([l])}}return s}(E,s,m,h);T[s].name="!Directory",r>0&&i!==v&&(T[i].name="!MiniFAT"),T[m[0]].name="!FAT",T.fat_addrs=m,T.ssz=h;var N=[],j=[],C=[];!function(e,t,a,r,n,s,i,o){for(var c,f=0,h=r.length?2:0,m=t[e].data,p=0,g=0;p<m.length;p+=128){var y=m.slice(p,p+128);Wi(y,64),g=y.read_shift(2),c=di(y,0,g-h),r.push(c);var b={name:c,type:y.read_shift(1),color:y.read_shift(1),L:y.read_shift(4,"i"),R:y.read_shift(4,"i"),C:y.read_shift(4,"i"),clsid:y.read_shift(16),state:y.read_shift(4,"i"),start:0,size:0};0!==y.read_shift(2)+y.read_shift(2)+y.read_shift(2)+y.read_shift(2)&&(b.ct=d(y,y.l-8)),0!==y.read_shift(2)+y.read_shift(2)+y.read_shift(2)+y.read_shift(2)&&(b.mt=d(y,y.l-8)),b.start=y.read_shift(4,"i"),b.size=y.read_shift(4,"i"),b.size<0&&b.start<0&&(b.size=b.type=0,b.start=v,b.name=""),5===b.type?(f=b.start,n>0&&f!==v&&(t[f].name="!StreamData")):b.size>=4096?(b.storage="fat",void 0===t[b.start]&&(t[b.start]=u(a,b.start,t.fat_addrs,t.ssz)),t[b.start].name=b.name,b.content=t[b.start].data.slice(0,b.size)):(b.storage="minifat",b.size<0?b.size=0:f!==v&&b.start!==v&&t[f]&&(b.content=l(b,t[f].data,(t[o]||{}).data))),b.content&&Wi(b.content,0),s[c]=b,i.push(b)}}(s,T,E,N,r,{},j,i),function(e,t,a){for(var r=0,n=0,s=0,i=0,o=0,l=a.length,c=[],u=[];r<l;++r)c[r]=u[r]=r,t[r]=a[r];for(;o<u.length;++o)n=e[r=u[o]].L,s=e[r].R,i=e[r].C,c[r]===r&&(-1!==n&&c[n]!==n&&(c[r]=c[n]),-1!==s&&c[s]!==s&&(c[r]=c[s])),-1!==i&&(c[i]=r),-1!==n&&r!=c[r]&&(c[n]=c[r],u.lastIndexOf(n)<o&&u.push(n)),-1!==s&&r!=c[r]&&(c[s]=c[r],u.lastIndexOf(s)<o&&u.push(s));for(r=1;r<l;++r)c[r]===r&&(-1!==s&&c[s]!==s?c[r]=c[s]:-1!==n&&c[n]!==n&&(c[r]=c[n]));for(r=1;r<l;++r)if(0!==e[r].type){if((o=r)!=c[o])do{o=c[o],t[r]=t[o]+"/"+t[r]}while(0!==o&&-1!==c[o]&&o!=c[o]);c[r]=-1}for(t[0]+="/",r=1;r<l;++r)2!==e[r].type&&(t[r]+="/")}(j,C,N),N.shift();var _={FileIndex:j,FullPaths:C};return t&&t.raw&&(_.raw={header:b,sectors:E}),_}function l(e,t,a){for(var r=e.start,n=e.size,s=[],i=r;a&&n>0&&i>=0;)s.push(t.slice(i*g,i*g+g)),n-=g,i=Di(a,4*i);return 0===s.length?Vi(0):xr(s).slice(0,e.size)}function c(e,t,a,r,n){var s=v;if(e===v){if(0!==t)throw new Error("DIFAT chain shorter than expected")}else if(-1!==e){var i=a[e],o=(r>>>2)-1;if(!i)return;for(var l=0;l<o&&(s=Di(i,4*l))!==v;++l)n.push(s);c(Di(i,r-4),t-1,a,r,n)}}function u(e,t,a,r,n){var s=[],i=[];n||(n=[]);var o=r-1,l=0,c=0;for(l=t;l>=0;){n[l]=!0,s[s.length]=l,i.push(e[l]);var u=a[Math.floor(4*l/r)];if(r<4+(c=4*l&o))throw new Error("FAT boundary crossed: "+l+" 4 "+r);if(!e[u])break;l=Di(e[u],c)}return{nodes:s,data:ci([i])}}function d(e,t){return new Date(1e3*(Oi(e,t+4)/1e7*Math.pow(2,32)+Oi(e,t)/1e7-11644473600))}function f(e,t){var a=t||{},r=a.root||"Root Entry";if(e.FullPaths||(e.FullPaths=[]),e.FileIndex||(e.FileIndex=[]),e.FullPaths.length!==e.FileIndex.length)throw new Error("inconsistent CFB structure");0===e.FullPaths.length&&(e.FullPaths[0]=r+"/",e.FileIndex[0]={name:r,type:5}),a.CLSID&&(e.FileIndex[0].clsid=a.CLSID),function(e){var t="\x01Sh33tJ5";if(bn.find(e,"/"+t))return;var a=Vi(4);a[0]=55,a[1]=a[3]=50,a[2]=54,e.FileIndex.push({name:t,type:2,content:a,size:4,L:69,R:69,C:69}),e.FullPaths.push(e.FullPaths[0]+t),h(e)}(e)}function h(e,t){f(e);for(var n=!1,s=!1,i=e.FullPaths.length-1;i>=0;--i){var o=e.FileIndex[i];switch(o.type){case 0:s?n=!0:(e.FileIndex.pop(),e.FullPaths.pop());break;case 1:case 2:case 5:s=!0,isNaN(o.R*o.L*o.C)&&(n=!0),o.R>-1&&o.L>-1&&o.R==o.L&&(n=!0);break;default:n=!0}}if(n||t){var l=new Date(1987,1,19),c=0,u=Object.create?Object.create(null):{},d=[];for(i=0;i<e.FullPaths.length;++i)u[e.FullPaths[i]]=!0,0!==e.FileIndex[i].type&&d.push([e.FullPaths[i],e.FileIndex[i]]);for(i=0;i<d.length;++i){var h=a(d[i][0]);(s=u[h])||(d.push([h,{name:r(h).replace("/",""),type:1,clsid:w,ct:l,mt:l,content:null}]),u[h]=!0)}for(d.sort(function(e,t){return function(e,t){for(var a=e.split("/"),r=t.split("/"),n=0,s=0,i=Math.min(a.length,r.length);n<i;++n){if(s=a[n].length-r[n].length)return s;if(a[n]!=r[n])return a[n]<r[n]?-1:1}return a.length-r.length}(e[0],t[0])}),e.FullPaths=[],e.FileIndex=[],i=0;i<d.length;++i)e.FullPaths[i]=d[i][0],e.FileIndex[i]=d[i][1];for(i=0;i<d.length;++i){var m=e.FileIndex[i],p=e.FullPaths[i];if(m.name=r(p).replace("/",""),m.L=m.R=m.C=-(m.color=1),m.size=m.content?m.content.length:0,m.start=0,m.clsid=m.clsid||w,0===i)m.C=d.length>1?1:-1,m.size=0,m.type=5;else if("/"==p.slice(-1)){for(c=i+1;c<d.length&&a(e.FullPaths[c])!=p;++c);for(m.C=c>=d.length?-1:c,c=i+1;c<d.length&&a(e.FullPaths[c])!=a(p);++c);m.R=c>=d.length?-1:c,m.type=1}else a(e.FullPaths[i+1]||"")==a(p)&&(m.R=i+1),m.type=2}}}function m(e,t){var a=t||{};if("mad"==a.fileType)return function(e,t){for(var a=t||{},r=a.boundary||"SheetJS",n=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(r="------="+r).slice(2)+'"',"","",""],s=e.FullPaths[0],i=s,o=e.FileIndex[0],l=1;l<e.FullPaths.length;++l)if(i=e.FullPaths[l].slice(s.length),(o=e.FileIndex[l]).size&&o.content&&"\x01Sh33tJ5"!=i){i=i.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(e){return"_x"+e.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(e){return"_u"+e.charCodeAt(0).toString(16)+"_"});for(var c=o.content,u=hr&&Buffer.isBuffer(c)?c.toString("binary"):k(c),d=0,f=Math.min(1024,u.length),h=0,m=0;m<=f;++m)(h=u.charCodeAt(m))>=32&&h<128&&++d;var p=d>=4*f/5;n.push(r),n.push("Content-Location: "+(a.root||"file:///C:/SheetJS/")+i),n.push("Content-Transfer-Encoding: "+(p?"quoted-printable":"base64")),n.push("Content-Type: "+ie(o,i)),n.push(""),n.push(p?le(u):oe(u))}return n.push(r+"--\r\n"),n.join("\r\n")}(e,a);if(h(e),"zip"===a.fileType)return function(e,t){var a=t||{},r=[],s=[],i=Vi(1),o=a.compression?8:0,l=0;0;var c=0,u=0,d=0,f=0,h=e.FullPaths[0],m=h,p=e.FileIndex[0],g=[],v=0;for(c=1;c<e.FullPaths.length;++c)if(m=e.FullPaths[c].slice(h.length),(p=e.FileIndex[c]).size&&p.content&&"\x01Sh33tJ5"!=m){var y=d,b=Vi(m.length);for(u=0;u<m.length;++u)b.write_shift(1,127&m.charCodeAt(u));b=b.slice(0,b.l),g[f]=yn.buf(p.content,0);var w=p.content;8==o&&(w=S(w)),(i=Vi(30)).write_shift(4,67324752),i.write_shift(2,20),i.write_shift(2,l),i.write_shift(2,o),p.mt?n(i,p.mt):i.write_shift(4,0),i.write_shift(-4,8&l?0:g[f]),i.write_shift(4,8&l?0:w.length),i.write_shift(4,8&l?0:p.content.length),i.write_shift(2,b.length),i.write_shift(2,0),d+=i.length,r.push(i),d+=b.length,r.push(b),d+=w.length,r.push(w),8&l&&((i=Vi(12)).write_shift(-4,g[f]),i.write_shift(4,w.length),i.write_shift(4,p.content.length),d+=i.l,r.push(i)),(i=Vi(46)).write_shift(4,33639248),i.write_shift(2,0),i.write_shift(2,20),i.write_shift(2,l),i.write_shift(2,o),i.write_shift(4,0),i.write_shift(-4,g[f]),i.write_shift(4,w.length),i.write_shift(4,p.content.length),i.write_shift(2,b.length),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(4,0),i.write_shift(4,y),v+=i.l,s.push(i),v+=b.length,s.push(b),++f}return i=Vi(22),i.write_shift(4,101010256),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,f),i.write_shift(2,f),i.write_shift(4,v),i.write_shift(4,d),i.write_shift(2,0),xr([xr(r),xr(s),i])}(e,a);var r=function(e){for(var t=0,a=0,r=0;r<e.FileIndex.length;++r){var n=e.FileIndex[r];if(n.content){var s=n.content.length;s>0&&(s<4096?t+=s+63>>6:a+=s+511>>9)}}for(var i=e.FullPaths.length+3>>2,o=t+127>>7,l=(t+7>>3)+a+i+o,c=l+127>>7,u=c<=109?0:Math.ceil((c-109)/127);l+c+u+127>>7>c;)u=++c<=109?0:Math.ceil((c-109)/127);var d=[1,u,c,o,i,a,t,0];return e.FileIndex[0].size=t<<6,d[7]=(e.FileIndex[0].start=d[0]+d[1]+d[2]+d[3]+d[4]+d[5])+(d[6]+7>>3),d}(e),s=Vi(r[7]<<9),i=0,o=0;for(i=0;i<8;++i)s.write_shift(1,b[i]);for(i=0;i<8;++i)s.write_shift(2,0);for(s.write_shift(2,62),s.write_shift(2,3),s.write_shift(2,65534),s.write_shift(2,9),s.write_shift(2,6),i=0;i<3;++i)s.write_shift(2,0);for(s.write_shift(4,0),s.write_shift(4,r[2]),s.write_shift(4,r[0]+r[1]+r[2]+r[3]-1),s.write_shift(4,0),s.write_shift(4,4096),s.write_shift(4,r[3]?r[0]+r[1]+r[2]-1:v),s.write_shift(4,r[3]),s.write_shift(-4,r[1]?r[0]-1:v),s.write_shift(4,r[1]),i=0;i<109;++i)s.write_shift(-4,i<r[2]?r[1]+i:-1);if(r[1])for(o=0;o<r[1];++o){for(;i<236+127*o;++i)s.write_shift(-4,i<r[2]?r[1]+i:-1);s.write_shift(-4,o===r[1]-1?v:o+1)}var l=function(e){for(o+=e;i<o-1;++i)s.write_shift(-4,i+1);e&&(++i,s.write_shift(-4,v))};for(o=i=0,o+=r[1];i<o;++i)s.write_shift(-4,x.DIFSECT);for(o+=r[2];i<o;++i)s.write_shift(-4,x.FATSECT);l(r[3]),l(r[4]);for(var c=0,u=0,d=e.FileIndex[0];c<e.FileIndex.length;++c)(d=e.FileIndex[c]).content&&((u=d.content.length)<4096||(d.start=o,l(u+511>>9)));for(l(r[6]+7>>3);511&s.l;)s.write_shift(-4,x.ENDOFCHAIN);for(o=i=0,c=0;c<e.FileIndex.length;++c)(d=e.FileIndex[c]).content&&(!(u=d.content.length)||u>=4096||(d.start=o,l(u+63>>6)));for(;511&s.l;)s.write_shift(-4,x.ENDOFCHAIN);for(i=0;i<r[4]<<2;++i){var f=e.FullPaths[i];if(f&&0!==f.length){d=e.FileIndex[i],0===i&&(d.start=d.size?d.start-1:v);var m=0===i&&a.root||d.name;if(u=2*(m.length+1),s.write_shift(64,m,"utf16le"),s.write_shift(2,u),s.write_shift(1,d.type),s.write_shift(1,d.color),s.write_shift(-4,d.L),s.write_shift(-4,d.R),s.write_shift(-4,d.C),d.clsid)s.write_shift(16,d.clsid,"hex");else for(c=0;c<4;++c)s.write_shift(4,0);s.write_shift(4,d.state||0),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,d.start),s.write_shift(4,d.size),s.write_shift(4,0)}else{for(c=0;c<17;++c)s.write_shift(4,0);for(c=0;c<3;++c)s.write_shift(4,-1);for(c=0;c<12;++c)s.write_shift(4,0)}}for(i=1;i<e.FileIndex.length;++i)if((d=e.FileIndex[i]).size>=4096)if(s.l=d.start+1<<9,hr&&Buffer.isBuffer(d.content))d.content.copy(s,s.l,0,d.size),s.l+=d.size+511&-512;else{for(c=0;c<d.size;++c)s.write_shift(1,d.content[c]);for(;511&c;++c)s.write_shift(1,0)}for(i=1;i<e.FileIndex.length;++i)if((d=e.FileIndex[i]).size>0&&d.size<4096)if(hr&&Buffer.isBuffer(d.content))d.content.copy(s,s.l,0,d.size),s.l+=d.size+63&-64;else{for(c=0;c<d.size;++c)s.write_shift(1,d.content[c]);for(;63&c;++c)s.write_shift(1,0)}if(hr)s.l=s.length;else for(;s.l<s.length;)s.write_shift(1,0);return s}t.version="1.2.1";var p,g=64,v=-2,y="d0cf11e0a1b11ae1",b=[208,207,17,224,161,177,26,225],w="00000000000000000000000000000000",x={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:v,FREESECT:-1,HEADER_SIGNATURE:y,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:w,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function k(e){for(var t=new Array(e.length),a=0;a<e.length;++a)t[a]=String.fromCharCode(e[a]);return t.join("")}function S(e){return p?p.deflateRawSync(e):Y(e)}var E=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],T=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],N=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function j(e){var t=139536&(e<<1|e<<11)|558144&(e<<5|e<<15);return 255&(t>>16|t>>8|t)}for(var C="undefined"!==typeof Uint8Array,_=C?new Uint8Array(256):[],A=0;A<256;++A)_[A]=j(A);function P(e,t){var a=_[255&e];return t<=8?a>>>8-t:(a=a<<8|_[e>>8&255],t<=16?a>>>16-t:(a=a<<8|_[e>>16&255])>>>24-t)}function R(e,t){var a=7&t,r=t>>>3;return(e[r]|(a<=6?0:e[r+1]<<8))>>>a&3}function O(e,t){var a=7&t,r=t>>>3;return(e[r]|(a<=5?0:e[r+1]<<8))>>>a&7}function D(e,t){var a=7&t,r=t>>>3;return(e[r]|(a<=3?0:e[r+1]<<8))>>>a&31}function F(e,t){var a=7&t,r=t>>>3;return(e[r]|(a<=1?0:e[r+1]<<8))>>>a&127}function I(e,t,a){var r=7&t,n=t>>>3,s=(1<<a)-1,i=e[n]>>>r;return a<8-r?i&s:(i|=e[n+1]<<8-r,a<16-r?i&s:(i|=e[n+2]<<16-r,a<24-r?i&s:(i|=e[n+3]<<24-r)&s))}function L(e,t,a){var r=7&t,n=t>>>3;return r<=5?e[n]|=(7&a)<<r:(e[n]|=a<<r&255,e[n+1]=(7&a)>>8-r),t+3}function M(e,t,a){return a=(1&a)<<(7&t),e[t>>>3]|=a,t+1}function z(e,t,a){var r=t>>>3;return a<<=7&t,e[r]|=255&a,a>>>=8,e[r+1]=a,t+8}function U(e,t,a){var r=t>>>3;return a<<=7&t,e[r]|=255&a,a>>>=8,e[r+1]=255&a,e[r+2]=a>>>8,t+16}function B(e,t){var a=e.length,r=2*a>t?2*a:t+5,n=0;if(a>=t)return e;if(hr){var s=gr(r);if(e.copy)e.copy(s);else for(;n<e.length;++n)s[n]=e[n];return s}if(C){var i=new Uint8Array(r);if(i.set)i.set(e);else for(;n<a;++n)i[n]=e[n];return i}return e.length=r,e}function W(e){for(var t=new Array(e),a=0;a<e;++a)t[a]=0;return t}function H(e,t,a){var r=1,n=0,s=0,i=0,o=0,l=e.length,c=C?new Uint16Array(32):W(32);for(s=0;s<32;++s)c[s]=0;for(s=l;s<a;++s)e[s]=0;l=e.length;var u=C?new Uint16Array(l):W(l);for(s=0;s<l;++s)c[n=e[s]]++,r<n&&(r=n),u[s]=0;for(c[0]=0,s=1;s<=r;++s)c[s+16]=o=o+c[s-1]<<1;for(s=0;s<l;++s)0!=(o=e[s])&&(u[s]=c[o+16]++);var d=0;for(s=0;s<l;++s)if(0!=(d=e[s]))for(o=P(u[s],r)>>r-d,i=(1<<r+4-d)-1;i>=0;--i)t[o|i<<d]=15&d|s<<4;return r}var V=C?new Uint16Array(512):W(512),G=C?new Uint16Array(32):W(32);if(!C){for(var $=0;$<512;++$)V[$]=0;for($=0;$<32;++$)G[$]=0}!function(){for(var e=[],t=0;t<32;t++)e.push(5);H(e,G,32);var a=[];for(t=0;t<=143;t++)a.push(8);for(;t<=255;t++)a.push(9);for(;t<=279;t++)a.push(7);for(;t<=287;t++)a.push(8);H(a,V,288)}();var q=function(){for(var e=C?new Uint8Array(32768):[],t=0,a=0;t<N.length-1;++t)for(;a<N[t+1];++a)e[a]=t;for(;a<32768;++a)e[a]=29;var r=C?new Uint8Array(259):[];for(t=0,a=0;t<T.length-1;++t)for(;a<T[t+1];++a)r[a]=t;return function(t,a){return t.length<8?function(e,t){for(var a=0;a<e.length;){var r=Math.min(65535,e.length-a),n=a+r==e.length;for(t.write_shift(1,+n),t.write_shift(2,r),t.write_shift(2,65535&~r);r-- >0;)t[t.l++]=e[a++]}return t.l}(t,a):function(t,a){for(var n=0,s=0,i=C?new Uint16Array(32768):[];s<t.length;){var o=Math.min(65535,t.length-s);if(o<10){for(7&(n=L(a,n,+!(s+o!=t.length)))&&(n+=8-(7&n)),a.l=n/8|0,a.write_shift(2,o),a.write_shift(2,65535&~o);o-- >0;)a[a.l++]=t[s++];n=8*a.l}else{n=L(a,n,+!(s+o!=t.length)+2);for(var l=0;o-- >0;){var c=t[s],u=-1,d=0;if((u=i[l=32767&(l<<5^c)])&&((u|=-32768&s)>s&&(u-=32768),u<s))for(;t[u+d]==t[s+d]&&d<250;)++d;if(d>2){(c=r[d])<=22?n=z(a,n,_[c+1]>>1)-1:(z(a,n,3),z(a,n+=5,_[c-23]>>5),n+=3);var f=c<8?0:c-4>>2;f>0&&(U(a,n,d-T[c]),n+=f),c=e[s-u],n=z(a,n,_[c]>>3),n-=3;var h=c<4?0:c-2>>1;h>0&&(U(a,n,s-u-N[c]),n+=h);for(var m=0;m<d;++m)i[l]=32767&s,l=32767&(l<<5^t[s]),++s;o-=d-1}else c<=143?c+=48:n=M(a,n,1),n=z(a,n,_[c]),i[l]=32767&s,++s}n=z(a,n,0)-1}}return a.l=(n+7)/8|0,a.l}(t,a)}}();function Y(e){var t=Vi(50+Math.floor(1.1*e.length)),a=q(e,t);return t.slice(0,a)}var X=C?new Uint16Array(32768):W(32768),K=C?new Uint16Array(32768):W(32768),J=C?new Uint16Array(128):W(128),Q=1,Z=1;function ee(e,t){var a=D(e,t)+257,r=D(e,t+=5)+1,n=function(e,t){var a=7&t,r=t>>>3;return(e[r]|(a<=4?0:e[r+1]<<8))>>>a&15}(e,t+=5)+4;t+=4;for(var s=0,i=C?new Uint8Array(19):W(19),o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l=1,c=C?new Uint8Array(8):W(8),u=C?new Uint8Array(8):W(8),d=i.length,f=0;f<n;++f)i[E[f]]=s=O(e,t),l<s&&(l=s),c[s]++,t+=3;var h=0;for(c[0]=0,f=1;f<=l;++f)u[f]=h=h+c[f-1]<<1;for(f=0;f<d;++f)0!=(h=i[f])&&(o[f]=u[h]++);var m=0;for(f=0;f<d;++f)if(0!=(m=i[f])){h=_[o[f]]>>8-m;for(var p=(1<<7-m)-1;p>=0;--p)J[h|p<<m]=7&m|f<<3}var g=[];for(l=1;g.length<a+r;)switch(t+=7&(h=J[F(e,t)]),h>>>=3){case 16:for(s=3+R(e,t),t+=2,h=g[g.length-1];s-- >0;)g.push(h);break;case 17:for(s=3+O(e,t),t+=3;s-- >0;)g.push(0);break;case 18:for(s=11+F(e,t),t+=7;s-- >0;)g.push(0);break;default:g.push(h),l<h&&(l=h)}var v=g.slice(0,a),y=g.slice(a);for(f=a;f<286;++f)v[f]=0;for(f=r;f<30;++f)y[f]=0;return Q=H(v,X,286),Z=H(y,K,30),t}function te(e,t){var a=function(e,t){if(3==e[0]&&!(3&e[1]))return[pr(t),2];for(var a=0,r=0,n=gr(t||1<<18),s=0,i=n.length>>>0,o=0,l=0;0==(1&r);)if(r=O(e,a),a+=3,r>>>1!=0)for(r>>1==1?(o=9,l=5):(a=ee(e,a),o=Q,l=Z);;){!t&&i<s+32767&&(i=(n=B(n,s+32767)).length);var c=I(e,a,o),u=r>>>1==1?V[c]:X[c];if(a+=15&u,0===((u>>>=4)>>>8&255))n[s++]=u;else{if(256==u)break;var d=(u-=257)<8?0:u-4>>2;d>5&&(d=0);var f=s+T[u];d>0&&(f+=I(e,a,d),a+=d),c=I(e,a,l),a+=15&(u=r>>>1==1?G[c]:K[c]);var h=(u>>>=4)<4?0:u-2>>1,m=N[u];for(h>0&&(m+=I(e,a,h),a+=h),!t&&i<f&&(i=(n=B(n,f+100)).length);s<f;)n[s]=n[s-m],++s}}else{7&a&&(a+=8-(7&a));var p=e[a>>>3]|e[(a>>>3)+1]<<8;if(a+=32,p>0)for(!t&&i<s+p&&(i=(n=B(n,s+p)).length);p-- >0;)n[s++]=e[a>>>3],a+=8}return t?[n,a+7>>>3]:[n.slice(0,s),a+7>>>3]}(e.slice(e.l||0),t);return e.l+=a[1],a[0]}function ae(e,t){if(!e)throw new Error(t);"undefined"!==typeof console&&console.error(t)}function re(e,t){var a=e;Wi(a,0);var r={FileIndex:[],FullPaths:[]};f(r,{root:t.root});for(var n=a.length-4;(80!=a[n]||75!=a[n+1]||5!=a[n+2]||6!=a[n+3])&&n>=0;)--n;a.l=n+4,a.l+=4;var i=a.read_shift(2);a.l+=6;var o=a.read_shift(4);for(a.l=o,n=0;n<i;++n){a.l+=20;var l=a.read_shift(4),c=a.read_shift(4),u=a.read_shift(2),d=a.read_shift(2),h=a.read_shift(2);a.l+=8;var m=a.read_shift(4),p=s(a.slice(a.l+u,a.l+u+d));a.l+=u+d+h;var g=a.l;a.l=m+4,ne(a,l,c,r,p),a.l=g}return r}function ne(e,t,a,r,n){e.l+=2;var i=e.read_shift(2),o=e.read_shift(2),l=function(e){var t=65535&e.read_shift(2),a=65535&e.read_shift(2),r=new Date,n=31&a,s=15&(a>>>=5);a>>>=4,r.setMilliseconds(0),r.setFullYear(a+1980),r.setMonth(s-1),r.setDate(n);var i=31&t,o=63&(t>>>=5);return t>>>=6,r.setHours(t),r.setMinutes(o),r.setSeconds(i<<1),r}(e);if(8257&i)throw new Error("Unsupported ZIP encryption");e.read_shift(4);for(var c=e.read_shift(4),u=e.read_shift(4),d=e.read_shift(2),f=e.read_shift(2),h="",m=0;m<d;++m)h+=String.fromCharCode(e[e.l++]);if(f){var g=s(e.slice(e.l,e.l+f));(g[21589]||{}).mt&&(l=g[21589].mt),((n||{})[21589]||{}).mt&&(l=n[21589].mt)}e.l+=f;var v=e.slice(e.l,e.l+c);switch(o){case 8:v=function(e,t){if(!p)return te(e,t);var a=new(0,p.InflateRaw),r=a._processChunk(e.slice(e.l),a._finishFlushFlag);return e.l+=a.bytesRead,r}(e,u);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+o)}var y=!1;8&i&&(134695760==e.read_shift(4)&&(e.read_shift(4),y=!0),c=e.read_shift(4),u=e.read_shift(4)),c!=t&&ae(y,"Bad compressed size: "+t+" != "+c),u!=a&&ae(y,"Bad uncompressed size: "+a+" != "+u),ue(r,h,v,{unsafe:!0,mt:l})}var se={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ie(e,t){if(e.ctype)return e.ctype;var a=e.name||"",r=a.match(/\.([^\.]+)$/);return r&&se[r[1]]||t&&(r=(a=t).match(/[\.\\]([^\.\\])+$/))&&se[r[1]]?se[r[1]]:"application/octet-stream"}function oe(e){for(var t=dr(e),a=[],r=0;r<t.length;r+=76)a.push(t.slice(r,r+76));return a.join("\r\n")+"\r\n"}function le(e){var t=e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(e){var t=e.charCodeAt(0).toString(16).toUpperCase();return"="+(1==t.length?"0"+t:t)});"\n"==(t=t.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)&&(t="=0D"+t.slice(1));for(var a=[],r=(t=t.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,"\n=0A").replace(/([^\r\n])\n/gm,"$1=0A")).split("\r\n"),n=0;n<r.length;++n){var s=r[n];if(0!=s.length)for(var i=0;i<s.length;){var o=76,l=s.slice(i,i+o);"="==l.charAt(o-1)?o--:"="==l.charAt(o-2)?o-=2:"="==l.charAt(o-3)&&(o-=3),l=s.slice(i,i+o),(i+=o)<s.length&&(l+="="),a.push(l)}else a.push("")}return a.join("\r\n")}function ce(e,t,a){for(var r,n="",s="",i="",o=0;o<10;++o){var l=t[o];if(!l||l.match(/^\s*$/))break;var c=l.match(/^(.*?):\s*([^\s].*)$/);if(c)switch(c[1].toLowerCase()){case"content-location":n=c[2].trim();break;case"content-type":i=c[2].trim();break;case"content-transfer-encoding":s=c[2].trim()}}switch(++o,s.toLowerCase()){case"base64":r=vr(fr(t.slice(o).join("")));break;case"quoted-printable":r=function(e){for(var t=[],a=0;a<e.length;++a){for(var r=e[a];a<=e.length&&"="==r.charAt(r.length-1);)r=r.slice(0,r.length-1)+e[++a];t.push(r)}for(var n=0;n<t.length;++n)t[n]=t[n].replace(/[=][0-9A-Fa-f]{2}/g,function(e){return String.fromCharCode(parseInt(e.slice(1),16))});return vr(t.join("\r\n"))}(t.slice(o));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+s)}var u=ue(e,n.slice(a.length),r,{unsafe:!0});i&&(u.ctype=i)}function ue(e,t,a,n){var s=n&&n.unsafe;s||f(e);var i=!s&&bn.find(e,t);if(!i){var o=e.FullPaths[0];t.slice(0,o.length)==o?o=t:("/"!=o.slice(-1)&&(o+="/"),o=(o+t).replace("//","/")),i={name:r(t),type:2},e.FileIndex.push(i),e.FullPaths.push(o),s||bn.utils.cfb_gc(e)}return i.content=a,i.size=a?a.length:0,n&&(n.CLSID&&(i.clsid=n.CLSID),n.mt&&(i.mt=n.mt),n.ct&&(i.ct=n.ct)),i}return t.find=function(e,t){var a=e.FullPaths.map(function(e){return e.toUpperCase()}),r=a.map(function(e){var t=e.split("/");return t[t.length-("/"==e.slice(-1)?2:1)]}),n=!1;47===t.charCodeAt(0)?(n=!0,t=a[0].slice(0,-1)+t):n=-1!==t.indexOf("/");var s=t.toUpperCase(),i=!0===n?a.indexOf(s):r.indexOf(s);if(-1!==i)return e.FileIndex[i];var o=!s.match(Sr);for(s=s.replace(kr,""),o&&(s=s.replace(Sr,"!")),i=0;i<a.length;++i){if((o?a[i].replace(Sr,"!"):a[i]).replace(kr,"")==s)return e.FileIndex[i];if((o?r[i].replace(Sr,"!"):r[i]).replace(kr,"")==s)return e.FileIndex[i]}return null},t.read=function(t,a){var r=a&&a.type;switch(r||hr&&Buffer.isBuffer(t)&&(r="buffer"),r||"base64"){case"file":return function(t,a){return i(),o(e.readFileSync(t),a)}(t,a);case"base64":return o(vr(fr(t)),a);case"binary":return o(vr(t),a)}return o(t,a)},t.parse=o,t.write=function(t,a){var r=m(t,a);switch(a&&a.type||"buffer"){case"file":return i(),e.writeFileSync(a.filename,r),r;case"binary":return"string"==typeof r?r:k(r);case"base64":return dr("string"==typeof r?r:k(r));case"buffer":if(hr)return Buffer.isBuffer(r)?r:mr(r);case"array":return"string"==typeof r?vr(r):r}return r},t.writeFile=function(t,a,r){i();var n=m(t,r);e.writeFileSync(a,n)},t.utils={cfb_new:function(e){var t={};return f(t,e),t},cfb_add:ue,cfb_del:function(e,t){f(e);var a=bn.find(e,t);if(a)for(var r=0;r<e.FileIndex.length;++r)if(e.FileIndex[r]==a)return e.FileIndex.splice(r,1),e.FullPaths.splice(r,1),!0;return!1},cfb_mov:function(e,t,a){f(e);var n=bn.find(e,t);if(n)for(var s=0;s<e.FileIndex.length;++s)if(e.FileIndex[s]==n)return e.FileIndex[s].name=r(a),e.FullPaths[s]=a,!0;return!1},cfb_gc:function(e){h(e,!0)},ReadShift:Ii,CheckField:Bi,prep_blob:Wi,bconcat:xr,use_zlib:function(e){try{var t=new(0,e.InflateRaw);if(t._processChunk(new Uint8Array([3,0]),t._finishFlushFlag),!t.bytesRead)throw new Error("zlib does not expose bytesRead");p=e}catch(Ig){console.error("cannot use native zlib: "+(Ig.message||Ig))}},_deflateRaw:Y,_inflateRaw:te,consts:x},t}();let wn;function xn(e){return"string"===typeof e?yr(e):Array.isArray(e)?function(e){if("undefined"===typeof Uint8Array)throw new Error("Unsupported");return new Uint8Array(e)}(e):e}function kn(e,t,a){if("undefined"!==typeof wn&&wn.writeFileSync)return a?wn.writeFileSync(e,t,a):wn.writeFileSync(e,t);if("undefined"!==typeof Deno){if(a&&"string"==typeof t)switch(a){case"utf8":t=new TextEncoder(a).encode(t);break;case"binary":t=yr(t);break;default:throw new Error("Unsupported encoding "+a)}return Deno.writeFileSync(e,t)}var r="utf8"==a?js(t):t;if("undefined"!==typeof IE_SaveFile)return IE_SaveFile(r,e);if("undefined"!==typeof Blob){var n=new Blob([xn(r)],{type:"application/octet-stream"});if("undefined"!==typeof navigator&&navigator.msSaveBlob)return navigator.msSaveBlob(n,e);if("undefined"!==typeof saveAs)return saveAs(n,e);if("undefined"!==typeof URL&&"undefined"!==typeof document&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(n);if("object"===typeof chrome&&"function"==typeof(chrome.downloads||{}).download)return URL.revokeObjectURL&&"undefined"!==typeof setTimeout&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var i=document.createElement("a");if(null!=i.download)return i.download=e,i.href=s,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&"undefined"!==typeof setTimeout&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if("undefined"!==typeof $&&"undefined"!==typeof File&&"undefined"!==typeof Folder)try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=br(t)),o.write(t),o.close(),t}catch(Ig){if(!Ig.message||!Ig.message.match(/onstruct/))throw Ig}throw new Error("cannot save file "+e)}function Sn(e){for(var t=Object.keys(e),a=[],r=0;r<t.length;++r)Object.prototype.hasOwnProperty.call(e,t[r])&&a.push(t[r]);return a}function En(e,t){for(var a=[],r=Sn(e),n=0;n!==r.length;++n)null==a[e[r[n]][t]]&&(a[e[r[n]][t]]=r[n]);return a}function Tn(e){for(var t=[],a=Sn(e),r=0;r!==a.length;++r)t[e[a[r]]]=a[r];return t}function Nn(e){for(var t=[],a=Sn(e),r=0;r!==a.length;++r)t[e[a[r]]]=parseInt(a[r],10);return t}var jn=new Date(1899,11,30,0,0,0);function Cn(e,t){var a=e.getTime();return t&&(a-=1263168e5),(a-(jn.getTime()+6e4*(e.getTimezoneOffset()-jn.getTimezoneOffset())))/864e5}var _n=new Date,An=jn.getTime()+6e4*(_n.getTimezoneOffset()-jn.getTimezoneOffset()),Pn=_n.getTimezoneOffset();function Rn(e){var t=new Date;return t.setTime(24*e*60*60*1e3+An),t.getTimezoneOffset()!==Pn&&t.setTime(t.getTime()+6e4*(t.getTimezoneOffset()-Pn)),t}function On(e){var t=0,a=0,r=!1,n=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=n.length;++s)if(n[s]){switch(a=1,s>3&&(r=!0),n[s].slice(n[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[s].slice(n[s].length-1));case"D":a*=24;case"H":a*=60;case"M":if(!r)throw new Error("Unsupported ISO Duration Field: M");a*=60}t+=a*parseInt(n[s],10)}return t}var Dn=new Date("2017-02-19T19:06:09.000Z"),Fn=isNaN(Dn.getFullYear())?new Date("2/19/17"):Dn,In=2017==Fn.getFullYear();function Ln(e,t){var a=new Date(e);if(In)return t>0?a.setTime(a.getTime()+60*a.getTimezoneOffset()*1e3):t<0&&a.setTime(a.getTime()-60*a.getTimezoneOffset()*1e3),a;if(e instanceof Date)return e;if(1917==Fn.getFullYear()&&!isNaN(a.getFullYear())){var r=a.getFullYear();return e.indexOf(""+r)>-1||a.setFullYear(a.getFullYear()+100),a}var n=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-60*s.getTimezoneOffset()*1e3)),s}function Mn(e,t){if(hr&&Buffer.isBuffer(e)){if(t){if(255==e[0]&&254==e[1])return js(e.slice(2).toString("utf16le"));if(254==e[1]&&255==e[2])return js(sr(e.slice(2).toString("binary")))}return e.toString("binary")}if("undefined"!==typeof TextDecoder)try{if(t){if(255==e[0]&&254==e[1])return js(new TextDecoder("utf-16le").decode(e.slice(2)));if(254==e[0]&&255==e[1])return js(new TextDecoder("utf-16be").decode(e.slice(2)))}var a={"\u20ac":"\x80","\u201a":"\x82","\u0192":"\x83","\u201e":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02c6":"\x88","\u2030":"\x89","\u0160":"\x8a","\u2039":"\x8b","\u0152":"\x8c","\u017d":"\x8e","\u2018":"\x91","\u2019":"\x92","\u201c":"\x93","\u201d":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02dc":"\x98","\u2122":"\x99","\u0161":"\x9a","\u203a":"\x9b","\u0153":"\x9c","\u017e":"\x9e","\u0178":"\x9f"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[\u20ac\u201a\u0192\u201e\u2026\u2020\u2021\u02c6\u2030\u0160\u2039\u0152\u017d\u2018\u2019\u201c\u201d\u2022\u2013\u2014\u02dc\u2122\u0161\u203a\u0153\u017e\u0178]/g,function(e){return a[e]||e})}catch(Ig){}for(var r=[],n=0;n!=e.length;++n)r.push(String.fromCharCode(e[n]));return r.join("")}function zn(e){if("undefined"!=typeof JSON&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if("object"!=typeof e||null==e)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=zn(e[a]));return t}function Un(e,t){for(var a="";a.length<t;)a+=e;return a}function Bn(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var a=1,r=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return a*=100,""});return isNaN(t=Number(r))?(r=r.replace(/[(](.*)[)]/,function(e,t){return a=-a,t}),isNaN(t=Number(r))?t:t/a):t/a}var Wn=["january","february","march","april","may","june","july","august","september","october","november","december"];function Hn(e){var t=new Date(e),a=new Date(NaN),r=t.getYear(),n=t.getMonth(),s=t.getDate();if(isNaN(s))return a;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==Wn.indexOf(i))return a}else if(i.match(/[a-z]/))return a;return r<0||r>8099?a:(n>0||s>1)&&101!=r?t:e.match(/[^-0-9:,\/\\]/)?a:t}var Vn=function(){var e=5=="abacaba".split(/(:?b)/i).length;return function(t,a,r){if(e||"string"==typeof a)return t.split(a);for(var n=t.split(a),s=[n[0]],i=1;i<n.length;++i)s.push(r),s.push(n[i]);return s}}();function Gn(e){return e?e.content&&e.type?Mn(e.content,!0):e.data?or(e.data):e.asNodeBuffer&&hr?or(e.asNodeBuffer().toString("binary")):e.asBinary?or(e.asBinary()):e._data&&e._data.getContent?or(Mn(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function $n(e){if(!e)return null;if(e.data)return nr(e.data);if(e.asNodeBuffer&&hr)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return"string"==typeof t?nr(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function qn(e,t){for(var a=e.FullPaths||Sn(e.files),r=t.toLowerCase().replace(/[\/]/g,"\\"),n=r.replace(/\\/g,"/"),s=0;s<a.length;++s){var i=a[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(r==i||n==i)return e.files?e.files[a[s]]:e.FileIndex[s]}return null}function Yn(e,t){var a=qn(e,t);if(null==a)throw new Error("Cannot find file "+t+" in zip");return a}function Xn(e,t,a){if(!a)return function(e){return e&&".bin"===e.name.slice(-4)?$n(e):Gn(e)}(Yn(e,t));if(!t)return null;try{return Xn(e,t)}catch(Ig){return null}}function Kn(e,t,a){if(!a)return Gn(Yn(e,t));if(!t)return null;try{return Kn(e,t)}catch(Ig){return null}}function Jn(e,t,a){if(!a)return $n(Yn(e,t));if(!t)return null;try{return Jn(e,t)}catch(Ig){return null}}function Qn(e){for(var t=e.FullPaths||Sn(e.files),a=[],r=0;r<t.length;++r)"/"!=t[r].slice(-1)&&a.push(t[r].replace(/^Root Entry[\/]/,""));return a.sort()}function Zn(e,t,a){if(e.FullPaths){var r;if("string"==typeof a)return r=hr?mr(a):function(e){for(var t=[],a=0,r=e.length+250,n=pr(e.length+255),s=0;s<e.length;++s){var i=e.charCodeAt(s);if(i<128)n[a++]=i;else if(i<2048)n[a++]=192|i>>6&31,n[a++]=128|63&i;else if(i>=55296&&i<57344){i=64+(1023&i);var o=1023&e.charCodeAt(++s);n[a++]=240|i>>8&7,n[a++]=128|i>>2&63,n[a++]=128|o>>6&15|(3&i)<<4,n[a++]=128|63&o}else n[a++]=224|i>>12&15,n[a++]=128|i>>6&63,n[a++]=128|63&i;a>r&&(t.push(n.slice(0,a)),a=0,n=pr(65535),r=65530)}return t.push(n.slice(0,a)),xr(t)}(a),bn.utils.cfb_add(e,t,r);bn.utils.cfb_add(e,t,a)}else e.file(t,a)}function es(){return bn.utils.cfb_new()}function ts(e,t){switch(t.type){case"base64":return bn.read(e,{type:"base64"});case"binary":return bn.read(e,{type:"binary"});case"buffer":case"array":return bn.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function as(e,t){if("/"==e.charAt(0))return e.slice(1);var a=t.split("/");"/"!=t.slice(-1)&&a.pop();for(var r=e.split("/");0!==r.length;){var n=r.shift();".."===n?a.pop():"."!==n&&a.push(n)}return a.join("/")}var rs='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',ns=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,ss=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/gm,is=rs.match(ss)?ss:/<[^>]*>/g,os=/<\w*:/,ls=/<(\/?)\w+:/;function cs(e,t,a){for(var r={},n=0,s=0;n!==e.length&&(32!==(s=e.charCodeAt(n))&&10!==s&&13!==s);++n);if(t||(r[0]=e.slice(0,n)),n===e.length)return r;var i=e.match(ns),o=0,l="",c=0,u="",d="",f=1;if(i)for(c=0;c!=i.length;++c){for(d=i[c],s=0;s!=d.length&&61!==d.charCodeAt(s);++s);for(u=d.slice(0,s).trim();32==d.charCodeAt(s+1);)++s;for(f=34==(n=d.charCodeAt(s+1))||39==n?1:0,l=d.slice(s+1+f,d.length-f),o=0;o!=u.length&&58!==u.charCodeAt(o);++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),r[u]=l,a||(r[u.toLowerCase()]=l);else{var h=(5===o&&"xmlns"===u.slice(0,5)?"xmlns":"")+u.slice(o+1);if(r[h]&&"ext"==u.slice(o-3,o))continue;r[h]=l,a||(r[h.toLowerCase()]=l)}}return r}function us(e){return e.replace(ls,"<$1")}var ds={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},fs=Tn(ds),hs=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/gi,t=/_x([\da-fA-F]{4})_/gi;return function a(r){var n=r+"",s=n.indexOf("<![CDATA[");if(-1==s)return n.replace(e,function(e,t){return ds[e]||String.fromCharCode(parseInt(t,e.indexOf("x")>-1?16:10))||e}).replace(t,function(e,t){return String.fromCharCode(parseInt(t,16))});var i=n.indexOf("]]>");return a(n.slice(0,s))+n.slice(s+9,i)+a(n.slice(i+3))}}(),ms=/[&<>'"]/g,ps=/[\u0000-\u0008\u000b-\u001f]/g;function gs(e){return(e+"").replace(ms,function(e){return fs[e]}).replace(ps,function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"})}function vs(e){return gs(e).replace(/ /g,"_x0020_")}var ys=/[\u0000-\u001f]/g;function bs(e){return(e+"").replace(ms,function(e){return fs[e]}).replace(/\n/g,"<br/>").replace(ys,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}var ws=function(){var e=/&#(\d+);/g;function t(e,t){return String.fromCharCode(parseInt(t,10))}return function(a){return a.replace(e,t)}}();function xs(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function ks(e){for(var t="",a=0,r=0,n=0,s=0,i=0,o=0;a<e.length;)(r=e.charCodeAt(a++))<128?t+=String.fromCharCode(r):(n=e.charCodeAt(a++),r>191&&r<224?(i=(31&r)<<6,i|=63&n,t+=String.fromCharCode(i)):(s=e.charCodeAt(a++),r<240?t+=String.fromCharCode((15&r)<<12|(63&n)<<6|63&s):(o=((7&r)<<18|(63&n)<<12|(63&s)<<6|63&(i=e.charCodeAt(a++)))-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(1023&o)))));return t}function Ss(e){var t,a,r,n=pr(2*e.length),s=1,i=0,o=0;for(a=0;a<e.length;a+=s)s=1,(r=e.charCodeAt(a))<128?t=r:r<224?(t=64*(31&r)+(63&e.charCodeAt(a+1)),s=2):r<240?(t=4096*(15&r)+64*(63&e.charCodeAt(a+1))+(63&e.charCodeAt(a+2)),s=3):(s=4,t=262144*(7&r)+4096*(63&e.charCodeAt(a+1))+64*(63&e.charCodeAt(a+2))+(63&e.charCodeAt(a+3)),o=55296+((t-=65536)>>>10&1023),t=56320+(1023&t)),0!==o&&(n[i++]=255&o,n[i++]=o>>>8,o=0),n[i++]=t%256,n[i++]=t>>>8;return n.slice(0,i).toString("ucs2")}function Es(e){return mr(e,"binary").toString("utf8")}var Ts="foo bar baz\xe2\x98\x83\xf0\x9f\x8d\xa3",Ns=hr&&(Es(Ts)==ks(Ts)&&Es||Ss(Ts)==ks(Ts)&&Ss)||ks,js=hr?function(e){return mr(e,"utf8").toString("binary")}:function(e){for(var t=[],a=0,r=0,n=0;a<e.length;)switch(r=e.charCodeAt(a++),!0){case r<128:t.push(String.fromCharCode(r));break;case r<2048:t.push(String.fromCharCode(192+(r>>6))),t.push(String.fromCharCode(128+(63&r)));break;case r>=55296&&r<57344:r-=55296,n=e.charCodeAt(a++)-56320+(r<<10),t.push(String.fromCharCode(240+(n>>18&7))),t.push(String.fromCharCode(144+(n>>12&63))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(63&n)));break;default:t.push(String.fromCharCode(224+(r>>12))),t.push(String.fromCharCode(128+(r>>6&63))),t.push(String.fromCharCode(128+(63&r)))}return t.join("")},Cs=function(){var e={};return function(t,a){var r=t+"|"+(a||"");return e[r]?e[r]:e[r]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",a||"")}}(),_s=function(){var e=[["nbsp"," "],["middot","\xb7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var a=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),r=0;r<e.length;++r)a=a.replace(e[r][0],e[r][1]);return a}}(),As=function(){var e={};return function(t){return void 0!==e[t]?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),Ps=/<\/?(?:vt:)?variant>/g,Rs=/<(?:vt:)([^>]*)>([\s\S]*)</;function Os(e,t){var a=cs(e),r=e.match(As(a.baseType))||[],n=[];if(r.length!=a.size){if(t.WTF)throw new Error("unexpected vector length "+r.length+" != "+a.size);return n}return r.forEach(function(e){var t=e.replace(Ps,"").match(Rs);t&&n.push({v:Ns(t[2]),t:t[1]})}),n}var Ds=/(^\s|\s$|\n)/;function Fs(e,t){return"<"+e+(t.match(Ds)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Is(e){return Sn(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Ls(e,t,a){return"<"+e+(null!=a?Is(a):"")+(null!=t?(t.match(Ds)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Ms(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(Ig){if(t)throw Ig}return""}function zs(e){if(hr&&Buffer.isBuffer(e))return e.toString("utf8");if("string"===typeof e)return e;if("undefined"!==typeof Uint8Array&&e instanceof Uint8Array)return Ns(br(wr(e)));throw new Error("Bad input format: expected Buffer or string")}var Us=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/gm,Bs="http://schemas.openxmlformats.org/package/2006/metadata/core-properties",Ws="http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",Hs="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",Vs="http://schemas.openxmlformats.org/package/2006/content-types",Gs="http://schemas.openxmlformats.org/package/2006/relationships",$s="http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",qs="http://purl.org/dc/elements/1.1/",Ys="http://purl.org/dc/terms/",Xs="http://purl.org/dc/dcmitype/",Ks="http://schemas.openxmlformats.org/officeDocument/2006/relationships",Js="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",Qs="http://www.w3.org/2001/XMLSchema-instance",Zs="http://www.w3.org/2001/XMLSchema",ei=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],ti="urn:schemas-microsoft-com:office:office",ai="urn:schemas-microsoft-com:office:excel",ri="urn:schemas-microsoft-com:office:spreadsheet",ni="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",si="http://macVmlSchemaUri",ii="urn:schemas-microsoft-com:vml",oi="http://www.w3.org/TR/REC-html40";var li=function(e){for(var t=[],a=0;a<e[0].length;++a)if(e[0][a])for(var r=0,n=e[0][a].length;r<n;r+=10240)t.push.apply(t,e[0][a].slice(r,r+10240));return t},ci=hr?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(e){return Buffer.isBuffer(e)?e:mr(e)})):li(e)}:li,ui=function(e,t,a){for(var r=[],n=t;n<a;n+=2)r.push(String.fromCharCode(Pi(e,n)));return r.join("").replace(kr,"")},di=hr?function(e,t,a){return Buffer.isBuffer(e)?e.toString("utf16le",t,a).replace(kr,""):ui(e,t,a)}:ui,fi=function(e,t,a){for(var r=[],n=t;n<t+a;++n)r.push(("0"+e[n].toString(16)).slice(-2));return r.join("")},hi=hr?function(e,t,a){return Buffer.isBuffer(e)?e.toString("hex",t,t+a):fi(e,t,a)}:fi,mi=function(e,t,a){for(var r=[],n=t;n<a;n++)r.push(String.fromCharCode(Ai(e,n)));return r.join("")},pi=hr?function(e,t,a){return Buffer.isBuffer(e)?e.toString("utf8",t,a):mi(e,t,a)}:mi,gi=function(e,t){var a=Oi(e,t);return a>0?pi(e,t+4,t+4+a-1):""},vi=gi,yi=function(e,t){var a=Oi(e,t);return a>0?pi(e,t+4,t+4+a-1):""},bi=yi,wi=function(e,t){var a=2*Oi(e,t);return a>0?pi(e,t+4,t+4+a-1):""},xi=wi,ki=function(e,t){var a=Oi(e,t);return a>0?di(e,t+4,t+4+a):""},Si=ki,Ei=function(e,t){var a=Oi(e,t);return a>0?pi(e,t+4,t+4+a):""},Ti=Ei,Ni=function(e,t){return function(e,t){for(var a=1-2*(e[t+7]>>>7),r=((127&e[t+7])<<4)+(e[t+6]>>>4&15),n=15&e[t+6],s=5;s>=0;--s)n=256*n+e[t+s];return 2047==r?0==n?a*(1/0):NaN:(0==r?r=-1022:(r-=1023,n+=Math.pow(2,52)),a*Math.pow(2,r-52)*n)}(e,t)},ji=Ni,Ci=function(e){return Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array};function _i(){di=function(e,t,a){return ir.utils.decode(1200,e.slice(t,a)).replace(kr,"")},pi=function(e,t,a){return ir.utils.decode(65001,e.slice(t,a))},vi=function(e,t){var a=Oi(e,t);return a>0?ir.utils.decode(Qa,e.slice(t+4,t+4+a-1)):""},bi=function(e,t){var a=Oi(e,t);return a>0?ir.utils.decode(Ja,e.slice(t+4,t+4+a-1)):""},xi=function(e,t){var a=2*Oi(e,t);return a>0?ir.utils.decode(1200,e.slice(t+4,t+4+a-1)):""},Si=function(e,t){var a=Oi(e,t);return a>0?ir.utils.decode(1200,e.slice(t+4,t+4+a)):""},Ti=function(e,t){var a=Oi(e,t);return a>0?ir.utils.decode(65001,e.slice(t+4,t+4+a)):""}}hr&&(vi=function(e,t){if(!Buffer.isBuffer(e))return gi(e,t);var a=e.readUInt32LE(t);return a>0?e.toString("utf8",t+4,t+4+a-1):""},bi=function(e,t){if(!Buffer.isBuffer(e))return yi(e,t);var a=e.readUInt32LE(t);return a>0?e.toString("utf8",t+4,t+4+a-1):""},xi=function(e,t){if(!Buffer.isBuffer(e))return wi(e,t);var a=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+a-1)},Si=function(e,t){if(!Buffer.isBuffer(e))return ki(e,t);var a=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+a)},Ti=function(e,t){if(!Buffer.isBuffer(e))return Ei(e,t);var a=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+a)},ji=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):Ni(e,t)},Ci=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array}),"undefined"!==typeof ir&&_i();var Ai=function(e,t){return e[t]},Pi=function(e,t){return 256*e[t+1]+e[t]},Ri=function(e,t){var a=256*e[t+1]+e[t];return a<32768?a:-1*(65535-a+1)},Oi=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Di=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},Fi=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Ii(e,t){var a,r,n,s,i,o,l="",c=[];switch(t){case"dbcs":if(o=this.l,hr&&Buffer.isBuffer(this))l=this.slice(this.l,this.l+2*e).toString("utf16le");else for(i=0;i<e;++i)l+=String.fromCharCode(Pi(this,o)),o+=2;e*=2;break;case"utf8":l=pi(this,this.l,this.l+e);break;case"utf16le":e*=2,l=di(this,this.l,this.l+e);break;case"wstr":if("undefined"===typeof ir)return Ii.call(this,e,"dbcs");l=ir.utils.decode(Ja,this.slice(this.l,this.l+2*e)),e*=2;break;case"lpstr-ansi":l=vi(this,this.l),e=4+Oi(this,this.l);break;case"lpstr-cp":l=bi(this,this.l),e=4+Oi(this,this.l);break;case"lpwstr":l=xi(this,this.l),e=4+2*Oi(this,this.l);break;case"lpp4":e=4+Oi(this,this.l),l=Si(this,this.l),2&e&&(e+=2);break;case"8lpp4":e=4+Oi(this,this.l),l=Ti(this,this.l),3&e&&(e+=4-(3&e));break;case"cstr":for(e=0,l="";0!==(n=Ai(this,this.l+e++));)c.push(lr(n));l=c.join("");break;case"_wstr":for(e=0,l="";0!==(n=Pi(this,this.l+e));)c.push(lr(n)),e+=2;e+=2,l=c.join("");break;case"dbcs-cont":for(l="",o=this.l,i=0;i<e;++i){if(this.lens&&-1!==this.lens.indexOf(o))return n=Ai(this,o),this.l=o+1,s=Ii.call(this,e-i,n?"dbcs-cont":"sbcs-cont"),c.join("")+s;c.push(lr(Pi(this,o))),o+=2}l=c.join(""),e*=2;break;case"cpstr":if("undefined"!==typeof ir){l=ir.utils.decode(Ja,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(l="",o=this.l,i=0;i!=e;++i){if(this.lens&&-1!==this.lens.indexOf(o))return n=Ai(this,o),this.l=o+1,s=Ii.call(this,e-i,n?"dbcs-cont":"sbcs-cont"),c.join("")+s;c.push(lr(Ai(this,o))),o+=1}l=c.join("");break;default:switch(e){case 1:return a=Ai(this,this.l),this.l++,a;case 2:return a=("i"===t?Ri:Pi)(this,this.l),this.l+=2,a;case 4:case-4:return"i"===t||0===(128&this[this.l+3])?(a=(e>0?Di:Fi)(this,this.l),this.l+=4,a):(r=Oi(this,this.l),this.l+=4,r);case 8:case-8:if("f"===t)return r=8==e?ji(this,this.l):ji([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,r;e=8;case 16:l=hi(this,this.l,e)}}return this.l+=e,l}var Li=function(e,t,a){e[a]=255&t,e[a+1]=t>>>8&255,e[a+2]=t>>>16&255,e[a+3]=t>>>24&255},Mi=function(e,t,a){e[a]=255&t,e[a+1]=t>>8&255,e[a+2]=t>>16&255,e[a+3]=t>>24&255},zi=function(e,t,a){e[a]=255&t,e[a+1]=t>>>8&255};function Ui(e,t,a){var r=0,n=0;if("dbcs"===a){for(n=0;n!=t.length;++n)zi(this,t.charCodeAt(n),this.l+2*n);r=2*t.length}else if("sbcs"===a){if("undefined"!==typeof ir&&874==Qa)for(n=0;n!=t.length;++n){var s=ir.utils.encode(Qa,t.charAt(n));this[this.l+n]=s[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=t.length;++n)this[this.l+n]=255&t.charCodeAt(n);r=t.length}else{if("hex"===a){for(;n<e;++n)this[this.l++]=parseInt(t.slice(2*n,2*n+2),16)||0;return this}if("utf16le"===a){var i=Math.min(this.l+e,this.length);for(n=0;n<Math.min(t.length,e);++n){var o=t.charCodeAt(n);this[this.l++]=255&o,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}switch(e){case 1:r=1,this[this.l]=255&t;break;case 2:r=2,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t;break;case 3:r=3,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t,t>>>=8,this[this.l+2]=255&t;break;case 4:r=4,Li(this,t,this.l);break;case 8:if(r=8,"f"===a){!function(e,t,a){var r=(t<0||1/t==-1/0?1:0)<<7,n=0,s=0,i=r?-t:t;isFinite(i)?0==i?n=s=0:(n=Math.floor(Math.log(i)/Math.LN2),s=i*Math.pow(2,52-n),n<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?n=-1022:(s-=Math.pow(2,52),n+=1023)):(n=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[a+o]=255&s;e[a+6]=(15&n)<<4|15&s,e[a+7]=n>>4|r}(this,t,this.l);break}case 16:break;case-4:r=4,Mi(this,t,this.l)}}return this.l+=r,this}function Bi(e,t){var a=hi(this,this.l,e.length>>1);if(a!==e)throw new Error(t+"Expected "+e+" saw "+a);this.l+=e.length>>1}function Wi(e,t){e.l=t,e.read_shift=Ii,e.chk=Bi,e.write_shift=Ui}function Hi(e,t){e.l+=t}function Vi(e){var t=pr(e);return Wi(t,0),t}function Gi(e,t,a){if(e){var r,n,s;Wi(e,e.l||0);for(var i=e.length,o=0,l=0;e.l<i;){128&(o=e.read_shift(1))&&(o=(127&o)+((127&e.read_shift(1))<<7));var c=tm[o]||tm[65535];for(s=127&(r=e.read_shift(1)),n=1;n<4&&128&r;++n)s+=(127&(r=e.read_shift(1)))<<7*n;l=e.l+s;var u=c.f&&c.f(e,s,a);if(e.l=l,t(u,c,o))return}}}function $i(){var e=[],t=hr?256:2048,a=function(e){var t=Vi(e);return Wi(t,0),t},r=a(t),n=function(){r&&(r.length>r.l&&((r=r.slice(0,r.l)).l=r.length),r.length>0&&e.push(r),r=null)},s=function(e){return r&&e<r.length-r.l?r:(n(),r=a(Math.max(e+1,t)))};return{next:s,push:function(e){n(),null==(r=e).l&&(r.l=r.length),s(t)},end:function(){return n(),xr(e)},_bufs:e}}function qi(e,t,a,r){var n,s=+t;if(!isNaN(s)){r||(r=tm[s].p||(a||[]).length||0),n=1+(s>=128?1:0)+1,r>=128&&++n,r>=16384&&++n,r>=2097152&&++n;var i=e.next(n);s<=127?i.write_shift(1,s):(i.write_shift(1,128+(127&s)),i.write_shift(1,s>>7));for(var o=0;4!=o;++o){if(!(r>=128)){i.write_shift(1,r);break}i.write_shift(1,128+(127&r)),r>>=7}r>0&&Ci(a)&&e.push(a)}}function Yi(e,t,a){var r=zn(e);if(t.s?(r.cRel&&(r.c+=t.s.c),r.rRel&&(r.r+=t.s.r)):(r.cRel&&(r.c+=t.c),r.rRel&&(r.r+=t.r)),!a||a.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function Xi(e,t,a){var r=zn(e);return r.s=Yi(r.s,t.s,a),r.e=Yi(r.e,t.s,a),r}function Ki(e,t){if(e.cRel&&e.c<0)for(e=zn(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=zn(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var a=ro(e);return e.cRel||null==e.cRel||(a=a.replace(/^([A-Z])/,"$$$1")),e.rRel||null==e.rRel||(a=function(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}(a)),a}function Ji(e,t){return 0!=e.s.r||e.s.rRel||e.e.r!=(t.biff>=12?1048575:t.biff>=8?65536:16384)||e.e.rRel?0!=e.s.c||e.s.cRel||e.e.c!=(t.biff>=12?16383:255)||e.e.cRel?Ki(e.s,t.biff)+":"+Ki(e.e,t.biff):(e.s.rRel?"":"$")+Zi(e.s.r)+":"+(e.e.rRel?"":"$")+Zi(e.e.r):(e.s.cRel?"":"$")+to(e.s.c)+":"+(e.e.cRel?"":"$")+to(e.e.c)}function Qi(e){return parseInt(e.replace(/\$(\d+)$/,"$1"),10)-1}function Zi(e){return""+(e+1)}function eo(e){for(var t=e.replace(/^\$([A-Z])/,"$1"),a=0,r=0;r!==t.length;++r)a=26*a+t.charCodeAt(r)-64;return a-1}function to(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function ao(e){for(var t=0,a=0,r=0;r<e.length;++r){var n=e.charCodeAt(r);n>=48&&n<=57?t=10*t+(n-48):n>=65&&n<=90&&(a=26*a+(n-64))}return{c:a-1,r:t-1}}function ro(e){for(var t=e.c+1,a="";t;t=(t-1)/26|0)a=String.fromCharCode((t-1)%26+65)+a;return a+(e.r+1)}function no(e){var t=e.indexOf(":");return-1==t?{s:ao(e),e:ao(e)}:{s:ao(e.slice(0,t)),e:ao(e.slice(t+1))}}function so(e,t){return"undefined"===typeof t||"number"===typeof t?so(e.s,e.e):("string"!==typeof e&&(e=ro(e)),"string"!==typeof t&&(t=ro(t)),e==t?e:e+":"+t)}function io(e){var t={s:{c:0,r:0},e:{c:0,r:0}},a=0,r=0,n=0,s=e.length;for(a=0;r<s&&!((n=e.charCodeAt(r)-64)<1||n>26);++r)a=26*a+n;for(t.s.c=--a,a=0;r<s&&!((n=e.charCodeAt(r)-48)<0||n>9);++r)a=10*a+n;if(t.s.r=--a,r===s||10!=n)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++r,a=0;r!=s&&!((n=e.charCodeAt(r)-64)<1||n>26);++r)a=26*a+n;for(t.e.c=--a,a=0;r!=s&&!((n=e.charCodeAt(r)-48)<0||n>9);++r)a=10*a+n;return t.e.r=--a,t}function oo(e,t){var a="d"==e.t&&t instanceof Date;if(null!=e.z)try{return e.w=fn(e.z,a?Cn(t):t)}catch(Ig){}try{return e.w=fn((e.XF||{}).numFmtId||(a?14:0),a?Cn(t):t)}catch(Ig){return""+t}}function lo(e,t,a){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&a&&a.dateNF&&(e.z=a.dateNF),"e"==e.t?Yo[e.v]||e.v:oo(e,void 0==t?e.v:t))}function co(e,t){var a=t&&t.sheet?t.sheet:"Sheet1",r={};return r[a]=e,{SheetNames:[a],Sheets:r}}function uo(e,t,a){var r=a||{},n=e?Array.isArray(e):r.dense;var s=e||(n?[]:{}),i=0,o=0;if(s&&null!=r.origin){if("number"==typeof r.origin)i=r.origin;else{var l="string"==typeof r.origin?ao(r.origin):r.origin;i=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var u=io(s["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),-1==i&&(c.e.r=i=u.e.r+1)}for(var d=0;d!=t.length;++d)if(t[d]){if(!Array.isArray(t[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var f=0;f!=t[d].length;++f)if("undefined"!==typeof t[d][f]){var h={v:t[d][f]},m=i+d,p=o+f;if(c.s.r>m&&(c.s.r=m),c.s.c>p&&(c.s.c=p),c.e.r<m&&(c.e.r=m),c.e.c<p&&(c.e.c=p),!t[d][f]||"object"!==typeof t[d][f]||Array.isArray(t[d][f])||t[d][f]instanceof Date)if(Array.isArray(h.v)&&(h.f=t[d][f][1],h.v=h.v[0]),null===h.v)if(h.f)h.t="n";else if(r.nullError)h.t="e",h.v=0;else{if(!r.sheetStubs)continue;h.t="z"}else"number"===typeof h.v?h.t="n":"boolean"===typeof h.v?h.t="b":h.v instanceof Date?(h.z=r.dateNF||Or[14],r.cellDates?(h.t="d",h.w=fn(h.z,Cn(h.v))):(h.t="n",h.v=Cn(h.v),h.w=fn(h.z,h.v))):h.t="s";else h=t[d][f];if(n)s[m]||(s[m]=[]),s[m][p]&&s[m][p].z&&(h.z=s[m][p].z),s[m][p]=h;else{var g=ro({c:p,r:m});s[g]&&s[g].z&&(h.z=s[g].z),s[g]=h}}}return c.s.c<1e7&&(s["!ref"]=so(c)),s}function fo(e,t){return uo(null,e,t)}function ho(e,t){return t||(t=Vi(4)),t.write_shift(4,e),t}function mo(e){var t=e.read_shift(4);return 0===t?"":e.read_shift(t,"dbcs")}function po(e,t){var a=!1;return null==t&&(a=!0,t=Vi(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),a?t.slice(0,t.l):t}function go(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function vo(e,t){var a=e.l,r=e.read_shift(1),n=mo(e),s=[],i={t:n,h:n};if(0!==(1&r)){for(var o=e.read_shift(4),l=0;l!=o;++l)s.push(go(e));i.r=s}else i.r=[{ich:0,ifnt:0}];return e.l=a+t,i}var yo=vo;function bo(e,t){var a=!1;return null==t&&(a=!0,t=Vi(23+4*e.t.length)),t.write_shift(1,1),po(e.t,t),t.write_shift(4,1),function(e,t){t||(t=Vi(4)),t.write_shift(2,e.ich||0),t.write_shift(2,e.ifnt||0)}({ich:0,ifnt:0},t),a?t.slice(0,t.l):t}function wo(e){var t=e.read_shift(4),a=e.read_shift(2);return a+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:a}}function xo(e,t){return null==t&&(t=Vi(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function ko(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function So(e,t){return null==t&&(t=Vi(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var Eo=mo,To=po;function No(e){var t=e.read_shift(4);return 0===t||4294967295===t?"":e.read_shift(t,"dbcs")}function jo(e,t){var a=!1;return null==t&&(a=!0,t=Vi(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),a?t.slice(0,t.l):t}var Co=mo,_o=No,Ao=jo;function Po(e){var t=e.slice(e.l,e.l+4),a=1&t[0],r=2&t[0];e.l+=4;var n=0===r?ji([0,0,0,0,252&t[0],t[1],t[2],t[3]],0):Di(t,0)>>2;return a?n/100:n}function Ro(e,t){null==t&&(t=Vi(4));var a=0,r=0,n=100*e;if(e==(0|e)&&e>=-(1<<29)&&e<1<<29?r=1:n==(0|n)&&n>=-(1<<29)&&n<1<<29&&(r=1,a=1),!r)throw new Error("unsupported RkNumber "+e);t.write_shift(-4,((a?n:e)<<2)+(a+2))}function Oo(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var Do=Oo,Fo=function(e,t){return t||(t=Vi(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t};function Io(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Lo(e,t){return(t||Vi(8)).write_shift(8,e,"f")}function Mo(e,t){if(t||(t=Vi(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;null!=e.index?(t.write_shift(1,2),t.write_shift(1,e.index)):null!=e.theme?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var a=e.tint||0;if(a>0?a*=32767:a<0&&(a*=32768),t.write_shift(2,a),e.rgb&&null==e.theme){var r=e.rgb||"FFFFFF";"number"==typeof r&&(r=("000000"+r.toString(16)).slice(-6)),t.write_shift(1,parseInt(r.slice(0,2),16)),t.write_shift(1,parseInt(r.slice(2,4),16)),t.write_shift(1,parseInt(r.slice(4,6),16)),t.write_shift(1,255)}else t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);return t}function zo(e,t){var a=e.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return{2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"}[e.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return e.l-=4,e.read_shift(0,1==t?"lpstr":"lpwstr")}var Uo=80,Bo=[Uo,81],Wo={1:{n:"CodePage",t:2},2:{n:"Category",t:Uo},3:{n:"PresentationFormat",t:Uo},4:{n:"ByteCount",t:3},5:{n:"LineCount",t:3},6:{n:"ParagraphCount",t:3},7:{n:"SlideCount",t:3},8:{n:"NoteCount",t:3},9:{n:"HiddenCount",t:3},10:{n:"MultimediaClipCount",t:3},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:Uo},15:{n:"Company",t:Uo},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:3},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:3,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:Uo},27:{n:"ContentStatus",t:Uo},28:{n:"Language",t:Uo},29:{n:"Version",t:Uo},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},Ho={1:{n:"CodePage",t:2},2:{n:"Title",t:Uo},3:{n:"Subject",t:Uo},4:{n:"Author",t:Uo},5:{n:"Keywords",t:Uo},6:{n:"Comments",t:Uo},7:{n:"Template",t:Uo},8:{n:"LastAuthor",t:Uo},9:{n:"RevNumber",t:Uo},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:3},15:{n:"WordCount",t:3},16:{n:"CharCount",t:3},17:{n:"Thumbnail",t:71},18:{n:"Application",t:Uo},19:{n:"DocSecurity",t:3},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},Vo={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Go=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function $o(e){return e.map(function(e){return[e>>16&255,e>>8&255,255&e]})}var qo=zn($o([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),Yo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Xo={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Ko={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Jo={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Qo(e,t){var a,r=function(e){for(var t=[],a=Sn(e),r=0;r!==a.length;++r)null==t[e[a[r]]]&&(t[e[a[r]]]=[]),t[e[a[r]]].push(a[r]);return t}(Ko),n=[];n[n.length]=rs,n[n.length]=Ls("Types",null,{xmlns:Vs,"xmlns:xsd":Zs,"xmlns:xsi":Qs}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(e){return Ls("Default",null,{Extension:e[0],ContentType:e[1]})}));var s=function(r){e[r]&&e[r].length>0&&(a=e[r][0],n[n.length]=Ls("Override",null,{PartName:("/"==a[0]?"":"/")+a,ContentType:Jo[r][t.bookType]||Jo[r].xlsx}))},i=function(a){(e[a]||[]).forEach(function(e){n[n.length]=Ls("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:Jo[a][t.bookType]||Jo[a].xlsx})})},o=function(t){(e[t]||[]).forEach(function(e){n[n.length]=Ls("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:r[t][0]})})};return s("workbooks"),i("sheets"),i("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),i("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Zo={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function el(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function tl(e,t){var a={"!id":{}};if(!e)return a;"/"!==t.charAt(0)&&(t="/"+t);var r={};return(e.match(is)||[]).forEach(function(e){var n=cs(e);if("<Relationship"===n[0]){var s={};s.Type=n.Type,s.Target=n.Target,s.Id=n.Id,n.TargetMode&&(s.TargetMode=n.TargetMode);var i="External"===n.TargetMode?n.Target:as(n.Target,t);a[i]=s,r[n.Id]=s}}),a["!id"]=r,a}function al(e){var t=[rs,Ls("Relationships",null,{xmlns:Gs})];return Sn(e["!id"]).forEach(function(a){t[t.length]=Ls("Relationship",null,e["!id"][a])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function rl(e,t,a,r,n,s){if(n||(n={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,n.Id="rId"+t,n.Type=r,n.Target=a,s?n.TargetMode=s:[Zo.HLINK,Zo.XPATH,Zo.XMISS].indexOf(n.Type)>-1&&(n.TargetMode="External"),e["!id"][n.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][n.Id]=n,e[("/"+n.Target).replace("//","/")]=n,t}function nl(e,t,a){return['  <rdf:Description rdf:about="'+e+'">\n','    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(a||"odf")+"#"+t+'"/>\n',"  </rdf:Description>\n"].join("")}function sl(e,t){return['  <rdf:Description rdf:about="'+e+'">\n','    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+'"/>\n',"  </rdf:Description>\n"].join("")}function il(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Ka.version+"</meta:generator></office:meta></office:document-meta>"}var ol=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],ll=function(){for(var e=new Array(ol.length),t=0;t<ol.length;++t){var a=ol[t],r="(?:"+a[0].slice(0,a[0].indexOf(":"))+":)"+a[0].slice(a[0].indexOf(":")+1);e[t]=new RegExp("<"+r+"[^>]*>([\\s\\S]*?)</"+r+">")}return e}();function cl(e){var t={};e=Ns(e);for(var a=0;a<ol.length;++a){var r=ol[a],n=e.match(ll[a]);null!=n&&n.length>0&&(t[r[1]]=hs(n[1])),"date"===r[2]&&t[r[1]]&&(t[r[1]]=Ln(t[r[1]]))}return t}function ul(e,t,a,r,n){null==n[e]&&null!=t&&""!==t&&(n[e]=t,t=gs(t),r[r.length]=a?Ls(e,t,a):Fs(e,t))}function dl(e,t){var a=t||{},r=[rs,Ls("cp:coreProperties",null,{"xmlns:cp":Bs,"xmlns:dc":qs,"xmlns:dcterms":Ys,"xmlns:dcmitype":Xs,"xmlns:xsi":Qs})],n={};if(!e&&!a.Props)return r.join("");e&&(null!=e.CreatedDate&&ul("dcterms:created","string"===typeof e.CreatedDate?e.CreatedDate:Ms(e.CreatedDate,a.WTF),{"xsi:type":"dcterms:W3CDTF"},r,n),null!=e.ModifiedDate&&ul("dcterms:modified","string"===typeof e.ModifiedDate?e.ModifiedDate:Ms(e.ModifiedDate,a.WTF),{"xsi:type":"dcterms:W3CDTF"},r,n));for(var s=0;s!=ol.length;++s){var i=ol[s],o=a.Props&&null!=a.Props[i[1]]?a.Props[i[1]]:e?e[i[1]]:null;!0===o?o="1":!1===o?o="0":"number"==typeof o&&(o=String(o)),null!=o&&ul(i[0],o,null,r,n)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var fl=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],hl=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function ml(e,t,a,r){var n=[];if("string"==typeof e)n=Os(e,r);else for(var s=0;s<e.length;++s)n=n.concat(e[s].map(function(e){return{v:e}}));var i="string"==typeof t?Os(t,r).map(function(e){return e.v}):t,o=0,l=0;if(i.length>0)for(var c=0;c!==n.length;c+=2){switch(l=+n[c+1].v,n[c].v){case"Worksheets":case"\u5de5\u4f5c\u8868":case"\u041b\u0438\u0441\u0442\u044b":case"\u0623\u0648\u0631\u0627\u0642 \u0627\u0644\u0639\u0645\u0644":case"\u30ef\u30fc\u30af\u30b7\u30fc\u30c8":case"\u05d2\u05dc\u05d9\u05d5\u05e0\u05d5\u05ea \u05e2\u05d1\u05d5\u05d3\u05d4":case"Arbeitsbl\xe4tter":case"\xc7al\u0131\u015fma Sayfalar\u0131":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de c\xe1lculo":case"Planilhas":case"Regneark":case"Hojas de c\xe1lculo":case"Werkbladen":a.Worksheets=l,a.SheetNames=i.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"\u540d\u524d\u4ed8\u304d\u4e00\u89a7":case"Benannte Bereiche":case"Navngivne omr\xe5der":a.NamedRanges=l,a.DefinedNames=i.slice(o,o+l);break;case"Charts":case"Diagramme":a.Chartsheets=l,a.ChartNames=i.slice(o,o+l)}o+=l}}function pl(e){var t=[],a=Ls;return e||(e={}),e.Application="SheetJS",t[t.length]=rs,t[t.length]=Ls("Properties",null,{xmlns:Hs,"xmlns:vt":Js}),fl.forEach(function(r){if(void 0!==e[r[1]]){var n;switch(r[2]){case"string":n=gs(String(e[r[1]]));break;case"bool":n=e[r[1]]?"true":"false"}void 0!==n&&(t[t.length]=a(r[0],n))}}),t[t.length]=a("HeadingPairs",a("vt:vector",a("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+a("vt:variant",a("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=a("TitlesOfParts",a("vt:vector",e.SheetNames.map(function(e){return"<vt:lpstr>"+gs(e)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var gl=/<[^>]+>[^<]*/g;function vl(e){var t=[rs,Ls("Properties",null,{xmlns:Ws,"xmlns:vt":Js})];if(!e)return t.join("");var a=1;return Sn(e).forEach(function(r){++a,t[t.length]=Ls("property",function(e,t){switch(typeof e){case"string":var a=Ls("vt:lpwstr",gs(e));return t&&(a=a.replace(/&quot;/g,"_x0022_")),a;case"number":return Ls((0|e)==e?"vt:i4":"vt:r8",gs(String(e)));case"boolean":return Ls("vt:bool",e?"true":"false")}if(e instanceof Date)return Ls("vt:filetime",Ms(e));throw new Error("Unable to serialize "+e)}(e[r],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:a,name:gs(r)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var yl,bl={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function wl(e,t,a){yl||(yl=Tn(bl)),e[t=yl[t]||t]=a}function xl(e){var t=e.read_shift(4),a=e.read_shift(4);return new Date(1e3*(a/1e7*Math.pow(2,32)+t/1e7-11644473600)).toISOString().replace(/\.000/,"")}function kl(e,t,a){var r=e.l,n=e.read_shift(0,"lpstr-cp");if(a)for(;e.l-r&3;)++e.l;return n}function Sl(e,t,a){var r=e.read_shift(0,"lpwstr");return a&&(e.l+=4-(r.length+1&3)&3),r}function El(e,t,a){return 31===t?Sl(e):kl(e,0,a)}function Tl(e,t,a){return El(e,t,!1===a?0:4)}function Nl(e){var t=e.l,a=_l(e,81);return 0==e[e.l]&&0==e[e.l+1]&&e.l-t&2&&(e.l+=2),[a,_l(e,3)]}function jl(e,t){for(var a=e.read_shift(4),r={},n=0;n!=a;++n){var s=e.read_shift(4),i=e.read_shift(4);r[s]=e.read_shift(i,1200===t?"utf16le":"utf8").replace(kr,"").replace(Sr,"!"),1200===t&&i%2&&(e.l+=2)}return 3&e.l&&(e.l=e.l>>3<<2),r}function Cl(e){var t=e.read_shift(4),a=e.slice(e.l,e.l+t);return e.l+=t,(3&t)>0&&(e.l+=4-(3&t)&3),a}function _l(e,t,a){var r,n=e.read_shift(2),s=a||{};if(e.l+=2,12!==t&&n!==t&&-1===Bo.indexOf(t)&&(4126!=(65534&t)||4126!=(65534&n)))throw new Error("Expected type "+t+" saw "+n);switch(12===t?n:t){case 2:return r=e.read_shift(2,"i"),s.raw||(e.l+=2),r;case 3:return r=e.read_shift(4,"i");case 11:return 0!==e.read_shift(4);case 19:return r=e.read_shift(4);case 30:return kl(e,0,4).replace(kr,"");case 31:return Sl(e);case 64:return xl(e);case 65:return Cl(e);case 71:return function(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}(e);case 80:return Tl(e,n,!s.raw).replace(kr,"");case 81:return function(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return El(e,t,0)}(e,n).replace(kr,"");case 4108:return function(e){for(var t=e.read_shift(4),a=[],r=0;r<t/2;++r)a.push(Nl(e));return a}(e);case 4126:case 4127:return 4127==n?function(e){for(var t=e.read_shift(4),a=[],r=0;r!=t;++r){var n=e.l;a[r]=e.read_shift(0,"lpwstr").replace(kr,""),e.l-n&2&&(e.l+=2)}return a}(e):function(e){for(var t=e.read_shift(4),a=[],r=0;r!=t;++r)a[r]=e.read_shift(0,"lpstr-cp").replace(kr,"");return a}(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function Al(e,t){var a=Vi(4),r=Vi(4);switch(a.write_shift(4,80==e?31:e),e){case 3:r.write_shift(-4,t);break;case 5:(r=Vi(8)).write_shift(8,t,"f");break;case 11:r.write_shift(4,t?1:0);break;case 64:r=function(e){var t=("string"==typeof e?new Date(Date.parse(e)):e).getTime()/1e3+11644473600,a=t%Math.pow(2,32),r=(t-a)/Math.pow(2,32);r*=1e7;var n=(a*=1e7)/Math.pow(2,32)|0;n>0&&(a%=Math.pow(2,32),r+=n);var s=Vi(8);return s.write_shift(4,a),s.write_shift(4,r),s}(t);break;case 31:case 80:for((r=Vi(4+2*(t.length+1)+(t.length%2?0:2))).write_shift(4,t.length+1),r.write_shift(0,t,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return xr([a,r])}function Pl(e,t){var a=e.l,r=e.read_shift(4),n=e.read_shift(4),s=[],i=0,o=0,l=-1,c={};for(i=0;i!=n;++i){var u=e.read_shift(4),d=e.read_shift(4);s[i]=[u,d+a]}s.sort(function(e,t){return e[1]-t[1]});var f={};for(i=0;i!=n;++i){if(e.l!==s[i][1]){var h=!0;if(i>0&&t)switch(t[s[i-1][0]].t){case 2:e.l+2===s[i][1]&&(e.l+=2,h=!1);break;case 80:case 4108:e.l<=s[i][1]&&(e.l=s[i][1],h=!1)}if((!t||0==i)&&e.l<=s[i][1]&&(h=!1,e.l=s[i][1]),h)throw new Error("Read Error: Expected address "+s[i][1]+" at "+e.l+" :"+i)}if(t){var m=t[s[i][0]];if(f[m.n]=_l(e,m.t,{raw:!0}),"version"===m.p&&(f[m.n]=String(f[m.n]>>16)+"."+("0000"+String(65535&f[m.n])).slice(-4)),"CodePage"==m.n)switch(f[m.n]){case 0:f[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ar(o=f[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+f[m.n])}}else if(1===s[i][0]){if(o=f.CodePage=_l(e,2),ar(o),-1!==l){var p=e.l;e.l=s[l][1],c=jl(e,o),e.l=p}}else if(0===s[i][0]){if(0===o){l=i,e.l=s[i+1][1];continue}c=jl(e,o)}else{var g,v=c[s[i][0]];switch(e[e.l]){case 65:e.l+=4,g=Cl(e);break;case 30:case 31:e.l+=4,g=Tl(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,g=e.read_shift(4,"i");break;case 19:e.l+=4,g=e.read_shift(4);break;case 5:e.l+=4,g=e.read_shift(8,"f");break;case 11:e.l+=4,g=Ml(e,4);break;case 64:e.l+=4,g=Ln(xl(e));break;default:throw new Error("unparsed value: "+e[e.l])}f[v]=g}}return e.l=a+r,f}var Rl=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Ol(e){switch(typeof e){case"boolean":return 11;case"number":return(0|e)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64}return-1}function Dl(e,t,a){var r=Vi(8),n=[],s=[],i=8,o=0,l=Vi(8),c=Vi(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),s.push(l),n.push(c),i+=8+l.length,!t){(c=Vi(8)).write_shift(4,0),n.unshift(c);var u=[Vi(4)];for(u[0].write_shift(4,e.length),o=0;o<e.length;++o){var d=e[o][0];for((l=Vi(8+2*(d.length+1)+(d.length%2?0:2))).write_shift(4,o+2),l.write_shift(4,d.length+1),l.write_shift(0,d,"dbcs");l.l!=l.length;)l.write_shift(1,0);u.push(l)}l=xr(u),s.unshift(l),i+=8+l.length}for(o=0;o<e.length;++o)if((!t||t[e[o][0]])&&!(Rl.indexOf(e[o][0])>-1||hl.indexOf(e[o][0])>-1)&&null!=e[o][1]){var f=e[o][1],h=0;if(t){var m=a[h=+t[e[o][0]]];if("version"==m.p&&"string"==typeof f){var p=f.split(".");f=(+p[0]<<16)+(+p[1]||0)}l=Al(m.t,f)}else{var g=Ol(f);-1==g&&(g=31,f=String(f)),l=Al(g,f)}s.push(l),(c=Vi(8)).write_shift(4,t?h:2+o),n.push(c),i+=8+l.length}var v=8*(s.length+1);for(o=0;o<s.length;++o)n[o].write_shift(4,v),v+=s[o].length;return r.write_shift(4,i),r.write_shift(4,s.length),xr([r].concat(n).concat(s))}function Fl(e,t,a){var r=e.content;if(!r)return{};Wi(r,0);var n,s,i,o,l=0;r.chk("feff","Byte Order: "),r.read_shift(2);var c=r.read_shift(4),u=r.read_shift(16);if(u!==bn.utils.consts.HEADER_CLSID&&u!==a)throw new Error("Bad PropertySet CLSID "+u);if(1!==(n=r.read_shift(4))&&2!==n)throw new Error("Unrecognized #Sets: "+n);if(s=r.read_shift(16),o=r.read_shift(4),1===n&&o!==r.l)throw new Error("Length mismatch: "+o+" !== "+r.l);2===n&&(i=r.read_shift(16),l=r.read_shift(4));var d,f=Pl(r,t),h={SystemIdentifier:c};for(var m in f)h[m]=f[m];if(h.FMTID=s,1===n)return h;if(l-r.l==2&&(r.l+=2),r.l!==l)throw new Error("Length mismatch 2: "+r.l+" !== "+l);try{d=Pl(r,null)}catch(Ig){}for(m in d)h[m]=d[m];return h.FMTID=[s,i],h}function Il(e,t,a,r,n,s){var i=Vi(n?68:48),o=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,bn.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,n?2:1),i.write_shift(16,t,"hex"),i.write_shift(4,n?68:48);var l=Dl(e,a,r);if(o.push(l),n){var c=Dl(n,null,null);i.write_shift(16,s,"hex"),i.write_shift(4,68+l.length),o.push(c)}return xr(o)}function Ll(e,t){return e.read_shift(t),null}function Ml(e,t){return 1===e.read_shift(t)}function zl(e,t){return t||(t=Vi(2)),t.write_shift(2,+!!e),t}function Ul(e){return e.read_shift(2,"u")}function Bl(e,t){return t||(t=Vi(2)),t.write_shift(2,e),t}function Wl(e,t){return function(e,t,a){for(var r=[],n=e.l+t;e.l<n;)r.push(a(e,n-e.l));if(n!==e.l)throw new Error("Slurp error");return r}(e,t,Ul)}function Hl(e,t,a){return a||(a=Vi(2)),a.write_shift(1,"e"==t?+e:+!!e),a.write_shift(1,"e"==t?1:0),a}function Vl(e,t,a){var r=e.read_shift(a&&a.biff>=12?2:1),n="sbcs-cont",s=Ja;(a&&a.biff>=8&&(Ja=1200),a&&8!=a.biff)?12==a.biff&&(n="wstr"):e.read_shift(1)&&(n="dbcs-cont");a.biff>=2&&a.biff<=5&&(n="cpstr");var i=r?e.read_shift(r,n):"";return Ja=s,i}function Gl(e){var t=Ja;Ja=1200;var a,r=e.read_shift(2),n=e.read_shift(1),s=4&n,i=8&n,o=1+(1&n),l=0,c={};i&&(l=e.read_shift(2)),s&&(a=e.read_shift(4));var u=2==o?"dbcs-cont":"sbcs-cont",d=0===r?"":e.read_shift(r,u);return i&&(e.l+=4*l),s&&(e.l+=a),c.t=d,i||(c.raw="<t>"+c.t+"</t>",c.r=c.t),Ja=t,c}function $l(e){var t=e.t||"",a=Vi(3);a.write_shift(2,t.length),a.write_shift(1,1);var r=Vi(2*t.length);return r.write_shift(2*t.length,t,"utf16le"),xr([a,r])}function ql(e,t,a){if(a){if(a.biff>=2&&a.biff<=5)return e.read_shift(t,"cpstr");if(a.biff>=12)return e.read_shift(t,"dbcs-cont")}return 0===e.read_shift(1)?e.read_shift(t,"sbcs-cont"):e.read_shift(t,"dbcs-cont")}function Yl(e,t,a){var r=e.read_shift(a&&2==a.biff?1:2);return 0===r?(e.l++,""):ql(e,r,a)}function Xl(e,t,a){if(a.biff>5)return Yl(e,0,a);var r=e.read_shift(1);return 0===r?(e.l++,""):e.read_shift(r,a.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Kl(e,t,a){return a||(a=Vi(3+2*e.length)),a.write_shift(2,e.length),a.write_shift(1,1),a.write_shift(31,e,"utf16le"),a}function Jl(e,t){var a=e.read_shift(16);switch(a){case"e0c9ea79f9bace118c8200aa004ba90b":return function(e){var t=e.read_shift(4),a=e.l,r=!1;t>24&&(e.l+=t-24,"795881f43b1d7f48af2c825dc4852763"===e.read_shift(16)&&(r=!0),e.l=a);var n=e.read_shift((r?t-24:t)>>1,"utf16le").replace(kr,"");return r&&(e.l+=24),n}(e);case"0303000000000000c000000000000046":return function(e){for(var t=e.read_shift(2),a="";t-- >0;)a+="../";var r=e.read_shift(0,"lpstr-ansi");if(e.l+=2,57005!=e.read_shift(2))throw new Error("Bad FileMoniker");if(0===e.read_shift(4))return a+r.replace(/\\/g,"/");var n=e.read_shift(4);if(3!=e.read_shift(2))throw new Error("Bad FileMoniker");return a+e.read_shift(n>>1,"utf16le").replace(kr,"")}(e);default:throw new Error("Unsupported Moniker "+a)}}function Ql(e){var t=e.read_shift(4);return t>0?e.read_shift(t,"utf16le").replace(kr,""):""}function Zl(e,t){t||(t=Vi(6+2*e.length)),t.write_shift(4,1+e.length);for(var a=0;a<e.length;++a)t.write_shift(2,e.charCodeAt(a));return t.write_shift(2,0),t}function ec(e){var t=Vi(512),a=0,r=e.Target;"file://"==r.slice(0,7)&&(r=r.slice(7));var n=r.indexOf("#"),s=n>-1?31:23;switch(r.charAt(0)){case"#":s=28;break;case".":s&=-3}t.write_shift(4,2),t.write_shift(4,s);var i=[8,6815827,6619237,4849780,83];for(a=0;a<i.length;++a)t.write_shift(4,i[a]);if(28==s)Zl(r=r.slice(1),t);else if(2&s){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<i.length;++a)t.write_shift(1,parseInt(i[a],16));var o=n>-1?r.slice(0,n):r;for(t.write_shift(4,2*(o.length+1)),a=0;a<o.length;++a)t.write_shift(2,o.charCodeAt(a));t.write_shift(2,0),8&s&&Zl(n>-1?r.slice(n+1):"",t)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),a=0;a<i.length;++a)t.write_shift(1,parseInt(i[a],16));for(var l=0;"../"==r.slice(3*l,3*l+3)||"..\\"==r.slice(3*l,3*l+3);)++l;for(t.write_shift(2,l),t.write_shift(4,r.length-3*l+1),a=0;a<r.length-3*l;++a)t.write_shift(1,255&r.charCodeAt(a+3*l));for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),a=0;a<6;++a)t.write_shift(4,0)}return t.slice(0,t.l)}function tc(e){return[e.read_shift(1),e.read_shift(1),e.read_shift(1),e.read_shift(1)]}function ac(e,t){var a=tc(e);return a[3]=0,a}function rc(e){return{r:e.read_shift(2),c:e.read_shift(2),ixfe:e.read_shift(2)}}function nc(e,t,a,r){return r||(r=Vi(6)),r.write_shift(2,e),r.write_shift(2,t),r.write_shift(2,a||0),r}function sc(e,t,a){var r=a.biff>8?4:2;return[e.read_shift(r),e.read_shift(r,"i"),e.read_shift(r,"i")]}function ic(e){return[e.read_shift(2),Po(e)]}function oc(e){var t=e.read_shift(2),a=e.read_shift(2);return{s:{c:e.read_shift(2),r:t},e:{c:e.read_shift(2),r:a}}}function lc(e,t){return t||(t=Vi(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function cc(e){var t=e.read_shift(2),a=e.read_shift(2);return{s:{c:e.read_shift(1),r:t},e:{c:e.read_shift(1),r:a}}}var uc=cc;function dc(e){e.l+=4;var t=e.read_shift(2),a=e.read_shift(2),r=e.read_shift(2);return e.l+=12,[a,t,r]}function fc(e){e.l+=2,e.l+=e.read_shift(2)}var hc={0:fc,4:fc,5:fc,6:fc,7:function(e){return e.l+=4,e.cf=e.read_shift(2),{}},8:fc,9:fc,10:fc,11:fc,12:fc,13:function(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t},14:fc,15:fc,16:fc,17:fc,18:fc,19:fc,20:fc,21:dc};function mc(e,t){var a={BIFFVer:0,dt:0};switch(a.BIFFVer=e.read_shift(2),(t-=2)>=2&&(a.dt=e.read_shift(2),e.l-=2),a.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+a.BIFFVer)}return e.read_shift(t),a}function pc(e,t,a){var r=1536,n=16;switch(a.bookType){case"biff8":case"xla":break;case"biff5":r=1280,n=8;break;case"biff4":r=4,n=6;break;case"biff3":r=3,n=6;break;case"biff2":r=2,n=4;break;default:throw new Error("unsupported BIFF version")}var s=Vi(n);return s.write_shift(2,r),s.write_shift(2,t),n>4&&s.write_shift(2,29282),n>6&&s.write_shift(2,1997),n>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function gc(e,t){var a=!t||t.biff>=8?2:1,r=Vi(8+a*e.name.length);r.write_shift(4,e.pos),r.write_shift(1,e.hs||0),r.write_shift(1,e.dt),r.write_shift(1,e.name.length),t.biff>=8&&r.write_shift(1,1),r.write_shift(a*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var n=r.slice(0,r.l);return n.l=r.l,n}function vc(e,t,a){var r=0;a&&2==a.biff||(r=e.read_shift(2));var n=e.read_shift(2);return a&&2==a.biff&&(r=1-(n>>15),n&=32767),[{Unsynced:1&r,DyZero:(2&r)>>1,ExAsc:(4&r)>>2,ExDsc:(8&r)>>3},n]}function yc(e,t,a,r){var n=a&&5==a.biff;r||(r=Vi(n?3+t.length:5+2*t.length)),r.write_shift(2,e),r.write_shift(n?1:2,t.length),n||r.write_shift(1,1),r.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le");var s=r.length>r.l?r.slice(0,r.l):r;return null==s.l&&(s.l=s.length),s}var bc=Xl;function wc(e,t,a){var r=e.l+t,n=8!=a.biff&&a.biff?2:4,s=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(2),l=e.read_shift(2);return e.l=r,{s:{r:s,c:o},e:{r:i,c:l}}}function xc(e,t,a,r){var n=a&&5==a.biff;r||(r=Vi(n?16:20)),r.write_shift(2,0),e.style?(r.write_shift(2,e.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,e.numFmtId||0),r.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&n&&(s|=1024),r.write_shift(4,s),r.write_shift(4,0),n||r.write_shift(4,0),r.write_shift(2,0),r}function kc(e,t,a){var r=rc(e);2!=a.biff&&9!=t||++e.l;var n=function(e){var t=e.read_shift(1);return 1===e.read_shift(1)?t:1===t}(e);return r.val=n,r.t=!0===n||!1===n?"b":"e",r}var Sc=function(e,t,a){return 0===t?"":Xl(e,0,a)};function Ec(e,t,a){var r,n=e.read_shift(2),s={fBuiltIn:1&n,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return 14849===a.sbcch&&(r=function(e,t,a){e.l+=4,t-=4;var r=e.l+t,n=Vl(e,0,a),s=e.read_shift(2);if(s!==(r-=e.l))throw new Error("Malformed AddinUdf: padding = "+r+" != "+s);return e.l+=s,n}(e,t-2,a)),s.body=r||e.read_shift(t-2),"string"===typeof r&&(s.Name=r),s}var Tc=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Nc(e,t,a){var r=e.l+t,n=e.read_shift(2),s=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(a&&2==a.biff?1:2),l=0;(!a||a.biff>=5)&&(5!=a.biff&&(e.l+=2),l=e.read_shift(2),5==a.biff&&(e.l+=2),e.l+=4);var c=ql(e,i,a);32&n&&(c=Tc[c.charCodeAt(0)]);var u=r-e.l;a&&2==a.biff&&--u;var d=r!=e.l&&0!==o&&u>0?function(e,t,a,r){var n,s=e.l+t,i=Bd(e,r,a);s!==e.l&&(n=Ud(e,s-e.l,i,a));return[i,n]}(e,u,a,o):[];return{chKey:s,Name:c,itab:l,rgce:d}}function jc(e,t,a){if(a.biff<8)return function(e,t,a){3==e[e.l+1]&&e[e.l]++;var r=Vl(e,0,a);return 3==r.charCodeAt(0)?r.slice(1):r}(e,0,a);for(var r=[],n=e.l+t,s=e.read_shift(a.biff>8?4:2);0!==s--;)r.push(sc(e,a.biff,a));if(e.l!=n)throw new Error("Bad ExternSheet: "+e.l+" != "+n);return r}function Cc(e,t,a){var r=uc(e,6);switch(a.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[r,qd(e,t,a)]}var _c={8:function(e,t){var a=e.l+t;e.l+=10;var r=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var n=e.read_shift(1);return e.l+=n,e.l=a,{fmt:r}}};function Ac(e){var t=Vi(24),a=ao(e[0]);t.write_shift(2,a.r),t.write_shift(2,a.r),t.write_shift(2,a.c),t.write_shift(2,a.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)t.write_shift(1,parseInt(r[n],16));return xr([t,ec(e[1])])}function Pc(e){var t=e[1].Tooltip,a=Vi(10+2*(t.length+1));a.write_shift(2,2048);var r=ao(e[0]);a.write_shift(2,r.r),a.write_shift(2,r.r),a.write_shift(2,r.c),a.write_shift(2,r.c);for(var n=0;n<t.length;++n)a.write_shift(2,t.charCodeAt(n));return a.write_shift(2,0),a}function Rc(e,t,a){if(!a.cellStyles)return Hi(e,t);var r=a&&a.biff>=12?4:2,n=e.read_shift(r),s=e.read_shift(r),i=e.read_shift(r),o=e.read_shift(r),l=e.read_shift(2);2==r&&(e.l+=2);var c={s:n,e:s,w:i,ixfe:o,flags:l};return(a.biff>=5||!a.biff)&&(c.level=l>>8&7),c}var Oc=rc,Dc=Wl,Fc=Yl;var Ic=[2,3,48,49,131,139,140,245],Lc=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Tn({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function a(t,a){var r=a||{};r.dateNF||(r.dateNF="yyyymmdd");var n=fo(function(t,a){var r=[],n=pr(1);switch(a.type){case"base64":n=vr(fr(t));break;case"binary":n=vr(t);break;case"buffer":case"array":n=t}Wi(n,0);var s=n.read_shift(1),i=!!(136&s),o=!1,l=!1;switch(s){case 2:case 3:case 131:case 139:case 245:break;case 48:case 49:o=!0,i=!0;break;case 140:l=!0;break;default:throw new Error("DBF Unsupported Version: "+s.toString(16))}var c=0,u=521;2==s&&(c=n.read_shift(2)),n.l+=3,2!=s&&(c=n.read_shift(4)),c>1048576&&(c=1e6),2!=s&&(u=n.read_shift(2));var d=n.read_shift(2),f=a.codepage||1252;2!=s&&(n.l+=16,n.read_shift(1),0!==n[n.l]&&(f=e[n[n.l]]),n.l+=1,n.l+=2),l&&(n.l+=36);for(var h=[],m={},p=Math.min(n.length,2==s?521:u-10-(o?264:0)),g=l?32:11;n.l<p&&13!=n[n.l];)switch((m={}).name=ir.utils.decode(f,n.slice(n.l,n.l+g)).replace(/[\u0000\r\n].*$/g,""),n.l+=g,m.type=String.fromCharCode(n.read_shift(1)),2==s||l||(m.offset=n.read_shift(4)),m.len=n.read_shift(1),2==s&&(m.offset=n.read_shift(2)),m.dec=n.read_shift(1),m.name.length&&h.push(m),2!=s&&(n.l+=l?13:14),m.type){case"B":o&&8==m.len||!a.WTF||console.log("Skipping "+m.name+":"+m.type);break;case"G":case"P":a.WTF&&console.log("Skipping "+m.name+":"+m.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+m.type)}if(13!==n[n.l]&&(n.l=u-1),13!==n.read_shift(1))throw new Error("DBF Terminator not found "+n.l+" "+n[n.l]);n.l=u;var v=0,y=0;for(r[0]=[],y=0;y!=h.length;++y)r[0][y]=h[y].name;for(;c-- >0;)if(42!==n[n.l])for(++n.l,r[++v]=[],y=0,y=0;y!=h.length;++y){var b=n.slice(n.l,n.l+h[y].len);n.l+=h[y].len,Wi(b,0);var w=ir.utils.decode(f,b);switch(h[y].type){case"C":w.trim().length&&(r[v][y]=w.replace(/\s+$/,""));break;case"D":8===w.length?r[v][y]=new Date(+w.slice(0,4),+w.slice(4,6)-1,+w.slice(6,8)):r[v][y]=w;break;case"F":r[v][y]=parseFloat(w.trim());break;case"+":case"I":r[v][y]=l?2147483648^b.read_shift(-4,"i"):b.read_shift(4,"i");break;case"L":switch(w.trim().toUpperCase()){case"Y":case"T":r[v][y]=!0;break;case"N":case"F":r[v][y]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+w+"|")}break;case"M":if(!i)throw new Error("DBF Unexpected MEMO for type "+s.toString(16));r[v][y]="##MEMO##"+(l?parseInt(w.trim(),10):b.read_shift(4));break;case"N":(w=w.replace(/\u0000/g,"").trim())&&"."!=w&&(r[v][y]=+w||0);break;case"@":r[v][y]=new Date(b.read_shift(-8,"f")-621356832e5);break;case"T":r[v][y]=new Date(864e5*(b.read_shift(4)-2440588)+b.read_shift(4));break;case"Y":r[v][y]=b.read_shift(4,"i")/1e4+b.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":r[v][y]=-b.read_shift(-8,"f");break;case"B":if(o&&8==h[y].len){r[v][y]=b.read_shift(8,"f");break}case"G":case"P":b.l+=h[y].len;break;case"0":if("_NullFlags"===h[y].name)break;default:throw new Error("DBF Unsupported data type "+h[y].type)}}else n.l+=d;if(2!=s&&n.l<n.length&&26!=n[n.l++])throw new Error("DBF EOF Marker missing "+(n.l-1)+" of "+n.length+" "+n[n.l-1].toString(16));return a&&a.sheetRows&&(r=r.slice(0,a.sheetRows)),a.DBF=h,r}(t,r),r);return n["!cols"]=r.DBF.map(function(e){return{wch:e.len,DBF:e}}),delete r.DBF,n}var r={B:8,C:250,L:1,D:8,"?":0,"":0};return{to_workbook:function(e,t){try{return co(a(e,t),t)}catch(Ig){if(t&&t.WTF)throw Ig}return{SheetNames:[],Sheets:{}}},to_sheet:a,from_sheet:function(e,a){var n=a||{};if(+n.codepage>=0&&ar(+n.codepage),"string"==n.type)throw new Error("Cannot write DBF to JS string");var s=$i(),i=Sp(e,{header:1,raw:!0,cellDates:!0}),o=i[0],l=i.slice(1),c=e["!cols"]||[],u=0,d=0,f=0,h=1;for(u=0;u<o.length;++u)if(((c[u]||{}).DBF||{}).name)o[u]=c[u].DBF.name,++f;else if(null!=o[u]){if(++f,"number"===typeof o[u]&&(o[u]=o[u].toString(10)),"string"!==typeof o[u])throw new Error("DBF Invalid column name "+o[u]+" |"+typeof o[u]+"|");if(o.indexOf(o[u])!==u)for(d=0;d<1024;++d)if(-1==o.indexOf(o[u]+"_"+d)){o[u]+="_"+d;break}}var m=io(e["!ref"]),p=[],g=[],v=[];for(u=0;u<=m.e.c-m.s.c;++u){var y="",b="",w=0,x=[];for(d=0;d<l.length;++d)null!=l[d][u]&&x.push(l[d][u]);if(0!=x.length&&null!=o[u]){for(d=0;d<x.length;++d){switch(typeof x[d]){case"number":b="B";break;case"string":default:b="C";break;case"boolean":b="L";break;case"object":b=x[d]instanceof Date?"D":"C"}w=Math.max(w,String(x[d]).length),y=y&&y!=b?"C":b}w>250&&(w=250),"C"==(b=((c[u]||{}).DBF||{}).type)&&c[u].DBF.len>w&&(w=c[u].DBF.len),"B"==y&&"N"==b&&(y="N",v[u]=c[u].DBF.dec,w=c[u].DBF.len),g[u]="C"==y||"N"==b?w:r[y]||0,h+=g[u],p[u]=y}else p[u]="?"}var k=s.next(32);for(k.write_shift(4,318902576),k.write_shift(4,l.length),k.write_shift(2,296+32*f),k.write_shift(2,h),u=0;u<4;++u)k.write_shift(4,0);for(k.write_shift(4,(+t[Qa]||3)<<8),u=0,d=0;u<o.length;++u)if(null!=o[u]){var S=s.next(32),E=(o[u].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);S.write_shift(1,E,"sbcs"),S.write_shift(1,"?"==p[u]?"C":p[u],"sbcs"),S.write_shift(4,d),S.write_shift(1,g[u]||r[p[u]]||0),S.write_shift(1,v[u]||0),S.write_shift(1,2),S.write_shift(4,0),S.write_shift(1,0),S.write_shift(4,0),S.write_shift(4,0),d+=g[u]||r[p[u]]||0}var T=s.next(264);for(T.write_shift(4,13),u=0;u<65;++u)T.write_shift(4,0);for(u=0;u<l.length;++u){var N=s.next(h);for(N.write_shift(1,0),d=0;d<o.length;++d)if(null!=o[d])switch(p[d]){case"L":N.write_shift(1,null==l[u][d]?63:l[u][d]?84:70);break;case"B":N.write_shift(8,l[u][d]||0,"f");break;case"N":var j="0";for("number"==typeof l[u][d]&&(j=l[u][d].toFixed(v[d]||0)),f=0;f<g[d]-j.length;++f)N.write_shift(1,32);N.write_shift(1,j,"sbcs");break;case"D":l[u][d]?(N.write_shift(4,("0000"+l[u][d].getFullYear()).slice(-4),"sbcs"),N.write_shift(2,("00"+(l[u][d].getMonth()+1)).slice(-2),"sbcs"),N.write_shift(2,("00"+l[u][d].getDate()).slice(-2),"sbcs")):N.write_shift(8,"00000000","sbcs");break;case"C":var C=String(null!=l[u][d]?l[u][d]:"").slice(0,g[d]);for(N.write_shift(1,C,"sbcs"),f=0;f<g[d]-C.length;++f)N.write_shift(1,32)}}return s.next(1).write_shift(1,26),s.end()}}}(),Mc=function(){var e={AA:"\xc0",BA:"\xc1",CA:"\xc2",DA:195,HA:"\xc4",JA:197,AE:"\xc8",BE:"\xc9",CE:"\xca",HE:"\xcb",AI:"\xcc",BI:"\xcd",CI:"\xce",HI:"\xcf",AO:"\xd2",BO:"\xd3",CO:"\xd4",DO:213,HO:"\xd6",AU:"\xd9",BU:"\xda",CU:"\xdb",HU:"\xdc",Aa:"\xe0",Ba:"\xe1",Ca:"\xe2",Da:227,Ha:"\xe4",Ja:229,Ae:"\xe8",Be:"\xe9",Ce:"\xea",He:"\xeb",Ai:"\xec",Bi:"\xed",Ci:"\xee",Hi:"\xef",Ao:"\xf2",Bo:"\xf3",Co:"\xf4",Do:245,Ho:"\xf6",Au:"\xf9",Bu:"\xfa",Cu:"\xfb",Hu:"\xfc",KC:"\xc7",Kc:"\xe7",q:"\xe6",z:"\u0153",a:"\xc6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1bN("+Sn(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),a=function(t,a){var r=e[a];return"number"==typeof r?cr(r):r},r=function(e,t,a){var r=t.charCodeAt(0)-32<<4|a.charCodeAt(0)-48;return 59==r?e:cr(r)};function n(e,n){var s,i=e.split(/[\n\r]+/),o=-1,l=-1,c=0,u=0,d=[],f=[],h=null,m={},p=[],g=[],v=[],y=0;for(+n.codepage>=0&&ar(+n.codepage);c!==i.length;++c){y=0;var b,w=i[c].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(t,a),x=w.replace(/;;/g,"\0").split(";").map(function(e){return e.replace(/\u0000/g,";")}),k=x[0];if(w.length>0)switch(k){case"ID":case"E":case"B":case"O":case"W":break;case"P":"P"==x[1].charAt(0)&&f.push(w.slice(3).replace(/;;/g,";"));break;case"C":var S=!1,E=!1,T=!1,N=!1,j=-1,C=-1;for(u=1;u<x.length;++u)switch(x[u].charAt(0)){case"A":case"G":break;case"X":l=parseInt(x[u].slice(1))-1,E=!0;break;case"Y":for(o=parseInt(x[u].slice(1))-1,E||(l=0),s=d.length;s<=o;++s)d[s]=[];break;case"K":'"'===(b=x[u].slice(1)).charAt(0)?b=b.slice(1,b.length-1):"TRUE"===b?b=!0:"FALSE"===b?b=!1:isNaN(Bn(b))?isNaN(Hn(b).getDate())||(b=Ln(b)):(b=Bn(b),null!==h&&ln(h)&&(b=Rn(b))),"undefined"!==typeof ir&&"string"==typeof b&&"string"!=(n||{}).type&&(n||{}).codepage&&(b=ir.utils.decode(n.codepage,b)),S=!0;break;case"E":N=!0;var _=pd(x[u].slice(1),{r:o,c:l});d[o][l]=[d[o][l],_];break;case"S":T=!0,d[o][l]=[d[o][l],"S5S"];break;case"R":j=parseInt(x[u].slice(1))-1;break;case"C":C=parseInt(x[u].slice(1))-1;break;default:if(n&&n.WTF)throw new Error("SYLK bad record "+w)}if(S&&(d[o][l]&&2==d[o][l].length?d[o][l][0]=b:d[o][l]=b,h=null),T){if(N)throw new Error("SYLK shared formula cannot have own formula");var A=j>-1&&d[j][C];if(!A||!A[1])throw new Error("SYLK shared formula cannot find base");d[o][l][1]=yd(A[1],{r:o-j,c:l-C})}break;case"F":var P=0;for(u=1;u<x.length;++u)switch(x[u].charAt(0)){case"X":l=parseInt(x[u].slice(1))-1,++P;break;case"Y":for(o=parseInt(x[u].slice(1))-1,s=d.length;s<=o;++s)d[s]=[];break;case"M":y=parseInt(x[u].slice(1))/20;break;case"F":case"G":case"S":case"D":case"N":break;case"P":h=f[parseInt(x[u].slice(1))];break;case"W":for(v=x[u].slice(1).split(" "),s=parseInt(v[0],10);s<=parseInt(v[1],10);++s)y=parseInt(v[2],10),g[s-1]=0===y?{hidden:!0}:{wch:y},Eu(g[s-1]);break;case"C":g[l=parseInt(x[u].slice(1))-1]||(g[l]={});break;case"R":p[o=parseInt(x[u].slice(1))-1]||(p[o]={}),y>0?(p[o].hpt=y,p[o].hpx=ju(y)):0===y&&(p[o].hidden=!0);break;default:if(n&&n.WTF)throw new Error("SYLK bad record "+w)}P<1&&(h=null);break;default:if(n&&n.WTF)throw new Error("SYLK bad record "+w)}}return p.length>0&&(m["!rows"]=p),g.length>0&&(m["!cols"]=g),n&&n.sheetRows&&(d=d.slice(0,n.sheetRows)),[d,m]}function s(e,t){var a=function(e,t){switch(t.type){case"base64":return n(fr(e),t);case"binary":return n(e,t);case"buffer":return n(hr&&Buffer.isBuffer(e)?e.toString("binary"):br(e),t);case"array":return n(Mn(e),t)}throw new Error("Unrecognized type "+t.type)}(e,t),r=a[0],s=a[1],i=fo(r,t);return Sn(s).forEach(function(e){i[e]=s[e]}),i}function i(e,t,a,r){var n="C;Y"+(a+1)+";X"+(r+1)+";K";switch(e.t){case"n":n+=e.v||0,e.f&&!e.F&&(n+=";E"+vd(e.f,{r:a,c:r}));break;case"b":n+=e.v?"TRUE":"FALSE";break;case"e":n+=e.w||e.v;break;case"d":n+='"'+(e.w||e.v)+'"';break;case"s":n+='"'+e.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return n}return e["|"]=254,{to_workbook:function(e,t){return co(s(e,t),t)},to_sheet:s,from_sheet:function(e,t){var a,r,n=["ID;PWXL;N;E"],s=[],o=io(e["!ref"]),l=Array.isArray(e),c="\r\n";n.push("P;PGeneral"),n.push("F;P0;DG0G8;M255"),e["!cols"]&&(r=n,e["!cols"].forEach(function(e,t){var a="F;W"+(t+1)+" "+(t+1)+" ";e.hidden?a+="0":("number"!=typeof e.width||e.wpx||(e.wpx=bu(e.width)),"number"!=typeof e.wpx||e.wch||(e.wch=wu(e.wpx)),"number"==typeof e.wch&&(a+=Math.round(e.wch)))," "!=a.charAt(a.length-1)&&r.push(a)})),e["!rows"]&&function(e,t){t.forEach(function(t,a){var r="F;";t.hidden?r+="M0;":t.hpt?r+="M"+20*t.hpt+";":t.hpx&&(r+="M"+20*Nu(t.hpx)+";"),r.length>2&&e.push(r+"R"+(a+1))})}(n,e["!rows"]),n.push("B;Y"+(o.e.r-o.s.r+1)+";X"+(o.e.c-o.s.c+1)+";D"+[o.s.c,o.s.r,o.e.c,o.e.r].join(" "));for(var u=o.s.r;u<=o.e.r;++u)for(var d=o.s.c;d<=o.e.c;++d){var f=ro({r:u,c:d});(a=l?(e[u]||[])[d]:e[f])&&(null!=a.v||a.f&&!a.F)&&s.push(i(a,0,u,d))}return n.join(c)+c+s.join(c)+c+"E"+c}}}(),zc=function(){function e(e,t){for(var a=e.split("\n"),r=-1,n=-1,s=0,i=[];s!==a.length;++s)if("BOT"!==a[s].trim()){if(!(r<0)){for(var o=a[s].trim().split(","),l=o[0],c=o[1],u=a[++s]||"";1&(u.match(/["]/g)||[]).length&&s<a.length-1;)u+="\n"+a[++s];switch(u=u.trim(),+l){case-1:if("BOT"===u){i[++r]=[],n=0;continue}if("EOD"!==u)throw new Error("Unrecognized DIF special command "+u);break;case 0:"TRUE"===u?i[r][n]=!0:"FALSE"===u?i[r][n]=!1:isNaN(Bn(c))?isNaN(Hn(c).getDate())?i[r][n]=c:i[r][n]=Ln(c):i[r][n]=Bn(c),++n;break;case 1:(u=(u=u.slice(1,u.length-1)).replace(/""/g,'"'))&&u.match(/^=".*"$/)&&(u=u.slice(2,-1)),i[r][n++]=""!==u?u:null}if("EOD"===u)break}}else i[++r]=[],n=0;return t&&t.sheetRows&&(i=i.slice(0,t.sheetRows)),i}function t(t,a){return fo(function(t,a){switch(a.type){case"base64":return e(fr(t),a);case"binary":return e(t,a);case"buffer":return e(hr&&Buffer.isBuffer(t)?t.toString("binary"):br(t),a);case"array":return e(Mn(t),a)}throw new Error("Unrecognized type "+a.type)}(t,a),a)}return{to_workbook:function(e,a){return co(t(e,a),a)},to_sheet:t,from_sheet:function(){var e=function(e,t,a,r,n){e.push(t),e.push(a+","+r),e.push('"'+n.replace(/"/g,'""')+'"')},t=function(e,t,a,r){e.push(t+","+a),e.push(1==t?'"'+r.replace(/"/g,'""')+'"':r)};return function(a){var r,n=[],s=io(a["!ref"]),i=Array.isArray(a);e(n,"TABLE",0,1,"sheetjs"),e(n,"VECTORS",0,s.e.r-s.s.r+1,""),e(n,"TUPLES",0,s.e.c-s.s.c+1,""),e(n,"DATA",0,0,"");for(var o=s.s.r;o<=s.e.r;++o){t(n,-1,0,"BOT");for(var l=s.s.c;l<=s.e.c;++l){var c=ro({r:o,c:l});if(r=i?(a[o]||[])[l]:a[c])switch(r.t){case"n":var u=r.w;u||null==r.v||(u=r.v),null==u?r.f&&!r.F?t(n,1,0,"="+r.f):t(n,1,0,""):t(n,0,u,"V");break;case"b":t(n,0,r.v?1:0,r.v?"TRUE":"FALSE");break;case"s":t(n,1,0,isNaN(r.v)?r.v:'="'+r.v+'"');break;case"d":r.w||(r.w=fn(r.z||Or[14],Cn(Ln(r.v)))),t(n,0,r.w,"V");break;default:t(n,1,0,"")}else t(n,1,0,"")}}t(n,-1,0,"EOD");return n.join("\r\n")}}()}}(),Uc=function(){function e(e){return e.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n")}function t(e){return e.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function a(t,a){return fo(function(t,a){for(var r=t.split("\n"),n=-1,s=-1,i=0,o=[];i!==r.length;++i){var l=r[i].trim().split(":");if("cell"===l[0]){var c=ao(l[1]);if(o.length<=c.r)for(n=o.length;n<=c.r;++n)o[n]||(o[n]=[]);switch(n=c.r,s=c.c,l[2]){case"t":o[n][s]=e(l[3]);break;case"v":o[n][s]=+l[3];break;case"vtf":var u=l[l.length-1];case"vtc":"nl"===l[3]?o[n][s]=!!+l[4]:o[n][s]=+l[4],"vtf"==l[2]&&(o[n][s]=[o[n][s],u])}}}return a&&a.sheetRows&&(o=o.slice(0,a.sheetRows)),o}(t,a),a)}var r=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),n=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",s=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),i="--SocialCalcSpreadsheetControlSave--";function o(e){if(!e||!e["!ref"])return"";for(var a,r=[],n=[],s="",i=no(e["!ref"]),o=Array.isArray(e),l=i.s.r;l<=i.e.r;++l)for(var c=i.s.c;c<=i.e.c;++c)if(s=ro({r:l,c:c}),(a=o?(e[l]||[])[c]:e[s])&&null!=a.v&&"z"!==a.t){switch(n=["cell",s,"t"],a.t){case"s":case"str":n.push(t(a.v));break;case"n":a.f?(n[2]="vtf",n[3]="n",n[4]=a.v,n[5]=t(a.f)):(n[2]="v",n[3]=a.v);break;case"b":n[2]="vt"+(a.f?"f":"c"),n[3]="nl",n[4]=a.v?"1":"0",n[5]=t(a.f||(a.v?"TRUE":"FALSE"));break;case"d":var u=Cn(Ln(a.v));n[2]="vtc",n[3]="nd",n[4]=""+u,n[5]=a.w||fn(a.z||Or[14],u);break;case"e":continue}r.push(n.join(":"))}return r.push("sheet:c:"+(i.e.c-i.s.c+1)+":r:"+(i.e.r-i.s.r+1)+":tvf:1"),r.push("valueformat:1:text-wiki"),r.join("\n")}return{to_workbook:function(e,t){return co(a(e,t),t)},to_sheet:a,from_sheet:function(e){return[r,n,s,n,o(e),i].join("\n")}}}(),Bc=function(){function e(e,t,a,r,n){n.raw?t[a][r]=e:""===e||("TRUE"===e?t[a][r]=!0:"FALSE"===e?t[a][r]=!1:isNaN(Bn(e))?isNaN(Hn(e).getDate())?t[a][r]=e:t[a][r]=Ln(e):t[a][r]=Bn(e))}var t={44:",",9:"\t",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function r(e){for(var r={},n=!1,s=0,i=0;s<e.length;++s)34==(i=e.charCodeAt(s))?n=!n:!n&&i in t&&(r[i]=(r[i]||0)+1);for(s in i=[],r)Object.prototype.hasOwnProperty.call(r,s)&&i.push([r[s],s]);if(!i.length)for(s in r=a)Object.prototype.hasOwnProperty.call(r,s)&&i.push([r[s],s]);return i.sort(function(e,t){return e[0]-t[0]||a[e[1]]-a[t[1]]}),t[i.pop()[1]]||44}function n(e,t){var a=t||{},n="";var s=a.dense?[]:{},i={s:{c:0,r:0},e:{c:0,r:0}};"sep="==e.slice(0,4)?13==e.charCodeAt(5)&&10==e.charCodeAt(6)?(n=e.charAt(4),e=e.slice(7)):13==e.charCodeAt(5)||10==e.charCodeAt(5)?(n=e.charAt(4),e=e.slice(6)):n=r(e.slice(0,1024)):n=a&&a.FS?a.FS:r(e.slice(0,1024));var o=0,l=0,c=0,u=0,d=0,f=n.charCodeAt(0),h=!1,m=0,p=e.charCodeAt(0);e=e.replace(/\r\n/gm,"\n");var g=null!=a.dateNF?function(e){var t="number"==typeof e?Or[e]:e;return t=t.replace(vn,"(\\d+)"),new RegExp("^"+t+"$")}(a.dateNF):null;function v(){var t=e.slice(u,d),r={};if('"'==t.charAt(0)&&'"'==t.charAt(t.length-1)&&(t=t.slice(1,-1).replace(/""/g,'"')),0===t.length)r.t="z";else if(a.raw)r.t="s",r.v=t;else if(0===t.trim().length)r.t="s",r.v=t;else if(61==t.charCodeAt(0))34==t.charCodeAt(1)&&34==t.charCodeAt(t.length-1)?(r.t="s",r.v=t.slice(2,-1).replace(/""/g,'"')):1!=t.length?(r.t="n",r.f=t.slice(1)):(r.t="s",r.v=t);else if("TRUE"==t)r.t="b",r.v=!0;else if("FALSE"==t)r.t="b",r.v=!1;else if(isNaN(c=Bn(t)))if(!isNaN(Hn(t).getDate())||g&&t.match(g)){r.z=a.dateNF||Or[14];var n=0;g&&t.match(g)&&(t=function(e,t,a){var r=-1,n=-1,s=-1,i=-1,o=-1,l=-1;(t.match(vn)||[]).forEach(function(e,t){var c=parseInt(a[t+1],10);switch(e.toLowerCase().charAt(0)){case"y":r=c;break;case"d":s=c;break;case"h":i=c;break;case"s":l=c;break;case"m":i>=0?o=c:n=c}}),l>=0&&-1==o&&n>=0&&(o=n,n=-1);var c=(""+(r>=0?r:(new Date).getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);7==c.length&&(c="0"+c),8==c.length&&(c="20"+c);var u=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return-1==i&&-1==o&&-1==l?c:-1==r&&-1==n&&-1==s?u:c+"T"+u}(0,a.dateNF,t.match(g)||[]),n=1),a.cellDates?(r.t="d",r.v=Ln(t,n)):(r.t="n",r.v=Cn(Ln(t,n))),!1!==a.cellText&&(r.w=fn(r.z,r.v instanceof Date?Cn(r.v):r.v)),a.cellNF||delete r.z}else r.t="s",r.v=t;else r.t="n",!1!==a.cellText&&(r.w=t),r.v=c;if("z"==r.t||(a.dense?(s[o]||(s[o]=[]),s[o][l]=r):s[ro({c:l,r:o})]=r),u=d+1,p=e.charCodeAt(u),i.e.c<l&&(i.e.c=l),i.e.r<o&&(i.e.r=o),m==f)++l;else if(l=0,++o,a.sheetRows&&a.sheetRows<=o)return!0}e:for(;d<e.length;++d)switch(m=e.charCodeAt(d)){case 34:34===p&&(h=!h);break;case f:case 10:case 13:if(!h&&v())break e}return d-u>0&&v(),s["!ref"]=so(i),s}function s(t,a){return a&&a.PRN?a.FS||"sep="==t.slice(0,4)||t.indexOf("\t")>=0||t.indexOf(",")>=0||t.indexOf(";")>=0?n(t,a):fo(function(t,a){var r=a||{},n=[];if(!t||0===t.length)return n;for(var s=t.split(/[\r\n]/),i=s.length-1;i>=0&&0===s[i].length;)--i;for(var o=10,l=0,c=0;c<=i;++c)-1==(l=s[c].indexOf(" "))?l=s[c].length:l++,o=Math.max(o,l);for(c=0;c<=i;++c){n[c]=[];var u=0;for(e(s[c].slice(0,o).trim(),n,c,u,r),u=1;u<=(s[c].length-o)/10+1;++u)e(s[c].slice(o+10*(u-1),o+10*u).trim(),n,c,u,r)}return r.sheetRows&&(n=n.slice(0,r.sheetRows)),n}(t,a),a):n(t,a)}function i(e,t){var a="",r="string"==t.type?[0,0,0,0]:fp(e,t);switch(t.type){case"base64":a=fr(e);break;case"binary":case"string":a=e;break;case"buffer":a=65001==t.codepage?e.toString("utf8"):t.codepage&&"undefined"!==typeof ir?ir.utils.decode(t.codepage,e):hr&&Buffer.isBuffer(e)?e.toString("binary"):br(e);break;case"array":a=Mn(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==r[0]&&187==r[1]&&191==r[2]?a=Ns(a.slice(3)):"string"!=t.type&&"buffer"!=t.type&&65001==t.codepage?a=Ns(a):"binary"==t.type&&"undefined"!==typeof ir&&t.codepage&&(a=ir.utils.decode(t.codepage,ir.utils.encode(28591,a))),"socialcalc:version:"==a.slice(0,19)?Uc.to_sheet("string"==t.type?a:Ns(a),t):s(a,t)}return{to_workbook:function(e,t){return co(i(e,t),t)},to_sheet:i,from_sheet:function(e){for(var t,a=[],r=io(e["!ref"]),n=Array.isArray(e),s=r.s.r;s<=r.e.r;++s){for(var i=[],o=r.s.c;o<=r.e.c;++o){var l=ro({r:s,c:o});if((t=n?(e[s]||[])[o]:e[l])&&null!=t.v){for(var c=(t.w||(lo(t),t.w)||"").slice(0,10);c.length<10;)c+=" ";i.push(c+(0===o?" ":""))}else i.push("          ")}a.push(i.join(""))}return a.join("\n")}}}();var Wc=function(){function e(e,t,a){if(e){Wi(e,e.l||0);for(var r=a.Enum||v;e.l<e.length;){var n=e.read_shift(2),s=r[n]||r[65535],i=e.read_shift(2),o=e.l+i,l=s.f&&s.f(e,i,a);if(e.l=o,t(l,s,n))return}}}function t(t,a){if(!t)return t;var r=a||{};var n=r.dense?[]:{},s="Sheet1",i="",o=0,l={},c=[],u=[],d={s:{r:0,c:0},e:{r:0,c:0}},f=r.sheetRows||0;if(0==t[2]&&(8==t[3]||9==t[3])&&t.length>=16&&5==t[14]&&108===t[15])throw new Error("Unsupported Works 3 for Mac file");if(2==t[2])r.Enum=v,e(t,function(e,t,a){switch(a){case 0:r.vers=e,e>=4096&&(r.qpro=!0);break;case 6:d=e;break;case 204:e&&(i=e);break;case 222:i=e;break;case 15:case 51:r.qpro||(e[1].v=e[1].v.slice(1));case 13:case 14:case 16:14==a&&112==(112&e[2])&&(15&e[2])>1&&(15&e[2])<15&&(e[1].z=r.dateNF||Or[14],r.cellDates&&(e[1].t="d",e[1].v=Rn(e[1].v))),r.qpro&&e[3]>o&&(n["!ref"]=so(d),l[s]=n,c.push(s),n=r.dense?[]:{},d={s:{r:0,c:0},e:{r:0,c:0}},o=e[3],s=i||"Sheet"+(o+1),i="");var u=r.dense?(n[e[0].r]||[])[e[0].c]:n[ro(e[0])];if(u){u.t=e[1].t,u.v=e[1].v,null!=e[1].z&&(u.z=e[1].z),null!=e[1].f&&(u.f=e[1].f);break}r.dense?(n[e[0].r]||(n[e[0].r]=[]),n[e[0].r][e[0].c]=e[1]):n[ro(e[0])]=e[1]}},r);else{if(26!=t[2]&&14!=t[2])throw new Error("Unrecognized LOTUS BOF "+t[2]);r.Enum=y,14==t[2]&&(r.qpro=!0,t.l=0),e(t,function(e,t,a){switch(a){case 204:s=e;break;case 22:e[1].v=e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(e[3]>o&&(n["!ref"]=so(d),l[s]=n,c.push(s),n=r.dense?[]:{},d={s:{r:0,c:0},e:{r:0,c:0}},o=e[3],s="Sheet"+(o+1)),f>0&&e[0].r>=f)break;r.dense?(n[e[0].r]||(n[e[0].r]=[]),n[e[0].r][e[0].c]=e[1]):n[ro(e[0])]=e[1],d.e.c<e[0].c&&(d.e.c=e[0].c),d.e.r<e[0].r&&(d.e.r=e[0].r);break;case 27:e[14e3]&&(u[e[14e3][0]]=e[14e3][1]);break;case 1537:u[e[0]]=e[1],e[0]==o&&(s=e[1])}},r)}if(n["!ref"]=so(d),l[i||s]=n,c.push(i||s),!u.length)return{SheetNames:c,Sheets:l};for(var h={},m=[],p=0;p<u.length;++p)l[c[p]]?(m.push(u[p]||c[p]),h[u[p]]=l[u[p]]||l[c[p]]):(m.push(u[p]),h[u[p]]={"!ref":"A1"});return{SheetNames:m,Sheets:h}}function a(e,t,a){var r=[{c:0,r:0},{t:"n",v:0},0,0];return a.qpro&&20768!=a.vers?(r[0].c=e.read_shift(1),r[3]=e.read_shift(1),r[0].r=e.read_shift(2),e.l+=2):(r[2]=e.read_shift(1),r[0].c=e.read_shift(2),r[0].r=e.read_shift(2)),r}function r(e,t,r){var n=e.l+t,s=a(e,0,r);if(s[1].t="s",20768==r.vers){e.l++;var i=e.read_shift(1);return s[1].v=e.read_shift(i,"utf8"),s}return r.qpro&&e.l++,s[1].v=e.read_shift(n-e.l,"cstr"),s}function n(e,t,a){var r=Vi(7+a.length);r.write_shift(1,255),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(1,39);for(var n=0;n<r.length;++n){var s=a.charCodeAt(n);r.write_shift(1,s>=128?95:s)}return r.write_shift(1,0),r}function s(e,t,a){var r=Vi(7);return r.write_shift(1,255),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(2,a,"i"),r}function i(e,t,a){var r=Vi(13);return r.write_shift(1,255),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(8,a,"f"),r}function o(e,t,a){var r=32768&t;return t=(r?e:0)+((t&=-32769)>=8192?t-16384:t),(r?"":"$")+(a?to(t):Zi(t))}var l={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},c=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function u(e){var t=[{c:0,r:0},{t:"n",v:0},0];return t[0].r=e.read_shift(2),t[3]=e[e.l++],t[0].c=e[e.l++],t}function d(e,t,a,r){var n=Vi(6+r.length);n.write_shift(2,e),n.write_shift(1,a),n.write_shift(1,t),n.write_shift(1,39);for(var s=0;s<r.length;++s){var i=r.charCodeAt(s);n.write_shift(1,i>=128?95:i)}return n.write_shift(1,0),n}function f(e,t){var a=u(e),r=e.read_shift(4),n=e.read_shift(4),s=e.read_shift(2);if(65535==s)return 0===r&&3221225472===n?(a[1].t="e",a[1].v=15):0===r&&3489660928===n?(a[1].t="e",a[1].v=42):a[1].v=0,a;var i=32768&s;return s=(32767&s)-16446,a[1].v=(1-2*i)*(n*Math.pow(2,s+32)+r*Math.pow(2,s)),a}function h(e,t,a,r){var n=Vi(14);if(n.write_shift(2,e),n.write_shift(1,a),n.write_shift(1,t),0==r)return n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,65535),n;var s,i=0,o=0,l=0;return r<0&&(i=1,r=-r),o=0|Math.log2(r),0==(2147483648&(l=(r/=Math.pow(2,o-31))>>>0))&&(++o,l=(r/=2)>>>0),r-=l,l|=2147483648,l>>>=0,s=(r*=Math.pow(2,32))>>>0,n.write_shift(4,s),n.write_shift(4,l),o+=16383+(i?32768:0),n.write_shift(2,o),n}function m(e,t){var a=u(e),r=e.read_shift(8,"f");return a[1].v=r,a}function p(e,t){return 0==e[e.l+t-1]?e.read_shift(t,"cstr"):""}function g(e,t){var a=Vi(5+e.length);a.write_shift(2,14e3),a.write_shift(2,t);for(var r=0;r<e.length;++r){var n=e.charCodeAt(r);a[a.l++]=n>127?95:n}return a[a.l++]=0,a}var v={0:{n:"BOF",f:Ul},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(e,t,a){var r={s:{c:0,r:0},e:{c:0,r:0}};return 8==t&&a.qpro?(r.s.c=e.read_shift(1),e.l++,r.s.r=e.read_shift(2),r.e.c=e.read_shift(1),e.l++,r.e.r=e.read_shift(2),r):(r.s.c=e.read_shift(2),r.s.r=e.read_shift(2),12==t&&a.qpro&&(e.l+=2),r.e.c=e.read_shift(2),r.e.r=e.read_shift(2),12==t&&a.qpro&&(e.l+=2),65535==r.s.c&&(r.s.c=r.e.c=r.s.r=r.e.r=0),r)}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(e,t,r){var n=a(e,0,r);return n[1].v=e.read_shift(2,"i"),n}},14:{n:"NUMBER",f:function(e,t,r){var n=a(e,0,r);return n[1].v=e.read_shift(8,"f"),n}},15:{n:"LABEL",f:r},16:{n:"FORMULA",f:function(e,t,r){var n=e.l+t,s=a(e,0,r);if(s[1].v=e.read_shift(8,"f"),r.qpro)e.l=n;else{var i=e.read_shift(2);!function(e,t){Wi(e,0);var a=[],r=0,n="",s="",i="",u="";for(;e.l<e.length;){var d=e[e.l++];switch(d){case 0:a.push(e.read_shift(8,"f"));break;case 1:s=o(t[0].c,e.read_shift(2),!0),n=o(t[0].r,e.read_shift(2),!1),a.push(s+n);break;case 2:var f=o(t[0].c,e.read_shift(2),!0),h=o(t[0].r,e.read_shift(2),!1);s=o(t[0].c,e.read_shift(2),!0),n=o(t[0].r,e.read_shift(2),!1),a.push(f+h+":"+s+n);break;case 3:if(e.l<e.length)return void console.error("WK1 premature formula end");break;case 4:a.push("("+a.pop()+")");break;case 5:a.push(e.read_shift(2));break;case 6:for(var m="";d=e[e.l++];)m+=String.fromCharCode(d);a.push('"'+m.replace(/"/g,'""')+'"');break;case 8:a.push("-"+a.pop());break;case 23:a.push("+"+a.pop());break;case 22:a.push("NOT("+a.pop()+")");break;case 20:case 21:u=a.pop(),i=a.pop(),a.push(["AND","OR"][d-20]+"("+i+","+u+")");break;default:if(d<32&&c[d])u=a.pop(),i=a.pop(),a.push(i+c[d]+u);else{if(!l[d])return d<=7?console.error("WK1 invalid opcode "+d.toString(16)):d<=24?console.error("WK1 unsupported op "+d.toString(16)):d<=30?console.error("WK1 invalid opcode "+d.toString(16)):d<=115?console.error("WK1 unsupported function opcode "+d.toString(16)):console.error("WK1 unrecognized opcode "+d.toString(16));if(69==(r=l[d][1])&&(r=e[e.l++]),r>a.length)return void console.error("WK1 bad formula parse 0x"+d.toString(16)+":|"+a.join("|")+"|");var p=a.slice(-r);a.length-=r,a.push(l[d][0]+"("+p.join(",")+")")}}}1==a.length?t[1].f=""+a[0]:console.error("WK1 bad formula parse |"+a.join("|")+"|")}(e.slice(e.l,e.l+i),s),e.l+=i}return s}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:r},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:p},222:{n:"SHEETNAMELP",f:function(e,t){var a=e[e.l++];a>t-1&&(a=t-1);for(var r="";r.length<a;)r+=String.fromCharCode(e[e.l++]);return r}},65535:{n:""}},y={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function(e,t){var a=u(e);return a[1].t="s",a[1].v=e.read_shift(t-4,"cstr"),a}},23:{n:"NUMBER17",f:f},24:{n:"NUMBER18",f:function(e,t){var a=u(e);a[1].v=e.read_shift(2);var r=a[1].v>>1;if(1&a[1].v)switch(7&r){case 0:r=5e3*(r>>3);break;case 1:r=500*(r>>3);break;case 2:r=(r>>3)/20;break;case 3:r=(r>>3)/200;break;case 4:r=(r>>3)/2e3;break;case 5:r=(r>>3)/2e4;break;case 6:r=(r>>3)/16;break;case 7:r=(r>>3)/64}return a[1].v=r,a}},25:{n:"FORMULA19",f:function(e,t){var a=f(e);return e.l+=t-14,a}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function(e,t){for(var a={},r=e.l+t;e.l<r;){var n=e.read_shift(2);if(14e3==n){for(a[n]=[0,""],a[n][0]=e.read_shift(2);e[e.l];)a[n][1]+=String.fromCharCode(e[e.l]),e.l++;e.l++}}return a}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function(e,t){var a=u(e),r=e.read_shift(4);return a[1].v=r>>6,a}},38:{n:"??"},39:{n:"NUMBER27",f:m},40:{n:"FORMULA28",f:function(e,t){var a=m(e);return e.l+=t-10,a}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:p},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function(e,t,a){if(a.qpro&&!(t<21)){var r=e.read_shift(1);return e.l+=17,e.l+=1,e.l+=2,[r,e.read_shift(t-21,"cstr")]}}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:function(e,t){var a=t||{};if(+a.codepage>=0&&ar(+a.codepage),"string"==a.type)throw new Error("Cannot write WK1 to JS string");var r=$i(),o=io(e["!ref"]),l=Array.isArray(e),c=[];rm(r,0,function(e){var t=Vi(2);return t.write_shift(2,e),t}(1030)),rm(r,6,function(e){var t=Vi(8);return t.write_shift(2,e.s.c),t.write_shift(2,e.s.r),t.write_shift(2,e.e.c),t.write_shift(2,e.e.r),t}(o));for(var u=Math.min(o.e.r,8191),d=o.s.r;d<=u;++d)for(var f=Zi(d),h=o.s.c;h<=o.e.c;++h){d===o.s.r&&(c[h]=to(h));var m=c[h]+f,p=l?(e[d]||[])[h]:e[m];if(p&&"z"!=p.t)if("n"==p.t)(0|p.v)==p.v&&p.v>=-32768&&p.v<=32767?rm(r,13,s(d,h,p.v)):rm(r,14,i(d,h,p.v));else rm(r,15,n(d,h,lo(p).slice(0,239)))}return rm(r,1),r.end()},book_to_wk3:function(e,t){var a=t||{};if(+a.codepage>=0&&ar(+a.codepage),"string"==a.type)throw new Error("Cannot write WK3 to JS string");var r=$i();rm(r,0,function(e){var t=Vi(26);t.write_shift(2,4096),t.write_shift(2,4),t.write_shift(4,0);for(var a=0,r=0,n=0,s=0;s<e.SheetNames.length;++s){var i=e.SheetNames[s],o=e.Sheets[i];if(o&&o["!ref"]){++n;var l=no(o["!ref"]);a<l.e.r&&(a=l.e.r),r<l.e.c&&(r=l.e.c)}}a>8191&&(a=8191);return t.write_shift(2,a),t.write_shift(1,n),t.write_shift(1,r),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,1),t.write_shift(1,2),t.write_shift(4,0),t.write_shift(4,0),t}(e));for(var n=0,s=0;n<e.SheetNames.length;++n)(e.Sheets[e.SheetNames[n]]||{})["!ref"]&&rm(r,27,g(e.SheetNames[n],s++));var i=0;for(n=0;n<e.SheetNames.length;++n){var o=e.Sheets[e.SheetNames[n]];if(o&&o["!ref"]){for(var l=io(o["!ref"]),c=Array.isArray(o),u=[],f=Math.min(l.e.r,8191),m=l.s.r;m<=f;++m)for(var p=Zi(m),v=l.s.c;v<=l.e.c;++v){m===l.s.r&&(u[v]=to(v));var y=u[v]+p,b=c?(o[m]||[])[v]:o[y];if(b&&"z"!=b.t)if("n"==b.t)rm(r,23,h(m,v,i,b.v));else rm(r,22,d(m,v,i,lo(b).slice(0,239)))}++i}}return rm(r,1),r.end()},to_workbook:function(e,a){switch(a.type){case"base64":return t(vr(fr(e)),a);case"binary":return t(vr(e),a);case"buffer":case"array":return t(e,a)}throw"Unsupported type "+a.type}}}();var Hc=function(){var e=Cs("t"),t=Cs("rPr");function a(a){var r=a.match(e);if(!r)return{t:"s",v:""};var n={t:"s",v:hs(r[1])},s=a.match(t);return s&&(n.s=function(e){var t={},a=e.match(is),r=0,n=!1;if(a)for(;r!=a.length;++r){var s=cs(a[r]);switch(s[0].replace(/\w*:/g,"")){case"<condense":case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if("1"==s.val)break;t.cp=er[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting"}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if("0"==s.val)break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if("0"==s.val)break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":case"<scheme":case"<scheme>":case"<scheme/>":case"</scheme>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(47!==s[0].charCodeAt(1)&&!n)throw new Error("Unrecognized rich format "+s[0])}}return t}(s[1])),n}var r=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function(e){return e.replace(r,"").split(n).map(a).filter(function(e){return e.v})}}(),Vc=function(){var e=/(\r\n|\n)/g;function t(t){var a=[[],t.v,[]];return t.v?(t.s&&function(e,t,a){var r=[];e.u&&r.push("text-decoration: underline;"),e.uval&&r.push("text-underline-style:"+e.uval+";"),e.sz&&r.push("font-size:"+e.sz+"pt;"),e.outline&&r.push("text-effect: outline;"),e.shadow&&r.push("text-shadow: auto;"),t.push('<span style="'+r.join("")+'">'),e.b&&(t.push("<b>"),a.push("</b>")),e.i&&(t.push("<i>"),a.push("</i>")),e.strike&&(t.push("<s>"),a.push("</s>"));var n=e.valign||"";"superscript"==n||"super"==n?n="sup":"subscript"==n&&(n="sub"),""!=n&&(t.push("<"+n+">"),a.push("</"+n+">")),a.push("</span>")}(t.s,a[0],a[2]),a[0].join("")+a[1].replace(e,"<br/>")+a[2].join("")):""}return function(e){return e.map(t).join("")}}(),Gc=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,$c=/<(?:\w+:)?r>/,qc=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Yc(e,t){var a=!t||t.cellHTML,r={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(r.t=hs(Ns(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),r.r=Ns(e),a&&(r.h=bs(r.t))):e.match($c)&&(r.r=Ns(e),r.t=hs(Ns((e.replace(qc,"").match(Gc)||[]).join("").replace(is,""))),a&&(r.h=Vc(Hc(r.r)))),r):{t:""}}var Xc=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Kc=/<(?:\w+:)?(?:si|sstItem)>/g,Jc=/<\/(?:\w+:)?(?:si|sstItem)>/;var Qc=/^\s|\s$|[\t\n\r]/;function Zc(e,t){if(!t.bookSST)return"";var a=[rs];a[a.length]=Ls("sst",null,{xmlns:ei[0],count:e.Count,uniqueCount:e.Unique});for(var r=0;r!=e.length;++r)if(null!=e[r]){var n=e[r],s="<si>";n.r?s+=n.r:(s+="<t",n.t||(n.t=""),n.t.match(Qc)&&(s+=' xml:space="preserve"'),s+=">"+gs(n.t)+"</t>"),s+="</si>",a[a.length]=s}return a.length>2&&(a[a.length]="</sst>",a[1]=a[1].replace("/>",">")),a.join("")}var eu=function(e,t){var a=!1;return null==t&&(a=!0,t=Vi(15+4*e.t.length)),t.write_shift(1,0),po(e.t,t),a?t.slice(0,t.l):t};function tu(e){var t=$i();qi(t,159,function(e,t){return t||(t=Vi(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}(e));for(var a=0;a<e.length;++a)qi(t,19,eu(e[a]));return qi(t,160),t.end()}function au(e){if("undefined"!==typeof ir)return ir.utils.encode(Qa,e);for(var t=[],a=e.split(""),r=0;r<a.length;++r)t[r]=a[r].charCodeAt(0);return t}function ru(e,t){var a={};return a.Major=e.read_shift(2),a.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),a}function nu(e){for(var t=e.read_shift(4),a=e.l+t-4,r={},n=e.read_shift(4),s=[];n-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(r.name=e.read_shift(0,"lpp4"),r.comps=s,e.l!=a)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+a);return r}function su(e){var t=function(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=ru(e,4),t.U=ru(e,4),t.W=ru(e,4),t}(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),4!=e.read_shift(4))throw new Error("Bad !Primary record");return t}function iu(e,t){var a=e.l+t,r={};r.Flags=63&e.read_shift(4),e.l+=4,r.AlgID=e.read_shift(4);var n=!1;switch(r.AlgID){case 26126:case 26127:case 26128:n=36==r.Flags;break;case 26625:n=4==r.Flags;break;case 0:n=16==r.Flags||4==r.Flags||36==r.Flags;break;default:throw"Unrecognized encryption algorithm: "+r.AlgID}if(!n)throw new Error("Encryption Flags/AlgID mismatch");return r.AlgIDHash=e.read_shift(4),r.KeySize=e.read_shift(4),r.ProviderType=e.read_shift(4),e.l+=8,r.CSPName=e.read_shift(a-e.l>>1,"utf16le"),e.l=a,r}function ou(e,t){var a={},r=e.l+t;return e.l+=4,a.Salt=e.slice(e.l,e.l+16),e.l+=16,a.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),a.VerifierHash=e.slice(e.l,r),e.l=r,a}function lu(e){if(36!=(63&e.read_shift(4)))throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4);return{t:"Std",h:iu(e,t),v:ou(e,e.length-e.l)}}function cu(){throw new Error("File is password-protected: ECMA-376 Extensible")}function uu(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var a=e.read_shift(e.length-e.l,"utf8"),r={};return a.replace(is,function(e){var a=cs(e);switch(us(a[0])){case"<?xml":case"<encryption":case"</encryption>":case"</keyEncryptors>":case"</keyEncryptor>":break;case"<keyData":t.forEach(function(e){r[e]=a[e]});break;case"<dataIntegrity":r.encryptedHmacKey=a.encryptedHmacKey,r.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":r.encs=[];break;case"<keyEncryptor":r.uri=a.uri;break;case"<encryptedKey":r.encs.push(a);break;default:throw a[0]}}),r}function du(e){var t,a,r=0,n=au(e),s=n.length+1;for((t=pr(s))[0]=n.length,a=1;a!=s;++a)t[a]=n[a-1];for(a=s-1;a>=0;--a)r=((0===(16384&r)?0:1)|r<<1&32767)^t[a];return 52811^r}var fu=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],a=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],r=function(e,t){return 255&((a=e^t)/2|128*a);var a};return function(n){for(var s,i,o,l=au(n),c=function(e){for(var r=t[e.length-1],n=104,s=e.length-1;s>=0;--s)for(var i=e[s],o=0;7!=o;++o)64&i&&(r^=a[n]),i*=2,--n;return r}(l),u=l.length,d=pr(16),f=0;16!=f;++f)d[f]=0;for(1===(1&u)&&(s=c>>8,d[u]=r(e[0],s),--u,s=255&c,i=l[l.length-1],d[u]=r(i,s));u>0;)s=c>>8,d[--u]=r(l[u],s),s=255&c,d[--u]=r(l[u],s);for(u=15,o=15-l.length;o>0;)s=c>>8,d[u]=r(e[o],s),--o,s=255&c,d[--u]=r(l[u],s),--u,--o;return d}}(),hu=function(e){var t=0,a=fu(e);return function(e){var r=function(e,t,a,r,n){var s,i;for(n||(n=t),r||(r=fu(e)),s=0;s!=t.length;++s)i=t[s],i=255&((i^=r[a])>>5|i<<3),n[s]=i,++a;return[n,a,r]}("",e,t,a);return t=r[1],r[0]}};function mu(e,t,a){var r=a||{};return r.Info=e.read_shift(2),e.l-=2,1===r.Info?r.Data=function(e){var t={},a=t.EncryptionVersionInfo=ru(e,4);if(1!=a.Major||1!=a.Minor)throw"unrecognized version code "+a.Major+" : "+a.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}(e):r.Data=function(e,t){var a={},r=a.EncryptionVersionInfo=ru(e,4);if(t-=4,2!=r.Minor)throw new Error("unrecognized minor version code: "+r.Minor);if(r.Major>4||r.Major<2)throw new Error("unrecognized major version code: "+r.Major);a.Flags=e.read_shift(4),t-=4;var n=e.read_shift(4);return t-=4,a.EncryptionHeader=iu(e,n),t-=n,a.EncryptionVerifier=ou(e,t),a}(e,t),r}var pu=function(){function e(e,a){switch(a.type){case"base64":return t(fr(e),a);case"binary":return t(e,a);case"buffer":return t(hr&&Buffer.isBuffer(e)?e.toString("binary"):br(e),a);case"array":return t(Mn(e),a)}throw new Error("Unrecognized type "+a.type)}function t(e,t){var a=(t||{}).dense?[]:{},r=e.match(/\\trowd.*?\\row\b/g);if(!r.length)throw new Error("RTF missing table");var n={s:{c:0,r:0},e:{c:0,r:r.length-1}};return r.forEach(function(e,t){Array.isArray(a)&&(a[t]=[]);for(var r,s=/\\\w+\b/g,i=0,o=-1;r=s.exec(e);){if("\\cell"===r[0]){var l=e.slice(i,s.lastIndex-r[0].length);if(" "==l[0]&&(l=l.slice(1)),++o,l.length){var c={v:l,t:"s"};Array.isArray(a)?a[t][o]=c:a[ro({r:t,c:o})]=c}}i=s.lastIndex}o>n.e.c&&(n.e.c=o)}),a["!ref"]=so(n),a}return{to_workbook:function(t,a){return co(e(t,a),a)},to_sheet:e,from_sheet:function(e){for(var t,a=["{\\rtf1\\ansi"],r=io(e["!ref"]),n=Array.isArray(e),s=r.s.r;s<=r.e.r;++s){a.push("\\trowd\\trautofit1");for(var i=r.s.c;i<=r.e.c;++i)a.push("\\cellx"+(i+1));for(a.push("\\pard\\intbl"),i=r.s.c;i<=r.e.c;++i){var o=ro({r:s,c:i});(t=n?(e[s]||[])[i]:e[o])&&(null!=t.v||t.f&&!t.F)&&(a.push(" "+(t.w||(lo(t),t.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}}}();function gu(e){for(var t=0,a=1;3!=t;++t)a=256*a+(e[t]>255?255:e[t]<0?0:e[t]);return a.toString(16).toUpperCase().slice(1)}function vu(e,t){if(0===t)return e;var a=function(e){var t=e[0]/255,a=e[1]/255,r=e[2]/255,n=Math.max(t,a,r),s=Math.min(t,a,r),i=n-s;if(0===i)return[0,0,t];var o,l=0,c=n+s;switch(o=i/(c>1?2-c:c),n){case t:l=((a-r)/i+6)%6;break;case a:l=(r-t)/i+2;break;case r:l=(t-a)/i+4}return[l/6,o,c/2]}(function(e){var t=e.slice("#"===e[0]?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}(e));return a[2]=t<0?a[2]*(1+t):1-(1-a[2])*(1-t),gu(function(e){var t,a=e[0],r=e[1],n=e[2],s=2*r*(n<.5?n:1-n),i=n-s/2,o=[i,i,i],l=6*a;if(0!==r)switch(0|l){case 0:case 6:t=s*l,o[0]+=s,o[1]+=t;break;case 1:t=s*(2-l),o[0]+=t,o[1]+=s;break;case 2:t=s*(l-2),o[1]+=s,o[2]+=t;break;case 3:t=s*(4-l),o[1]+=t,o[2]+=s;break;case 4:t=s*(l-4),o[2]+=s,o[0]+=t;break;case 5:t=s*(6-l),o[2]+=t,o[0]+=s}for(var c=0;3!=c;++c)o[c]=Math.round(255*o[c]);return o}(a))}var yu=6;function bu(e){return Math.floor((e+Math.round(128/yu)/256)*yu)}function wu(e){return Math.floor((e-5)/yu*100+.5)/100}function xu(e){return Math.round((e*yu+5)/yu*256)/256}function ku(e){return xu(wu(bu(e)))}function Su(e){var t=Math.abs(e-ku(e)),a=yu;if(t>.005)for(yu=1;yu<15;++yu)Math.abs(e-ku(e))<=t&&(t=Math.abs(e-ku(e)),a=yu);yu=a}function Eu(e){e.width?(e.wpx=bu(e.width),e.wch=wu(e.wpx),e.MDW=yu):e.wpx?(e.wch=wu(e.wpx),e.width=xu(e.wch),e.MDW=yu):"number"==typeof e.wch&&(e.width=xu(e.wch),e.wpx=bu(e.width),e.MDW=yu),e.customWidth&&delete e.customWidth}var Tu=96;function Nu(e){return 96*e/Tu}function ju(e){return e*Tu/96}var Cu={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};var _u=["numFmtId","fillId","fontId","borderId","xfId"],Au=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];var Pu=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,r=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,n=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(s,i,o){var l,c={};return s?((l=(s=s.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"")).match(e))&&function(e,t,a){t.NumberFmt=[];for(var r=Sn(Or),n=0;n<r.length;++n)t.NumberFmt[r[n]]=Or[r[n]];var s=e[0].match(is);if(s)for(n=0;n<s.length;++n){var i=cs(s[n]);switch(us(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":case"</numFmt>":break;case"<numFmt":var o=hs(Ns(i.formatCode)),l=parseInt(i.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&null!=t.NumberFmt[l];--l);t.NumberFmt[l]=o}hn(o,l)}break;default:if(a.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}(l,c,o),(l=s.match(r))&&function(e,t,a,r){t.Fonts=[];var n={},s=!1;(e[0].match(is)||[]).forEach(function(e){var i=cs(e);switch(us(i[0])){case"<fonts":case"<fonts>":case"</fonts>":case"<font":case"<font>":case"<name/>":case"</name>":case"<sz/>":case"</sz>":case"<vertAlign/>":case"</vertAlign>":case"<family/>":case"</family>":case"<scheme/>":case"</scheme>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"</font>":case"<font/>":t.Fonts.push(n),n={};break;case"<name":i.val&&(n.name=Ns(i.val));break;case"<b":n.bold=i.val?xs(i.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=i.val?xs(i.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(i.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=i.val?xs(i.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=i.val?xs(i.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=i.val?xs(i.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=i.val?xs(i.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=i.val?xs(i.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":i.val&&(n.sz=+i.val);break;case"<vertAlign":i.val&&(n.vertAlign=i.val);break;case"<family":i.val&&(n.family=parseInt(i.val,10));break;case"<scheme":i.val&&(n.scheme=i.val);break;case"<charset":if("1"==i.val)break;i.codepage=er[parseInt(i.val,10)];break;case"<color":if(n.color||(n.color={}),i.auto&&(n.color.auto=xs(i.auto)),i.rgb)n.color.rgb=i.rgb.slice(-6);else if(i.indexed){n.color.index=parseInt(i.indexed,10);var o=qo[n.color.index];81==n.color.index&&(o=qo[1]),o||(o=qo[1]),n.color.rgb=o[0].toString(16)+o[1].toString(16)+o[2].toString(16)}else i.theme&&(n.color.theme=parseInt(i.theme,10),i.tint&&(n.color.tint=parseFloat(i.tint)),i.theme&&a.themeElements&&a.themeElements.clrScheme&&(n.color.rgb=vu(a.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<AlternateContent":case"<ext":s=!0;break;case"</AlternateContent>":case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+i[0]+" in fonts")}})}(l,c,i,o),(l=s.match(a))&&function(e,t,a,r){t.Fills=[];var n={},s=!1;(e[0].match(is)||[]).forEach(function(e){var a=cs(e);switch(us(a[0])){case"<fills":case"<fills>":case"</fills>":case"</fill>":case"<gradientFill>":case"<patternFill/>":case"</patternFill>":case"<bgColor/>":case"</bgColor>":case"<fgColor/>":case"</fgColor>":case"<stop":case"<stop/>":case"</stop>":case"<color":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<fill>":case"<fill":case"<fill/>":n={},t.Fills.push(n);break;case"<gradientFill":case"</gradientFill>":t.Fills.push(n),n={};break;case"<patternFill":case"<patternFill>":a.patternType&&(n.patternType=a.patternType);break;case"<bgColor":n.bgColor||(n.bgColor={}),a.indexed&&(n.bgColor.indexed=parseInt(a.indexed,10)),a.theme&&(n.bgColor.theme=parseInt(a.theme,10)),a.tint&&(n.bgColor.tint=parseFloat(a.tint)),a.rgb&&(n.bgColor.rgb=a.rgb.slice(-6));break;case"<fgColor":n.fgColor||(n.fgColor={}),a.theme&&(n.fgColor.theme=parseInt(a.theme,10)),a.tint&&(n.fgColor.tint=parseFloat(a.tint)),null!=a.rgb&&(n.fgColor.rgb=a.rgb.slice(-6));break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+a[0]+" in fills")}})}(l,c,0,o),(l=s.match(n))&&function(e,t,a,r){t.Borders=[];var n={},s=!1;(e[0].match(is)||[]).forEach(function(e){var a=cs(e);switch(us(a[0])){case"<borders":case"<borders>":case"</borders>":case"</border>":case"<left/>":case"<left":case"<left>":case"</left>":case"<right/>":case"<right":case"<right>":case"</right>":case"<top/>":case"<top":case"<top>":case"</top>":case"<bottom/>":case"<bottom":case"<bottom>":case"</bottom>":case"<diagonal":case"<diagonal>":case"<diagonal/>":case"</diagonal>":case"<horizontal":case"<horizontal>":case"<horizontal/>":case"</horizontal>":case"<vertical":case"<vertical>":case"<vertical/>":case"</vertical>":case"<start":case"<start>":case"<start/>":case"</start>":case"<end":case"<end>":case"<end/>":case"</end>":case"<color":case"<color>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<border":case"<border>":case"<border/>":n={},a.diagonalUp&&(n.diagonalUp=xs(a.diagonalUp)),a.diagonalDown&&(n.diagonalDown=xs(a.diagonalDown)),t.Borders.push(n);break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+a[0]+" in borders")}})}(l,c,0,o),(l=s.match(t))&&function(e,t,a){var r;t.CellXf=[];var n=!1;(e[0].match(is)||[]).forEach(function(e){var s=cs(e),i=0;switch(us(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":case"</xf>":case"</alignment>":case"<protection":case"</protection>":case"<protection/>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<xf":case"<xf/>":for(delete(r=s)[0],i=0;i<_u.length;++i)r[_u[i]]&&(r[_u[i]]=parseInt(r[_u[i]],10));for(i=0;i<Au.length;++i)r[Au[i]]&&(r[Au[i]]=xs(r[Au[i]]));if(t.NumberFmt&&r.numFmtId>392)for(i=392;i>60;--i)if(t.NumberFmt[r.numFmtId]==t.NumberFmt[i]){r.numFmtId=i;break}t.CellXf.push(r);break;case"<alignment":case"<alignment/>":var o={};s.vertical&&(o.vertical=s.vertical),s.horizontal&&(o.horizontal=s.horizontal),null!=s.textRotation&&(o.textRotation=s.textRotation),s.indent&&(o.indent=s.indent),s.wrapText&&(o.wrapText=xs(s.wrapText)),r.alignment=o;break;case"<AlternateContent":case"<ext":n=!0;break;case"</AlternateContent>":case"</ext>":n=!1;break;default:if(a&&a.WTF&&!n)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}(l,c,o),c):c}}();function Ru(e,t){var a,r=[rs,Ls("styleSheet",null,{xmlns:ei[0],"xmlns:vt":Js})];return e.SSF&&null!=(a=function(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var r=a[0];r<=a[1];++r)null!=e[r]&&(t[t.length]=Ls("numFmt",null,{numFmtId:r,formatCode:gs(e[r])}))}),1===t.length?"":(t[t.length]="</numFmts>",t[0]=Ls("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}(e.SSF))&&(r[r.length]=a),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=function(e){var t=[];return t[t.length]=Ls("cellXfs",null),e.forEach(function(e){t[t.length]=Ls("xf",null,e)}),t[t.length]="</cellXfs>",2===t.length?"":(t[0]=Ls("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}(t.cellXfs))&&(r[r.length]=a),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Ou(e,t,a){a||(a=Vi(6+4*t.length)),a.write_shift(2,e),po(t,a);var r=a.length>a.l?a.slice(0,a.l):a;return null==a.l&&(a.l=a.length),r}function Du(e,t){t||(t=Vi(153)),t.write_shift(2,20*e.sz),function(e,t){t||(t=Vi(2));var a=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);t.write_shift(1,a),t.write_shift(1,0)}(e,t),t.write_shift(2,e.bold?700:400);var a=0;"superscript"==e.vertAlign?a=1:"subscript"==e.vertAlign&&(a=2),t.write_shift(2,a),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Mo(e.color,t);var r=0;return"major"==e.scheme&&(r=1),"minor"==e.scheme&&(r=2),t.write_shift(1,r),po(e.name,t),t.length>t.l?t.slice(0,t.l):t}var Fu,Iu=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Lu=Hi;function Mu(e,t){t||(t=Vi(84)),Fu||(Fu=Tn(Iu));var a=Fu[e.patternType];null==a&&(a=40),t.write_shift(4,a);var r=0;if(40!=a)for(Mo({auto:1},t),Mo({auto:1},t);r<12;++r)t.write_shift(4,0);else{for(;r<4;++r)t.write_shift(4,0);for(;r<12;++r)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function zu(e,t,a){a||(a=Vi(16)),a.write_shift(2,t||0),a.write_shift(2,e.numFmtId||0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(1,0),a.write_shift(1,0);return a.write_shift(1,0),a.write_shift(1,0),a.write_shift(1,0),a.write_shift(1,0),a}function Uu(e,t){return t||(t=Vi(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var Bu=Hi;function Wu(e){var t;qi(e,613,ho(1)),qi(e,46,(t||(t=Vi(51)),t.write_shift(1,0),Uu(0,t),Uu(0,t),Uu(0,t),Uu(0,t),Uu(0,t),t.length>t.l?t.slice(0,t.l):t)),qi(e,614)}function Hu(e){var t,a;qi(e,619,ho(1)),qi(e,48,(t={xfId:0,builtinId:0,name:"Normal"},a||(a=Vi(52)),a.write_shift(4,t.xfId),a.write_shift(2,1),a.write_shift(1,+t.builtinId),a.write_shift(1,0),jo(t.name||"",a),a.length>a.l?a.slice(0,a.l):a)),qi(e,620)}function Vu(e){qi(e,508,function(e,t,a){var r=Vi(2052);return r.write_shift(4,e),jo(t,r),jo(a,r),r.length>r.l?r.slice(0,r.l):r}(0,"TableStyleMedium9","PivotStyleMedium4")),qi(e,509)}function Gu(e,t){var a=$i();return qi(a,278),function(e,t){if(t){var a=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var r=e[0];r<=e[1];++r)null!=t[r]&&++a}),0!=a&&(qi(e,615,ho(a)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var r=a[0];r<=a[1];++r)null!=t[r]&&qi(e,44,Ou(r,t[r]))}),qi(e,616))}}(a,e.SSF),function(e){qi(e,611,ho(1)),qi(e,43,Du({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),qi(e,612)}(a),function(e){qi(e,603,ho(2)),qi(e,45,Mu({patternType:"none"})),qi(e,45,Mu({patternType:"gray125"})),qi(e,604)}(a),Wu(a),function(e){qi(e,626,ho(1)),qi(e,47,zu({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),qi(e,627)}(a),function(e,t){qi(e,617,ho(t.length)),t.forEach(function(t){qi(e,47,zu(t,0))}),qi(e,618)}(a,t.cellXfs),Hu(a),function(e){qi(e,505,ho(0)),qi(e,506)}(a),Vu(a),qi(a,279),a.end()}var $u=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function qu(e,t,a){t.themeElements.clrScheme=[];var r={};(e[0].match(is)||[]).forEach(function(e){var n=cs(e);switch(n[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":r.rgb=n.val;break;case"<a:sysClr":r.rgb=n.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":"/"===n[0].charAt(1)?(t.themeElements.clrScheme[$u.indexOf(n[0])]=r,r={}):r.name=n[0].slice(3,n[0].length-1);break;default:if(a&&a.WTF)throw new Error("Unrecognized "+n[0]+" in clrScheme")}})}function Yu(){}function Xu(){}var Ku=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Ju=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Qu=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;var Zu=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function ed(e,t){var a;e&&0!==e.length||(e=td());var r={};if(!(a=e.match(Zu)))throw new Error("themeElements not found in theme");return function(e,t,a){var r;t.themeElements={},[["clrScheme",Ku,qu],["fontScheme",Ju,Yu],["fmtScheme",Qu,Xu]].forEach(function(n){if(!(r=e.match(n[1])))throw new Error(n[0]+" not found in themeElements");n[2](r,t,a)})}(a[0],r,t),r.raw=e,r}function td(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&"string"==typeof e.raw)return e.raw;var a=[rs];return a[a.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',a[a.length]="<a:themeElements>",a[a.length]='<a:clrScheme name="Office">',a[a.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',a[a.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',a[a.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',a[a.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',a[a.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',a[a.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',a[a.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',a[a.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',a[a.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',a[a.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',a[a.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',a[a.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',a[a.length]="</a:clrScheme>",a[a.length]='<a:fontScheme name="Office">',a[a.length]="<a:majorFont>",a[a.length]='<a:latin typeface="Cambria"/>',a[a.length]='<a:ea typeface=""/>',a[a.length]='<a:cs typeface=""/>',a[a.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',a[a.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',a[a.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',a[a.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',a[a.length]='<a:font script="Arab" typeface="Times New Roman"/>',a[a.length]='<a:font script="Hebr" typeface="Times New Roman"/>',a[a.length]='<a:font script="Thai" typeface="Tahoma"/>',a[a.length]='<a:font script="Ethi" typeface="Nyala"/>',a[a.length]='<a:font script="Beng" typeface="Vrinda"/>',a[a.length]='<a:font script="Gujr" typeface="Shruti"/>',a[a.length]='<a:font script="Khmr" typeface="MoolBoran"/>',a[a.length]='<a:font script="Knda" typeface="Tunga"/>',a[a.length]='<a:font script="Guru" typeface="Raavi"/>',a[a.length]='<a:font script="Cans" typeface="Euphemia"/>',a[a.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',a[a.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',a[a.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',a[a.length]='<a:font script="Thaa" typeface="MV Boli"/>',a[a.length]='<a:font script="Deva" typeface="Mangal"/>',a[a.length]='<a:font script="Telu" typeface="Gautami"/>',a[a.length]='<a:font script="Taml" typeface="Latha"/>',a[a.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',a[a.length]='<a:font script="Orya" typeface="Kalinga"/>',a[a.length]='<a:font script="Mlym" typeface="Kartika"/>',a[a.length]='<a:font script="Laoo" typeface="DokChampa"/>',a[a.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',a[a.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',a[a.length]='<a:font script="Viet" typeface="Times New Roman"/>',a[a.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',a[a.length]='<a:font script="Geor" typeface="Sylfaen"/>',a[a.length]="</a:majorFont>",a[a.length]="<a:minorFont>",a[a.length]='<a:latin typeface="Calibri"/>',a[a.length]='<a:ea typeface=""/>',a[a.length]='<a:cs typeface=""/>',a[a.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',a[a.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',a[a.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',a[a.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',a[a.length]='<a:font script="Arab" typeface="Arial"/>',a[a.length]='<a:font script="Hebr" typeface="Arial"/>',a[a.length]='<a:font script="Thai" typeface="Tahoma"/>',a[a.length]='<a:font script="Ethi" typeface="Nyala"/>',a[a.length]='<a:font script="Beng" typeface="Vrinda"/>',a[a.length]='<a:font script="Gujr" typeface="Shruti"/>',a[a.length]='<a:font script="Khmr" typeface="DaunPenh"/>',a[a.length]='<a:font script="Knda" typeface="Tunga"/>',a[a.length]='<a:font script="Guru" typeface="Raavi"/>',a[a.length]='<a:font script="Cans" typeface="Euphemia"/>',a[a.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',a[a.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',a[a.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',a[a.length]='<a:font script="Thaa" typeface="MV Boli"/>',a[a.length]='<a:font script="Deva" typeface="Mangal"/>',a[a.length]='<a:font script="Telu" typeface="Gautami"/>',a[a.length]='<a:font script="Taml" typeface="Latha"/>',a[a.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',a[a.length]='<a:font script="Orya" typeface="Kalinga"/>',a[a.length]='<a:font script="Mlym" typeface="Kartika"/>',a[a.length]='<a:font script="Laoo" typeface="DokChampa"/>',a[a.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',a[a.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',a[a.length]='<a:font script="Viet" typeface="Arial"/>',a[a.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',a[a.length]='<a:font script="Geor" typeface="Sylfaen"/>',a[a.length]="</a:minorFont>",a[a.length]="</a:fontScheme>",a[a.length]='<a:fmtScheme name="Office">',a[a.length]="<a:fillStyleLst>",a[a.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:lin ang="16200000" scaled="1"/>',a[a.length]="</a:gradFill>",a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:lin ang="16200000" scaled="0"/>',a[a.length]="</a:gradFill>",a[a.length]="</a:fillStyleLst>",a[a.length]="<a:lnStyleLst>",a[a.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]="</a:lnStyleLst>",a[a.length]="<a:effectStyleLst>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]="</a:effectStyle>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]="</a:effectStyle>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',a[a.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',a[a.length]="</a:effectStyle>",a[a.length]="</a:effectStyleLst>",a[a.length]="<a:bgFillStyleLst>",a[a.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',a[a.length]="</a:gradFill>",a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',a[a.length]="</a:gradFill>",a[a.length]="</a:bgFillStyleLst>",a[a.length]="</a:fmtScheme>",a[a.length]="</a:themeElements>",a[a.length]="<a:objectDefaults>",a[a.length]="<a:spDef>",a[a.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',a[a.length]="</a:spDef>",a[a.length]="<a:lnDef>",a[a.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',a[a.length]="</a:lnDef>",a[a.length]="</a:objectDefaults>",a[a.length]="<a:extraClrSchemeLst/>",a[a.length]="</a:theme>",a.join("")}function ad(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:case 4:e.l+=4;break;case 1:t.xclrValue=function(e,t){return Hi(e,t)}(e,4);break;case 2:t.xclrValue=tc(e);break;case 3:t.xclrValue=function(e){return e.read_shift(4)}(e)}return e.l+=8,t}function rd(e){var t=e.read_shift(2),a=e.read_shift(2)-4,r=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:r[1]=ad(e);break;case 6:r[1]=function(e,t){return Hi(e,t)}(e,a);break;case 14:case 15:r[1]=e.read_shift(1===a?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+a)}return r}function nd(e,t){t.forEach(function(e){e[0]})}function sd(){var e=$i();return qi(e,332),qi(e,334,ho(1)),qi(e,335,function(e){var t=Vi(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),po(e.name,t),t.slice(0,t.l)}({name:"XLDAPR",version:12e4,flags:3496657072})),qi(e,336),qi(e,339,function(e,t){var a=Vi(8+2*t.length);return a.write_shift(4,e),po(t,a),a.slice(0,a.l)}(1,"XLDAPR")),qi(e,52),qi(e,35,ho(514)),qi(e,4096,ho(0)),qi(e,4097,Bl(1)),qi(e,36),qi(e,53),qi(e,340),qi(e,337,function(e,t){var a=Vi(8);return a.write_shift(4,e),a.write_shift(4,t?1:0),a}(1,!0)),qi(e,51,function(e){var t=Vi(4+8*e.length);t.write_shift(4,e.length);for(var a=0;a<e.length;++a)t.write_shift(4,e[a][0]),t.write_shift(4,e[a][1]);return t}([[1,0]])),qi(e,338),qi(e,333),e.end()}function id(){var e=[rs];return e.push('<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">\n  <metadataTypes count="1">\n    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>\n  </metadataTypes>\n  <futureMetadata name="XLDAPR" count="1">\n    <bk>\n      <extLst>\n        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">\n          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>\n        </ext>\n      </extLst>\n    </bk>\n  </futureMetadata>\n  <cellMetadata count="1">\n    <bk>\n      <rc t="1" v="0"/>\n    </bk>\n  </cellMetadata>\n</metadata>'),e.join("")}var od=1024;function ld(e,t){for(var a=[21600,21600],r=["m0,0l0",a[1],a[0],a[1],a[0],"0xe"].join(","),n=[Ls("xml",null,{"xmlns:v":ii,"xmlns:o":ti,"xmlns:x":ai,"xmlns:mv":si}).replace(/\/>/,">"),Ls("o:shapelayout",Ls("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Ls("v:shapetype",[Ls("v:stroke",null,{joinstyle:"miter"}),Ls("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:a.join(","),path:r})];od<1e3*e;)od+=1e3;return t.forEach(function(e){var t=ao(e[0]),a={color2:"#BEFF82",type:"gradient"};"gradient"==a.type&&(a.angle="-180");var r="gradient"==a.type?Ls("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,s=Ls("v:fill",r,a);++od,n=n.concat(["<v:shape"+Is({id:"_x0000_s"+od,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(e[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",s,Ls("v:shadow",null,{on:"t",obscured:"t"}),Ls("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Fs("x:Anchor",[t.c+1,0,t.r+1,0,t.c+3,20,t.r+5,20].join(",")),Fs("x:AutoFill","False"),Fs("x:Row",String(t.r)),Fs("x:Column",String(t.c)),e[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),n.push("</xml>"),n.join("")}function cd(e,t,a,r){var n,s=Array.isArray(e);t.forEach(function(t){var i=ao(t.ref);if(s?(e[i.r]||(e[i.r]=[]),n=e[i.r][i.c]):n=e[t.ref],!n){n={t:"z"},s?e[i.r][i.c]=n:e[t.ref]=n;var o=io(e["!ref"]||"BDWGO1000001:A1");o.s.r>i.r&&(o.s.r=i.r),o.e.r<i.r&&(o.e.r=i.r),o.s.c>i.c&&(o.s.c=i.c),o.e.c<i.c&&(o.e.c=i.c);var l=so(o);l!==e["!ref"]&&(e["!ref"]=l)}n.c||(n.c=[]);var c={a:t.author,t:t.t,r:t.r,T:a};t.h&&(c.h=t.h);for(var u=n.c.length-1;u>=0;--u){if(!a&&n.c[u].T)return;a&&!n.c[u].T&&n.c.splice(u,1)}if(a&&r)for(u=0;u<r.length;++u)if(c.a==r[u].id){c.a=r[u].name||c.a;break}n.c.push(c)})}function ud(e){var t=[rs,Ls("comments",null,{xmlns:ei[0]})],a=[];return t.push("<authors>"),e.forEach(function(e){e[1].forEach(function(e){var r=gs(e.a);-1==a.indexOf(r)&&(a.push(r),t.push("<author>"+r+"</author>")),e.T&&e.ID&&-1==a.indexOf("tc="+e.ID)&&(a.push("tc="+e.ID),t.push("<author>tc="+e.ID+"</author>"))})}),0==a.length&&(a.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(e){var r=0,n=[];if(e[1][0]&&e[1][0].T&&e[1][0].ID?r=a.indexOf("tc="+e[1][0].ID):e[1].forEach(function(e){e.a&&(r=a.indexOf(gs(e.a))),n.push(e.t||"")}),t.push('<comment ref="'+e[0]+'" authorId="'+r+'"><text>'),n.length<=1)t.push(Fs("t",gs(n[0]||"")));else{for(var s="Comment:\n    "+n[0]+"\n",i=1;i<n.length;++i)s+="Reply:\n    "+n[i]+"\n";t.push(Fs("t",gs(s)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function dd(e,t,a){var r=[rs,Ls("ThreadedComments",null,{xmlns:$s}).replace(/[\/]>/,">")];return e.forEach(function(e){var n="";(e[1]||[]).forEach(function(s,i){if(s.T){s.a&&-1==t.indexOf(s.a)&&t.push(s.a);var o={ref:e[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+a.tcid++).slice(-12)+"}"};0==i?n=o.id:o.parentId=n,s.ID=o.id,s.a&&(o.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(s.a)).slice(-12)+"}"),r.push(Ls("threadedComment",Fs("text",s.t||""),o))}else delete s.ID})}),r.push("</ThreadedComments>"),r.join("")}var fd=mo;function hd(e){var t=$i(),a=[];return qi(t,628),qi(t,630),e.forEach(function(e){e[1].forEach(function(e){a.indexOf(e.a)>-1||(a.push(e.a.slice(0,54)),qi(t,632,function(e){return po(e.slice(0,54))}(e.a)))})}),qi(t,631),qi(t,633),e.forEach(function(e){e[1].forEach(function(r){r.iauthor=a.indexOf(r.a);var n={s:ao(e[0]),e:ao(e[0])};qi(t,635,function(e,t){return null==t&&(t=Vi(36)),t.write_shift(4,e[1].iauthor),Fo(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}([n,r])),r.t&&r.t.length>0&&qi(t,637,bo(r)),qi(t,636),delete r.iauthor})}),qi(t,634),qi(t,629),t.end()}var md=["xlsb","xlsm","xlam","biff8","xla"];var pd=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function a(e,a,r,n){var s=!1,i=!1;0==r.length?i=!0:"["==r.charAt(0)&&(i=!0,r=r.slice(1,-1)),0==n.length?s=!0:"["==n.charAt(0)&&(s=!0,n=n.slice(1,-1));var o=r.length>0?0|parseInt(r,10):0,l=n.length>0?0|parseInt(n,10):0;return s?l+=t.c:--l,i?o+=t.r:--o,a+(s?"":"$")+to(l)+(i?"":"$")+Zi(o)}return function(r,n){return t=n,r.replace(e,a)}}(),gd=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,vd=function(){return function(e,t){return e.replace(gd,function(e,a,r,n,s,i){var o=eo(n)-(r?0:t.c),l=Qi(i)-(s?0:t.r);return a+"R"+(0==l?"":s?l+1:"["+l+"]")+"C"+(0==o?"":r?o+1:"["+o+"]")})}}();function yd(e,t){return e.replace(gd,function(e,a,r,n,s,i){return a+("$"==r?r+n:to(eo(n)+t.c))+("$"==s?s+i:Zi(Qi(i)+t.r))})}function bd(e,t,a){var r=no(t).s,n=ao(a);return yd(e,{r:n.r-r.r,c:n.c-r.c})}function wd(e){return e.replace(/_xlfn\./g,"")}function xd(e){e.l+=1}function kd(e,t){var a=e.read_shift(1==t?1:2);return[16383&a,a>>14&1,a>>15&1]}function Sd(e,t,a){var r=2;if(a){if(a.biff>=2&&a.biff<=5)return Ed(e);12==a.biff&&(r=4)}var n=e.read_shift(r),s=e.read_shift(r),i=kd(e,2),o=kd(e,2);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function Ed(e){var t=kd(e,2),a=kd(e,2),r=e.read_shift(1),n=e.read_shift(1);return{s:{r:t[0],c:r,cRel:t[1],rRel:t[2]},e:{r:a[0],c:n,cRel:a[1],rRel:a[2]}}}function Td(e,t,a){if(a&&a.biff>=2&&a.biff<=5)return function(e){var t=kd(e,2),a=e.read_shift(1);return{r:t[0],c:a,cRel:t[1],rRel:t[2]}}(e);var r=e.read_shift(a&&12==a.biff?4:2),n=kd(e,2);return{r:r,c:n[0],cRel:n[1],rRel:n[2]}}function Nd(e){var t=e.read_shift(2),a=e.read_shift(2);return{r:t,c:255&a,fQuoted:!!(16384&a),cRel:a>>15,rRel:a>>15}}function jd(e){var t=1&e[e.l+1];return e.l+=4,[t,1]}function Cd(e){return[e.read_shift(1),e.read_shift(1)]}function _d(e,t){var a=[e.read_shift(1)];if(12==t)switch(a[0]){case 2:a[0]=4;break;case 4:a[0]=16;break;case 0:a[0]=1;break;case 1:a[0]=2}switch(a[0]){case 4:a[1]=Ml(e,1)?"TRUE":"FALSE",12!=t&&(e.l+=7);break;case 37:case 16:a[1]=Yo[e[e.l]],e.l+=12==t?4:8;break;case 0:e.l+=8;break;case 1:a[1]=Io(e);break;case 2:a[1]=Xl(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+a[0])}return a}function Ad(e,t,a){for(var r=e.read_shift(12==a.biff?4:2),n=[],s=0;s!=r;++s)n.push((12==a.biff?Do:oc)(e,8));return n}function Pd(e,t,a){var r=0,n=0;12==a.biff?(r=e.read_shift(4),n=e.read_shift(4)):(n=1+e.read_shift(1),r=1+e.read_shift(2)),a.biff>=2&&a.biff<8&&(--r,0==--n&&(n=256));for(var s=0,i=[];s!=r&&(i[s]=[]);++s)for(var o=0;o!=n;++o)i[s][o]=_d(e,a.biff);return i}function Rd(e,t,a){return e.l+=2,[Nd(e)]}function Od(e){return e.l+=6,[]}function Dd(e){return e.l+=2,[Ul(e),1&e.read_shift(2)]}var Fd=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];var Id={1:{n:"PtgExp",f:function(e,t,a){return e.l++,a&&12==a.biff?[e.read_shift(4,"i"),0]:[e.read_shift(2),e.read_shift(a&&2==a.biff?1:2)]}},2:{n:"PtgTbl",f:Hi},3:{n:"PtgAdd",f:xd},4:{n:"PtgSub",f:xd},5:{n:"PtgMul",f:xd},6:{n:"PtgDiv",f:xd},7:{n:"PtgPower",f:xd},8:{n:"PtgConcat",f:xd},9:{n:"PtgLt",f:xd},10:{n:"PtgLe",f:xd},11:{n:"PtgEq",f:xd},12:{n:"PtgGe",f:xd},13:{n:"PtgGt",f:xd},14:{n:"PtgNe",f:xd},15:{n:"PtgIsect",f:xd},16:{n:"PtgUnion",f:xd},17:{n:"PtgRange",f:xd},18:{n:"PtgUplus",f:xd},19:{n:"PtgUminus",f:xd},20:{n:"PtgPercent",f:xd},21:{n:"PtgParen",f:xd},22:{n:"PtgMissArg",f:xd},23:{n:"PtgStr",f:function(e,t,a){return e.l++,Vl(e,0,a)}},26:{n:"PtgSheet",f:function(e,t,a){return e.l+=5,e.l+=2,e.l+=2==a.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(e,t,a){return e.l+=2==a.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(e){return e.l++,Yo[e.read_shift(1)]}},29:{n:"PtgBool",f:function(e){return e.l++,0!==e.read_shift(1)}},30:{n:"PtgInt",f:function(e){return e.l++,e.read_shift(2)}},31:{n:"PtgNum",f:function(e){return e.l++,Io(e)}},32:{n:"PtgArray",f:function(e,t,a){var r=(96&e[e.l++])>>5;return e.l+=2==a.biff?6:12==a.biff?14:7,[r]}},33:{n:"PtgFunc",f:function(e,t,a){var r=(96&e[e.l])>>5;e.l+=1;var n=e.read_shift(a&&a.biff<=3?1:2);return[nf[n],rf[n],r]}},34:{n:"PtgFuncVar",f:function(e,t,a){var r=e[e.l++],n=e.read_shift(1),s=a&&a.biff<=3?[88==r?-1:0,e.read_shift(1)]:function(e){return[e[e.l+1]>>7,32767&e.read_shift(2)]}(e);return[n,(0===s[0]?rf:af)[s[1]]]}},35:{n:"PtgName",f:function(e,t,a){var r=e.read_shift(1)>>>5&3,n=!a||a.biff>=8?4:2,s=e.read_shift(n);switch(a.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12}return[r,0,s]}},36:{n:"PtgRef",f:function(e,t,a){var r=(96&e[e.l])>>5;return e.l+=1,[r,Td(e,0,a)]}},37:{n:"PtgArea",f:function(e,t,a){return[(96&e[e.l++])>>5,Sd(e,a.biff>=2&&a.biff,a)]}},38:{n:"PtgMemArea",f:function(e,t,a){var r=e.read_shift(1)>>>5&3;return e.l+=a&&2==a.biff?3:4,[r,e.read_shift(a&&2==a.biff?1:2)]}},39:{n:"PtgMemErr",f:Hi},40:{n:"PtgMemNoMem",f:Hi},41:{n:"PtgMemFunc",f:function(e,t,a){return[e.read_shift(1)>>>5&3,e.read_shift(a&&2==a.biff?1:2)]}},42:{n:"PtgRefErr",f:function(e,t,a){var r=e.read_shift(1)>>>5&3;return e.l+=4,a.biff<8&&e.l--,12==a.biff&&(e.l+=2),[r]}},43:{n:"PtgAreaErr",f:function(e,t,a){var r=(96&e[e.l++])>>5;return e.l+=a&&a.biff>8?12:a.biff<8?6:8,[r]}},44:{n:"PtgRefN",f:function(e,t,a){var r=(96&e[e.l])>>5;e.l+=1;var n=function(e,t,a){var r=a&&a.biff?a.biff:8;if(r>=2&&r<=5)return function(e){var t=e.read_shift(2),a=e.read_shift(1),r=(32768&t)>>15,n=(16384&t)>>14;return t&=16383,1==r&&t>=8192&&(t-=16384),1==n&&a>=128&&(a-=256),{r:t,c:a,cRel:n,rRel:r}}(e);var n=e.read_shift(r>=12?4:2),s=e.read_shift(2),i=(16384&s)>>14,o=(32768&s)>>15;if(s&=16383,1==o)for(;n>524287;)n-=1048576;if(1==i)for(;s>8191;)s-=16384;return{r:n,c:s,cRel:i,rRel:o}}(e,0,a);return[r,n]}},45:{n:"PtgAreaN",f:function(e,t,a){var r=(96&e[e.l++])>>5,n=function(e,t,a){if(a.biff<8)return Ed(e);var r=e.read_shift(12==a.biff?4:2),n=e.read_shift(12==a.biff?4:2),s=kd(e,2),i=kd(e,2);return{s:{r:r,c:s[0],cRel:s[1],rRel:s[2]},e:{r:n,c:i[0],cRel:i[1],rRel:i[2]}}}(e,0,a);return[r,n]}},46:{n:"PtgMemAreaN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},57:{n:"PtgNameX",f:function(e,t,a){return 5==a.biff?function(e){var t=e.read_shift(1)>>>5&3,a=e.read_shift(2,"i");e.l+=8;var r=e.read_shift(2);return e.l+=12,[t,a,r]}(e):[e.read_shift(1)>>>5&3,e.read_shift(2),e.read_shift(4)]}},58:{n:"PtgRef3d",f:function(e,t,a){var r=(96&e[e.l])>>5;e.l+=1;var n=e.read_shift(2);return a&&5==a.biff&&(e.l+=12),[r,n,Td(e,0,a)]}},59:{n:"PtgArea3d",f:function(e,t,a){var r=(96&e[e.l++])>>5,n=e.read_shift(2,"i");if(a)switch(a.biff){case 5:e.l+=12;break;case 12:0}return[r,n,Sd(e,0,a)]}},60:{n:"PtgRefErr3d",f:function(e,t,a){var r=(96&e[e.l++])>>5,n=e.read_shift(2),s=4;if(a)switch(a.biff){case 5:s=15;break;case 12:s=6}return e.l+=s,[r,n]}},61:{n:"PtgAreaErr3d",f:function(e,t,a){var r=(96&e[e.l++])>>5,n=e.read_shift(2),s=8;if(a)switch(a.biff){case 5:e.l+=12,s=6;break;case 12:s=12}return e.l+=s,[r,n]}},255:{}},Ld={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Md={1:{n:"PtgElfLel",f:Dd},2:{n:"PtgElfRw",f:Rd},3:{n:"PtgElfCol",f:Rd},6:{n:"PtgElfRwV",f:Rd},7:{n:"PtgElfColV",f:Rd},10:{n:"PtgElfRadical",f:Rd},11:{n:"PtgElfRadicalS",f:Od},13:{n:"PtgElfColS",f:Od},15:{n:"PtgElfColSV",f:Od},16:{n:"PtgElfRadicalLel",f:Dd},25:{n:"PtgList",f:function(e){e.l+=2;var t=e.read_shift(2),a=e.read_shift(2),r=e.read_shift(4),n=e.read_shift(2),s=e.read_shift(2);return{ixti:t,coltype:3&a,rt:Fd[a>>2&31],idx:r,c:n,C:s}}},29:{n:"PtgSxName",f:function(e){return e.l+=2,[e.read_shift(4)]}},255:{}},zd={0:{n:"PtgAttrNoop",f:function(e){return e.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(e,t,a){var r=255&e[e.l+1]?1:0;return e.l+=a&&2==a.biff?3:4,[r]}},2:{n:"PtgAttrIf",f:function(e,t,a){var r=255&e[e.l+1]?1:0;return e.l+=2,[r,e.read_shift(a&&2==a.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function(e,t,a){e.l+=2;for(var r=e.read_shift(a&&2==a.biff?1:2),n=[],s=0;s<=r;++s)n.push(e.read_shift(a&&2==a.biff?1:2));return n}},8:{n:"PtgAttrGoto",f:function(e,t,a){var r=255&e[e.l+1]?1:0;return e.l+=2,[r,e.read_shift(a&&2==a.biff?1:2)]}},16:{n:"PtgAttrSum",f:function(e,t,a){e.l+=a&&2==a.biff?3:4}},32:{n:"PtgAttrBaxcel",f:jd},33:{n:"PtgAttrBaxcel",f:jd},64:{n:"PtgAttrSpace",f:function(e){return e.read_shift(2),Cd(e)}},65:{n:"PtgAttrSpaceSemi",f:function(e){return e.read_shift(2),Cd(e)}},128:{n:"PtgAttrIfError",f:function(e){var t=255&e[e.l+1]?1:0;return e.l+=2,[t,e.read_shift(2)]}},255:{}};function Ud(e,t,a,r){if(r.biff<8)return Hi(e,t);for(var n=e.l+t,s=[],i=0;i!==a.length;++i)switch(a[i][0]){case"PtgArray":a[i][1]=Pd(e,0,r),s.push(a[i][1]);break;case"PtgMemArea":a[i][2]=Ad(e,a[i][1],r),s.push(a[i][2]);break;case"PtgExp":r&&12==r.biff&&(a[i][1][1]=e.read_shift(4),s.push(a[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+a[i][0]}return 0!==(t=n-e.l)&&s.push(Hi(e,t)),s}function Bd(e,t,a){for(var r,n,s=e.l+t,i=[];s!=e.l;)t=s-e.l,n=e[e.l],r=Id[n]||Id[Ld[n]],24!==n&&25!==n||(r=(24===n?Md:zd)[e[e.l+1]]),r&&r.f?i.push([r.n,r.f(e,t,a)]):Hi(e,t);return i}function Wd(e){for(var t=[],a=0;a<e.length;++a){for(var r=e[a],n=[],s=0;s<r.length;++s){var i=r[s];if(i)if(2===i[0])n.push('"'+i[1].replace(/"/g,'""')+'"');else n.push(i[1]);else n.push("")}t.push(n.join(","))}return t.join(";")}var Hd={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Vd(e,t,a){if(!e)return"SH33TJSERR0";if(a.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var r=e.XTI[t];if(a.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),0==t?"":e.XTI[t-1];if(!r)return"SH33TJSERR1";var n="";if(a.biff>8)switch(e[r[0]][0]){case 357:return n=-1==r[1]?"#REF":e.SheetNames[r[1]],r[1]==r[2]?n:n+":"+e.SheetNames[r[2]];case 358:return null!=a.SID?e.SheetNames[a.SID]:"SH33TJSSAME"+e[r[0]][0];default:return"SH33TJSSRC"+e[r[0]][0]}switch(e[r[0]][0][0]){case 1025:return n=-1==r[1]?"#REF":e.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?n:n+":"+e.SheetNames[r[2]];case 14849:return e[r[0]].slice(1).map(function(e){return e.Name}).join(";;");default:return e[r[0]][0][3]?(n=-1==r[1]?"#REF":e[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?n:n+":"+e[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function Gd(e,t,a){var r=Vd(e,t,a);return"#REF"==r?r:function(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}(r,a)}function $d(e,t,a,r,n){var s,i,o,l,c=n&&n.biff||8,u={s:{c:0,r:0},e:{c:0,r:0}},d=[],f=0,h=0,m="";if(!e[0]||!e[0][0])return"";for(var p=-1,g="",v=0,y=e[0].length;v<y;++v){var b=e[0][v];switch(b[0]){case"PtgUminus":d.push("-"+d.pop());break;case"PtgUplus":d.push("+"+d.pop());break;case"PtgPercent":d.push(d.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(s=d.pop(),i=d.pop(),p>=0){switch(e[0][p][1][0]){case 0:g=Un(" ",e[0][p][1][1]);break;case 1:g=Un("\r",e[0][p][1][1]);break;default:if(g="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}i+=g,p=-1}d.push(i+Hd[b[0]]+s);break;case"PtgIsect":s=d.pop(),i=d.pop(),d.push(i+" "+s);break;case"PtgUnion":s=d.pop(),i=d.pop(),d.push(i+","+s);break;case"PtgRange":s=d.pop(),i=d.pop(),d.push(i+":"+s);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":case"PtgAttrBaxcel":case"PtgAttrSemi":case"PtgMemArea":case"PtgTbl":case"PtgMemErr":case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgRef":o=Yi(b[1][1],u,n),d.push(Ki(o,c));break;case"PtgRefN":o=a?Yi(b[1][1],a,n):b[1][1],d.push(Ki(o,c));break;case"PtgRef3d":f=b[1][1],o=Yi(b[1][2],u,n);m=Gd(r,f,n);d.push(m+"!"+Ki(o,c));break;case"PtgFunc":case"PtgFuncVar":var w=b[1][0],x=b[1][1];w||(w=0);var k=0==(w&=127)?[]:d.slice(-w);d.length-=w,"User"===x&&(x=k.shift()),d.push(x+"("+k.join(",")+")");break;case"PtgBool":d.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":case"PtgErr":d.push(b[1]);break;case"PtgNum":d.push(String(b[1]));break;case"PtgStr":d.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgAreaN":l=Xi(b[1][1],a?{s:a}:u,n),d.push(Ji(l,n));break;case"PtgArea":l=Xi(b[1][1],u,n),d.push(Ji(l,n));break;case"PtgArea3d":f=b[1][1],l=b[1][2],m=Gd(r,f,n),d.push(m+"!"+Ji(l,n));break;case"PtgAttrSum":d.push("SUM("+d.pop()+")");break;case"PtgName":h=b[1][2];var S=(r.names||[])[h-1]||(r[0]||[])[h],E=S?S.Name:"SH33TJSNAME"+String(h);E&&"_xlfn."==E.slice(0,6)&&!n.xlfn&&(E=E.slice(6)),d.push(E);break;case"PtgNameX":var T,N=b[1][1];if(h=b[1][2],!(n.biff<=5)){var j="";if(14849==((r[N]||[])[0]||[])[0]||(1025==((r[N]||[])[0]||[])[0]?r[N][h]&&r[N][h].itab>0&&(j=r.SheetNames[r[N][h].itab-1]+"!"):j=r.SheetNames[h-1]+"!"),r[N]&&r[N][h])j+=r[N][h].Name;else if(r[0]&&r[0][h])j+=r[0][h].Name;else{var C=(Vd(r,N,n)||"").split(";;");C[h-1]?j=C[h-1]:j+="SH33TJSERRX"}d.push(j);break}N<0&&(N=-N),r[N]&&(T=r[N][h]),T||(T={Name:"SH33TJSERRY"}),d.push(T.Name);break;case"PtgParen":var _="(",A=")";if(p>=0){switch(g="",e[0][p][1][0]){case 2:_=Un(" ",e[0][p][1][1])+_;break;case 3:_=Un("\r",e[0][p][1][1])+_;break;case 4:A=Un(" ",e[0][p][1][1])+A;break;case 5:A=Un("\r",e[0][p][1][1])+A;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}d.push(_+d.pop()+A);break;case"PtgRefErr":case"PtgRefErr3d":case"PtgAreaErr":case"PtgAreaErr3d":d.push("#REF!");break;case"PtgExp":o={c:b[1][1],r:b[1][0]};var P={c:a.c,r:a.r};if(r.sharedf[ro(o)]){var R=r.sharedf[ro(o)];d.push($d(R,u,P,r,n))}else{var O=!1;for(s=0;s!=r.arrayf.length;++s)if(i=r.arrayf[s],!(o.c<i[0].s.c||o.c>i[0].e.c)&&!(o.r<i[0].s.r||o.r>i[0].e.r)){d.push($d(i[1],u,P,r,n)),O=!0;break}O||d.push(b[1])}break;case"PtgArray":d.push("{"+Wd(b[1])+"}");break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=v;break;case"PtgMissArg":d.push("");break;case"PtgList":d.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(b))}if(3!=n.biff&&p>=0&&-1==["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(e[0][v][0])){var D=!0;switch((b=e[0][p])[1][0]){case 4:D=!1;case 0:g=Un(" ",b[1][1]);break;case 5:D=!1;case 1:g=Un("\r",b[1][1]);break;default:if(g="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}d.push((D?g:"")+d.pop()+(D?"":g)),p=-1}}if(d.length>1&&n.WTF)throw new Error("bad formula stack");return d[0]}function qd(e,t,a){var r,n=e.l+t,s=2==a.biff?1:2,i=e.read_shift(s);if(65535==i)return[[],Hi(e,t-2)];var o=Bd(e,i,a);return t!==i+s&&(r=Ud(e,t-i-s,o,a)),e.l=n,[o,r]}function Yd(e,t,a){var r,n=e.l+t,s=e.read_shift(2),i=Bd(e,s,a);return 65535==s?[[],Hi(e,t-2)]:(t!==s+2&&(r=Ud(e,n-s-2,i,a)),[i,r])}function Xd(e,t,a){var r=e.l+t,n=rc(e);2==a.biff&&++e.l;var s=function(e){var t;if(65535!==Pi(e,e.l+6))return[Io(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=1===e[e.l+2],e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}(e),i=e.read_shift(1);2!=a.biff&&(e.read_shift(1),a.biff>=5&&e.read_shift(4));var o=function(e,t,a){var r,n=e.l+t,s=2==a.biff?1:2,i=e.read_shift(s);if(65535==i)return[[],Hi(e,t-2)];var o=Bd(e,i,a);return t!==i+s&&(r=Ud(e,t-i-s,o,a)),e.l=n,[o,r]}(e,r-e.l,a);return{cell:n,val:s[0],formula:o,shared:i>>3&1,tt:s[1]}}function Kd(e,t,a,r,n){var s=nc(t,a,n),i=function(e){if(null==e){var t=Vi(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}return Lo("number"==typeof e?e:0)}(e.v),o=Vi(6);o.write_shift(2,33),o.write_shift(4,0);for(var l=Vi(e.bf.length),c=0;c<e.bf.length;++c)l[c]=e.bf[c];return xr([s,i,o,l])}function Jd(e,t,a){var r=e.read_shift(4),n=Bd(e,r,a),s=e.read_shift(4);return[n,s>0?Ud(e,s,n,a):null]}var Qd=Jd,Zd=Jd,ef=Jd,tf=Jd,af={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},rf={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},nf={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function sf(e){return"of:"==e.slice(0,3)&&(e=e.slice(3)),61==e.charCodeAt(0)&&61==(e=e.slice(1)).charCodeAt(0)&&(e=e.slice(1)),(e=(e=(e=e.replace(/COM\.MICROSOFT\./g,"")).replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,t){return t.replace(/\./g,"")})).replace(/\[.(#[A-Z]*[?!])\]/g,"$1")).replace(/[;~]/g,",").replace(/\|/g,";")}function of(e){return("of:="+e.replace(gd,"$1[.$2$3$4$5]").replace(/\]:\[/g,":")).replace(/;/g,"|").replace(/,/g,";")}function lf(e){var t=e.split(":");return[t[0].split(".")[0],t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function cf(e){return e.replace(/\./,"!")}var uf={},df={},ff="undefined"!==typeof Map;function hf(e,t,a){var r=0,n=e.length;if(a){if(ff?a.has(t):Object.prototype.hasOwnProperty.call(a,t))for(var s=ff?a.get(t):a[t];r<s.length;++r)if(e[s[r]].t===t)return e.Count++,s[r]}else for(;r<n;++r)if(e[r].t===t)return e.Count++,r;return e[n]={t:t},e.Count++,e.Unique++,a&&(ff?(a.has(t)||a.set(t,[]),a.get(t).push(n)):(Object.prototype.hasOwnProperty.call(a,t)||(a[t]=[]),a[t].push(n))),n}function mf(e,t){var a={min:e+1,max:e+1},r=-1;return t.MDW&&(yu=t.MDW),null!=t.width?a.customWidth=1:null!=t.wpx?r=wu(t.wpx):null!=t.wch&&(r=t.wch),r>-1?(a.width=xu(r),a.customWidth=1):null!=t.width&&(a.width=t.width),t.hidden&&(a.hidden=!0),null!=t.level&&(a.outlineLevel=a.level=t.level),a}function pf(e,t){if(e){var a=[.7,.7,.75,.75,.3,.3];"xlml"==t&&(a=[1,1,1,1,.5,.5]),null==e.left&&(e.left=a[0]),null==e.right&&(e.right=a[1]),null==e.top&&(e.top=a[2]),null==e.bottom&&(e.bottom=a[3]),null==e.header&&(e.header=a[4]),null==e.footer&&(e.footer=a[5])}}function gf(e,t,a){var r=a.revssf[null!=t.z?t.z:"General"],n=60,s=e.length;if(null==r&&a.ssf)for(;n<392;++n)if(null==a.ssf[n]){hn(t.z,n),a.ssf[n]=t.z,a.revssf[t.z]=r=n;break}for(n=0;n!=s;++n)if(e[n].numFmtId===r)return n;return e[s]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function vf(e,t,a,r,n,s){try{r.cellNF&&(e.z=Or[t])}catch(Ig){if(r.WTF)throw Ig}if("z"!==e.t||r.cellStyles){if("d"===e.t&&"string"===typeof e.v&&(e.v=Ln(e.v)),(!r||!1!==r.cellText)&&"z"!==e.t)try{if(null==Or[t]&&hn(gn[t]||"General",t),"e"===e.t)e.w=e.w||Yo[e.v];else if(0===t)if("n"===e.t)(0|e.v)===e.v?e.w=e.v.toString(10):e.w=Hr(e.v);else if("d"===e.t){var i=Cn(e.v);e.w=(0|i)===i?i.toString(10):Hr(i)}else{if(void 0===e.v)return"";e.w=Vr(e.v,df)}else"d"===e.t?e.w=fn(t,Cn(e.v),df):e.w=fn(t,e.v,df)}catch(Ig){if(r.WTF)throw Ig}if(r.cellStyles&&null!=a)try{e.s=s.Fills[a],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=vu(n.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),r.WTF&&(e.s.fgColor.raw_rgb=n.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=vu(n.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),r.WTF&&(e.s.bgColor.raw_rgb=n.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(Ig){if(r.WTF&&s.Fills)throw Ig}}}function yf(e,t,a){if(e&&e["!ref"]){var r=io(e["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+a+"): "+e["!ref"])}}var bf=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,wf=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,xf=/<(?:\w:)?hyperlink [^>]*>/gm,kf=/"(\w*:\w*)"/,Sf=/<(?:\w:)?col\b[^>]*[\/]?>/g,Ef=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Tf=/<(?:\w:)?pageMargins[^>]*\/>/g,Nf=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,jf=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Cf=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function _f(e,t,a,r,n,s,i){if(!e)return e;r||(r={"!id":{}});var o=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",d=e.match(wf);d?(c=e.slice(0,d.index),u=e.slice(d.index+d[0].length)):c=u=e;var f=c.match(Nf);f?Af(f[0],o,n,a):(f=c.match(jf))&&function(e,t,a,r,n){Af(e.slice(0,e.indexOf(">")),a,r,n)}(f[0],f[1],o,n,a);var h=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(h>0){var m=c.slice(h,h+50).match(kf);m&&function(e,t){var a=io(t);a.s.r<=a.e.r&&a.s.c<=a.e.c&&a.s.r>=0&&a.s.c>=0&&(e["!ref"]=so(a))}(o,m[1])}var p=c.match(Cf);p&&p[1]&&function(e,t){t.Views||(t.Views=[{}]);(e.match(Of)||[]).forEach(function(e,a){var r=cs(e);t.Views[a]||(t.Views[a]={}),+r.zoomScale&&(t.Views[a].zoom=+r.zoomScale),xs(r.rightToLeft)&&(t.Views[a].RTL=!0)})}(p[1],n);var g=[];if(t.cellStyles){var v=c.match(Sf);v&&function(e,t){for(var a=!1,r=0;r!=t.length;++r){var n=cs(t[r],!0);n.hidden&&(n.hidden=xs(n.hidden));var s=parseInt(n.min,10)-1,i=parseInt(n.max,10)-1;for(n.outlineLevel&&(n.level=+n.outlineLevel||0),delete n.min,delete n.max,n.width=+n.width,!a&&n.width&&(a=!0,Su(n.width)),Eu(n);s<=i;)e[s++]=zn(n)}}(g,v)}d&&Ff(d[1],o,t,l,s,i);var y=u.match(Ef);y&&(o["!autofilter"]=function(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}(y[0]));var b=[],w=u.match(bf);if(w)for(h=0;h!=w.length;++h)b[h]=io(w[h].slice(w[h].indexOf('"')+1));var x=u.match(xf);x&&function(e,t,a){for(var r=Array.isArray(e),n=0;n!=t.length;++n){var s=cs(Ns(t[n]),!0);if(!s.ref)return;var i=((a||{})["!id"]||[])[s.id];i?(s.Target=i.Target,s.location&&(s.Target+="#"+hs(s.location))):(s.Target="#"+hs(s.location),i={Target:s.Target,TargetMode:"Internal"}),s.Rel=i,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=io(s.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var u=ro({c:c,r:l});r?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=s):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=s)}}}(o,x,r);var k=u.match(Tf);if(k&&(o["!margins"]=function(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(a){e[a]&&(t[a]=parseFloat(e[a]))}),t}(cs(k[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=so(l)),t.sheetRows>0&&o["!ref"]){var S=io(o["!ref"]);t.sheetRows<=+S.e.r&&(S.e.r=t.sheetRows-1,S.e.r>l.e.r&&(S.e.r=l.e.r),S.e.r<S.s.r&&(S.s.r=S.e.r),S.e.c>l.e.c&&(S.e.c=l.e.c),S.e.c<S.s.c&&(S.s.c=S.e.c),o["!fullref"]=o["!ref"],o["!ref"]=so(S))}return g.length>0&&(o["!cols"]=g),b.length>0&&(o["!merges"]=b),o}function Af(e,t,a,r){var n=cs(e);a.Sheets[r]||(a.Sheets[r]={}),n.codeName&&(a.Sheets[r].CodeName=hs(Ns(n.codeName)))}var Pf=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Rf=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];var Of=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function Df(e,t,a,r){if(e.c&&a["!comments"].push([t,e.c]),void 0===e.v&&"string"!==typeof e.f||"z"===e.t&&!e.f)return"";var n="",s=e.t,i=e.v;if("z"!==e.t)switch(e.t){case"b":n=e.v?"1":"0";break;case"n":n=""+e.v;break;case"e":n=Yo[e.v];break;case"d":r&&r.cellDates?n=Ln(e.v,-1).toISOString():((e=zn(e)).t="n",n=""+(e.v=Cn(Ln(e.v)))),"undefined"===typeof e.z&&(e.z=Or[14]);break;default:n=e.v}var o=Fs("v",gs(n)),l={r:t},c=gf(r.cellXfs,e,r);switch(0!==c&&(l.s=c),e.t){case"n":case"z":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;default:if(null==e.v){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){o=Fs("v",""+hf(r.Strings,e.v,r.revStrings)),l.t="s";break}l.t="str"}if(e.t!=s&&(e.t=s,e.v=i),"string"==typeof e.f&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=Ls("f",gs(e.f),u)+(null!=e.v?o:"")}return e.l&&a["!links"].push([t,e.l]),e.D&&(l.cm=1),Ls("c",o,l)}var Ff=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,a=/r=["']([^"']*)["']/,r=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,n=/ref=["']([^"']*)["']/,s=Cs("v"),i=Cs("f");return function(o,l,c,u,d,f){for(var h,m,p,g,v,y=0,b="",w=[],x=[],k=0,S=0,E=0,T="",N=0,j=0,C=0,_=0,A=Array.isArray(f.CellXf),P=[],R=[],O=Array.isArray(l),D=[],F={},I=!1,L=!!c.sheetStubs,M=o.split(t),z=0,U=M.length;z!=U;++z){var B=(b=M[z].trim()).length;if(0!==B){var W=0;e:for(y=0;y<B;++y)switch(b[y]){case">":if("/"!=b[y-1]){++y;break e}if(c&&c.cellStyles){if(N=null!=(m=cs(b.slice(W,y),!0)).r?parseInt(m.r,10):N+1,j=-1,c.sheetRows&&c.sheetRows<N)continue;F={},I=!1,m.ht&&(I=!0,F.hpt=parseFloat(m.ht),F.hpx=ju(F.hpt)),"1"==m.hidden&&(I=!0,F.hidden=!0),null!=m.outlineLevel&&(I=!0,F.level=+m.outlineLevel),I&&(D[N-1]=F)}break;case"<":W=y}if(W>=y)break;if(N=null!=(m=cs(b.slice(W,y),!0)).r?parseInt(m.r,10):N+1,j=-1,!(c.sheetRows&&c.sheetRows<N)){u.s.r>N-1&&(u.s.r=N-1),u.e.r<N-1&&(u.e.r=N-1),c&&c.cellStyles&&(F={},I=!1,m.ht&&(I=!0,F.hpt=parseFloat(m.ht),F.hpx=ju(F.hpt)),"1"==m.hidden&&(I=!0,F.hidden=!0),null!=m.outlineLevel&&(I=!0,F.level=+m.outlineLevel),I&&(D[N-1]=F)),w=b.slice(y).split(e);for(var H=0;H!=w.length&&"<"==w[H].trim().charAt(0);++H);for(w=w.slice(H),y=0;y!=w.length;++y)if(0!==(b=w[y].trim()).length){if(x=b.match(a),k=y,S=0,E=0,b="<c "+("<"==b.slice(0,1)?">":"")+b,null!=x&&2===x.length){for(k=0,T=x[1],S=0;S!=T.length&&!((E=T.charCodeAt(S)-64)<1||E>26);++S)k=26*k+E;j=--k}else++j;for(S=0;S!=b.length&&62!==b.charCodeAt(S);++S);if(++S,(m=cs(b.slice(0,S),!0)).r||(m.r=ro({r:N-1,c:j})),h={t:""},null!=(x=(T=b.slice(S)).match(s))&&""!==x[1]&&(h.v=hs(x[1])),c.cellFormula){if(null!=(x=T.match(i))&&""!==x[1]){if(h.f=hs(Ns(x[1])).replace(/\r\n/g,"\n"),c.xlfn||(h.f=wd(h.f)),x[0].indexOf('t="array"')>-1)h.F=(T.match(n)||[])[1],h.F.indexOf(":")>-1&&P.push([io(h.F),h.F]);else if(x[0].indexOf('t="shared"')>-1){g=cs(x[0]);var V=hs(Ns(x[1]));c.xlfn||(V=wd(V)),R[parseInt(g.si,10)]=[g,V,m.r]}}else(x=T.match(/<f[^>]*\/>/))&&R[(g=cs(x[0])).si]&&(h.f=bd(R[g.si][1],R[g.si][2],m.r));var G=ao(m.r);for(S=0;S<P.length;++S)G.r>=P[S][0].s.r&&G.r<=P[S][0].e.r&&G.c>=P[S][0].s.c&&G.c<=P[S][0].e.c&&(h.F=P[S][1])}if(null==m.t&&void 0===h.v)if(h.f||h.F)h.v=0,h.t="n";else{if(!L)continue;h.t="z"}else h.t=m.t||"n";switch(u.s.c>j&&(u.s.c=j),u.e.c<j&&(u.e.c=j),h.t){case"n":if(""==h.v||null==h.v){if(!L)continue;h.t="z"}else h.v=parseFloat(h.v);break;case"s":if("undefined"==typeof h.v){if(!L)continue;h.t="z"}else p=uf[parseInt(h.v,10)],h.v=p.t,h.r=p.r,c.cellHTML&&(h.h=p.h);break;case"str":h.t="s",h.v=null!=h.v?Ns(h.v):"",c.cellHTML&&(h.h=bs(h.v));break;case"inlineStr":x=T.match(r),h.t="s",null!=x&&(p=Yc(x[1]))?(h.v=p.t,c.cellHTML&&(h.h=p.h)):h.v="";break;case"b":h.v=xs(h.v);break;case"d":c.cellDates?h.v=Ln(h.v,1):(h.v=Cn(Ln(h.v,1)),h.t="n");break;case"e":c&&!1===c.cellText||(h.w=h.v),h.v=Xo[h.v]}if(C=_=0,v=null,A&&void 0!==m.s&&null!=(v=f.CellXf[m.s])&&(null!=v.numFmtId&&(C=v.numFmtId),c.cellStyles&&null!=v.fillId&&(_=v.fillId)),vf(h,C,_,c,d,f),c.cellDates&&A&&"n"==h.t&&ln(Or[C])&&(h.t="d",h.v=Rn(h.v)),m.cm&&c.xlmeta){var $=(c.xlmeta.Cell||[])[+m.cm-1];$&&"XLDAPR"==$.type&&(h.D=!0)}if(O){var q=ao(m.r);l[q.r]||(l[q.r]=[]),l[q.r][q.c]=h}else l[m.r]=h}}}}D.length>0&&(l["!rows"]=D)}}();function If(e,t,a,r){var n,s=[rs,Ls("worksheet",null,{xmlns:ei[0],"xmlns:r":Ks})],i=a.SheetNames[e],o="",l=a.Sheets[i];null==l&&(l={});var c=l["!ref"]||"A1",u=io(c);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),c=so(u)}r||(r={}),l["!comments"]=[];var d=[];!function(e,t,a,r,n){var s=!1,i={},o=null;if("xlsx"!==r.bookType&&t.vbaraw){var l=t.SheetNames[a];try{t.Workbook&&(l=t.Workbook.Sheets[a].CodeName||l)}catch(Ig){}s=!0,i.codeName=js(gs(l))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),o=(o||"")+Ls("outlinePr",null,c)}(s||o)&&(n[n.length]=Ls("sheetPr",o,i))}(l,a,e,t,s),s[s.length]=Ls("dimension",null,{ref:c}),s[s.length]=function(e,t,a,r){var n={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),Ls("sheetViews",Ls("sheetView",null,n),{})}(0,0,0,a),t.sheetFormat&&(s[s.length]=Ls("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),null!=l["!cols"]&&l["!cols"].length>0&&(s[s.length]=function(e,t){for(var a,r=["<cols>"],n=0;n!=t.length;++n)(a=t[n])&&(r[r.length]=Ls("col",null,mf(n,a)));return r[r.length]="</cols>",r.join("")}(0,l["!cols"])),s[n=s.length]="<sheetData/>",l["!links"]=[],null!=l["!ref"]&&(o=function(e,t){var a,r,n=[],s=[],i=io(e["!ref"]),o="",l="",c=[],u=0,d=0,f=e["!rows"],h=Array.isArray(e),m={r:l},p=-1;for(d=i.s.c;d<=i.e.c;++d)c[d]=to(d);for(u=i.s.r;u<=i.e.r;++u){for(s=[],l=Zi(u),d=i.s.c;d<=i.e.c;++d){a=c[d]+l;var g=h?(e[u]||[])[d]:e[a];void 0!==g&&null!=(o=Df(g,a,e,t))&&s.push(o)}(s.length>0||f&&f[u])&&(m={r:l},f&&f[u]&&((r=f[u]).hidden&&(m.hidden=1),p=-1,r.hpx?p=Nu(r.hpx):r.hpt&&(p=r.hpt),p>-1&&(m.ht=p,m.customHeight=1),r.level&&(m.outlineLevel=r.level)),n[n.length]=Ls("row",s.join(""),m))}if(f)for(;u<f.length;++u)f&&f[u]&&(m={r:u+1},(r=f[u]).hidden&&(m.hidden=1),p=-1,r.hpx?p=Nu(r.hpx):r.hpt&&(p=r.hpt),p>-1&&(m.ht=p,m.customHeight=1),r.level&&(m.outlineLevel=r.level),n[n.length]=Ls("row","",m));return n.join("")}(l,t,0,0),o.length>0&&(s[s.length]=o)),s.length>n+1&&(s[s.length]="</sheetData>",s[n]=s[n].replace("/>",">")),l["!protect"]&&(s[s.length]=function(e){var t={sheet:1};return Pf.forEach(function(a){null!=e[a]&&e[a]&&(t[a]="1")}),Rf.forEach(function(a){null==e[a]||e[a]||(t[a]="0")}),e.password&&(t.password=du(e.password).toString(16).toUpperCase()),Ls("sheetProtection",null,t)}(l["!protect"])),null!=l["!autofilter"]&&(s[s.length]=function(e,t,a,r){var n="string"==typeof e.ref?e.ref:so(e.ref);a.Workbook||(a.Workbook={Sheets:[]}),a.Workbook.Names||(a.Workbook.Names=[]);var s=a.Workbook.Names,i=no(n);i.s.r==i.e.r&&(i.e.r=no(t["!ref"]).e.r,n=so(i));for(var o=0;o<s.length;++o){var l=s[o];if("_xlnm._FilterDatabase"==l.Name&&l.Sheet==r){l.Ref="'"+a.SheetNames[r]+"'!"+n;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+a.SheetNames[r]+"'!"+n}),Ls("autoFilter",null,{ref:n})}(l["!autofilter"],l,a,e)),null!=l["!merges"]&&l["!merges"].length>0&&(s[s.length]=function(e){if(0===e.length)return"";for(var t='<mergeCells count="'+e.length+'">',a=0;a!=e.length;++a)t+='<mergeCell ref="'+so(e[a])+'"/>';return t+"</mergeCells>"}(l["!merges"]));var f,h,m=-1,p=-1;return l["!links"].length>0&&(s[s.length]="<hyperlinks>",l["!links"].forEach(function(e){e[1].Target&&(f={ref:e[0]},"#"!=e[1].Target.charAt(0)&&(p=rl(r,-1,gs(e[1].Target).replace(/#.*$/,""),Zo.HLINK),f["r:id"]="rId"+p),(m=e[1].Target.indexOf("#"))>-1&&(f.location=gs(e[1].Target.slice(m+1))),e[1].Tooltip&&(f.tooltip=gs(e[1].Tooltip)),s[s.length]=Ls("hyperlink",null,f))}),s[s.length]="</hyperlinks>"),delete l["!links"],null!=l["!margins"]&&(s[s.length]=(pf(h=l["!margins"]),Ls("pageMargins",null,h))),t&&!t.ignoreEC&&void 0!=t.ignoreEC||(s[s.length]=Fs("ignoredErrors",Ls("ignoredError",null,{numberStoredAsText:1,sqref:c}))),d.length>0&&(p=rl(r,-1,"../drawings/drawing"+(e+1)+".xml",Zo.DRAW),s[s.length]=Ls("drawing",null,{"r:id":"rId"+p}),l["!drawing"]=d),l["!comments"].length>0&&(p=rl(r,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Zo.VML),s[s.length]=Ls("legacyDrawing",null,{"r:id":"rId"+p}),l["!legacy"]=p),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function Lf(e,t,a,r){var n=function(e,t,a){var r=Vi(145),n=(a["!rows"]||[])[e]||{};r.write_shift(4,e),r.write_shift(4,0);var s=320;n.hpx?s=20*Nu(n.hpx):n.hpt&&(s=20*n.hpt),r.write_shift(2,s),r.write_shift(1,0);var i=0;n.level&&(i|=n.level),n.hidden&&(i|=16),(n.hpx||n.hpt)&&(i|=32),r.write_shift(1,i),r.write_shift(1,0);var o=0,l=r.l;r.l+=4;for(var c={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var d=-1,f=-1,h=u<<10;h<u+1<<10;++h)c.c=h,(Array.isArray(a)?(a[c.r]||[])[c.c]:a[ro(c)])&&(d<0&&(d=h),f=h);d<0||(++o,r.write_shift(4,d),r.write_shift(4,f))}var m=r.l;return r.l=l,r.write_shift(4,o),r.l=m,r.length>r.l?r.slice(0,r.l):r}(r,a,t);(n.length>17||(t["!rows"]||[])[r])&&qi(e,0,n)}var Mf=Do,zf=Fo;function Uf(e){return[ko(e),Io(e),"n"]}var Bf=Do,Wf=Fo;var Hf=["left","right","top","bottom","header","footer"];function Vf(e,t,a,r,n,s,i){if(void 0===t.v)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":(t=zn(t)).z=t.z||Or[14],t.v=Cn(Ln(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v}var l={r:a,c:r};switch(l.s=gf(n.cellXfs,t,n),t.l&&s["!links"].push([ro(l),t.l]),t.c&&s["!comments"].push([ro(l),t.c]),t.t){case"s":case"str":return n.bookSST?(o=hf(n.Strings,t.v,n.revStrings),l.t="s",l.v=o,i?qi(e,18,function(e,t,a){return null==a&&(a=Vi(8)),So(t,a),a.write_shift(4,t.v),a}(0,l)):qi(e,7,function(e,t,a){return null==a&&(a=Vi(12)),xo(t,a),a.write_shift(4,t.v),a}(0,l))):(l.t="str",i?qi(e,17,function(e,t,a){return null==a&&(a=Vi(8+4*e.v.length)),So(t,a),po(e.v,a),a.length>a.l?a.slice(0,a.l):a}(t,l)):qi(e,6,function(e,t,a){return null==a&&(a=Vi(12+4*e.v.length)),xo(t,a),po(e.v,a),a.length>a.l?a.slice(0,a.l):a}(t,l))),!0;case"n":return t.v==(0|t.v)&&t.v>-1e3&&t.v<1e3?i?qi(e,13,function(e,t,a){return null==a&&(a=Vi(8)),So(t,a),Ro(e.v,a),a}(t,l)):qi(e,2,function(e,t,a){return null==a&&(a=Vi(12)),xo(t,a),Ro(e.v,a),a}(t,l)):i?qi(e,16,function(e,t,a){return null==a&&(a=Vi(12)),So(t,a),Lo(e.v,a),a}(t,l)):qi(e,5,function(e,t,a){return null==a&&(a=Vi(16)),xo(t,a),Lo(e.v,a),a}(t,l)),!0;case"b":return l.t="b",i?qi(e,15,function(e,t,a){return null==a&&(a=Vi(5)),So(t,a),a.write_shift(1,e.v?1:0),a}(t,l)):qi(e,4,function(e,t,a){return null==a&&(a=Vi(9)),xo(t,a),a.write_shift(1,e.v?1:0),a}(t,l)),!0;case"e":return l.t="e",i?qi(e,14,function(e,t,a){return null==a&&(a=Vi(8)),So(t,a),a.write_shift(1,e.v),a.write_shift(2,0),a.write_shift(1,0),a}(t,l)):qi(e,3,function(e,t,a){return null==a&&(a=Vi(9)),xo(t,a),a.write_shift(1,e.v),a}(t,l)),!0}return i?qi(e,12,function(e,t,a){return null==a&&(a=Vi(4)),So(t,a)}(0,l)):qi(e,1,function(e,t,a){return null==a&&(a=Vi(8)),xo(t,a)}(0,l)),!0}function Gf(e,t){var a,r;t&&t["!merges"]&&(qi(e,177,(a=t["!merges"].length,null==r&&(r=Vi(4)),r.write_shift(4,a),r)),t["!merges"].forEach(function(t){qi(e,176,Wf(t))}),qi(e,178))}function $f(e,t){t&&t["!cols"]&&(qi(e,390),t["!cols"].forEach(function(t,a){t&&qi(e,60,function(e,t,a){null==a&&(a=Vi(18));var r=mf(e,t);a.write_shift(-4,e),a.write_shift(-4,e),a.write_shift(4,256*(r.width||10)),a.write_shift(4,0);var n=0;return t.hidden&&(n|=1),"number"==typeof r.width&&(n|=2),t.level&&(n|=t.level<<8),a.write_shift(2,n),a}(a,t))}),qi(e,391))}function qf(e,t){t&&t["!ref"]&&(qi(e,648),qi(e,649,function(e){var t=Vi(24);return t.write_shift(4,4),t.write_shift(4,1),Fo(e,t),t}(io(t["!ref"]))),qi(e,650))}function Yf(e,t,a){t["!links"].forEach(function(t){if(t[1].Target){var r=rl(a,-1,t[1].Target.replace(/#.*$/,""),Zo.HLINK);qi(e,494,function(e,t){var a=Vi(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Fo({s:ao(e[0]),e:ao(e[0])},a),Ao("rId"+t,a);var r=e[1].Target.indexOf("#");return po((-1==r?"":e[1].Target.slice(r+1))||"",a),po(e[1].Tooltip||"",a),po("",a),a.slice(0,a.l)}(t,r))}}),delete t["!links"]}function Xf(e,t,a){qi(e,133),qi(e,137,function(e,t,a){null==a&&(a=Vi(30));var r=924;return(((t||{}).Views||[])[0]||{}).RTL&&(r|=32),a.write_shift(2,r),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(1,0),a.write_shift(1,0),a.write_shift(2,0),a.write_shift(2,100),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(4,0),a}(0,a)),qi(e,138),qi(e,134)}function Kf(e,t){var a,r;t["!protect"]&&qi(e,535,(a=t["!protect"],null==r&&(r=Vi(66)),r.write_shift(2,a.password?du(a.password):0),r.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(e){e[1]?r.write_shift(4,null==a[e[0]]||a[e[0]]?0:1):r.write_shift(4,null!=a[e[0]]&&a[e[0]]?0:1)}),r))}function Jf(e,t,a,r){var n=$i(),s=a.SheetNames[e],i=a.Sheets[s]||{},o=s;try{a&&a.Workbook&&(o=a.Workbook.Sheets[e].CodeName||o)}catch(Ig){}var l,c,u=io(i["!ref"]||"A1");if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],qi(n,129),(a.vbaraw||i["!outline"])&&qi(n,147,function(e,t,a){null==a&&(a=Vi(84+4*e.length));var r=192;t&&(t.above&&(r&=-65),t.left&&(r&=-129)),a.write_shift(1,r);for(var n=1;n<3;++n)a.write_shift(1,0);return Mo({auto:1},a),a.write_shift(-4,-1),a.write_shift(-4,-1),To(e,a),a.slice(0,a.l)}(o,i["!outline"])),qi(n,148,zf(u)),Xf(n,0,a.Workbook),$f(n,i),function(e,t,a,r){var n,s=io(t["!ref"]||"A1"),i="",o=[];qi(e,145);var l=Array.isArray(t),c=s.e.r;t["!rows"]&&(c=Math.max(s.e.r,t["!rows"].length-1));for(var u=s.s.r;u<=c;++u){i=Zi(u),Lf(e,t,s,u);var d=!1;if(u<=s.e.r)for(var f=s.s.c;f<=s.e.c;++f){u===s.s.r&&(o[f]=to(f)),n=o[f]+i;var h=l?(t[u]||[])[f]:t[n];d=!!h&&Vf(e,h,u,f,r,t,d)}}qi(e,146)}(n,i,0,t),Kf(n,i),function(e,t,a,r){if(t["!autofilter"]){var n=t["!autofilter"],s="string"===typeof n.ref?n.ref:so(n.ref);a.Workbook||(a.Workbook={Sheets:[]}),a.Workbook.Names||(a.Workbook.Names=[]);var i=a.Workbook.Names,o=no(s);o.s.r==o.e.r&&(o.e.r=no(t["!ref"]).e.r,s=so(o));for(var l=0;l<i.length;++l){var c=i[l];if("_xlnm._FilterDatabase"==c.Name&&c.Sheet==r){c.Ref="'"+a.SheetNames[r]+"'!"+s;break}}l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+a.SheetNames[r]+"'!"+s}),qi(e,161,Fo(io(s))),qi(e,162)}}(n,i,a,e),Gf(n,i),Yf(n,i,r),i["!margins"]&&qi(n,476,(l=i["!margins"],null==c&&(c=Vi(48)),pf(l),Hf.forEach(function(e){Lo(l[e],c)}),c)),t&&!t.ignoreEC&&void 0!=t.ignoreEC||qf(n,i),function(e,t,a,r){if(t["!comments"].length>0){var n=rl(r,-1,"../drawings/vmlDrawing"+(a+1)+".vml",Zo.VML);qi(e,551,Ao("rId"+n)),t["!legacy"]=n}}(n,i,e,r),qi(n,130),n.end()}function Qf(e,t,a,r,n,s){var i=s||{"!type":"chart"};if(!e)return s;var o=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(e){var t=function(e){var t,a=[],r=e.match(/^<c:numCache>/);(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/gm)||[]).forEach(function(e){var t=e.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);t&&(a[+t[1]]=r?+t[2]:t[2])});var n=hs((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/gm)||[]).forEach(function(e){t=e.replace(/<.*?>/g,"")}),[a,n,t]}(e);u.s.r=u.s.c=0,u.e.c=o,c=to(o),t[0].forEach(function(e,a){i[c+Zi(a)]={t:"n",v:e,z:t[1]},l=a}),u.e.r<l&&(u.e.r=l),++o}),o>0&&(i["!ref"]=so(u)),i}var Zf=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],eh=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],th=[],ah=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function rh(e,t){for(var a=0;a!=e.length;++a)for(var r=e[a],n=0;n!=t.length;++n){var s=t[n];if(null==r[s[0]])r[s[0]]=s[1];else switch(s[2]){case"bool":"string"==typeof r[s[0]]&&(r[s[0]]=xs(r[s[0]]));break;case"int":"string"==typeof r[s[0]]&&(r[s[0]]=parseInt(r[s[0]],10))}}}function nh(e,t){for(var a=0;a!=t.length;++a){var r=t[a];if(null==e[r[0]])e[r[0]]=r[1];else switch(r[2]){case"bool":"string"==typeof e[r[0]]&&(e[r[0]]=xs(e[r[0]]));break;case"int":"string"==typeof e[r[0]]&&(e[r[0]]=parseInt(e[r[0]],10))}}}function sh(e){nh(e.WBProps,Zf),nh(e.CalcPr,ah),rh(e.WBView,eh),rh(e.Sheets,th),df.date1904=xs(e.WBProps.date1904)}var ih="][*?/\\".split("");function oh(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var a=!0;return ih.forEach(function(r){if(-1!=e.indexOf(r)){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");a=!1}}),a}function lh(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t,a,r,n=e.Workbook&&e.Workbook.Sheets||[];t=e.SheetNames,a=n,r=!!e.vbaraw,t.forEach(function(e,n){oh(e);for(var s=0;s<n;++s)if(e==t[s])throw new Error("Duplicate Sheet Name: "+e);if(r){var i=a&&a[n]&&a[n].CodeName||e;if(95==i.charCodeAt(0)&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}});for(var s=0;s<e.SheetNames.length;++s)yf(e.Sheets[e.SheetNames[s]],e.SheetNames[s],s)}var ch=/<\w+:workbook/;function uh(e){var t=[rs];t[t.length]=Ls("workbook",null,{xmlns:ei[0],"xmlns:r":Ks});var a=e.Workbook&&(e.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Zf.forEach(function(t){null!=e.Workbook.WBProps[t[0]]&&e.Workbook.WBProps[t[0]]!=t[1]&&(r[t[0]]=e.Workbook.WBProps[t[0]])}),e.Workbook.WBProps.CodeName&&(r.codeName=e.Workbook.WBProps.CodeName,delete r.CodeName)),t[t.length]=Ls("workbookPr",null,r);var n=e.Workbook&&e.Workbook.Sheets||[],s=0;if(n&&n[0]&&n[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&n[s]&&n[s].Hidden;++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var i={name:gs(e.SheetNames[s].slice(0,31))};if(i.sheetId=""+(s+1),i["r:id"]="rId"+(s+1),n[s])switch(n[s].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden"}t[t.length]=Ls("sheet",null,i)}return t[t.length]="</sheets>",a&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(e){var a={name:e.Name};e.Comment&&(a.comment=e.Comment),null!=e.Sheet&&(a.localSheetId=""+e.Sheet),e.Hidden&&(a.hidden="1"),e.Ref&&(t[t.length]=Ls("definedName",gs(e.Ref),a))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function dh(e,t){return t||(t=Vi(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Ao(e.strRelID,t),po(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function fh(e,t){var a={};return e.read_shift(4),a.ArchID=e.read_shift(4),e.l+=t-8,a}function hh(e,t){if(t.Workbook&&t.Workbook.Sheets){for(var a,r,n=t.Workbook.Sheets,s=0,i=-1,o=-1;s<n.length;++s)!n[s]||!n[s].Hidden&&-1==i?i=s:1==n[s].Hidden&&-1==o&&(o=s);if(!(o>i))qi(e,135),qi(e,158,(a=i,r||(r=Vi(29)),r.write_shift(-4,0),r.write_shift(-4,460),r.write_shift(4,28800),r.write_shift(4,17600),r.write_shift(4,500),r.write_shift(4,a),r.write_shift(4,a),r.write_shift(1,120),r.length>r.l?r.slice(0,r.l):r)),qi(e,136)}}function mh(e,t){var a=$i();return qi(a,131),qi(a,128,function(e,t){t||(t=Vi(127));for(var a=0;4!=a;++a)t.write_shift(4,0);return po("SheetJS",t),po(Ka.version,t),po(Ka.version,t),po("7262",t),t.length>t.l?t.slice(0,t.l):t}()),qi(a,153,function(e,t){t||(t=Vi(72));var a=0;return e&&e.filterPrivacy&&(a|=8),t.write_shift(4,a),t.write_shift(4,0),To(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}(e.Workbook&&e.Workbook.WBProps||null)),hh(a,e),function(e,t){qi(e,143);for(var a=0;a!=t.SheetNames.length;++a)qi(e,156,dh({Hidden:t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[a]&&t.Workbook.Sheets[a].Hidden||0,iTabID:a+1,strRelID:"rId"+(a+1),name:t.SheetNames[a]}));qi(e,144)}(a,e),qi(a,132),a.end()}function ph(e,t,a){return".bin"===t.slice(-4)?function(e,t){var a={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},r=[],n=!1;t||(t={}),t.biff=12;var s=[],i=[[]];return i.SheetNames=[],i.XTI=[],tm[16]={n:"BrtFRTArchID$",f:fh},Gi(e,function(e,o,l){switch(l){case 156:i.SheetNames.push(e.name),a.Sheets.push(e);break;case 153:a.WBProps=e;break;case 39:null!=e.Sheet&&(t.SID=e.Sheet),e.Ref=$d(e.Ptg,0,null,i,t),delete t.SID,delete e.Ptg,s.push(e);break;case 1036:case 361:case 2071:case 158:case 143:case 664:case 353:case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:case 16:break;case 357:case 358:case 355:case 667:i[0].length?i.push([l,e]):i[0]=[l,e],i[i.length-1].XTI=[];break;case 362:0===i.length&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(e),i.XTI=i.XTI.concat(e);break;case 35:case 37:r.push(l),n=!0;break;case 36:case 38:r.pop(),n=!1;break;default:if(o.T);else if(!n||t.WTF&&37!=r[r.length-1]&&35!=r[r.length-1])throw new Error("Unexpected record 0x"+l.toString(16))}},t),sh(a),a.Names=s,a.supbooks=i,a}(e,a):function(e,t){if(!e)throw new Error("Could not find file");var a={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},r=!1,n="xmlns",s={},i=0;if(e.replace(is,function(o,l){var c=cs(o);switch(us(c[0])){case"<?xml":case"</workbook>":case"<fileVersion/>":case"</fileVersion>":case"<fileSharing":case"<fileSharing/>":case"</workbookPr>":case"<workbookProtection":case"<workbookProtection/>":case"<bookViews":case"<bookViews>":case"</bookViews>":case"</workbookView>":case"<sheets":case"<sheets>":case"</sheets>":case"</sheet>":case"<functionGroups":case"<functionGroups/>":case"<functionGroup":case"<externalReferences":case"</externalReferences>":case"<externalReferences>":case"<externalReference":case"<definedNames/>":case"<definedName/>":case"</calcPr>":case"<oleSize":case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":case"<customWorkbookView":case"</customWorkbookView>":case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":case"<pivotCache":case"<smartTagPr":case"<smartTagPr/>":case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":case"<smartTagType":case"<webPublishing":case"<webPublishing/>":case"<fileRecoveryPr":case"<fileRecoveryPr/>":case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":case"<webPublishObject":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":case"<ArchID":case"<revisionPtr":break;case"<workbook":o.match(ch)&&(n="xmlns"+o.match(/<(\w+):/)[1]),a.xmlns=c[n];break;case"<fileVersion":delete c[0],a.AppVersion=c;break;case"<workbookPr":case"<workbookPr/>":Zf.forEach(function(e){if(null!=c[e[0]])switch(e[2]){case"bool":a.WBProps[e[0]]=xs(c[e[0]]);break;case"int":a.WBProps[e[0]]=parseInt(c[e[0]],10);break;default:a.WBProps[e[0]]=c[e[0]]}}),c.codeName&&(a.WBProps.CodeName=Ns(c.codeName));break;case"<workbookView":case"<workbookView/>":delete c[0],a.WBView.push(c);break;case"<sheet":switch(c.state){case"hidden":c.Hidden=1;break;case"veryHidden":c.Hidden=2;break;default:c.Hidden=0}delete c.state,c.name=hs(Ns(c.name)),delete c[0],a.Sheets.push(c);break;case"<definedNames>":case"<definedNames":case"<ext":case"<AlternateContent":case"<AlternateContent>":r=!0;break;case"</definedNames>":case"</ext>":case"</AlternateContent>":r=!1;break;case"<definedName":(s={}).Name=Ns(c.name),c.comment&&(s.Comment=c.comment),c.localSheetId&&(s.Sheet=+c.localSheetId),xs(c.hidden||"0")&&(s.Hidden=!0),i=l+o.length;break;case"</definedName>":s.Ref=hs(Ns(e.slice(i,l))),a.Names.push(s);break;case"<calcPr":case"<calcPr/>":delete c[0],a.CalcPr=c;break;default:if(!r&&t.WTF)throw new Error("unrecognized "+c[0]+" in workbook")}return o}),-1===ei.indexOf(a.xmlns))throw new Error("Unknown Namespace: "+a.xmlns);return sh(a),a}(e,a)}function gh(e,t,a,r,n,s,i,o){return".bin"===t.slice(-4)?function(e,t,a,r,n,s,i){if(!e)return e;var o=t||{};r||(r={"!id":{}});var l,c,u,d,f,h,m,p,g,v,y=o.dense?[]:{},b={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=[],x=!1,k=!1,S=[];o.biff=12,o["!row"]=0;var E=0,T=!1,N=[],j={},C=o.supbooks||n.supbooks||[[]];if(C.sharedf=j,C.arrayf=N,C.SheetNames=n.SheetNames||n.Sheets.map(function(e){return e.name}),!o.supbooks&&(o.supbooks=C,n.Names))for(var _=0;_<n.Names.length;++_)C[0][_+1]=n.Names[_];var A,P,R=[],O=[],D=!1;if(tm[16]={n:"BrtShortReal",f:Uf},Gi(e,function(e,t,_){if(!k)switch(_){case 148:l=e;break;case 0:c=e,o.sheetRows&&o.sheetRows<=c.r&&(k=!0),g=Zi(f=c.r),o["!row"]=c.r,(e.hidden||e.hpt||null!=e.level)&&(e.hpt&&(e.hpx=ju(e.hpt)),O[e.r]=e);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(u={t:e[2]},e[2]){case"n":u.v=e[1];break;case"s":p=uf[e[1]],u.v=p.t,u.r=p.r;break;case"b":u.v=!!e[1];break;case"e":u.v=e[1],!1!==o.cellText&&(u.w=Yo[u.v]);break;case"str":u.t="s",u.v=e[1];break;case"is":u.t="s",u.v=e[1].t}if((d=i.CellXf[e[0].iStyleRef])&&vf(u,d.numFmtId,null,o,s,i),h=-1==e[0].c?h+1:e[0].c,o.dense?(y[f]||(y[f]=[]),y[f][h]=u):y[to(h)+g]=u,o.cellFormula){for(T=!1,E=0;E<N.length;++E){var F=N[E];c.r>=F[0].s.r&&c.r<=F[0].e.r&&h>=F[0].s.c&&h<=F[0].e.c&&(u.F=so(F[0]),T=!0)}!T&&e.length>3&&(u.f=e[3])}if(b.s.r>c.r&&(b.s.r=c.r),b.s.c>h&&(b.s.c=h),b.e.r<c.r&&(b.e.r=c.r),b.e.c<h&&(b.e.c=h),o.cellDates&&d&&"n"==u.t&&ln(Or[d.numFmtId])){var I=Lr(u.v);I&&(u.t="d",u.v=new Date(I.y,I.m-1,I.d,I.H,I.M,I.S,I.u))}A&&("XLDAPR"==A.type&&(u.D=!0),A=void 0),P&&(P=void 0);break;case 1:case 12:if(!o.sheetStubs||x)break;u={t:"z",v:void 0},h=-1==e[0].c?h+1:e[0].c,o.dense?(y[f]||(y[f]=[]),y[f][h]=u):y[to(h)+g]=u,b.s.r>c.r&&(b.s.r=c.r),b.s.c>h&&(b.s.c=h),b.e.r<c.r&&(b.e.r=c.r),b.e.c<h&&(b.e.c=h),A&&("XLDAPR"==A.type&&(u.D=!0),A=void 0),P&&(P=void 0);break;case 176:S.push(e);break;case 49:A=((o.xlmeta||{}).Cell||[])[e-1];break;case 494:var L=r["!id"][e.relId];for(L?(e.Target=L.Target,e.loc&&(e.Target+="#"+e.loc),e.Rel=L):""==e.relId&&(e.Target="#"+e.loc),f=e.rfx.s.r;f<=e.rfx.e.r;++f)for(h=e.rfx.s.c;h<=e.rfx.e.c;++h)o.dense?(y[f]||(y[f]=[]),y[f][h]||(y[f][h]={t:"z",v:void 0}),y[f][h].l=e):(m=ro({c:h,r:f}),y[m]||(y[m]={t:"z",v:void 0}),y[m].l=e);break;case 426:if(!o.cellFormula)break;N.push(e),(v=o.dense?y[f][h]:y[to(h)+g]).f=$d(e[1],0,{r:c.r,c:h},C,o),v.F=so(e[0]);break;case 427:if(!o.cellFormula)break;j[ro(e[0].s)]=e[1],(v=o.dense?y[f][h]:y[to(h)+g]).f=$d(e[1],0,{r:c.r,c:h},C,o);break;case 60:if(!o.cellStyles)break;for(;e.e>=e.s;)R[e.e--]={width:e.w/256,hidden:!!(1&e.flags),level:e.level},D||(D=!0,Su(e.w/256)),Eu(R[e.e+1]);break;case 161:y["!autofilter"]={ref:so(e)};break;case 476:y["!margins"]=e;break;case 147:n.Sheets[a]||(n.Sheets[a]={}),e.name&&(n.Sheets[a].CodeName=e.name),(e.above||e.left)&&(y["!outline"]={above:e.above,left:e.left});break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),e.RTL&&(n.Views[0].RTL=!0);break;case 485:case 64:case 1053:case 151:case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:x=!0;break;case 36:x=!1;break;case 37:w.push(_),x=!0;break;case 38:w.pop(),x=!1;break;default:if(t.T);else if(!x||o.WTF)throw new Error("Unexpected record 0x"+_.toString(16))}},o),delete o.supbooks,delete o["!row"],!y["!ref"]&&(b.s.r<2e6||l&&(l.e.r>0||l.e.c>0||l.s.r>0||l.s.c>0))&&(y["!ref"]=so(l||b)),o.sheetRows&&y["!ref"]){var F=io(y["!ref"]);o.sheetRows<=+F.e.r&&(F.e.r=o.sheetRows-1,F.e.r>b.e.r&&(F.e.r=b.e.r),F.e.r<F.s.r&&(F.s.r=F.e.r),F.e.c>b.e.c&&(F.e.c=b.e.c),F.e.c<F.s.c&&(F.s.c=F.e.c),y["!fullref"]=y["!ref"],y["!ref"]=so(F))}return S.length>0&&(y["!merges"]=S),R.length>0&&(y["!cols"]=R),O.length>0&&(y["!rows"]=O),y}(e,r,a,n,s,i,o):_f(e,r,a,n,s,i,o)}function vh(e,t,a,r,n,s,i,o){return".bin"===t.slice(-4)?function(e,t,a,r,n){if(!e)return e;r||(r={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i=[],o=!1;return Gi(e,function(e,r,l){switch(l){case 550:s["!rel"]=e;break;case 651:n.Sheets[a]||(n.Sheets[a]={}),e.name&&(n.Sheets[a].CodeName=e.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:i.push(l);break;case 38:i.pop();break;default:if(r.T>0)i.push(l);else if(r.T<0)i.pop();else if(!o||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}},t),r["!id"][s["!rel"]]&&(s["!drawel"]=r["!id"][s["!rel"]]),s}(e,r,a,n,s):function(e,t,a,r,n){if(!e)return e;r||(r={"!id":{}});var s,i={"!type":"chart","!drawel":null,"!rel":""},o=e.match(Nf);return o&&Af(o[0],0,n,a),(s=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=s[1]),r["!id"][i["!rel"]]&&(i["!drawel"]=r["!id"][i["!rel"]]),i}(e,0,a,n,s)}function yh(e,t,a,r){return".bin"===t.slice(-4)?function(e,t,a){var r={NumberFmt:[]};for(var n in Or)r.NumberFmt[n]=Or[n];r.CellXf=[],r.Fonts=[];var s=[],i=!1;return Gi(e,function(e,n,o){switch(o){case 44:r.NumberFmt[e[0]]=e[1],hn(e[1],e[0]);break;case 43:r.Fonts.push(e),null!=e.color.theme&&t&&t.themeElements&&t.themeElements.clrScheme&&(e.color.rgb=vu(t.themeElements.clrScheme[e.color.theme].rgb,e.color.tint||0));break;case 1025:case 45:case 46:case 48:case 507:case 572:case 475:case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 47:617==s[s.length-1]&&r.CellXf.push(e);break;case 35:i=!0;break;case 36:i=!1;break;case 37:s.push(o),i=!0;break;case 38:s.pop(),i=!1;break;default:if(n.T>0)s.push(o);else if(n.T<0)s.pop();else if(!i||a.WTF&&37!=s[s.length-1])throw new Error("Unexpected record 0x"+o.toString(16))}}),r}(e,a,r):Pu(e,a,r)}function bh(e,t,a){return".bin"===t.slice(-4)?function(e,t){var a=[],r=!1;return Gi(e,function(e,n,s){switch(s){case 159:a.Count=e[0],a.Unique=e[1];break;case 19:a.push(e);break;case 160:return!0;case 35:r=!0;break;case 36:r=!1;break;default:if(n.T,!r||t.WTF)throw new Error("Unexpected record 0x"+s.toString(16))}}),a}(e,a):function(e,t){var a=[],r="";if(!e)return a;var n=e.match(Xc);if(n){r=n[2].replace(Kc,"").split(Jc);for(var s=0;s!=r.length;++s){var i=Yc(r[s].trim(),t);null!=i&&(a[a.length]=i)}n=cs(n[1]),a.Count=n.count,a.Unique=n.uniqueCount}return a}(e,a)}function wh(e,t,a){return".bin"===t.slice(-4)?function(e,t){var a=[],r=[],n={},s=!1;return Gi(e,function(e,i,o){switch(o){case 632:r.push(e);break;case 635:n=e;break;case 637:n.t=e.t,n.h=e.h,n.r=e.r;break;case 636:if(n.author=r[n.iauthor],delete n.iauthor,t.sheetRows&&n.rfx&&t.sheetRows<=n.rfx.r)break;n.t||(n.t=""),delete n.rfx,a.push(n);break;case 3072:case 37:case 38:break;case 35:s=!0;break;case 36:s=!1;break;default:if(i.T);else if(!s||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),a}(e,a):function(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var a=[],r=[],n=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);n&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach(function(e){if(""!==e&&""!==e.trim()){var t=e.match(/<(?:\w+:)?author[^>]*>(.*)/);t&&a.push(t[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(e){if(""!==e&&""!==e.trim()){var n=e.match(/<(?:\w+:)?comment[^>]*>/);if(n){var s=cs(n[0]),i={author:s.authorId&&a[s.authorId]||"sheetjsghost",ref:s.ref,guid:s.guid},o=ao(s.ref);if(!(t.sheetRows&&t.sheetRows<=o.r)){var l=e.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),c=!!l&&!!l[1]&&Yc(l[1])||{r:"",t:"",h:""};i.r=c.r,"<t></t>"==c.r&&(c.t=c.h=""),i.t=(c.t||"").replace(/\r\n/g,"\n").replace(/\r/g,"\n"),t.cellHTML&&(i.h=c.h),r.push(i)}}}}),r}(e,a)}function xh(e,t,a){return".bin"===t.slice(-4)?function(e){var t=[];return Gi(e,function(e,a,r){if(63===r)t.push(e);else if(!a.T)throw new Error("Unexpected record 0x"+r.toString(16))}),t}(e):function(e){var t=[];if(!e)return t;var a=1;return(e.match(is)||[]).forEach(function(e){var r=cs(e);switch(r[0]){case"<?xml":case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete r[0],r.i?a=r.i:r.i=a,t.push(r)}}),t}(e)}function kh(e,t,a,r){if(".bin"===a.slice(-4))return function(e,t,a,r){if(!e)return e;var n=r||{},s=!1;Gi(e,function(e,t,a){switch(a){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(t.T);else if(!s||n.WTF)throw new Error("Unexpected record 0x"+a.toString(16))}},n)}(e,0,0,r)}function Sh(e,t,a){return".bin"===t.slice(-4)?function(e,t,a){var r={Types:[],Cell:[],Value:[]},n=a||{},s=[],i=!1,o=2;return Gi(e,function(e,t,a){switch(a){case 335:r.Types.push({name:e.name});break;case 51:e.forEach(function(e){1==o?r.Cell.push({type:r.Types[e[0]-1].name,index:e[1]}):0==o&&r.Value.push({type:r.Types[e[0]-1].name,index:e[1]})});break;case 337:o=e?1:0;break;case 338:o=2;break;case 35:s.push(a),i=!0;break;case 36:s.pop(),i=!1;break;default:if(t.T);else if(!i||n.WTF&&35!=s[s.length-1])throw new Error("Unexpected record 0x"+a.toString(16))}}),r}(e,0,a):function(e,t,a){var r={Types:[],Cell:[],Value:[]};if(!e)return r;var n,s=!1,i=2;return e.replace(is,function(e){var t=cs(e);switch(us(t[0])){case"<?xml":case"<metadata":case"</metadata>":case"<metadataTypes":case"</metadataTypes>":case"</metadataType>":case"</futureMetadata>":case"<bk>":case"</bk>":case"</rc>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<metadataType":r.Types.push({name:t.name});break;case"<futureMetadata":for(var o=0;o<r.Types.length;++o)r.Types[o].name==t.name&&(n=r.Types[o]);break;case"<rc":1==i?r.Cell.push({type:r.Types[t.t-1].name,index:+t.v}):0==i&&r.Value.push({type:r.Types[t.t-1].name,index:+t.v});break;case"<cellMetadata":i=1;break;case"</cellMetadata>":case"</valueMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!n)break;n.offsets||(n.offsets=[]),n.offsets.push(+t.i);break;default:if(!s&&a.WTF)throw new Error("unrecognized "+t[0]+" in metadata")}return e}),r}(e,0,a)}function Eh(e,t,a,r,n){return(".bin"===t.slice(-4)?Jf:If)(e,a,r,n)}function Th(e,t,a){return(".bin"===t.slice(-4)?hd:ud)(e,a)}var Nh,jh=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Ch=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function _h(e,t){var a=e.split(/\s+/),r=[];if(t||(r[0]=a[0]),1===a.length)return r;var n,s,i,o=e.match(jh);if(o)for(i=0;i!=o.length;++i)-1===(s=(n=o[i].match(Ch))[1].indexOf(":"))?r[n[1]]=n[2].slice(1,n[2].length-1):r["xmlns:"===n[1].slice(0,6)?"xmlns"+n[1].slice(6):n[1].slice(s+1)]=n[2].slice(1,n[2].length-1);return r}function Ah(e){var t={};if(1===e.split(/\s+/).length)return t;var a,r,n,s=e.match(jh);if(s)for(n=0;n!=s.length;++n)-1===(r=(a=s[n].match(Ch))[1].indexOf(":"))?t[a[1]]=a[2].slice(1,a[2].length-1):t["xmlns:"===a[1].slice(0,6)?"xmlns"+a[1].slice(6):a[1].slice(r+1)]=a[2].slice(1,a[2].length-1);return t}function Ph(e,t,a,r){var n=r;switch((a[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=xs(r);break;case"i2":case"int":n=parseInt(r,10);break;case"r4":case"float":n=parseFloat(r);break;case"date":case"dateTime.tz":n=Ln(r);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+a[0])}e[hs(t)]=n}function Rh(e,t,a){if("z"!==e.t){if(!a||!1!==a.cellText)try{"e"===e.t?e.w=e.w||Yo[e.v]:"General"===t?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=Hr(e.v):e.w=Vr(e.v):e.w=function(e,t){var a=Nh[e]||hs(e);return"General"===a?Vr(t):fn(a,t)}(t||"General",e.v)}catch(Ig){if(a.WTF)throw Ig}try{var r=Nh[t]||t||"General";if(a.cellNF&&(e.z=r),a.cellDates&&"n"==e.t&&ln(r)){var n=Lr(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}catch(Ig){if(a.WTF)throw Ig}}}function Oh(e,t,a){if(a.cellStyles&&t.Interior){var r=t.Interior;r.Pattern&&(r.patternType=Cu[r.Pattern]||r.Pattern)}e[t.ID]=t}function Dh(e,t,a,r,n,s,i,o,l,c){var u="General",d=r.StyleID,f={};c=c||{};var h=[],m=0;for(void 0===d&&o&&(d=o.StyleID),void 0===d&&i&&(d=i.StyleID);void 0!==s[d]&&(s[d].nf&&(u=s[d].nf),s[d].Interior&&h.push(s[d].Interior),s[d].Parent);)d=s[d].Parent;switch(a.Type){case"Boolean":r.t="b",r.v=xs(e);break;case"String":r.t="s",r.r=ws(hs(e)),r.v=e.indexOf("<")>-1?hs(t||e).replace(/<.*?>/g,""):r.r;break;case"DateTime":"Z"!=e.slice(-1)&&(e+="Z"),r.v=(Ln(e)-new Date(Date.UTC(1899,11,30)))/864e5,r.v!==r.v?r.v=hs(e):r.v<60&&(r.v=r.v-1),u&&"General"!=u||(u="yyyy-mm-dd");case"Number":void 0===r.v&&(r.v=+e),r.t||(r.t="n");break;case"Error":r.t="e",r.v=Xo[e],!1!==c.cellText&&(r.w=e);break;default:""==e&&""==t?r.t="z":(r.t="s",r.v=ws(t||e))}if(Rh(r,u,c),!1!==c.cellFormula)if(r.Formula){var p=hs(r.Formula);61==p.charCodeAt(0)&&(p=p.slice(1)),r.f=pd(p,n),delete r.Formula,"RC"==r.ArrayRange?r.F=pd("RC:RC",n):r.ArrayRange&&(r.F=pd(r.ArrayRange,n),l.push([io(r.F),r.F]))}else for(m=0;m<l.length;++m)n.r>=l[m][0].s.r&&n.r<=l[m][0].e.r&&n.c>=l[m][0].s.c&&n.c<=l[m][0].e.c&&(r.F=l[m][1]);c.cellStyles&&(h.forEach(function(e){!f.patternType&&e.patternType&&(f.patternType=e.patternType)}),r.s=f),void 0!==r.StyleID&&(r.ixfe=r.StyleID)}function Fh(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),e.v=e.w=e.ixfe=void 0}function Ih(e,t){var a=t||{};pn();var r=or(zs(e));"binary"!=a.type&&"array"!=a.type&&"base64"!=a.type||(r="undefined"!==typeof ir?ir.utils.decode(65001,nr(r)):Ns(r));var n,s=r.slice(0,1024).toLowerCase(),i=!1;if((1023&(s=s.replace(/".*?"/g,"")).indexOf(">"))>Math.min(1023&s.indexOf(","),1023&s.indexOf(";"))){var o=zn(a);return o.type="string",Bc.to_workbook(r,o)}if(-1==s.indexOf("<?xml")&&["html","table","head","meta","script","style","div"].forEach(function(e){s.indexOf("<"+e)>=0&&(i=!0)}),i)return function(e,t){var a=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!a||0==a.length)throw new Error("Invalid HTML: could not find <table>");if(1==a.length)return co(hm(a[0],t),t);var r={SheetNames:[],Sheets:{}};return a.forEach(function(e,a){Pp(r,hm(e,t),"Sheet"+(a+1))}),r}(r,a);Nh={"General Number":"General","General Date":Or[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Or[15],"Short Date":Or[14],"Long Time":Or[19],"Medium Time":Or[18],"Short Time":Or[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Or[2],Standard:Or[4],Percent:Or[10],Scientific:Or[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[];var u,d={},f=[],h=a.dense?[]:{},m="",p={},g={},v=_h('<Data ss:Type="String">'),y=0,b=0,w=0,x={s:{r:2e6,c:2e6},e:{r:0,c:0}},k={},S={},E="",T=0,N=[],j={},C={},_=0,A=[],P=[],R={},O=[],D=!1,F=[],I=[],L={},M=0,z=0,U={Sheets:[],WBProps:{date1904:!1}},B={};Us.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/gm,"");for(var W="";n=Us.exec(r);)switch(n[3]=(W=n[3]).toLowerCase()){case"data":if("data"==W){if("/"===n[1]){if((l=c.pop())[0]!==n[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==n[0].charAt(n[0].length-2)&&c.push([n[3],!0]);break}if(c[c.length-1][1])break;"/"===n[1]?Dh(r.slice(y,n.index),E,v,"comment"==c[c.length-1][0]?R:p,{c:b,r:w},k,O[b],g,F,a):(E="",v=_h(n[0]),y=n.index+n[0].length);break;case"cell":if("/"===n[1])if(P.length>0&&(p.c=P),(!a.sheetRows||a.sheetRows>w)&&void 0!==p.v&&(a.dense?(h[w]||(h[w]=[]),h[w][b]=p):h[to(b)+Zi(w)]=p),p.HRef&&(p.l={Target:hs(p.HRef)},p.HRefScreenTip&&(p.l.Tooltip=p.HRefScreenTip),delete p.HRef,delete p.HRefScreenTip),(p.MergeAcross||p.MergeDown)&&(M=b+(0|parseInt(p.MergeAcross,10)),z=w+(0|parseInt(p.MergeDown,10)),N.push({s:{c:b,r:w},e:{c:M,r:z}})),a.sheetStubs)if(p.MergeAcross||p.MergeDown){for(var H=b;H<=M;++H)for(var V=w;V<=z;++V)(H>b||V>w)&&(a.dense?(h[V]||(h[V]=[]),h[V][H]={t:"z"}):h[to(H)+Zi(V)]={t:"z"});b=M+1}else++b;else p.MergeAcross?b=M+1:++b;else(p=Ah(n[0])).Index&&(b=+p.Index-1),b<x.s.c&&(x.s.c=b),b>x.e.c&&(x.e.c=b),"/>"===n[0].slice(-2)&&++b,P=[];break;case"row":"/"===n[1]||"/>"===n[0].slice(-2)?(w<x.s.r&&(x.s.r=w),w>x.e.r&&(x.e.r=w),"/>"===n[0].slice(-2)&&(g=_h(n[0])).Index&&(w=+g.Index-1),b=0,++w):((g=_h(n[0])).Index&&(w=+g.Index-1),L={},("0"==g.AutoFitHeight||g.Height)&&(L.hpx=parseInt(g.Height,10),L.hpt=Nu(L.hpx),I[w]=L),"1"==g.Hidden&&(L.hidden=!0,I[w]=L));break;case"worksheet":if("/"===n[1]){if((l=c.pop())[0]!==n[3])throw new Error("Bad state: "+l.join("|"));f.push(m),x.s.r<=x.e.r&&x.s.c<=x.e.c&&(h["!ref"]=so(x),a.sheetRows&&a.sheetRows<=x.e.r&&(h["!fullref"]=h["!ref"],x.e.r=a.sheetRows-1,h["!ref"]=so(x))),N.length&&(h["!merges"]=N),O.length>0&&(h["!cols"]=O),I.length>0&&(h["!rows"]=I),d[m]=h}else x={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=b=0,c.push([n[3],!1]),l=_h(n[0]),m=hs(l.Name),h=a.dense?[]:{},N=[],F=[],I=[],B={name:m,Hidden:0},U.Sheets.push(B);break;case"table":if("/"===n[1]){if((l=c.pop())[0]!==n[3])throw new Error("Bad state: "+l.join("|"))}else{if("/>"==n[0].slice(-2))break;c.push([n[3],!1]),O=[],D=!1}break;case"style":"/"===n[1]?Oh(k,S,a):S=_h(n[0]);break;case"numberformat":S.nf=hs(_h(n[0]).Format||"General"),Nh[S.nf]&&(S.nf=Nh[S.nf]);for(var G=0;392!=G&&Or[G]!=S.nf;++G);if(392==G)for(G=57;392!=G;++G)if(null==Or[G]){hn(S.nf,G);break}break;case"column":if("table"!==c[c.length-1][0])break;if((u=_h(n[0])).Hidden&&(u.hidden=!0,delete u.Hidden),u.Width&&(u.wpx=parseInt(u.Width,10)),!D&&u.wpx>10){D=!0,yu=6;for(var $=0;$<O.length;++$)O[$]&&Eu(O[$])}D&&Eu(u),O[u.Index-1||O.length]=u;for(var q=0;q<+u.Span;++q)O[O.length]=zn(u);break;case"namedrange":if("/"===n[1])break;U.Names||(U.Names=[]);var Y=cs(n[0]),X={Name:Y.Name,Ref:pd(Y.RefersTo.slice(1),{r:0,c:0})};U.Sheets.length>0&&(X.Sheet=U.Sheets.length-1),U.Names.push(X);break;case"namedcell":case"b":case"i":case"u":case"s":case"em":case"h2":case"h3":case"sub":case"sup":case"span":case"alignment":case"borders":case"border":case"protection":case"paragraphs":case"name":case"pixelsperinch":case"null":break;case"font":if("/>"===n[0].slice(-2))break;"/"===n[1]?E+=r.slice(T,n.index):T=n.index+n[0].length;break;case"interior":if(!a.cellStyles)break;S.Interior=_h(n[0]);break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if("/>"===n[0].slice(-2))break;"/"===n[1]?wl(j,W,r.slice(_,n.index)):_=n.index+n[0].length;break;case"styles":case"workbook":if("/"===n[1]){if((l=c.pop())[0]!==n[3])throw new Error("Bad state: "+l.join("|"))}else c.push([n[3],!1]);break;case"comment":if("/"===n[1]){if((l=c.pop())[0]!==n[3])throw new Error("Bad state: "+l.join("|"));Fh(R),P.push(R)}else c.push([n[3],!1]),R={a:(l=_h(n[0])).Author};break;case"autofilter":if("/"===n[1]){if((l=c.pop())[0]!==n[3])throw new Error("Bad state: "+l.join("|"))}else if("/"!==n[0].charAt(n[0].length-2)){var K=_h(n[0]);h["!autofilter"]={ref:pd(K.Range).replace(/\$/g,"")},c.push([n[3],!0])}break;case"datavalidation":if("/"===n[1]){if((l=c.pop())[0]!==n[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==n[0].charAt(n[0].length-2)&&c.push([n[3],!0]);break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if("/"===n[1]){if((l=c.pop())[0]!==n[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==n[0].charAt(n[0].length-2)&&c.push([n[3],!0]);break;default:if(0==c.length&&"document"==n[3])return Nm(r,a);if(0==c.length&&"uof"==n[3])return Nm(r,a);var J=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(n[3]){case"allowpng":case"removepersonalinformation":case"downloadcomponents":case"locationofcomponents":case"colors":case"color":case"index":case"rgb":case"targetscreensize":case"readonlyrecommended":break;default:J=!1}break;case"componentoptions":switch(n[3]){case"toolbar":case"hideofficelogo":case"spreadsheetautofit":case"label":case"caption":case"maxheight":case"maxwidth":case"nextsheetnumber":break;default:J=!1}break;case"excelworkbook":switch(n[3]){case"date1904":U.WBProps.date1904=!0;break;case"windowheight":case"windowwidth":case"windowtopx":case"windowtopy":case"tabratio":case"protectstructure":case"protectwindow":case"protectwindows":case"activesheet":case"displayinknotes":case"firstvisiblesheet":case"supbook":case"sheetname":case"sheetindex":case"sheetindexfirst":case"sheetindexlast":case"dll":case"acceptlabelsinformulas":case"donotsavelinkvalues":case"iteration":case"maxiterations":case"maxchange":case"path":case"xct":case"count":case"selectedsheets":case"calculation":case"uncalced":case"startupprompt":case"crn":case"externname":case"formula":case"colfirst":case"collast":case"wantadvise":case"boolean":case"error":case"text":case"ole":case"noautorecover":case"publishobjects":case"donotcalculatebeforesave":case"number":case"refmoder1c1":case"embedsavesmarttags":break;default:J=!1}break;case"workbookoptions":switch(n[3]){case"owcversion":case"height":case"width":break;default:J=!1}break;case"worksheetoptions":switch(n[3]){case"visible":if("/>"===n[0].slice(-2));else if("/"===n[1])switch(r.slice(_,n.index)){case"SheetHidden":B.Hidden=1;break;case"SheetVeryHidden":B.Hidden=2}else _=n.index+n[0].length;break;case"header":h["!margins"]||pf(h["!margins"]={},"xlml"),isNaN(+cs(n[0]).Margin)||(h["!margins"].header=+cs(n[0]).Margin);break;case"footer":h["!margins"]||pf(h["!margins"]={},"xlml"),isNaN(+cs(n[0]).Margin)||(h["!margins"].footer=+cs(n[0]).Margin);break;case"pagemargins":var Q=cs(n[0]);h["!margins"]||pf(h["!margins"]={},"xlml"),isNaN(+Q.Top)||(h["!margins"].top=+Q.Top),isNaN(+Q.Left)||(h["!margins"].left=+Q.Left),isNaN(+Q.Right)||(h["!margins"].right=+Q.Right),isNaN(+Q.Bottom)||(h["!margins"].bottom=+Q.Bottom);break;case"displayrighttoleft":U.Views||(U.Views=[]),U.Views[0]||(U.Views[0]={}),U.Views[0].RTL=!0;break;case"freezepanes":case"frozennosplit":case"splithorizontal":case"splitvertical":case"donotdisplaygridlines":case"activerow":case"activecol":case"toprowbottompane":case"leftcolumnrightpane":case"unsynced":case"print":case"printerrors":case"panes":case"scale":case"pane":case"number":case"layout":case"pagesetup":case"selected":case"protectobjects":case"enableselection":case"protectscenarios":case"validprinterinfo":case"horizontalresolution":case"verticalresolution":case"numberofcopies":case"activepane":case"toprowvisible":case"leftcolumnvisible":case"fittopage":case"rangeselection":case"papersizeindex":case"pagelayoutzoom":case"pagebreakzoom":case"filteron":case"fitwidth":case"fitheight":case"commentslayout":case"zoom":case"lefttoright":case"gridlines":case"allowsort":case"allowfilter":case"allowinsertrows":case"allowdeleterows":case"allowinsertcols":case"allowdeletecols":case"allowinserthyperlinks":case"allowformatcells":case"allowsizecols":case"allowsizerows":case"tabcolorindex":case"donotdisplayheadings":case"showpagelayoutzoom":case"blackandwhite":case"donotdisplayzeros":case"displaypagebreak":case"rowcolheadings":case"donotdisplayoutline":case"noorientation":case"allowusepivottables":case"zeroheight":case"viewablerange":case"selection":case"protectcontents":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;default:J=!1}break;case"pivottable":case"pivotcache":switch(n[3]){case"immediateitemsondrop":case"showpagemultipleitemlabel":case"compactrowindent":case"location":case"pivotfield":case"orientation":case"layoutform":case"layoutsubtotallocation":case"layoutcompactrow":case"position":case"pivotitem":case"datatype":case"datafield":case"sourcename":case"parentfield":case"ptlineitems":case"ptlineitem":case"countofsameitems":case"item":case"itemtype":case"ptsource":case"cacheindex":case"consolidationreference":case"filename":case"reference":case"nocolumngrand":case"norowgrand":case"blanklineafteritems":case"hidden":case"subtotal":case"basefield":case"mapchilditems":case"function":case"refreshonfileopen":case"printsettitles":case"mergelabels":case"defaultversion":case"refreshname":case"refreshdate":case"refreshdatecopy":case"versionlastrefresh":case"versionlastupdate":case"versionupdateablemin":case"versionrefreshablemin":case"calculation":break;default:J=!1}break;case"pagebreaks":switch(n[3]){case"colbreaks":case"colbreak":case"rowbreaks":case"rowbreak":case"colstart":case"colend":case"rowend":break;default:J=!1}break;case"autofilter":switch(n[3]){case"autofiltercolumn":case"autofiltercondition":case"autofilterand":case"autofilteror":break;default:J=!1}break;case"querytable":switch(n[3]){case"id":case"autoformatfont":case"autoformatpattern":case"querysource":case"querytype":case"enableredirections":case"refreshedinxl9":case"urlstring":case"htmltables":case"connection":case"commandtext":case"refreshinfo":case"notitles":case"nextid":case"columninfo":case"overwritecells":case"donotpromptforfile":case"textwizardsettings":case"source":case"number":case"decimal":case"thousandseparator":case"trailingminusnumbers":case"formatsettings":case"fieldtype":case"delimiters":case"tab":case"comma":case"autoformatname":case"versionlastedit":case"versionlastrefresh":break;default:J=!1}break;case"datavalidation":switch(n[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":case"cellrangelist":break;default:J=!1}break;case"sorting":case"conditionalformatting":switch(n[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"cellrangelist":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":break;default:J=!1}break;case"mapinfo":case"schema":case"data":switch(n[3]){case"map":case"entry":case"range":case"xpath":case"field":case"xsdtype":case"filteron":case"aggregate":case"elementtype":case"attributetype":case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":case"row":break;default:J=!1}break;case"smarttags":break;default:J=!1}if(J)break;if(n[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+n[3]+"|"+c.join("|");if("customdocumentproperties"===c[c.length-1][0]){if("/>"===n[0].slice(-2))break;"/"===n[1]?Ph(C,W,A,r.slice(_,n.index)):(A=n,_=n.index+n[0].length);break}if(a.WTF)throw"Unrecognized tag: "+n[3]+"|"+c.join("|")}var Z={};return a.bookSheets||a.bookProps||(Z.Sheets=d),Z.SheetNames=f,Z.Workbook=U,Z.SSF=zn(Or),Z.Props=j,Z.Custprops=C,Z}function Lh(e,t){switch(np(t=t||{}),t.type||"base64"){case"base64":return Ih(fr(e),t);case"binary":case"buffer":case"file":return Ih(e,t);case"array":return Ih(br(e),t)}}function Mh(e,t){var a=[];return e.Props&&a.push(function(e,t){var a=[];return Sn(bl).map(function(e){for(var t=0;t<ol.length;++t)if(ol[t][1]==e)return ol[t];for(t=0;t<fl.length;++t)if(fl[t][1]==e)return fl[t];throw e}).forEach(function(r){if(null!=e[r[1]]){var n=t&&t.Props&&null!=t.Props[r[1]]?t.Props[r[1]]:e[r[1]];"date"===r[2]&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"Z")),"number"==typeof n?n=String(n):!0===n||!1===n?n=n?"1":"0":n instanceof Date&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"")),a.push(Fs(bl[r[1]]||r[1],n))}}),Ls("DocumentProperties",a.join(""),{xmlns:ti})}(e.Props,t)),e.Custprops&&a.push(function(e,t){var a=["Worksheets","SheetNames"],r="CustomDocumentProperties",n=[];return e&&Sn(e).forEach(function(t){if(Object.prototype.hasOwnProperty.call(e,t)){for(var r=0;r<ol.length;++r)if(t==ol[r][1])return;for(r=0;r<fl.length;++r)if(t==fl[r][1])return;for(r=0;r<a.length;++r)if(t==a[r])return;var s=e[t],i="string";"number"==typeof s?(i="float",s=String(s)):!0===s||!1===s?(i="boolean",s=s?"1":"0"):s=String(s),n.push(Ls(vs(t),s,{"dt:dt":i}))}}),t&&Sn(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)&&(!e||!Object.prototype.hasOwnProperty.call(e,a))){var r=t[a],s="string";"number"==typeof r?(s="float",r=String(r)):!0===r||!1===r?(s="boolean",r=r?"1":"0"):r instanceof Date?(s="dateTime.tz",r=r.toISOString()):r=String(r),n.push(Ls(vs(a),r,{"dt:dt":s}))}}),"<"+r+' xmlns="'+ti+'">'+n.join("")+"</"+r+">"}(e.Props,e.Custprops)),a.join("")}function zh(e){return Ls("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+vd(e.Ref,{r:0,c:0})})}function Uh(e,t,a,r,n,s,i){if(!e||void 0==e.v&&void 0==e.f)return"";var o={};if(e.f&&(o["ss:Formula"]="="+gs(vd(e.f,i))),e.F&&e.F.slice(0,t.length)==t){var l=ao(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==i.r?"":"["+(l.r-i.r)+"]")+"C"+(l.c==i.c?"":"["+(l.c-i.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=gs(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=gs(e.l.Tooltip))),a["!merges"])for(var c=a["!merges"],u=0;u!=c.length;++u)c[u].s.c==i.c&&c[u].s.r==i.r&&(c[u].e.c>c[u].s.c&&(o["ss:MergeAcross"]=c[u].e.c-c[u].s.c),c[u].e.r>c[u].s.r&&(o["ss:MergeDown"]=c[u].e.r-c[u].s.r));var d="",f="";switch(e.t){case"z":if(!r.sheetStubs)return"";break;case"n":d="Number",f=String(e.v);break;case"b":d="Boolean",f=e.v?"1":"0";break;case"e":d="Error",f=Yo[e.v];break;case"d":d="DateTime",f=new Date(e.v).toISOString(),null==e.z&&(e.z=e.z||Or[14]);break;case"s":d="String",f=((e.v||"")+"").replace(ms,function(e){return fs[e]}).replace(ys,function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"})}var h=gf(r.cellXfs,e,r);o["ss:StyleID"]="s"+(21+h),o["ss:Index"]=i.c+1;var m=null!=e.v?f:"",p="z"==e.t?"":'<Data ss:Type="'+d+'">'+m+"</Data>";return(e.c||[]).length>0&&(p+=e.c.map(function(e){var t=Ls("ss:Data",(e.t||"").replace(/(\r\n|[\r\n])/g,"&#10;"),{xmlns:"http://www.w3.org/TR/REC-html40"});return Ls("Comment",t,{"ss:Author":e.a})}).join("")),Ls("Cell",p,o)}function Bh(e,t){var a='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=ju(t.hpt)),t.hpx&&(a+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(a+=' ss:Hidden="1"')),a+">"}function Wh(e,t,a){var r=[],n=a.SheetNames[e],s=a.Sheets[n],i=s?function(e,t,a,r){if(!e)return"";if(!((r||{}).Workbook||{}).Names)return"";for(var n=r.Workbook.Names,s=[],i=0;i<n.length;++i){var o=n[i];o.Sheet==a&&(o.Name.match(/^_xlfn\./)||s.push(zh(o)))}return s.join("")}(s,0,e,a):"";return i.length>0&&r.push("<Names>"+i+"</Names>"),i=s?function(e,t){if(!e["!ref"])return"";var a=io(e["!ref"]),r=e["!merges"]||[],n=0,s=[];e["!cols"]&&e["!cols"].forEach(function(e,t){Eu(e);var a=!!e.width,r=mf(t,e),n={"ss:Index":t+1};a&&(n["ss:Width"]=bu(r.width)),e.hidden&&(n["ss:Hidden"]="1"),s.push(Ls("Column",null,n))});for(var i=Array.isArray(e),o=a.s.r;o<=a.e.r;++o){for(var l=[Bh(o,(e["!rows"]||[])[o])],c=a.s.c;c<=a.e.c;++c){var u=!1;for(n=0;n!=r.length;++n)if(!(r[n].s.c>c)&&!(r[n].s.r>o)&&!(r[n].e.c<c)&&!(r[n].e.r<o)){r[n].s.c==c&&r[n].s.r==o||(u=!0);break}if(!u){var d={r:o,c:c},f=ro(d),h=i?(e[o]||[])[c]:e[f];l.push(Uh(h,f,e,t,0,0,d))}}l.push("</Row>"),l.length>2&&s.push(l.join(""))}return s.join("")}(s,t):"",i.length>0&&r.push("<Table>"+i+"</Table>"),r.push(function(e,t,a,r){if(!e)return"";var n=[];if(e["!margins"]&&(n.push("<PageSetup>"),e["!margins"].header&&n.push(Ls("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&n.push(Ls("Footer",null,{"x:Margin":e["!margins"].footer})),n.push(Ls("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),n.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[a])if(r.Workbook.Sheets[a].Hidden)n.push(Ls("Visible",1==r.Workbook.Sheets[a].Hidden?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<a&&(!r.Workbook.Sheets[s]||r.Workbook.Sheets[s].Hidden);++s);s==a&&n.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),e["!protect"]&&(n.push(Fs("ProtectContents","True")),e["!protect"].objects&&n.push(Fs("ProtectObjects","True")),e["!protect"].scenarios&&n.push(Fs("ProtectScenarios","True")),null==e["!protect"].selectLockedCells||e["!protect"].selectLockedCells?null==e["!protect"].selectUnlockedCells||e["!protect"].selectUnlockedCells||n.push(Fs("EnableSelection","UnlockedCells")):n.push(Fs("EnableSelection","NoSelection")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(t){e["!protect"][t[0]]&&n.push("<"+t[1]+"/>")})),0==n.length?"":Ls("WorksheetOptions",n.join(""),{xmlns:ai})}(s,0,e,a)),r.join("")}function Hh(e,t){t||(t={}),e.SSF||(e.SSF=zn(Or)),e.SSF&&(pn(),mn(e.SSF),t.revssf=Nn(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],gf(t.cellXfs,{},{revssf:{General:0}}));var a=[];a.push(Mh(e,t)),a.push(""),a.push(""),a.push("");for(var r=0;r<e.SheetNames.length;++r)a.push(Ls("Worksheet",Wh(r,t,e),{"ss:Name":gs(e.SheetNames[r])}));return a[2]=function(e,t){var a=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(e,t){var r=[];r.push(Ls("NumberFormat",null,{"ss:Format":gs(Or[e.numFmtId])}));var n={"ss:ID":"s"+(21+t)};a.push(Ls("Style",r.join(""),n))}),Ls("Styles",a.join(""))}(0,t),a[3]=function(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,a=[],r=0;r<t.length;++r){var n=t[r];null==n.Sheet&&(n.Name.match(/^_xlfn\./)||a.push(zh(n)))}return Ls("Names",a.join(""))}(e),rs+Ls("Workbook",a.join(""),{xmlns:ri,"xmlns:o":ti,"xmlns:x":ai,"xmlns:ss":ri,"xmlns:dt":ni,"xmlns:html":oi})}function Vh(e){var t={},a=e.content;if(a.l=28,t.AnsiUserType=a.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=function(e){return zo(e,1)}(a),a.length-a.l<=4)return t;var r=a.read_shift(4);return 0==r||r>40?t:(a.l-=4,t.Reserved1=a.read_shift(0,"lpstr-ansi"),a.length-a.l<=4||1907505652!==(r=a.read_shift(4))?t:(t.UnicodeClipboardFormat=function(e){return zo(e,2)}(a),0==(r=a.read_shift(4))||r>40?t:(a.l-=4,void(t.Reserved2=a.read_shift(0,"lpwstr")))))}var Gh=[60,1084,2066,2165,2175];function $h(e,t,a,r,n){var s=r,i=[],o=a.slice(a.l,a.l+s);if(n&&n.enc&&n.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:case 133:break;default:n.enc.insitu(o)}i.push(o),a.l+=s;for(var l=Pi(a,a.l),c=am[l],u=0;null!=c&&Gh.indexOf(l)>-1;)s=Pi(a,a.l+2),u=a.l+4,2066==l?u+=4:2165!=l&&2175!=l||(u+=12),o=a.slice(u,a.l+4+s),i.push(o),a.l+=4+s,c=am[l=Pi(a,a.l)];var d=xr(i);Wi(d,0);var f=0;d.lens=[];for(var h=0;h<i.length;++h)d.lens.push(f),f+=i[h].length;if(d.length<r)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+d.length+" < "+r;return t.f(d,d.length,n)}function qh(e,t,a){if("z"!==e.t&&e.XF){var r=0;try{r=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Or[r])}catch(Ig){if(t.WTF)throw Ig}if(!t||!1!==t.cellText)try{"e"===e.t?e.w=e.w||Yo[e.v]:0===r||"General"==r?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=Hr(e.v):e.w=Vr(e.v):e.w=fn(r,e.v,{date1904:!!a,dateNF:t&&t.dateNF})}catch(Ig){if(t.WTF)throw Ig}if(t.cellDates&&r&&"n"==e.t&&ln(Or[r]||String(r))){var n=Lr(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}}function Yh(e,t,a){return{v:e,ixfe:t,t:a}}function Xh(e,t){var a={opts:{}},r={};var n,s,i,o,l,c,u,d,f=t.dense?[]:{},h={},m={},p=null,g=[],v="",y={},b="",w={},x=[],k=[],S=[],E={Sheets:[],WBProps:{date1904:!1},Views:[{}]},T={},N=function(e){return e<8?qo[e]:e<64&&S[e-8]||qo[e]},j=function(e,t,a){if(!(L>1)&&!(a.sheetRows&&e.r>=a.sheetRows)){if(a.cellStyles&&t.XF&&t.XF.data&&function(e,t,a){var r,n=t.XF.data;n&&n.patternType&&a&&a.cellStyles&&(t.s={},t.s.patternType=n.patternType,(r=gu(N(n.icvFore)))&&(t.s.fgColor={rgb:r}),(r=gu(N(n.icvBack)))&&(t.s.bgColor={rgb:r}))}(0,t,a),delete t.ixfe,delete t.XF,n=e,b=ro(e),m&&m.s&&m.e||(m={s:{r:0,c:0},e:{r:0,c:0}}),e.r<m.s.r&&(m.s.r=e.r),e.c<m.s.c&&(m.s.c=e.c),e.r+1>m.e.r&&(m.e.r=e.r+1),e.c+1>m.e.c&&(m.e.c=e.c+1),a.cellFormula&&t.f)for(var r=0;r<x.length;++r)if(!(x[r][0].s.c>e.c||x[r][0].s.r>e.r)&&!(x[r][0].e.c<e.c||x[r][0].e.r<e.r)){t.F=so(x[r][0]),x[r][0].s.c==e.c&&x[r][0].s.r==e.r||delete t.f,t.f&&(t.f=""+$d(x[r][1],0,e,D,C));break}a.dense?(f[e.r]||(f[e.r]=[]),f[e.r][e.c]=t):f[b]=t}},C={enc:!1,sbcch:0,snames:[],sharedf:w,arrayf:x,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(C.password=t.password);var _=[],A=[],P=[],R=[],O=!1,D=[];D.SheetNames=C.snames,D.sharedf=C.sharedf,D.arrayf=C.arrayf,D.names=[],D.XTI=[];var F,I=0,L=0,M=0,z=[],U=[];C.codepage=1200,ar(1200);for(var B=!1;e.l<e.length-1;){var W=e.l,H=e.read_shift(2);if(0===H&&10===I)break;var V=e.l===e.length?0:e.read_shift(2),G=am[H];if(G&&G.f){if(t.bookSheets&&133===I&&133!==H)break;if(I=H,2===G.r||12==G.r){var $=e.read_shift(2);if(V-=2,!C.enc&&$!==H&&((255&$)<<8|$>>8)!==H)throw new Error("rt mismatch: "+$+"!="+H);12==G.r&&(e.l+=10,V-=10)}var q={};if(q=10===H?G.f(e,V,C):$h(H,G,e,V,C),0==L&&-1===[9,521,1033,2057].indexOf(I))continue;switch(H){case 34:a.opts.Date1904=E.WBProps.date1904=q;break;case 134:a.opts.WriteProtect=!0;break;case 47:if(C.enc||(e.l=0),C.enc=q,!t.password)throw new Error("File is password-protected");if(null==q.valid)throw new Error("Encryption scheme unsupported");if(!q.valid)throw new Error("Password is incorrect");break;case 92:C.lastuser=q;break;case 66:var Y=Number(q);switch(Y){case 21010:Y=1200;break;case 32768:Y=1e4;break;case 32769:Y=1252}ar(C.codepage=Y),B=!0;break;case 317:C.rrtabid=q;break;case 25:C.winlocked=q;break;case 439:a.opts.RefreshAll=q;break;case 12:a.opts.CalcCount=q;break;case 16:a.opts.CalcDelta=q;break;case 17:a.opts.CalcIter=q;break;case 13:a.opts.CalcMode=q;break;case 14:a.opts.CalcPrecision=q;break;case 95:a.opts.CalcSaveRecalc=q;break;case 15:C.CalcRefMode=q;break;case 2211:a.opts.FullCalc=q;break;case 129:q.fDialog&&(f["!type"]="dialog"),q.fBelow||((f["!outline"]||(f["!outline"]={})).above=!0),q.fRight||((f["!outline"]||(f["!outline"]={})).left=!0);break;case 224:k.push(q);break;case 430:D.push([q]),D[D.length-1].XTI=[];break;case 35:case 547:D[D.length-1].push(q);break;case 24:case 536:F={Name:q.Name,Ref:$d(q.rgce,0,null,D,C)},q.itab>0&&(F.Sheet=q.itab-1),D.names.push(F),D[0]||(D[0]=[],D[0].XTI=[]),D[D.length-1].push(q),"_xlnm._FilterDatabase"==q.Name&&q.itab>0&&q.rgce&&q.rgce[0]&&q.rgce[0][0]&&"PtgArea3d"==q.rgce[0][0][0]&&(U[q.itab-1]={ref:so(q.rgce[0][0][1][2])});break;case 22:C.ExternCount=q;break;case 23:0==D.length&&(D[0]=[],D[0].XTI=[]),D[D.length-1].XTI=D[D.length-1].XTI.concat(q),D.XTI=D.XTI.concat(q);break;case 2196:if(C.biff<8)break;null!=F&&(F.Comment=q[1]);break;case 18:f["!protect"]=q;break;case 19:0!==q&&C.WTF&&console.error("Password verifier: "+q);break;case 133:h[q.pos]=q,C.snames.push(q.name);break;case 10:if(--L)break;if(m.e){if(m.e.r>0&&m.e.c>0){if(m.e.r--,m.e.c--,f["!ref"]=so(m),t.sheetRows&&t.sheetRows<=m.e.r){var X=m.e.r;m.e.r=t.sheetRows-1,f["!fullref"]=f["!ref"],f["!ref"]=so(m),m.e.r=X}m.e.r++,m.e.c++}_.length>0&&(f["!merges"]=_),A.length>0&&(f["!objects"]=A),P.length>0&&(f["!cols"]=P),R.length>0&&(f["!rows"]=R),E.Sheets.push(T)}""===v?y=f:r[v]=f,f=t.dense?[]:{};break;case 9:case 521:case 1033:case 2057:if(8===C.biff&&(C.biff={9:2,521:3,1033:4}[H]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[q.BIFFVer]||8),C.biffguess=0==q.BIFFVer,0==q.BIFFVer&&4096==q.dt&&(C.biff=5,B=!0,ar(C.codepage=28591)),8==C.biff&&0==q.BIFFVer&&16==q.dt&&(C.biff=2),L++)break;if(f=t.dense?[]:{},C.biff<8&&!B&&(B=!0,ar(C.codepage=t.codepage||1252)),C.biff<5||0==q.BIFFVer&&4096==q.dt){""===v&&(v="Sheet1"),m={s:{r:0,c:0},e:{r:0,c:0}};var K={pos:e.l-V,name:v};h[K.pos]=K,C.snames.push(v)}else v=(h[W]||{name:""}).name;32==q.dt&&(f["!type"]="chart"),64==q.dt&&(f["!type"]="macro"),_=[],A=[],C.arrayf=x=[],P=[],R=[],O=!1,T={Hidden:(h[W]||{hs:0}).hs,name:v};break;case 515:case 3:case 2:"chart"==f["!type"]&&(t.dense?(f[q.r]||[])[q.c]:f[ro({c:q.c,r:q.r})])&&++q.c,c={ixfe:q.ixfe,XF:k[q.ixfe]||{},v:q.val,t:"n"},M>0&&(c.z=z[c.ixfe>>8&63]),qh(c,t,a.opts.Date1904),j({c:q.c,r:q.r},c,t);break;case 5:case 517:c={ixfe:q.ixfe,XF:k[q.ixfe],v:q.val,t:q.t},M>0&&(c.z=z[c.ixfe>>8&63]),qh(c,t,a.opts.Date1904),j({c:q.c,r:q.r},c,t);break;case 638:c={ixfe:q.ixfe,XF:k[q.ixfe],v:q.rknum,t:"n"},M>0&&(c.z=z[c.ixfe>>8&63]),qh(c,t,a.opts.Date1904),j({c:q.c,r:q.r},c,t);break;case 189:for(var J=q.c;J<=q.C;++J){var Q=q.rkrec[J-q.c][0];c={ixfe:Q,XF:k[Q],v:q.rkrec[J-q.c][1],t:"n"},M>0&&(c.z=z[c.ixfe>>8&63]),qh(c,t,a.opts.Date1904),j({c:J,r:q.r},c,t)}break;case 6:case 518:case 1030:if("String"==q.val){p=q;break}if((c=Yh(q.val,q.cell.ixfe,q.tt)).XF=k[c.ixfe],t.cellFormula){var Z=q.formula;if(Z&&Z[0]&&Z[0][0]&&"PtgExp"==Z[0][0][0]){var ee=Z[0][0][1][0],te=Z[0][0][1][1],ae=ro({r:ee,c:te});w[ae]?c.f=""+$d(q.formula,0,q.cell,D,C):c.F=((t.dense?(f[ee]||[])[te]:f[ae])||{}).F}else c.f=""+$d(q.formula,0,q.cell,D,C)}M>0&&(c.z=z[c.ixfe>>8&63]),qh(c,t,a.opts.Date1904),j(q.cell,c,t),p=q;break;case 7:case 519:if(!p)throw new Error("String record expects Formula");p.val=q,(c=Yh(q,p.cell.ixfe,"s")).XF=k[c.ixfe],t.cellFormula&&(c.f=""+$d(p.formula,0,p.cell,D,C)),M>0&&(c.z=z[c.ixfe>>8&63]),qh(c,t,a.opts.Date1904),j(p.cell,c,t),p=null;break;case 33:case 545:x.push(q);var re=ro(q[0].s);if(s=t.dense?(f[q[0].s.r]||[])[q[0].s.c]:f[re],t.cellFormula&&s){if(!p)break;if(!re||!s)break;s.f=""+$d(q[1],0,q[0],D,C),s.F=so(q[0])}break;case 1212:if(!t.cellFormula)break;if(b){if(!p)break;w[ro(p.cell)]=q[0],((s=t.dense?(f[p.cell.r]||[])[p.cell.c]:f[ro(p.cell)])||{}).f=""+$d(q[0],0,n,D,C)}break;case 253:c=Yh(g[q.isst].t,q.ixfe,"s"),g[q.isst].h&&(c.h=g[q.isst].h),c.XF=k[c.ixfe],M>0&&(c.z=z[c.ixfe>>8&63]),qh(c,t,a.opts.Date1904),j({c:q.c,r:q.r},c,t);break;case 513:t.sheetStubs&&(c={ixfe:q.ixfe,XF:k[q.ixfe],t:"z"},M>0&&(c.z=z[c.ixfe>>8&63]),qh(c,t,a.opts.Date1904),j({c:q.c,r:q.r},c,t));break;case 190:if(t.sheetStubs)for(var ne=q.c;ne<=q.C;++ne){var se=q.ixfe[ne-q.c];c={ixfe:se,XF:k[se],t:"z"},M>0&&(c.z=z[c.ixfe>>8&63]),qh(c,t,a.opts.Date1904),j({c:ne,r:q.r},c,t)}break;case 214:case 516:case 4:(c=Yh(q.val,q.ixfe,"s")).XF=k[c.ixfe],M>0&&(c.z=z[c.ixfe>>8&63]),qh(c,t,a.opts.Date1904),j({c:q.c,r:q.r},c,t);break;case 0:case 512:1===L&&(m=q);break;case 252:g=q;break;case 1054:if(4==C.biff){z[M++]=q[1];for(var ie=0;ie<M+163&&Or[ie]!=q[1];++ie);ie>=163&&hn(q[1],M+163)}else hn(q[1],q[0]);break;case 30:z[M++]=q;for(var oe=0;oe<M+163&&Or[oe]!=q;++oe);oe>=163&&hn(q,M+163);break;case 229:_=_.concat(q);break;case 93:A[q.cmo[0]]=C.lastobj=q;break;case 438:C.lastobj.TxO=q;break;case 127:C.lastobj.ImData=q;break;case 440:for(l=q[0].s.r;l<=q[0].e.r;++l)for(o=q[0].s.c;o<=q[0].e.c;++o)(s=t.dense?(f[l]||[])[o]:f[ro({c:o,r:l})])&&(s.l=q[1]);break;case 2048:for(l=q[0].s.r;l<=q[0].e.r;++l)for(o=q[0].s.c;o<=q[0].e.c;++o)(s=t.dense?(f[l]||[])[o]:f[ro({c:o,r:l})])&&s.l&&(s.l.Tooltip=q[1]);break;case 28:if(C.biff<=5&&C.biff>=2)break;s=t.dense?(f[q[0].r]||[])[q[0].c]:f[ro(q[0])];var le=A[q[2]];s||(t.dense?(f[q[0].r]||(f[q[0].r]=[]),s=f[q[0].r][q[0].c]={t:"z"}):s=f[ro(q[0])]={t:"z"},m.e.r=Math.max(m.e.r,q[0].r),m.s.r=Math.min(m.s.r,q[0].r),m.e.c=Math.max(m.e.c,q[0].c),m.s.c=Math.min(m.s.c,q[0].c)),s.c||(s.c=[]),i={a:q[1],t:le.TxO.t},s.c.push(i);break;case 2173:nd(k[q.ixfe],q.ext);break;case 125:if(!C.cellStyles)break;for(;q.e>=q.s;)P[q.e--]={width:q.w/256,level:q.level||0,hidden:!!(1&q.flags)},O||(O=!0,Su(q.w/256)),Eu(P[q.e+1]);break;case 520:var ce={};null!=q.level&&(R[q.r]=ce,ce.level=q.level),q.hidden&&(R[q.r]=ce,ce.hidden=!0),q.hpt&&(R[q.r]=ce,ce.hpt=q.hpt,ce.hpx=ju(q.hpt));break;case 38:case 39:case 40:case 41:f["!margins"]||pf(f["!margins"]={}),f["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[H]]=q;break;case 161:f["!margins"]||pf(f["!margins"]={}),f["!margins"].header=q.header,f["!margins"].footer=q.footer;break;case 574:q.RTL&&(E.Views[0].RTL=!0);break;case 146:S=q;break;case 2198:d=q;break;case 140:u=q;break;case 442:v?T.CodeName=q||T.name:E.WBProps.CodeName=q||"ThisWorkbook"}}else G||console.error("Missing Info for XLS Record 0x"+H.toString(16)),e.l+=V}return a.SheetNames=Sn(h).sort(function(e,t){return Number(e)-Number(t)}).map(function(e){return h[e].name}),t.bookSheets||(a.Sheets=r),!a.SheetNames.length&&y["!ref"]?(a.SheetNames.push("Sheet1"),a.Sheets&&(a.Sheets.Sheet1=y)):a.Preamble=y,a.Sheets&&U.forEach(function(e,t){a.Sheets[a.SheetNames[t]]["!autofilter"]=e}),a.Strings=g,a.SSF=zn(Or),C.enc&&(a.Encryption=C.enc),d&&(a.Themes=d),a.Metadata={},void 0!==u&&(a.Metadata.Country=u),D.names.length>0&&(E.Names=D.names),a.Workbook=E,a}var Kh="e0859ff2f94f6810ab9108002b27b3d9",Jh="02d5cdd59c2e1b10939708002b2cf9ae",Qh="05d5cdd59c2e1b10939708002b2cf9ae";function Zh(e,t){var a,r,n,s;if(t||(t={}),np(t),rr(),t.codepage&&tr(t.codepage),e.FullPaths){if(bn.find(e,"/encryption"))throw new Error("File is password-protected");a=bn.find(e,"!CompObj"),r=bn.find(e,"/Workbook")||bn.find(e,"/Book")}else{switch(t.type){case"base64":e=vr(fr(e));break;case"binary":e=vr(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e))}Wi(e,0),r={content:e}}if(a&&Vh(a),t.bookProps&&!t.bookSheets)n={};else{var i=hr?"buffer":"array";if(r&&r.content)n=Xh(r.content,t);else if((s=bn.find(e,"PerfectOffice_MAIN"))&&s.content)n=Wc.to_workbook(s.content,(t.type=i,t));else{if(!(s=bn.find(e,"NativeContent_MAIN"))||!s.content)throw(s=bn.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");n=Wc.to_workbook(s.content,(t.type=i,t))}t.bookVBA&&e.FullPaths&&bn.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=function(e){var t=bn.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(a,r){if("/"!==a.slice(-1)&&a.match(/_VBA_PROJECT_CUR/)){var n=a.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");bn.utils.cfb_add(t,n,e.FileIndex[r].content)}}),bn.write(t)}(e))}var o={};return e.FullPaths&&function(e,t,a){var r=bn.find(e,"/!DocumentSummaryInformation");if(r&&r.size>0)try{var n=Fl(r,Wo,Jh);for(var s in n)t[s]=n[s]}catch(Ig){if(a.WTF)throw Ig}var i=bn.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=Fl(i,Ho,Kh);for(var l in o)null==t[l]&&(t[l]=o[l])}catch(Ig){if(a.WTF)throw Ig}t.HeadingPairs&&t.TitlesOfParts&&(ml(t.HeadingPairs,t.TitlesOfParts,t,a),delete t.HeadingPairs,delete t.TitlesOfParts)}(e,o,t),n.Props=n.Custprops=o,t.bookFiles&&(n.cfb=e),n}function em(e,t){var a=t||{},r=bn.utils.cfb_new({root:"R"}),n="/Workbook";switch(a.bookType||"xls"){case"xls":a.bookType="biff8";case"xla":a.bookType||(a.bookType="xla");case"biff8":n="/Workbook",a.biff=8;break;case"biff5":n="/Book",a.biff=5;break;default:throw new Error("invalid type "+a.bookType+" for XLS CFB")}return bn.utils.cfb_add(r,n,fm(e,a)),8==a.biff&&(e.Props||e.Custprops)&&function(e,t){var a,r=[],n=[],s=[],i=0,o=En(Wo,"n"),l=En(Ho,"n");if(e.Props)for(a=Sn(e.Props),i=0;i<a.length;++i)(Object.prototype.hasOwnProperty.call(o,a[i])?r:Object.prototype.hasOwnProperty.call(l,a[i])?n:s).push([a[i],e.Props[a[i]]]);if(e.Custprops)for(a=Sn(e.Custprops),i=0;i<a.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},a[i])||(Object.prototype.hasOwnProperty.call(o,a[i])?r:Object.prototype.hasOwnProperty.call(l,a[i])?n:s).push([a[i],e.Custprops[a[i]]]);var c=[];for(i=0;i<s.length;++i)Rl.indexOf(s[i][0])>-1||hl.indexOf(s[i][0])>-1||null!=s[i][1]&&c.push(s[i]);n.length&&bn.utils.cfb_add(t,"/\x05SummaryInformation",Il(n,Kh,l,Ho)),(r.length||c.length)&&bn.utils.cfb_add(t,"/\x05DocumentSummaryInformation",Il(r,Jh,o,Wo,c.length?c:null,Qh))}(e,r),8==a.biff&&e.vbaraw&&function(e,t){t.FullPaths.forEach(function(a,r){if(0!=r){var n=a.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");"/"!==n.slice(-1)&&bn.utils.cfb_add(e,n,t.FileIndex[r].content)}})}(r,bn.read(e.vbaraw,{type:"string"==typeof e.vbaraw?"binary":"buffer"})),r}var tm={0:{f:function(e,t){var a={},r=e.l+t;a.r=e.read_shift(4),e.l+=4;var n=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=r,7&s&&(a.level=7&s),16&s&&(a.hidden=!0),32&s&&(a.hpt=n/20),a}},1:{f:function(e){return[wo(e)]}},2:{f:function(e){return[wo(e),Po(e),"n"]}},3:{f:function(e){return[wo(e),e.read_shift(1),"e"]}},4:{f:function(e){return[wo(e),e.read_shift(1),"b"]}},5:{f:function(e){return[wo(e),Io(e),"n"]}},6:{f:function(e){return[wo(e),mo(e),"str"]}},7:{f:function(e){return[wo(e),e.read_shift(4),"s"]}},8:{f:function(e,t,a){var r=e.l+t,n=wo(e);n.r=a["!row"];var s=[n,mo(e),"str"];if(a.cellFormula){e.l+=2;var i=Zd(e,r-e.l,a);s[3]=$d(i,0,n,a.supbooks,a)}else e.l=r;return s}},9:{f:function(e,t,a){var r=e.l+t,n=wo(e);n.r=a["!row"];var s=[n,Io(e),"n"];if(a.cellFormula){e.l+=2;var i=Zd(e,r-e.l,a);s[3]=$d(i,0,n,a.supbooks,a)}else e.l=r;return s}},10:{f:function(e,t,a){var r=e.l+t,n=wo(e);n.r=a["!row"];var s=[n,e.read_shift(1),"b"];if(a.cellFormula){e.l+=2;var i=Zd(e,r-e.l,a);s[3]=$d(i,0,n,a.supbooks,a)}else e.l=r;return s}},11:{f:function(e,t,a){var r=e.l+t,n=wo(e);n.r=a["!row"];var s=[n,e.read_shift(1),"e"];if(a.cellFormula){e.l+=2;var i=Zd(e,r-e.l,a);s[3]=$d(i,0,n,a.supbooks,a)}else e.l=r;return s}},12:{f:function(e){return[ko(e)]}},13:{f:function(e){return[ko(e),Po(e),"n"]}},14:{f:function(e){return[ko(e),e.read_shift(1),"e"]}},15:{f:function(e){return[ko(e),e.read_shift(1),"b"]}},16:{f:Uf},17:{f:function(e){return[ko(e),mo(e),"str"]}},18:{f:function(e){return[ko(e),e.read_shift(4),"s"]}},19:{f:vo},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function(e,t,a){var r=e.l+t;e.l+=4,e.l+=1;var n=e.read_shift(4),s=Co(e),i=ef(e,0,a),o=No(e);e.l=r;var l={Name:s,Ptg:i};return n<268435455&&(l.Sheet=n),o&&(l.Comment=o),l}},40:{},42:{},43:{f:function(e,t,a){var r={};r.sz=e.read_shift(2)/20;var n=function(e){var t=e.read_shift(1);return e.l++,{fBold:1&t,fItalic:2&t,fUnderline:4&t,fStrikeout:8&t,fOutline:16&t,fShadow:32&t,fCondense:64&t,fExtend:128&t}}(e);switch(n.fItalic&&(r.italic=1),n.fCondense&&(r.condense=1),n.fExtend&&(r.extend=1),n.fShadow&&(r.shadow=1),n.fOutline&&(r.outline=1),n.fStrikeout&&(r.strike=1),700===e.read_shift(2)&&(r.bold=1),e.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript"}var s=e.read_shift(1);0!=s&&(r.underline=s);var i=e.read_shift(1);i>0&&(r.family=i);var o=e.read_shift(1);switch(o>0&&(r.charset=o),e.l++,r.color=function(e){var t={},a=e.read_shift(1)>>>1,r=e.read_shift(1),n=e.read_shift(2,"i"),s=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(1);switch(e.l++,a){case 0:t.auto=1;break;case 1:t.index=r;var l=qo[r];l&&(t.rgb=gu(l));break;case 2:t.rgb=gu([s,i,o]);break;case 3:t.theme=r}return 0!=n&&(t.tint=n>0?n/32767:n/32768),t}(e),e.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor"}return r.name=mo(e),r}},44:{f:function(e,t){return[e.read_shift(2),mo(e)]}},45:{f:Lu},46:{f:Bu},47:{f:function(e,t){var a=e.l+t,r=e.read_shift(2),n=e.read_shift(2);return e.l=a,{ixfe:r,numFmtId:n}}},48:{},49:{f:function(e){return e.read_shift(4,"i")}},50:{},51:{f:function(e){for(var t=[],a=e.read_shift(4);a-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Rc},62:{f:function(e){return[wo(e),vo(e),"is"]}},63:{f:function(e){var t={};t.i=e.read_shift(4);var a={};a.r=e.read_shift(4),a.c=e.read_shift(4),t.r=ro(a);var r=e.read_shift(1);return 2&r&&(t.l="1"),8&r&&(t.a="1"),t}},64:{f:function(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Hi,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function(e){var t=e.read_shift(2);return e.l+=28,{RTL:32&t}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function(e,t){var a={},r=e[e.l];return++e.l,a.above=!(64&r),a.left=!(128&r),e.l+=18,a.name=Eo(e,t-19),a}},148:{f:Mf,p:16},151:{f:function(){}},152:{},153:{f:function(e,t){var a={},r=e.read_shift(4);a.defaultThemeVersion=e.read_shift(4);var n=t>8?mo(e):"";return n.length>0&&(a.CodeName=n),a.autoCompressPictures=!!(65536&r),a.backupFile=!!(64&r),a.checkCompatibility=!!(4096&r),a.date1904=!!(1&r),a.filterPrivacy=!!(8&r),a.hidePivotFieldList=!!(1024&r),a.promptedSolutions=!!(16&r),a.publishItems=!!(2048&r),a.refreshAllConnections=!!(262144&r),a.saveExternalLinkValues=!!(128&r),a.showBorderUnselectedTables=!!(4&r),a.showInkAnnotation=!!(32&r),a.showObjects=["all","placeholders","none"][r>>13&3],a.showPivotChartFilter=!!(32768&r),a.updateLinks=["userSet","never","always"][r>>8&3],a}},154:{},155:{},156:{f:function(e,t){var a={};return a.Hidden=e.read_shift(4),a.iTabID=e.read_shift(4),a.strRelID=_o(e,t-8),a.name=mo(e),a}},157:{},158:{},159:{T:1,f:function(e){return[e.read_shift(4),e.read_shift(4)]}},160:{T:-1},161:{T:1,f:Do},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Bf},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:mo(e)}}},336:{T:-1},337:{f:function(e){return e.l+=4,0!=e.read_shift(4)},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:_o},357:{},358:{},359:{},360:{T:1},361:{},362:{f:jc},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function(e,t,a){var r=e.l+t,n=Oo(e),s=e.read_shift(1),i=[n];if(i[2]=s,a.cellFormula){var o=Qd(e,r-e.l,a);i[1]=o}else e.l=r;return i}},427:{f:function(e,t,a){var r=e.l+t,n=[Do(e,16)];if(a.cellFormula){var s=tf(e,r-e.l,a);n[1]=s,e.l=r}else e.l=r;return n}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function(e){var t={};return Hf.forEach(function(a){t[a]=Io(e)}),t}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function(e,t){var a=e.l+t,r=Do(e,16),n=No(e),s=mo(e),i=mo(e),o=mo(e);e.l=a;var l={rfx:r,relId:n,loc:s,display:o};return i&&(l.Tooltip=i),l}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:_o},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:fd},633:{T:1},634:{T:-1},635:{T:1,f:function(e){var t={};t.iauthor=e.read_shift(4);var a=Do(e,16);return t.rfx=a.s,t.ref=ro(a.s),e.l+=16,t}},636:{T:-1},637:{f:yo},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function(e,t){return e.l+=10,{name:mo(e)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},am={6:{f:Xd},10:{f:Ll},12:{f:Ul},13:{f:Ul},14:{f:Ml},15:{f:Ml},16:{f:Io},17:{f:Ml},18:{f:Ml},19:{f:Ul},20:{f:Sc},21:{f:Sc},23:{f:jc},24:{f:Nc},25:{f:Ml},26:{},27:{},28:{f:function(e,t,a){return function(e,t,a){if(!(a.biff<8)){var r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=Xl(e,0,a);return a.biff<8&&e.read_shift(1),[{r:r,c:n},o,i,s]}}(e,0,a)}},29:{},34:{f:Ml},35:{f:Ec},38:{f:Io},39:{f:Io},40:{f:Io},41:{f:Io},42:{f:Ml},43:{f:Ml},47:{f:function(e,t,a){var r={Type:a.biff>=8?e.read_shift(2):0};return r.Type?mu(e,t-2,r):function(e,t,a,r){var n={key:Ul(e),verificationBytes:Ul(e)};a.password&&(n.verifier=du(a.password)),r.valid=n.verificationBytes===n.verifier,r.valid&&(r.insitu=hu(a.password))}(e,a.biff,a,r),r}},49:{f:function(e,t,a){var r={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(a&&a.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10}return r.name=Vl(e,0,a),r}},51:{f:Ul},60:{},61:{f:function(e){return{Pos:[e.read_shift(2),e.read_shift(2)],Dim:[e.read_shift(2),e.read_shift(2)],Flags:e.read_shift(2),CurTab:e.read_shift(2),FirstTab:e.read_shift(2),Selected:e.read_shift(2),TabRatio:e.read_shift(2)}}},64:{f:Ml},65:{f:function(){}},66:{f:Ul},77:{},80:{},81:{},82:{},85:{f:Ul},89:{},90:{},91:{},92:{f:function(e,t,a){if(a.enc)return e.l+=t,"";var r=e.l,n=Xl(e,0,a);return e.read_shift(t+r-e.l),n}},93:{f:function(e,t,a){if(a&&a.biff<8)return function(e,t,a){e.l+=4;var r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((_c[r]||Hi)(e,t,a)),{cmo:[n,r,s],ft:i}}(e,t,a);var r=dc(e),n=function(e,t){for(var a=e.l+t,r=[];e.l<a;){var n=e.read_shift(2);e.l-=2;try{r.push(hc[n](e,a-e.l))}catch(Ig){return e.l=a,r}}return e.l!=a&&(e.l=a),r}(e,t-22,r[1]);return{cmo:r,ft:n}}},94:{},95:{f:Ml},96:{},97:{},99:{f:Ml},125:{f:Rc},128:{f:function(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(0!==t[0]&&t[0]--,0!==t[1]&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}},129:{f:function(e,t,a){var r=a&&8==a.biff||2==t?e.read_shift(2):(e.l+=t,0);return{fDialog:16&r,fBelow:64&r,fRight:128&r}}},130:{f:Ul},131:{f:Ml},132:{f:Ml},133:{f:function(e,t,a){var r=e.read_shift(4),n=3&e.read_shift(1),s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule"}var i=Vl(e,0,a);return 0===i.length&&(i="Sheet1"),{pos:r,hs:n,dt:s,name:i}}},134:{},140:{f:function(e){var t,a=[0,0];return t=e.read_shift(2),a[0]=Vo[t]||t,t=e.read_shift(2),a[1]=Vo[t]||t,a}},141:{f:Ul},144:{},146:{f:function(e){for(var t=e.read_shift(2),a=[];t-- >0;)a.push(ac(e));return a}},151:{},152:{},153:{},154:{},155:{},156:{f:Ul},157:{},158:{},160:{f:Dc},161:{f:function(e,t){var a={};return t<32||(e.l+=16,a.header=Io(e),a.footer=Io(e),e.l+=2),a}},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:function(e,t){for(var a=e.l+t-2,r=e.read_shift(2),n=e.read_shift(2),s=[];e.l<a;)s.push(ic(e));if(e.l!==a)throw new Error("MulRK read error");var i=e.read_shift(2);if(s.length!=i-n+1)throw new Error("MulRK length mismatch");return{r:r,c:n,C:i,rkrec:s}}},190:{f:function(e,t){for(var a=e.l+t-2,r=e.read_shift(2),n=e.read_shift(2),s=[];e.l<a;)s.push(e.read_shift(2));if(e.l!==a)throw new Error("MulBlank read error");var i=e.read_shift(2);if(s.length!=i-n+1)throw new Error("MulBlank length mismatch");return{r:r,c:n,C:i,ixfe:s}}},193:{f:Ll},197:{},198:{},199:{},200:{},201:{},202:{f:Ml},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Ul},220:{},221:{f:Ml},222:{},224:{f:function(e,t,a){var r={};return r.ifnt=e.read_shift(2),r.numFmtId=e.read_shift(2),r.flags=e.read_shift(2),r.fStyle=r.flags>>2&1,r.data=function(e,t,a,r){var n={},s=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return n.patternType=Go[o>>26],r.cellStyles?(n.alc=7&s,n.fWrap=s>>3&1,n.alcV=s>>4&7,n.fJustLast=s>>7&1,n.trot=s>>8&255,n.cIndent=s>>16&15,n.fShrinkToFit=s>>20&1,n.iReadOrder=s>>22&2,n.fAtrNum=s>>26&1,n.fAtrFnt=s>>27&1,n.fAtrAlc=s>>28&1,n.fAtrBdr=s>>29&1,n.fAtrPat=s>>30&1,n.fAtrProt=s>>31&1,n.dgLeft=15&i,n.dgRight=i>>4&15,n.dgTop=i>>8&15,n.dgBottom=i>>12&15,n.icvLeft=i>>16&127,n.icvRight=i>>23&127,n.grbitDiag=i>>30&3,n.icvTop=127&o,n.icvBottom=o>>7&127,n.icvDiag=o>>14&127,n.dgDiag=o>>21&15,n.icvFore=127&l,n.icvBack=l>>7&127,n.fsxButton=l>>14&1,n):n}(e,0,r.fStyle,a),r}},225:{f:function(e,t){return 0===t||e.read_shift(2),1200}},226:{f:Ll},227:{},229:{f:function(e,t){for(var a=[],r=e.read_shift(2);r--;)a.push(oc(e));return a}},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:function(e,t){for(var a=e.l+t,r=e.read_shift(4),n=e.read_shift(4),s=[],i=0;i!=n&&e.l<a;++i)s.push(Gl(e));return s.Count=r,s.Unique=n,s}},253:{f:function(e){var t=rc(e);return t.isst=e.read_shift(4),t}},255:{f:function(e,t){var a={};return a.dsst=e.read_shift(2),e.l+=t-2,a}},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Wl},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Ml},353:{f:Ll},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:function(e,t,a){var r=e.l+t,n=e.read_shift(2),s=e.read_shift(2);if(a.sbcch=s,1025==s||14849==s)return[s,n];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var i=ql(e,s),o=[];r>e.l;)o.push(Yl(e));return[s,n,i,o]}},431:{f:Ml},432:{},433:{},434:{},437:{},438:{f:function(e,t,a){var r=e.l,n="";try{e.l+=4;var s=(a.lastobj||{cmo:[0,0]}).cmo[1];-1==[0,5,7,11,12,14].indexOf(s)?e.l+=6:function(e){var t=e.read_shift(1);e.l++;var a=e.read_shift(2);return e.l+=2,[t,a]}(e);var i=e.read_shift(2);e.read_shift(2),Ul(e);var o=e.read_shift(2);e.l+=o;for(var l=1;l<e.lens.length-1;++l){if(e.l-r!=e.lens[l])throw new Error("TxO: bad continue record");var c=e[e.l];if((n+=ql(e,e.lens[l+1]-e.lens[l]-1)).length>=(c?i:2*i))break}if(n.length!==i&&n.length!==2*i)throw new Error("cchText: "+i+" != "+n.length);return e.l=r+t,{t:n}}catch(Ig){return e.l=r+t,{t:n}}}},439:{f:Ml},440:{f:function(e,t){var a=oc(e);e.l+=16;var r=function(e,t){var a=e.l+t,r=e.read_shift(4);if(2!==r)throw new Error("Unrecognized streamVersion: "+r);var n=e.read_shift(2);e.l+=2;var s,i,o,l,c,u,d="";16&n&&(s=Ql(e,e.l)),128&n&&(i=Ql(e,e.l)),257===(257&n)&&(o=Ql(e,e.l)),1===(257&n)&&(l=Jl(e,e.l)),8&n&&(d=Ql(e,e.l)),32&n&&(c=e.read_shift(16)),64&n&&(u=xl(e)),e.l=a;var f=i||o||l||"";f&&d&&(f+="#"+d),f||(f="#"+d),2&n&&"/"==f.charAt(0)&&"/"!=f.charAt(1)&&(f="file://"+f);var h={Target:f};return c&&(h.guid=c),u&&(h.time=u),s&&(h.Tooltip=s),h}(e,t-24);return[a,r]}},441:{},442:{f:Yl},443:{},444:{f:Ul},445:{},446:{},448:{f:Ll},449:{f:function(e){return e.read_shift(2),e.read_shift(4)},r:2},450:{f:Ll},512:{f:wc},513:{f:Oc},515:{f:function(e,t,a){a.biffguess&&2==a.biff&&(a.biff=5);var r=rc(e),n=Io(e);return r.val=n,r}},516:{f:function(e,t,a){a.biffguess&&2==a.biff&&(a.biff=5),e.l;var r=rc(e);2==a.biff&&e.l++;var n=Yl(e,e.l,a);return r.val=n,r}},517:{f:kc},519:{f:Fc},520:{f:function(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var a=e.read_shift(2);e.l+=4;var r=e.read_shift(1);return e.l+=3,7&r&&(t.level=7&r),32&r&&(t.hidden=!0),64&r&&(t.hpt=a/20),t}},523:{},545:{f:Cc},549:{f:vc},566:{},574:{f:function(e,t,a){return a&&a.biff>=2&&a.biff<5?{}:{RTL:64&e.read_shift(2)}}},638:{f:function(e){var t=e.read_shift(2),a=e.read_shift(2),r=ic(e);return{r:t,c:a,ixfe:r[0],rknum:r[1]}}},659:{},1048:{},1054:{f:function(e,t,a){return[e.read_shift(2),Xl(e,0,a)]}},1084:{},1212:{f:function(e,t,a){var r=cc(e);e.l++;var n=e.read_shift(1);return[Yd(e,t-=8,a),n,r]}},2048:{f:function(e,t){e.read_shift(2);var a=oc(e),r=e.read_shift((t-10)/2,"dbcs-cont");return[a,r=r.replace(kr,"")]}},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:mc},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ll},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:function(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t},r:12},2173:{f:function(e,t){e.l,e.l+=2;var a=e.read_shift(2);e.l+=2;for(var r=e.read_shift(2),n=[];r-- >0;)n.push(rd(e,e.l));return{ixfe:a,ext:n}},r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Ml,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:function(e,t,a){if(!(a.biff<8)){var r=e.read_shift(2),n=e.read_shift(2);return[ql(e,r,a),ql(e,n,a)]}e.l+=t},r:12},2197:{},2198:{f:function(e,t,a){var r=e.l+t;if(124226!==e.read_shift(4))if(a.cellStyles){var n,s=e.slice(e.l);e.l=r;try{n=ts(s,{type:"array"})}catch(Ig){return}var i=Kn(n,"theme/theme/theme1.xml",!0);if(i)return ed(i,a)}else e.l=r},r:12},2199:{},2200:{},2201:{},2202:{f:function(e){return[0!==e.read_shift(4),0!==e.read_shift(4),e.read_shift(4)]},r:12},2203:{f:Ll},2204:{},2205:{},2206:{},2207:{},2211:{f:function(e){var t=function(e){var t=e.read_shift(2),a=e.read_shift(2);return e.l+=8,{type:t,flags:a}}(e);if(2211!=t.type)throw new Error("Invalid Future Record "+t.type);return 0!==e.read_shift(4)}},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Ul},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:function(e,t,a){var r={area:!1};if(5!=a.biff)return e.l+=t,r;var n=e.read_shift(1);return e.l+=3,16&n&&(r.area=!0),r}},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:function(e){for(var t=e.read_shift(2),a=[];t-- >0;)a.push(ac(e));return a}},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:wc},1:{},2:{f:function(e){var t=rc(e);++e.l;var a=e.read_shift(2);return t.t="n",t.val=a,t}},3:{f:function(e){var t=rc(e);++e.l;var a=Io(e);return t.t="n",t.val=a,t}},4:{f:function(e,t,a){a.biffguess&&5==a.biff&&(a.biff=2);var r=rc(e);++e.l;var n=Xl(e,0,a);return r.t="str",r.val=n,r}},5:{f:kc},7:{f:function(e){var t=e.read_shift(1);return 0===t?(e.l++,""):e.read_shift(t,"sbcs-cont")}},8:{},9:{f:mc},11:{},22:{f:Ul},30:{f:bc},31:{},32:{},33:{f:Cc},36:{},37:{f:vc},50:{f:function(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}},62:{},52:{},67:{},68:{f:Ul},69:{},86:{},126:{},127:{f:function(e){var t=e.read_shift(2),a=e.read_shift(2),r=e.read_shift(4),n={fmt:t,env:a,len:r,data:e.slice(e.l,e.l+r)};return e.l+=r,n}},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:function(e,t,a){var r=e.l+t,n=rc(e),s=e.read_shift(2),i=ql(e,s,a);return e.l=r,n.t="str",n.val=i,n}},223:{},234:{},354:{},421:{},518:{f:Xd},521:{f:mc},536:{f:Nc},547:{f:Ec},561:{},579:{},1030:{f:Xd},1033:{f:mc},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function rm(e,t,a,r){var n=t;if(!isNaN(n)){var s=r||(a||[]).length||0,i=e.next(4);i.write_shift(2,n),i.write_shift(2,s),s>0&&Ci(a)&&e.push(a)}}function nm(e,t,a){return e||(e=Vi(7)),e.write_shift(2,t),e.write_shift(2,a),e.write_shift(2,0),e.write_shift(1,0),e}function sm(e,t,a,r){if(null!=t.v)switch(t.t){case"d":case"n":var n="d"==t.t?Cn(Ln(t.v)):t.v;return void(n==(0|n)&&n>=0&&n<65536?rm(e,2,function(e,t,a){var r=Vi(9);return nm(r,e,t),r.write_shift(2,a),r}(a,r,n)):rm(e,3,function(e,t,a){var r=Vi(15);return nm(r,e,t),r.write_shift(8,a,"f"),r}(a,r,n)));case"b":case"e":return void rm(e,5,function(e,t,a,r){var n=Vi(9);return nm(n,e,t),Hl(a,r||"b",n),n}(a,r,t.v,t.t));case"s":case"str":return void rm(e,4,function(e,t,a){var r=Vi(8+2*a.length);return nm(r,e,t),r.write_shift(1,a.length),r.write_shift(a.length,a,"sbcs"),r.l<r.length?r.slice(0,r.l):r}(a,r,(t.v||"").slice(0,255)))}rm(e,1,nm(null,a,r))}function im(e,t){var a=t||{};for(var r=$i(),n=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==a.sheet&&(n=s);if(0==n&&a.sheet&&e.SheetNames[0]!=a.sheet)throw new Error("Sheet not found: "+a.sheet);return rm(r,4==a.biff?1033:3==a.biff?521:9,pc(0,16,a)),function(e,t,a,r){var n,s=Array.isArray(t),i=io(t["!ref"]||"A1"),o="",l=[];if(i.e.c>255||i.e.r>16383){if(r.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),n=so(i)}for(var c=i.s.r;c<=i.e.r;++c){o=Zi(c);for(var u=i.s.c;u<=i.e.c;++u){c===i.s.r&&(l[u]=to(u)),n=l[u]+o;var d=s?(t[c]||[])[u]:t[n];d&&sm(e,d,c,u)}}}(r,e.Sheets[e.SheetNames[n]],0,a),rm(r,10),r.end()}function om(e,t,a){rm(e,49,function(e,t){var a=e.name||"Arial",r=t&&5==t.biff,n=Vi(r?15+a.length:16+2*a.length);return n.write_shift(2,20*(e.sz||12)),n.write_shift(4,0),n.write_shift(2,400),n.write_shift(4,0),n.write_shift(2,0),n.write_shift(1,a.length),r||n.write_shift(1,1),n.write_shift((r?1:2)*a.length,a,r?"sbcs":"utf16le"),n}({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},a))}function lm(e,t){if(t){var a=0;t.forEach(function(t,r){++a<=256&&t&&rm(e,125,function(e,t){var a=Vi(12);a.write_shift(2,t),a.write_shift(2,t),a.write_shift(2,256*e.width),a.write_shift(2,0);var r=0;return e.hidden&&(r|=1),a.write_shift(1,r),r=e.level||0,a.write_shift(1,r),a.write_shift(2,0),a}(mf(r,t),r))})}}function cm(e,t,a,r,n){var s=16+gf(n.cellXfs,t,n);if(null!=t.v||t.bf)if(t.bf)rm(e,6,Kd(t,a,r,0,s));else switch(t.t){case"d":case"n":rm(e,515,function(e,t,a,r){var n=Vi(14);return nc(e,t,r,n),Lo(a,n),n}(a,r,"d"==t.t?Cn(Ln(t.v)):t.v,s));break;case"b":case"e":rm(e,517,function(e,t,a,r,n,s){var i=Vi(8);return nc(e,t,r,i),Hl(a,s,i),i}(a,r,t.v,s,0,t.t));break;case"s":case"str":if(n.bookSST)rm(e,253,function(e,t,a,r){var n=Vi(10);return nc(e,t,r,n),n.write_shift(4,a),n}(a,r,hf(n.Strings,t.v,n.revStrings),s));else rm(e,516,function(e,t,a,r,n){var s=!n||8==n.biff,i=Vi(+s+8+(1+s)*a.length);return nc(e,t,r,i),i.write_shift(2,a.length),s&&i.write_shift(1,1),i.write_shift((1+s)*a.length,a,s?"utf16le":"sbcs"),i}(a,r,(t.v||"").slice(0,255),s,n));break;default:rm(e,513,nc(a,r,s))}else rm(e,513,nc(a,r,s))}function um(e,t,a){var r,n=$i(),s=a.SheetNames[e],i=a.Sheets[s]||{},o=(a||{}).Workbook||{},l=(o.Sheets||[])[e]||{},c=Array.isArray(i),u=8==t.biff,d="",f=[],h=io(i["!ref"]||"A1"),m=u?65536:16384;if(h.e.c>255||h.e.r>=m){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");h.e.c=Math.min(h.e.c,255),h.e.r=Math.min(h.e.c,m-1)}rm(n,2057,pc(0,16,t)),rm(n,13,Bl(1)),rm(n,12,Bl(100)),rm(n,15,zl(!0)),rm(n,17,zl(!1)),rm(n,16,Lo(.001)),rm(n,95,zl(!0)),rm(n,42,zl(!1)),rm(n,43,zl(!1)),rm(n,130,Bl(1)),rm(n,128,function(e){var t=Vi(8);return t.write_shift(4,0),t.write_shift(2,e[0]?e[0]+1:0),t.write_shift(2,e[1]?e[1]+1:0),t}([0,0])),rm(n,131,zl(!1)),rm(n,132,zl(!1)),u&&lm(n,i["!cols"]),rm(n,512,function(e,t){var a=8!=t.biff&&t.biff?2:4,r=Vi(2*a+6);return r.write_shift(a,e.s.r),r.write_shift(a,e.e.r+1),r.write_shift(2,e.s.c),r.write_shift(2,e.e.c+1),r.write_shift(2,0),r}(h,t)),u&&(i["!links"]=[]);for(var p=h.s.r;p<=h.e.r;++p){d=Zi(p);for(var g=h.s.c;g<=h.e.c;++g){p===h.s.r&&(f[g]=to(g)),r=f[g]+d;var v=c?(i[p]||[])[g]:i[r];v&&(cm(n,v,p,g,t),u&&v.l&&i["!links"].push([r,v.l]))}}var y=l.CodeName||l.name||s;return u&&rm(n,574,function(e){var t=Vi(18),a=1718;return e&&e.RTL&&(a|=64),t.write_shift(2,a),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}((o.Views||[])[0])),u&&(i["!merges"]||[]).length&&rm(n,229,function(e){var t=Vi(2+8*e.length);t.write_shift(2,e.length);for(var a=0;a<e.length;++a)lc(e[a],t);return t}(i["!merges"])),u&&function(e,t){for(var a=0;a<t["!links"].length;++a){var r=t["!links"][a];rm(e,440,Ac(r)),r[1].Tooltip&&rm(e,2048,Pc(r))}delete t["!links"]}(n,i),rm(n,442,Kl(y)),u&&function(e,t){var a=Vi(19);a.write_shift(4,2151),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(2,3),a.write_shift(1,1),a.write_shift(4,0),rm(e,2151,a),(a=Vi(39)).write_shift(4,2152),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(2,3),a.write_shift(1,0),a.write_shift(4,0),a.write_shift(2,1),a.write_shift(4,4),a.write_shift(2,0),lc(io(t["!ref"]||"A1"),a),a.write_shift(4,4),rm(e,2152,a)}(n,i),rm(n,10),n.end()}function dm(e,t,a){var r=$i(),n=(e||{}).Workbook||{},s=n.Sheets||[],i=n.WBProps||{},o=8==a.biff,l=5==a.biff;(rm(r,2057,pc(0,5,a)),"xla"==a.bookType&&rm(r,135),rm(r,225,o?Bl(1200):null),rm(r,193,function(e,t){t||(t=Vi(e));for(var a=0;a<e;++a)t.write_shift(1,0);return t}(2)),l&&rm(r,191),l&&rm(r,192),rm(r,226),rm(r,92,function(e,t){var a=!t||8==t.biff,r=Vi(a?112:54);for(r.write_shift(8==t.biff?2:1,7),a&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(a?0:536870912));r.l<r.length;)r.write_shift(1,a?0:32);return r}(0,a)),rm(r,66,Bl(o?1200:1252)),o&&rm(r,353,Bl(0)),o&&rm(r,448),rm(r,317,function(e){for(var t=Vi(2*e),a=0;a<e;++a)t.write_shift(2,a+1);return t}(e.SheetNames.length)),o&&e.vbaraw&&rm(r,211),o&&e.vbaraw)&&rm(r,442,Kl(i.CodeName||"ThisWorkbook"));rm(r,156,Bl(17)),rm(r,25,zl(!1)),rm(r,18,zl(!1)),rm(r,19,Bl(0)),o&&rm(r,431,zl(!1)),o&&rm(r,444,Bl(0)),rm(r,61,function(){var e=Vi(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}()),rm(r,64,zl(!1)),rm(r,141,Bl(0)),rm(r,34,zl("true"==function(e){return e.Workbook&&e.Workbook.WBProps&&xs(e.Workbook.WBProps.date1904)?"true":"false"}(e))),rm(r,14,zl(!0)),o&&rm(r,439,zl(!1)),rm(r,218,Bl(0)),om(r,0,a),function(e,t,a){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)null!=t[n]&&rm(e,1054,yc(n,t[n],a))})}(r,e.SSF,a),function(e,t){for(var a=0;a<16;++a)rm(e,224,xc({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(a){rm(e,224,xc(a,0,t))})}(r,a),o&&rm(r,352,zl(!1));var c,u=r.end(),d=$i();o&&rm(d,140,(c||(c=Vi(4)),c.write_shift(2,1),c.write_shift(2,1),c)),o&&a.Strings&&function(e,t,a,r){var n=r||(a||[]).length||0;if(n<=8224)return rm(e,t,a,n);var s=t;if(!isNaN(s)){for(var i=a.parts||[],o=0,l=0,c=0;c+(i[o]||8224)<=8224;)c+=i[o]||8224,o++;var u=e.next(4);for(u.write_shift(2,s),u.write_shift(2,c),e.push(a.slice(l,l+c)),l+=c;l<n;){for((u=e.next(4)).write_shift(2,60),c=0;c+(i[o]||8224)<=8224;)c+=i[o]||8224,o++;u.write_shift(2,c),e.push(a.slice(l,l+c)),l+=c}}}(d,252,function(e){var t=Vi(8);t.write_shift(4,e.Count),t.write_shift(4,e.Unique);for(var a=[],r=0;r<e.length;++r)a[r]=$l(e[r]);var n=xr([t].concat(a));return n.parts=[t.length].concat(a.map(function(e){return e.length})),n}(a.Strings)),rm(d,10);var f=d.end(),h=$i(),m=0,p=0;for(p=0;p<e.SheetNames.length;++p)m+=(o?12:11)+(o?2:1)*e.SheetNames[p].length;var g=u.length+m+f.length;for(p=0;p<e.SheetNames.length;++p){rm(h,133,gc({pos:g,hs:(s[p]||{}).Hidden||0,dt:0,name:e.SheetNames[p]},a)),g+=t[p].length}var v=h.end();if(m!=v.length)throw new Error("BS8 "+m+" != "+v.length);var y=[];return u.length&&y.push(u),v.length&&y.push(v),f.length&&y.push(f),xr(y)}function fm(e,t){for(var a=0;a<=e.SheetNames.length;++a){var r=e.Sheets[e.SheetNames[a]];if(r&&r["!ref"])no(r["!ref"]).e.c>255&&"undefined"!=typeof console&&console.error&&console.error("Worksheet '"+e.SheetNames[a]+"' extends beyond column IV (255).  Data may be lost.")}var n=t||{};switch(n.biff||2){case 8:case 5:return function(e,t){var a=t||{},r=[];e&&!e.SSF&&(e.SSF=zn(Or)),e&&e.SSF&&(pn(),mn(e.SSF),a.revssf=Nn(e.SSF),a.revssf[e.SSF[65535]]=0,a.ssf=e.SSF),a.Strings=[],a.Strings.Count=0,a.Strings.Unique=0,sp(a),a.cellXfs=[],gf(a.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var n=0;n<e.SheetNames.length;++n)r[r.length]=um(n,a,e);return r.unshift(dm(e,r,a)),xr(r)}(e,t);case 4:case 3:case 2:return im(e,t)}throw new Error("invalid type "+n.bookType+" for BIFF")}function hm(e,t){var a=t||{};var r=a.dense?[]:{},n=(e=e.replace(/<!--.*?-->/g,"")).match(/<table/i);if(!n)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),i=n.index,o=s&&s.index||e.length,l=Vn(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,d=0,f=0,h={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(i=0;i<l.length;++i){var p=l[i].trim(),g=p.slice(0,3).toLowerCase();if("<tr"!=g){if("<td"==g||"<th"==g){var v=p.split(/<\/t[dh]>/i);for(o=0;o<v.length;++o){var y=v[o].trim();if(y.match(/<t[dh]/i)){for(var b=y,w=0;"<"==b.charAt(0)&&(w=b.indexOf(">"))>-1;)b=b.slice(w+1);for(var x=0;x<m.length;++x){var k=m[x];k.s.c==u&&k.s.r<c&&c<=k.e.r&&(u=k.e.c+1,x=-1)}var S=cs(y.slice(0,y.indexOf(">")));f=S.colspan?+S.colspan:1,((d=+S.rowspan)>1||f>1)&&m.push({s:{r:c,c:u},e:{r:c+(d||1)-1,c:u+f-1}});var E=S.t||S["data-t"]||"";if(b.length)if(b=_s(b),h.s.r>c&&(h.s.r=c),h.e.r<c&&(h.e.r=c),h.s.c>u&&(h.s.c=u),h.e.c<u&&(h.e.c=u),b.length){var T={t:"s",v:b};a.raw||!b.trim().length||"s"==E||("TRUE"===b?T={t:"b",v:!0}:"FALSE"===b?T={t:"b",v:!1}:isNaN(Bn(b))?isNaN(Hn(b).getDate())||(T={t:"d",v:Ln(b)},a.cellDates||(T={t:"n",v:Cn(T.v)}),T.z=a.dateNF||Or[14]):T={t:"n",v:Bn(b)}),a.dense?(r[c]||(r[c]=[]),r[c][u]=T):r[ro({r:c,c:u})]=T,u+=f}else u+=f;else u+=f}}}}else{if(++c,a.sheetRows&&a.sheetRows<=c){--c;break}u=0}}return r["!ref"]=so(h),m.length&&(r["!merges"]=m),r}function mm(e,t,a,r){for(var n=e["!merges"]||[],s=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,l=0,c=0;c<n.length;++c)if(!(n[c].s.r>a||n[c].s.c>i)&&!(n[c].e.r<a||n[c].e.c<i)){if(n[c].s.r<a||n[c].s.c<i){o=-1;break}o=n[c].e.r-n[c].s.r+1,l=n[c].e.c-n[c].s.c+1;break}if(!(o<0)){var u=ro({r:a,c:i}),d=r.dense?(e[a]||[])[i]:e[u],f=d&&null!=d.v&&(d.h||bs(d.w||(lo(d),d.w)||""))||"",h={};o>1&&(h.rowspan=o),l>1&&(h.colspan=l),r.editable?f='<span contenteditable="true">'+f+"</span>":d&&(h["data-t"]=d&&d.t||"z",null!=d.v&&(h["data-v"]=d.v),null!=d.z&&(h["data-z"]=d.z),d.l&&"#"!=(d.l.Target||"#").charAt(0)&&(f='<a href="'+d.l.Target+'">'+f+"</a>")),h.id=(r.id||"sjs")+"-"+u,s.push(Ls("td",f,h))}}return"<tr>"+s.join("")+"</tr>"}var pm='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',gm="</body></html>";function vm(e,t,a){return[].join("")+"<table"+(a&&a.id?' id="'+a.id+'"':"")+">"}function ym(e,t){var a=t||{},r=null!=a.header?a.header:pm,n=null!=a.footer?a.footer:gm,s=[r],i=no(e["!ref"]);a.dense=Array.isArray(e),s.push(vm(0,0,a));for(var o=i.s.r;o<=i.e.r;++o)s.push(mm(e,i,o,a));return s.push("</table>"+n),s.join("")}function bm(e,t,a){var r=a||{};var n=0,s=0;if(null!=r.origin)if("number"==typeof r.origin)n=r.origin;else{var i="string"==typeof r.origin?ao(r.origin):r.origin;n=i.r,s=i.c}var o=t.getElementsByTagName("tr"),l=Math.min(r.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:n,c:s}};if(e["!ref"]){var u=no(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),-1==n&&(c.e.r=n=u.e.r+1)}var d=[],f=0,h=e["!rows"]||(e["!rows"]=[]),m=0,p=0,g=0,v=0,y=0,b=0;for(e["!cols"]||(e["!cols"]=[]);m<o.length&&p<l;++m){var w=o[m];if(xm(w)){if(r.display)continue;h[p]={hidden:!0}}var x=w.children;for(g=v=0;g<x.length;++g){var k=x[g];if(!r.display||!xm(k)){var S=k.hasAttribute("data-v")?k.getAttribute("data-v"):k.hasAttribute("v")?k.getAttribute("v"):_s(k.innerHTML),E=k.getAttribute("data-z")||k.getAttribute("z");for(f=0;f<d.length;++f){var T=d[f];T.s.c==v+s&&T.s.r<p+n&&p+n<=T.e.r&&(v=T.e.c+1-s,f=-1)}b=+k.getAttribute("colspan")||1,((y=+k.getAttribute("rowspan")||1)>1||b>1)&&d.push({s:{r:p+n,c:v+s},e:{r:p+n+(y||1)-1,c:v+s+(b||1)-1}});var N={t:"s",v:S},j=k.getAttribute("data-t")||k.getAttribute("t")||"";null!=S&&(0==S.length?N.t=j||"z":r.raw||0==S.trim().length||"s"==j||("TRUE"===S?N={t:"b",v:!0}:"FALSE"===S?N={t:"b",v:!1}:isNaN(Bn(S))?isNaN(Hn(S).getDate())||(N={t:"d",v:Ln(S)},r.cellDates||(N={t:"n",v:Cn(N.v)}),N.z=r.dateNF||Or[14]):N={t:"n",v:Bn(S)})),void 0===N.z&&null!=E&&(N.z=E);var C="",_=k.getElementsByTagName("A");if(_&&_.length)for(var A=0;A<_.length&&(!_[A].hasAttribute("href")||"#"==(C=_[A].getAttribute("href")).charAt(0));++A);C&&"#"!=C.charAt(0)&&(N.l={Target:C}),r.dense?(e[p+n]||(e[p+n]=[]),e[p+n][v+s]=N):e[ro({c:v+s,r:p+n})]=N,c.e.c<v+s&&(c.e.c=v+s),v+=b}}++p}return d.length&&(e["!merges"]=(e["!merges"]||[]).concat(d)),c.e.r=Math.max(c.e.r,p-1+n),e["!ref"]=so(c),p>=l&&(e["!fullref"]=so((c.e.r=o.length-m+p-1+n,c))),e}function wm(e,t){return bm((t||{}).dense?[]:{},e,t)}function xm(e){var t="",a=function(e){return e.ownerDocument.defaultView&&"function"===typeof e.ownerDocument.defaultView.getComputedStyle?e.ownerDocument.defaultView.getComputedStyle:"function"===typeof getComputedStyle?getComputedStyle:null}(e);return a&&(t=a(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),"none"===t}function km(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(e,t){return Array(parseInt(t,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"\t").replace(/<text:line-break\/>/g,"\n");return[hs(t.replace(/<[^>]*>/g,""))]}var Sm={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Em(e,t){var a=t||{};var r,n,s,i,o,l,c=zs(e),u=[],d={name:""},f="",h=0,m={},p=[],g=a.dense?[]:{},v={value:""},y="",b=0,w=[],x=-1,k=-1,S={s:{r:1e6,c:1e7},e:{r:0,c:0}},E=0,T={},N=[],j={},C=[],_=1,A=1,P=[],R={Names:[]},O={},D=["",""],F=[],I={},L="",M=0,z=!1,U=!1,B=0;for(Us.lastIndex=0,c=c.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");o=Us.exec(c);)switch(o[3]=o[3].replace(/_.*$/,"")){case"table":case"\u5de5\u4f5c\u8868":"/"===o[1]?(S.e.c>=S.s.c&&S.e.r>=S.s.r?g["!ref"]=so(S):g["!ref"]="A1:A1",a.sheetRows>0&&a.sheetRows<=S.e.r&&(g["!fullref"]=g["!ref"],S.e.r=a.sheetRows-1,g["!ref"]=so(S)),N.length&&(g["!merges"]=N),C.length&&(g["!rows"]=C),s.name=s["\u540d\u79f0"]||s.name,"undefined"!==typeof JSON&&JSON.stringify(s),p.push(s.name),m[s.name]=g,U=!1):"/"!==o[0].charAt(o[0].length-2)&&(s=cs(o[0],!1),x=k=-1,S.s.r=S.s.c=1e7,S.e.r=S.e.c=0,g=a.dense?[]:{},N=[],C=[],U=!0);break;case"table-row-group":"/"===o[1]?--E:++E;break;case"table-row":case"\u884c":if("/"===o[1]){x+=_,_=1;break}if((i=cs(o[0],!1))["\u884c\u53f7"]?x=i["\u884c\u53f7"]-1:-1==x&&(x=0),(_=+i["number-rows-repeated"]||1)<10)for(B=0;B<_;++B)E>0&&(C[x+B]={level:E});k=-1;break;case"covered-table-cell":"/"!==o[1]&&++k,a.sheetStubs&&(a.dense?(g[x]||(g[x]=[]),g[x][k]={t:"z"}):g[ro({r:x,c:k})]={t:"z"}),y="",w=[];break;case"table-cell":case"\u6570\u636e":if("/"===o[0].charAt(o[0].length-2))++k,v=cs(o[0],!1),A=parseInt(v["number-columns-repeated"]||"1",10),l={t:"z",v:null},v.formula&&0!=a.cellFormula&&(l.f=sf(hs(v.formula))),"string"==(v["\u6570\u636e\u7c7b\u578b"]||v["value-type"])&&(l.t="s",l.v=hs(v["string-value"]||""),a.dense?(g[x]||(g[x]=[]),g[x][k]=l):g[ro({r:x,c:k})]=l),k+=A-1;else if("/"!==o[1]){y="",b=0,w=[],A=1;var W=_?x+_-1:x;if(++k>S.e.c&&(S.e.c=k),k<S.s.c&&(S.s.c=k),x<S.s.r&&(S.s.r=x),W>S.e.r&&(S.e.r=W),F=[],I={},l={t:(v=cs(o[0],!1))["\u6570\u636e\u7c7b\u578b"]||v["value-type"],v:null},a.cellFormula)if(v.formula&&(v.formula=hs(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(j={s:{r:x,c:k},e:{r:x+(parseInt(v["number-matrix-rows-spanned"],10)||0)-1,c:k+(parseInt(v["number-matrix-columns-spanned"],10)||0)-1}},l.F=so(j),P.push([j,l.F])),v.formula)l.f=sf(v.formula);else for(B=0;B<P.length;++B)x>=P[B][0].s.r&&x<=P[B][0].e.r&&k>=P[B][0].s.c&&k<=P[B][0].e.c&&(l.F=P[B][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(j={s:{r:x,c:k},e:{r:x+(parseInt(v["number-rows-spanned"],10)||0)-1,c:k+(parseInt(v["number-columns-spanned"],10)||0)-1}},N.push(j)),v["number-columns-repeated"]&&(A=parseInt(v["number-columns-repeated"],10)),l.t){case"boolean":l.t="b",l.v=xs(v["boolean-value"]);break;case"float":case"percentage":case"currency":l.t="n",l.v=parseFloat(v.value);break;case"date":l.t="d",l.v=Ln(v["date-value"]),a.cellDates||(l.t="n",l.v=Cn(l.v)),l.z="m/d/yy";break;case"time":l.t="n",l.v=On(v["time-value"])/86400,a.cellDates&&(l.t="d",l.v=Rn(l.v)),l.z="HH:MM:SS";break;case"number":l.t="n",l.v=parseFloat(v["\u6570\u636e\u6570\u503c"]);break;default:if("string"!==l.t&&"text"!==l.t&&l.t)throw new Error("Unsupported value type "+l.t);l.t="s",null!=v["string-value"]&&(y=hs(v["string-value"]),w=[])}}else{if(z=!1,"s"===l.t&&(l.v=y||"",w.length&&(l.R=w),z=0==b),O.Target&&(l.l=O),F.length>0&&(l.c=F,F=[]),y&&!1!==a.cellText&&(l.w=y),z&&(l.t="z",delete l.v),(!z||a.sheetStubs)&&!(a.sheetRows&&a.sheetRows<=x))for(var H=0;H<_;++H){if(A=parseInt(v["number-columns-repeated"]||"1",10),a.dense)for(g[x+H]||(g[x+H]=[]),g[x+H][k]=0==H?l:zn(l);--A>0;)g[x+H][k+A]=zn(l);else for(g[ro({r:x+H,c:k})]=l;--A>0;)g[ro({r:x+H,c:k+A})]=zn(l);S.e.c<=k&&(S.e.c=k)}k+=(A=parseInt(v["number-columns-repeated"]||"1",10))-1,A=0,l={},y="",w=[]}O={};break;case"document":case"document-content":case"\u7535\u5b50\u8868\u683c\u6587\u6863":case"spreadsheet":case"\u4e3b\u4f53":case"scripts":case"styles":case"font-face-decls":case"master-styles":if("/"===o[1]){if((r=u.pop())[0]!==o[3])throw"Bad state: "+r}else"/"!==o[0].charAt(o[0].length-2)&&u.push([o[3],!0]);break;case"annotation":if("/"===o[1]){if((r=u.pop())[0]!==o[3])throw"Bad state: "+r;I.t=y,w.length&&(I.R=w),I.a=L,F.push(I)}else"/"!==o[0].charAt(o[0].length-2)&&u.push([o[3],!1]);L="",M=0,y="",b=0,w=[];break;case"creator":"/"===o[1]?L=c.slice(M,o.index):M=o.index+o[0].length;break;case"meta":case"\u5143\u6570\u636e":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if("/"===o[1]){if((r=u.pop())[0]!==o[3])throw"Bad state: "+r}else"/"!==o[0].charAt(o[0].length-2)&&u.push([o[3],!1]);y="",b=0,w=[];break;case"scientific-number":case"currency-symbol":case"currency-style":case"script":case"libraries":case"automatic-styles":case"default-style":case"page-layout":case"style":case"map":case"font-face":case"paragraph-properties":case"table-properties":case"table-column-properties":case"table-row-properties":case"table-cell-properties":case"fraction":case"boolean-style":case"boolean":case"text-style":case"text-content":case"text-properties":case"embedded-text":case"body":case"\u7535\u5b50\u8868\u683c":case"forms":case"table-column":case"table-header-rows":case"table-rows":case"table-column-group":case"table-header-columns":case"table-columns":case"null-date":case"graphic-properties":case"calculation-settings":case"named-expressions":case"label-range":case"label-ranges":case"named-expression":case"sort":case"sort-by":case"sort-groups":case"tab":case"line-break":case"span":case"s":case"date":case"object":case"title":case"\u6807\u9898":case"desc":case"binary-data":case"table-source":case"scenario":case"iteration":case"content-validations":case"content-validation":case"help-message":case"error-message":case"database-ranges":case"filter":case"filter-and":case"filter-or":case"filter-condition":case"list-level-style-bullet":case"list-level-style-number":case"list-level-properties":case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":case"event-listener":case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":case"config-item":case"page-number":case"page-count":case"time":case"cell-range-source":case"detective":case"operation":case"highlighted-range":case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":case"rect":case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":case"properties":case"property":case"table-protection":case"data-pilot-grand-total":case"office-document-common-attrs":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if("/"===o[1]){if(T[d.name]=f,(r=u.pop())[0]!==o[3])throw"Bad state: "+r}else"/"!==o[0].charAt(o[0].length-2)&&(f="",d=cs(o[0],!1),u.push([o[3],!0]));break;case"number":case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(u[u.length-1][0]){case"time-style":case"date-style":n=cs(o[0],!1),f+=Sm[o[3]]["long"===n.style?1:0]}break;case"text":if("/>"===o[0].slice(-2))break;if("/"===o[1])switch(u[u.length-1][0]){case"number-style":case"date-style":case"time-style":f+=c.slice(h,o.index)}else h=o.index+o[0].length;break;case"named-range":D=lf((n=cs(o[0],!1))["cell-range-address"]);var V={Name:n.name,Ref:D[0]+"!"+D[1]};U&&(V.Sheet=p.length),R.Names.push(V);break;case"p":case"\u6587\u672c\u4e32":if(["master-styles"].indexOf(u[u.length-1][0])>-1)break;if("/"!==o[1]||v&&v["string-value"])cs(o[0],!1),b=o.index+o[0].length;else{var G=km(c.slice(b,o.index));y=(y.length>0?y+"\n":"")+G[0]}break;case"database-range":if("/"===o[1])break;try{m[(D=lf(cs(o[0])["target-range-address"]))[0]]["!autofilter"]={ref:D[1]}}catch(Ig){}break;case"a":if("/"!==o[1]){if(!(O=cs(o[0],!1)).href)break;O.Target=hs(O.href),delete O.href,"#"==O.Target.charAt(0)&&O.Target.indexOf(".")>-1?(D=lf(O.Target.slice(1)),O.Target="#"+D[0]+"!"+D[1]):O.Target.match(/^\.\.[\\\/]/)&&(O.Target=O.Target.slice(3))}break;default:switch(o[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"\u8868:":case"\u5b57:":break;default:if(a.WTF)throw new Error(o)}}var $={Sheets:m,SheetNames:p,Workbook:R};return a.bookSheets&&delete $.Sheets,$}function Tm(e,t){t=t||{},qn(e,"META-INF/manifest.xml")&&function(e,t){for(var a,r,n=zs(e);a=Us.exec(n);)switch(a[3]){case"manifest":break;case"file-entry":if("/"==(r=cs(a[0],!1)).path&&"application/vnd.oasis.opendocument.spreadsheet"!==r.type)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw a}}(Xn(e,"META-INF/manifest.xml"),t);var a=Kn(e,"content.xml");if(!a)throw new Error("Missing content.xml in ODS / UOF file");var r=Em(Ns(a),t);return qn(e,"meta.xml")&&(r.Props=cl(Xn(e,"meta.xml"))),r}function Nm(e,t){return Em(e,t)}var jm=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Is({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return rs+t}}(),Cm=function(){var e=function(e){return gs(e).replace(/  +/g,function(e){return'<text:s text:c="'+e.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t="          <table:table-cell />\n",a=function(a,r,n){var s=[];s.push('      <table:table table:name="'+gs(r.SheetNames[n])+'" table:style-name="ta1">\n');var i=0,o=0,l=no(a["!ref"]||"A1"),c=a["!merges"]||[],u=0,d=Array.isArray(a);if(a["!cols"])for(o=0;o<=l.e.c;++o)s.push("        <table:table-column"+(a["!cols"][o]?' table:style-name="co'+a["!cols"][o].ods+'"':"")+"></table:table-column>\n");var f="",h=a["!rows"]||[];for(i=0;i<l.s.r;++i)f=h[i]?' table:style-name="ro'+h[i].ods+'"':"",s.push("        <table:table-row"+f+"></table:table-row>\n");for(;i<=l.e.r;++i){for(f=h[i]?' table:style-name="ro'+h[i].ods+'"':"",s.push("        <table:table-row"+f+">\n"),o=0;o<l.s.c;++o)s.push(t);for(;o<=l.e.c;++o){var m=!1,p={},g="";for(u=0;u!=c.length;++u)if(!(c[u].s.c>o)&&!(c[u].s.r>i)&&!(c[u].e.c<o)&&!(c[u].e.r<i)){c[u].s.c==o&&c[u].s.r==i||(m=!0),p["table:number-columns-spanned"]=c[u].e.c-c[u].s.c+1,p["table:number-rows-spanned"]=c[u].e.r-c[u].s.r+1;break}if(m)s.push("          <table:covered-table-cell/>\n");else{var v=ro({r:i,c:o}),y=d?(a[i]||[])[o]:a[v];if(y&&y.f&&(p["table:formula"]=gs(of(y.f)),y.F&&y.F.slice(0,v.length)==v)){var b=no(y.F);p["table:number-matrix-columns-spanned"]=b.e.c-b.s.c+1,p["table:number-matrix-rows-spanned"]=b.e.r-b.s.r+1}if(y){switch(y.t){case"b":g=y.v?"TRUE":"FALSE",p["office:value-type"]="boolean",p["office:boolean-value"]=y.v?"true":"false";break;case"n":g=y.w||String(y.v||0),p["office:value-type"]="float",p["office:value"]=y.v||0;break;case"s":case"str":g=null==y.v?"":y.v,p["office:value-type"]="string";break;case"d":g=y.w||Ln(y.v).toISOString(),p["office:value-type"]="date",p["office:date-value"]=Ln(y.v).toISOString(),p["table:style-name"]="ce1";break;default:s.push(t);continue}var w=e(g);if(y.l&&y.l.Target){var x=y.l.Target;"#"==(x="#"==x.charAt(0)?"#"+cf(x.slice(1)):x).charAt(0)||x.match(/^\w+:/)||(x="../"+x),w=Ls("text:a",w,{"xlink:href":x.replace(/&/g,"&amp;")})}s.push("          "+Ls("table:table-cell",Ls("text:p",w,{}),p)+"\n")}else s.push(t)}}s.push("        </table:table-row>\n")}return s.push("      </table:table>\n"),s.join("")};return function(e,t){var r=[rs],n=Is({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),s=Is({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});"fods"==t.bookType?(r.push("<office:document"+n+s+">\n"),r.push(il().replace(/office:document-meta/g,"office:meta"))):r.push("<office:document-content"+n+">\n"),function(e,t){e.push(" <office:automatic-styles>\n"),e.push('  <number:date-style style:name="N37" number:automatic-order="true">\n'),e.push('   <number:month number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push('   <number:day number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push("   <number:year/>\n"),e.push("  </number:date-style>\n");var a=0;t.SheetNames.map(function(e){return t.Sheets[e]}).forEach(function(t){if(t&&t["!cols"])for(var r=0;r<t["!cols"].length;++r)if(t["!cols"][r]){var n=t["!cols"][r];if(null==n.width&&null==n.wpx&&null==n.wch)continue;Eu(n),n.ods=a;var s=t["!cols"][r].wpx+"px";e.push('  <style:style style:name="co'+a+'" style:family="table-column">\n'),e.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+s+'"/>\n'),e.push("  </style:style>\n"),++a}});var r=0;t.SheetNames.map(function(e){return t.Sheets[e]}).forEach(function(t){if(t&&t["!rows"])for(var a=0;a<t["!rows"].length;++a)if(t["!rows"][a]){t["!rows"][a].ods=r;var n=t["!rows"][a].hpx+"px";e.push('  <style:style style:name="ro'+r+'" style:family="table-row">\n'),e.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+n+'"/>\n'),e.push("  </style:style>\n"),++r}}),e.push('  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">\n'),e.push('   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>\n'),e.push("  </style:style>\n"),e.push('  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>\n'),e.push(" </office:automatic-styles>\n")}(r,e),r.push("  <office:body>\n"),r.push("    <office:spreadsheet>\n");for(var i=0;i!=e.SheetNames.length;++i)r.push(a(e.Sheets[e.SheetNames[i]],e,i));return r.push("    </office:spreadsheet>\n"),r.push("  </office:body>\n"),"fods"==t.bookType?r.push("</office:document>"):r.push("</office:document-content>"),r.join("")}}();function _m(e,t){if("fods"==t.bookType)return Cm(e,t);var a=es(),r="",n=[],s=[];return Zn(a,r="mimetype","application/vnd.oasis.opendocument.spreadsheet"),Zn(a,r="content.xml",Cm(e,t)),n.push([r,"text/xml"]),s.push([r,"ContentFile"]),Zn(a,r="styles.xml",jm(e,t)),n.push([r,"text/xml"]),s.push([r,"StylesFile"]),Zn(a,r="meta.xml",rs+il()),n.push([r,"text/xml"]),s.push([r,"MetadataFile"]),Zn(a,r="manifest.rdf",function(e){var t=[rs];t.push('<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n');for(var a=0;a!=e.length;++a)t.push(nl(e[a][0],e[a][1])),t.push(sl("",e[a][0]));return t.push(nl("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}(s)),n.push([r,"application/rdf+xml"]),Zn(a,r="META-INF/manifest.xml",function(e){var t=[rs];t.push('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">\n'),t.push('  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>\n');for(var a=0;a<e.length;++a)t.push('  <manifest:file-entry manifest:full-path="'+e[a][0]+'" manifest:media-type="'+e[a][1]+'"/>\n');return t.push("</manifest:manifest>"),t.join("")}(n)),a}function Am(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Pm(e){return"undefined"!=typeof TextDecoder?(new TextDecoder).decode(e):Ns(br(e))}function Rm(e){return"undefined"!=typeof TextEncoder?(new TextEncoder).encode(e):vr(js(e))}function Om(e){var t=e.reduce(function(e,t){return e+t.length},0),a=new Uint8Array(t),r=0;return e.forEach(function(e){a.set(e,r),r+=e.length}),a}function Dm(e){return 16843009*((e=(858993459&(e-=e>>1&1431655765))+(e>>2&858993459))+(e>>4)&252645135)>>>24}function Fm(e,t){var a=t?t[0]:0,r=127&e[a];e:if(e[a++]>=128){if(r|=(127&e[a])<<7,e[a++]<128)break e;if(r|=(127&e[a])<<14,e[a++]<128)break e;if(r|=(127&e[a])<<21,e[a++]<128)break e;if(r+=(127&e[a])*Math.pow(2,28),++a,e[a++]<128)break e;if(r+=(127&e[a])*Math.pow(2,35),++a,e[a++]<128)break e;if(r+=(127&e[a])*Math.pow(2,42),++a,e[a++]<128)break e}return t&&(t[0]=a),r}function Im(e){var t=new Uint8Array(7);t[0]=127&e;var a=1;e:if(e>127){if(t[a-1]|=128,t[a]=e>>7&127,++a,e<=16383)break e;if(t[a-1]|=128,t[a]=e>>14&127,++a,e<=2097151)break e;if(t[a-1]|=128,t[a]=e>>21&127,++a,e<=268435455)break e;if(t[a-1]|=128,t[a]=e/256>>>21&127,++a,e<=34359738367)break e;if(t[a-1]|=128,t[a]=e/65536>>>21&127,++a,e<=4398046511103)break e;t[a-1]|=128,t[a]=e/16777216>>>21&127,++a}return t.slice(0,a)}function Lm(e){var t=0,a=127&e[t];e:if(e[t++]>=128){if(a|=(127&e[t])<<7,e[t++]<128)break e;if(a|=(127&e[t])<<14,e[t++]<128)break e;if(a|=(127&e[t])<<21,e[t++]<128)break e;a|=(127&e[t])<<28}return a}function Mm(e){for(var t=[],a=[0];a[0]<e.length;){var r,n=a[0],s=Fm(e,a),i=7&s,o=0;if(0==(s=Math.floor(s/8)))break;switch(i){case 0:for(var l=a[0];e[a[0]++]>=128;);r=e.slice(l,a[0]);break;case 5:o=4,r=e.slice(a[0],a[0]+o),a[0]+=o;break;case 1:o=8,r=e.slice(a[0],a[0]+o),a[0]+=o;break;case 2:o=Fm(e,a),r=e.slice(a[0],a[0]+o),a[0]+=o;break;default:throw new Error("PB Type ".concat(i," for Field ").concat(s," at offset ").concat(n))}var c={data:r,type:i};null==t[s]?t[s]=[c]:t[s].push(c)}return t}function zm(e){var t=[];return e.forEach(function(e,a){e.forEach(function(e){e.data&&(t.push(Im(8*a+e.type)),2==e.type&&t.push(Im(e.data.length)),t.push(e.data))})}),Om(t)}function Um(e,t){return(null==e?void 0:e.map(function(e){return t(e.data)}))||[]}function Bm(e){for(var t,a=[],r=[0];r[0]<e.length;){var n=Fm(e,r),s=Mm(e.slice(r[0],r[0]+n));r[0]+=n;var i={id:Lm(s[1][0].data),messages:[]};s[2].forEach(function(t){var a=Mm(t.data),n=Lm(a[3][0].data);i.messages.push({meta:a,data:e.slice(r[0],r[0]+n)}),r[0]+=n}),(null==(t=s[3])?void 0:t[0])&&(i.merge=Lm(s[3][0].data)>>>0>0),a.push(i)}return a}function Wm(e){var t=[];return e.forEach(function(e){var a=[];a[1]=[{data:Im(e.id),type:0}],a[2]=[],null!=e.merge&&(a[3]=[{data:Im(+!!e.merge),type:0}]);var r=[];e.messages.forEach(function(e){r.push(e.data),e.meta[3]=[{type:0,data:Im(e.data.length)}],a[2].push({data:zm(e.meta),type:2})});var n=zm(a);t.push(Im(n.length)),t.push(n),r.forEach(function(e){return t.push(e)})}),Om(t)}function Hm(e,t){if(0!=e)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var a=[0],r=Fm(t,a),n=[];a[0]<t.length;){var s=3&t[a[0]];if(0!=s){var i=0,o=0;if(1==s?(o=4+(t[a[0]]>>2&7),i=(224&t[a[0]++])<<3,i|=t[a[0]++]):(o=1+(t[a[0]++]>>2),2==s?(i=t[a[0]]|t[a[0]+1]<<8,a[0]+=2):(i=(t[a[0]]|t[a[0]+1]<<8|t[a[0]+2]<<16|t[a[0]+3]<<24)>>>0,a[0]+=4)),n=[Om(n)],0==i)throw new Error("Invalid offset 0");if(i>n[0].length)throw new Error("Invalid offset beyond length");if(o>=i)for(n.push(n[0].slice(-i)),o-=i;o>=n[n.length-1].length;)n.push(n[n.length-1]),o-=n[n.length-1].length;n.push(n[0].slice(-i,-i+o))}else{var l=t[a[0]++]>>2;if(l<60)++l;else{var c=l-59;l=t[a[0]],c>1&&(l|=t[a[0]+1]<<8),c>2&&(l|=t[a[0]+2]<<16),c>3&&(l|=t[a[0]+3]<<24),l>>>=0,l++,a[0]+=c}n.push(t.slice(a[0],a[0]+l)),a[0]+=l}}var u=Om(n);if(u.length!=r)throw new Error("Unexpected length: ".concat(u.length," != ").concat(r));return u}function Vm(e){for(var t=[],a=0;a<e.length;){var r=e[a++],n=e[a]|e[a+1]<<8|e[a+2]<<16;a+=3,t.push(Hm(r,e.slice(a,a+n))),a+=n}if(a!==e.length)throw new Error("data is not a valid framed stream!");return Om(t)}function Gm(e){for(var t=[],a=0;a<e.length;){var r=Math.min(e.length-a,268435455),n=new Uint8Array(4);t.push(n);var s=Im(r),i=s.length;t.push(s),r<=60?(i++,t.push(new Uint8Array([r-1<<2]))):r<=256?(i+=2,t.push(new Uint8Array([240,r-1&255]))):r<=65536?(i+=3,t.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(i+=4,t.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(i+=5,t.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),t.push(e.slice(a,a+r)),i+=r,n[0]=0,n[1]=255&i,n[2]=i>>8&255,n[3]=i>>16&255,a+=r}return Om(t)}function $m(e,t,a){var r,n=Am(e),s=n.getUint32(8,!0),i=12,o=-1,l=-1,c=NaN,u=NaN,d=new Date(2001,0,1);switch(1&s&&(c=function(e,t){for(var a=(127&e[t+15])<<7|e[t+14]>>1,r=1&e[t+14],n=t+13;n>=t;--n)r=256*r+e[n];return(128&e[t+15]?-r:r)*Math.pow(10,a-6176)}(e,i),i+=16),2&s&&(u=n.getFloat64(i,!0),i+=8),4&s&&(d.setTime(d.getTime()+1e3*n.getFloat64(i,!0)),i+=8),8&s&&(l=n.getUint32(i,!0),i+=4),16&s&&(o=n.getUint32(i,!0),i+=4),e[1]){case 0:break;case 2:case 10:r={t:"n",v:c};break;case 3:r={t:"s",v:t[l]};break;case 5:r={t:"d",v:d};break;case 6:r={t:"b",v:u>0};break;case 7:r={t:"n",v:u/86400};break;case 8:r={t:"e",v:0};break;case 9:if(!(o>-1))throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&s," : ").concat(e.slice(0,4)));r={t:"s",v:a[o]};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&s," : ").concat(e.slice(0,4)))}return r}function qm(e,t){var a=new Uint8Array(32),r=Am(a),n=12,s=0;switch(a[0]=5,e.t){case"n":a[1]=2,function(e,t,a){var r=Math.floor(0==a?0:Math.LOG10E*Math.log(Math.abs(a)))+6176-20,n=a/Math.pow(10,r-6176);e[t+15]|=r>>7,e[t+14]|=(127&r)<<1;for(var s=0;n>=1;++s,n/=256)e[t+s]=255&n;e[t+15]|=a>=0?0:128}(a,n,e.v),s|=1,n+=16;break;case"b":a[1]=6,r.setFloat64(n,e.v?1:0,!0),s|=2,n+=8;break;case"s":if(-1==t.indexOf(e.v))throw new Error("Value ".concat(e.v," missing from SST!"));a[1]=3,r.setUint32(n,t.indexOf(e.v),!0),s|=8,n+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(8,s,!0),a.slice(0,n)}function Ym(e,t){var a=new Uint8Array(32),r=Am(a),n=12,s=0;switch(a[0]=3,e.t){case"n":a[2]=2,r.setFloat64(n,e.v,!0),s|=32,n+=8;break;case"b":a[2]=6,r.setFloat64(n,e.v?1:0,!0),s|=32,n+=8;break;case"s":if(-1==t.indexOf(e.v))throw new Error("Value ".concat(e.v," missing from SST!"));a[2]=3,r.setUint32(n,t.indexOf(e.v),!0),s|=16,n+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(4,s,!0),a.slice(0,n)}function Xm(e,t,a){switch(e[0]){case 0:case 1:case 2:case 3:return function(e,t,a,r){var n,s=Am(e),i=s.getUint32(4,!0),o=(r>1?12:8)+4*Dm(i&(r>1?3470:398)),l=-1,c=-1,u=NaN,d=new Date(2001,0,1);switch(512&i&&(l=s.getUint32(o,!0),o+=4),o+=4*Dm(i&(r>1?12288:4096)),16&i&&(c=s.getUint32(o,!0),o+=4),32&i&&(u=s.getFloat64(o,!0),o+=8),64&i&&(d.setTime(d.getTime()+1e3*s.getFloat64(o,!0)),o+=8),e[2]){case 0:break;case 2:n={t:"n",v:u};break;case 3:n={t:"s",v:t[c]};break;case 5:n={t:"d",v:d};break;case 6:n={t:"b",v:u>0};break;case 7:n={t:"n",v:u/86400};break;case 8:n={t:"e",v:0};break;case 9:if(l>-1)n={t:"s",v:a[l]};else if(c>-1)n={t:"s",v:t[c]};else{if(isNaN(u))throw new Error("Unsupported cell type ".concat(e.slice(0,4)));n={t:"n",v:u}}break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return n}(e,t,a,e[0]);case 5:return $m(e,t,a);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Km(e){return Fm(Mm(e)[1][0].data)}function Jm(e,t){var a=Mm(t.data),r=Lm(a[1][0].data),n=a[3],s=[];return(n||[]).forEach(function(t){var a=Mm(t.data),n=Lm(a[1][0].data)>>>0;switch(r){case 1:s[n]=Pm(a[3][0].data);break;case 8:var i=Mm(e[Km(a[9][0].data)][0].data),o=e[Km(i[1][0].data)][0],l=Lm(o.meta[1][0].data);if(2001!=l)throw new Error("2000 unexpected reference to ".concat(l));var c=Mm(o.data);s[n]=c[3].map(function(e){return Pm(e.data)}).join("")}}),s}function Qm(e,t){var a,r=Mm(t.data),n=(null==(a=null==r?void 0:r[7])?void 0:a[0])?Lm(r[7][0].data)>>>0>0?1:0:-1,s=Um(r[5],function(e){return function(e,t){var a,r,n,s,i,o,l,c,u,d,f,h,m,p,g,v,y=Mm(e),b=Lm(y[1][0].data)>>>0,w=Lm(y[2][0].data)>>>0,x=(null==(r=null==(a=y[8])?void 0:a[0])?void 0:r.data)&&Lm(y[8][0].data)>0||!1;if((null==(s=null==(n=y[7])?void 0:n[0])?void 0:s.data)&&0!=t)g=null==(o=null==(i=y[7])?void 0:i[0])?void 0:o.data,v=null==(c=null==(l=y[6])?void 0:l[0])?void 0:c.data;else{if(!(null==(d=null==(u=y[4])?void 0:u[0])?void 0:d.data)||1==t)throw"NUMBERS Tile missing ".concat(t," cell storage");g=null==(h=null==(f=y[4])?void 0:f[0])?void 0:h.data,v=null==(p=null==(m=y[3])?void 0:m[0])?void 0:p.data}for(var k=x?4:1,S=Am(g),E=[],T=0;T<g.length/2;++T){var N=S.getUint16(2*T,!0);N<65535&&E.push([T,N])}if(E.length!=w)throw"Expected ".concat(w," cells, found ").concat(E.length);var j=[];for(T=0;T<E.length-1;++T)j[E[T][0]]=v.subarray(E[T][1]*k,E[T+1][1]*k);return E.length>=1&&(j[E[E.length-1][0]]=v.subarray(E[E.length-1][1]*k)),{R:b,cells:j}}(e,n)});return{nrows:Lm(r[4][0].data)>>>0,data:s.reduce(function(e,t){return e[t.R]||(e[t.R]=[]),t.cells.forEach(function(a,r){if(e[t.R][r])throw new Error("Duplicate cell r=".concat(t.R," c=").concat(r));e[t.R][r]=a}),e},[])}}function Zm(e,t){var a={"!ref":"A1"},r=e[Km(Mm(t.data)[2][0].data)],n=Lm(r[0].meta[1][0].data);if(6001!=n)throw new Error("6000 unexpected reference to ".concat(n));return function(e,t,a){var r,n=Mm(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Lm(n[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(n[6][0].data));if(s.e.c=(Lm(n[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(n[7][0].data));a["!ref"]=so(s);var i=Mm(n[4][0].data),o=Jm(e,e[Km(i[4][0].data)][0]),l=(null==(r=i[17])?void 0:r[0])?Jm(e,e[Km(i[17][0].data)][0]):[],c=Mm(i[3][0].data),u=0;c[1].forEach(function(t){var r=Mm(t.data),n=e[Km(r[2][0].data)][0],s=Lm(n.meta[1][0].data);if(6002!=s)throw new Error("6001 unexpected reference to ".concat(s));var i=Qm(0,n);i.data.forEach(function(e,t){e.forEach(function(e,r){var n=ro({r:u+t,c:r}),s=Xm(e,o,l);s&&(a[n]=s)})}),u+=i.nrows})}(e,r[0],a),a}function ep(e,t){var a={SheetNames:[],Sheets:{}};if(Um(Mm(t.data)[1],Km).forEach(function(t){e[t].forEach(function(t){if(2==Lm(t.meta[1][0].data)){var r=function(e,t){var a,r=Mm(t.data),n={name:(null==(a=r[1])?void 0:a[0])?Pm(r[1][0].data):"",sheets:[]};return Um(r[2],Km).forEach(function(t){e[t].forEach(function(t){6e3==Lm(t.meta[1][0].data)&&n.sheets.push(Zm(e,t))})}),n}(e,t);r.sheets.forEach(function(e,t){Pp(a,e,0==t?r.name:r.name+"_"+t,!0)})}})}),0==a.SheetNames.length)throw new Error("Empty NUMBERS file");return a}function tp(e){var t,a,r,n,s={},i=[];if(e.FullPaths.forEach(function(e){if(e.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(e){if(e.name.match(/\.iwa$/)){var t,a;try{t=Vm(e.content)}catch(Ig){return console.log("?? "+e.content.length+" "+(Ig.message||Ig))}try{a=Bm(t)}catch(Ig){return console.log("## "+(Ig.message||Ig))}a.forEach(function(e){s[e.id]=e.messages,i.push(e.id)})}}),!i.length)throw new Error("File has no messages");var o=(null==(n=null==(r=null==(a=null==(t=null==s?void 0:s[1])?void 0:t[0])?void 0:a.meta)?void 0:r[1])?void 0:n[0].data)&&1==Lm(s[1][0].meta[1][0].data)&&s[1][0];if(o||i.forEach(function(e){s[e].forEach(function(e){if(1==Lm(e.meta[1][0].data)>>>0){if(o)throw new Error("Document has multiple roots");o=e}})}),!o)throw new Error("Cannot find Document root");return ep(s,o)}function ap(e,t,a){var r,n,s,i;if(!(null==(r=e[6])?void 0:r[0])||!(null==(n=e[7])?void 0:n[0]))throw"Mutation only works on post-BNC storages!";if((null==(i=null==(s=e[8])?void 0:s[0])?void 0:i.data)&&Lm(e[8][0].data)>0||!1)throw"Math only works with normal offsets";for(var o=0,l=Am(e[7][0].data),c=0,u=[],d=Am(e[4][0].data),f=0,h=[],m=0;m<t.length;++m)if(null!=t[m]){var p,g;switch(l.setUint16(2*m,c,!0),d.setUint16(2*m,f,!0),typeof t[m]){case"string":p=qm({t:"s",v:t[m]},a),g=Ym({t:"s",v:t[m]},a);break;case"number":p=qm({t:"n",v:t[m]},a),g=Ym({t:"n",v:t[m]},a);break;case"boolean":p=qm({t:"b",v:t[m]},a),g=Ym({t:"b",v:t[m]},a);break;default:throw new Error("Unsupported value "+t[m])}u.push(p),c+=p.length,h.push(g),f+=g.length,++o}else l.setUint16(2*m,65535,!0),d.setUint16(2*m,65535);for(e[2][0].data=Im(o);m<e[7][0].data.length/2;++m)l.setUint16(2*m,65535,!0),d.setUint16(2*m,65535,!0);return e[6][0].data=Om(u),e[3][0].data=Om(h),o}function rp(e){return function(t){for(var a=0;a!=e.length;++a){var r=e[a];void 0===t[r[0]]&&(t[r[0]]=r[1]),"n"===r[2]&&(t[r[0]]=Number(t[r[0]]))}}}function np(e){rp([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function sp(e){rp([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function ip(e,t,a,r,n,s,i,o,l,c,u,d){try{s[r]=tl(Kn(e,a,!0),t);var f,h=Xn(e,t);switch(o){case"sheet":f=gh(h,t,n,l,s[r],c,u,d);break;case"chart":if(!(f=vh(h,t,n,l,s[r],c))||!f["!drawel"])break;var m=as(f["!drawel"].Target,t),p=el(m),g=function(e,t){if(!e)return"??";var a=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][a].Target}(Kn(e,m,!0),tl(Kn(e,p,!0),m)),v=as(g,m),y=el(v);f=Qf(Kn(e,v,!0),0,0,tl(Kn(e,y,!0),v),0,f);break;case"macro":w=t,s[r],w.slice(-4),f={"!type":"macro"};break;case"dialog":f=function(e,t){return t.slice(-4),{"!type":"dialog"}}(0,t,0,0,s[r]);break;default:throw new Error("Unrecognized sheet type "+o)}i[r]=f;var b=[];s&&s[r]&&Sn(s[r]).forEach(function(a){var n="";if(s[r][a].Type==Zo.CMNT){n=as(s[r][a].Target,t);var i=wh(Xn(e,n,!0),n,l);if(!i||!i.length)return;cd(f,i,!1)}s[r][a].Type==Zo.TCMNT&&(n=as(s[r][a].Target,t),b=b.concat(function(e,t){var a=[],r=!1,n={},s=0;return e.replace(is,function(i,o){var l=cs(i);switch(us(l[0])){case"<?xml":case"<ThreadedComments":case"</ThreadedComments>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<threadedComment":n={author:l.personId,guid:l.id,ref:l.ref,T:1};break;case"</threadedComment>":null!=n.t&&a.push(n);break;case"<text>":case"<text":s=o+i.length;break;case"</text>":n.t=e.slice(s,o).replace(/\r\n/g,"\n").replace(/\r/g,"\n");break;case"<mentions":case"<mentions>":case"<ext":r=!0;break;case"</mentions>":case"</ext>":r=!1;break;default:if(!r&&t.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return i}),a}(Xn(e,n,!0),l)))}),b&&b.length&&cd(f,b,!0,l.people||[])}catch(Ig){if(l.WTF)throw Ig}var w}function op(e){return"/"==e.charAt(0)?e.slice(1):e}function lp(e,t){if(pn(),np(t=t||{}),qn(e,"META-INF/manifest.xml"))return Tm(e,t);if(qn(e,"objectdata.xml"))return Tm(e,t);if(qn(e,"Index/Document.iwa")){if("undefined"==typeof Uint8Array)throw new Error("NUMBERS file parsing requires Uint8Array support");if(e.FileIndex)return tp(e);var a=bn.utils.cfb_new();return Qn(e).forEach(function(t){Zn(a,t,Jn(e,t))}),tp(a)}if(!qn(e,"[Content_Types].xml")){if(qn(e,"index.xml.gz"))throw new Error("Unsupported NUMBERS 08 file");if(qn(e,"index.xml"))throw new Error("Unsupported NUMBERS 09 file");throw new Error("Unsupported ZIP file")}var r,n,s=Qn(e),i=function(e){var t={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};if(!e||!e.match)return t;var a={};if((e.match(is)||[]).forEach(function(e){var r=cs(e);switch(r[0].replace(os,"<")){case"<?xml":break;case"<Types":t.xmlns=r["xmlns"+(r[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":a[r.Extension]=r.ContentType;break;case"<Override":void 0!==t[Ko[r.ContentType]]&&t[Ko[r.ContentType]].push(r.PartName)}}),t.xmlns!==Vs)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=a,delete t.calcchains,t}(Kn(e,"[Content_Types].xml")),o=!1;if(0===i.workbooks.length&&Xn(e,n="xl/workbook.xml",!0)&&i.workbooks.push(n),0===i.workbooks.length){if(!Xn(e,n="xl/workbook.bin",!0))throw new Error("Could not find workbook");i.workbooks.push(n),o=!0}"bin"==i.workbooks[0].slice(-3)&&(o=!0);var l={},c={};if(!t.bookSheets&&!t.bookProps){if(uf=[],i.sst)try{uf=bh(Xn(e,op(i.sst)),i.sst,t)}catch(Ig){if(t.WTF)throw Ig}t.cellStyles&&i.themes.length&&(l=function(e,t,a){return ed(e,a)}(Kn(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],t)),i.style&&(c=yh(Xn(e,op(i.style)),i.style,l,t))}i.links.map(function(a){try{tl(Kn(e,el(op(a))),a);return kh(Xn(e,op(a)),0,a,t)}catch(Ig){}});var u=ph(Xn(e,op(i.workbooks[0])),i.workbooks[0],t),d={},f="";i.coreprops.length&&((f=Xn(e,op(i.coreprops[0]),!0))&&(d=cl(f)),0!==i.extprops.length&&(f=Xn(e,op(i.extprops[0]),!0))&&function(e,t,a){var r={};t||(t={}),e=Ns(e),fl.forEach(function(a){var n=(e.match(Cs(a[0]))||[])[1];switch(a[2]){case"string":n&&(t[a[1]]=hs(n));break;case"bool":t[a[1]]="true"===n;break;case"raw":var s=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));s&&s.length>0&&(r[a[1]]=s[1])}}),r.HeadingPairs&&r.TitlesOfParts&&ml(r.HeadingPairs,r.TitlesOfParts,t,a)}(f,d,t));var h={};t.bookSheets&&!t.bookProps||0!==i.custprops.length&&(f=Kn(e,op(i.custprops[0]),!0))&&(h=function(e,t){var a={},r="",n=e.match(gl);if(n)for(var s=0;s!=n.length;++s){var i=n[s],o=cs(i);switch(o[0]){case"<?xml":case"<Properties":break;case"<property":r=hs(o.name);break;case"</property>":r=null;break;default:if(0===i.indexOf("<vt:")){var l=i.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":case"cy":case"error":a[r]=hs(u);break;case"bool":a[r]=xs(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":a[r]=parseInt(u,10);break;case"r4":case"r8":case"decimal":a[r]=parseFloat(u);break;case"filetime":case"date":a[r]=Ln(u);break;default:if("/"==c.slice(-1))break;t.WTF&&"undefined"!==typeof console&&console.warn("Unexpected",i,c,l)}}else if("</"===i.slice(0,2));else if(t.WTF)throw new Error(i)}}return a}(f,t));var m={};if((t.bookSheets||t.bookProps)&&(u.Sheets?r=u.Sheets.map(function(e){return e.name}):d.Worksheets&&d.SheetNames.length>0&&(r=d.SheetNames),t.bookProps&&(m.Props=d,m.Custprops=h),t.bookSheets&&"undefined"!==typeof r&&(m.SheetNames=r),t.bookSheets?m.SheetNames:t.bookProps))return m;r={};var p={};t.bookDeps&&i.calcchain&&(p=xh(Xn(e,op(i.calcchain)),i.calcchain));var g,v,y=0,b={},w=u.Sheets;d.Worksheets=w.length,d.SheetNames=[];for(var x=0;x!=w.length;++x)d.SheetNames[x]=w[x].name;var k=o?"bin":"xml",S=i.workbooks[0].lastIndexOf("/"),E=(i.workbooks[0].slice(0,S+1)+"_rels/"+i.workbooks[0].slice(S+1)+".rels").replace(/^\//,"");qn(e,E)||(E="xl/_rels/workbook."+k+".rels");var T=tl(Kn(e,E,!0),E.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(t.xlmeta=Sh(Xn(e,op(i.metadata[0])),i.metadata[0],t)),(i.people||[]).length>=1&&(t.people=function(e,t){var a=[],r=!1;return e.replace(is,function(e){var n=cs(e);switch(us(n[0])){case"<?xml":case"<personList":case"</personList>":case"</person>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<person":a.push({name:n.displayname,id:n.id});break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&t.WTF)throw new Error("unrecognized "+n[0]+" in threaded comments")}return e}),a}(Xn(e,op(i.people[0])),t)),T&&(T=function(e,t){if(!e)return 0;try{e=t.map(function(t){return t.id||(t.id=t.strRelID),[t.name,e["!id"][t.id].Target,(a=e["!id"][t.id].Type,Zo.WS.indexOf(a)>-1?"sheet":Zo.CS&&a==Zo.CS?"chart":Zo.DS&&a==Zo.DS?"dialog":Zo.MS&&a==Zo.MS?"macro":a&&a.length?a:"sheet")];var a})}catch(Ig){return null}return e&&0!==e.length?e:null}(T,u.Sheets));var N=Xn(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(y=0;y!=d.Worksheets;++y){var j="sheet";if(T&&T[y]?(g="xl/"+T[y][1].replace(/[\/]?xl\//,""),qn(e,g)||(g=T[y][1]),qn(e,g)||(g=E.replace(/_rels\/.*$/,"")+T[y][1]),j=T[y][2]):g=(g="xl/worksheets/sheet"+(y+1-N)+"."+k).replace(/sheet0\./,"sheet."),v=g.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&null!=t.sheets)switch(typeof t.sheets){case"number":if(y!=t.sheets)continue e;break;case"string":if(d.SheetNames[y].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var C=!1,_=0;_!=t.sheets.length;++_)"number"==typeof t.sheets[_]&&t.sheets[_]==y&&(C=1),"string"==typeof t.sheets[_]&&t.sheets[_].toLowerCase()==d.SheetNames[y].toLowerCase()&&(C=1);if(!C)continue e}}ip(e,g,v,d.SheetNames[y],y,b,r,j,t,u,l,c)}return m={Directory:i,Workbook:u,Props:d,Custprops:h,Deps:p,Sheets:r,SheetNames:d.SheetNames,Strings:uf,Styles:c,Themes:l,SSF:zn(Or)},t&&t.bookFiles&&(e.files?(m.keys=s,m.files=e.files):(m.keys=[],m.files={},e.FullPaths.forEach(function(t,a){t=t.replace(/^Root Entry[\/]/,""),m.keys.push(t),m.files[t]=e.FileIndex[a]}))),t&&t.bookVBA&&(i.vba.length>0?m.vbaraw=Xn(e,op(i.vba[0]),!0):i.defaults&&"application/vnd.ms-office.vbaProject"===i.defaults.bin&&(m.vbaraw=Xn(e,"xl/vbaProject.bin",!0))),m}function cp(e,t){var a=t||{},r="Workbook",n=bn.find(e,r);try{if(r="/!DataSpaces/Version",!(n=bn.find(e,r))||!n.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(function(e){var t={};t.id=e.read_shift(0,"lpp4"),t.R=ru(e,4),t.U=ru(e,4),t.W=ru(e,4)}(n.content),r="/!DataSpaces/DataSpaceMap",!(n=bn.find(e,r))||!n.content)throw new Error("ECMA-376 Encrypted file missing "+r);var s=function(e){var t=[];e.l+=4;for(var a=e.read_shift(4);a-- >0;)t.push(nu(e));return t}(n.content);if(1!==s.length||1!==s[0].comps.length||0!==s[0].comps[0].t||"StrongEncryptionDataSpace"!==s[0].name||"EncryptedPackage"!==s[0].comps[0].v)throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",!(n=bn.find(e,r))||!n.content)throw new Error("ECMA-376 Encrypted file missing "+r);var i=function(e){var t=[];e.l+=4;for(var a=e.read_shift(4);a-- >0;)t.push(e.read_shift(0,"lpp4"));return t}(n.content);if(1!=i.length||"StrongEncryptionTransform"!=i[0])throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",!(n=bn.find(e,r))||!n.content)throw new Error("ECMA-376 Encrypted file missing "+r);su(n.content)}catch(Ig){}if(r="/EncryptionInfo",!(n=bn.find(e,r))||!n.content)throw new Error("ECMA-376 Encrypted file missing "+r);var o=function(e){var t=ru(e);switch(t.Minor){case 2:return[t.Minor,lu(e)];case 3:return[t.Minor,cu()];case 4:return[t.Minor,uu(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}(n.content);if(r="/EncryptedPackage",!(n=bn.find(e,r))||!n.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(4==o[0]&&"undefined"!==typeof decrypt_agile)return decrypt_agile(o[1],n.content,a.password||"",a);if(2==o[0]&&"undefined"!==typeof decrypt_std76)return decrypt_std76(o[1],n.content,a.password||"",a);throw new Error("File is password-protected")}function up(e,t){return"ods"==t.bookType?_m(e,t):"numbers"==t.bookType?function(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var a=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=no(a["!ref"]);r.s.r=r.s.c=0;var n=!1;r.e.c>9&&(n=!0,r.e.c=9),r.e.r>49&&(n=!0,r.e.r=49),n&&console.error("The Numbers writer is currently limited to ".concat(so(r)));var s=Sp(a,{range:r,header:1}),i=["~Sh33tJ5~"];s.forEach(function(e){return e.forEach(function(e){"string"==typeof e&&i.push(e)})});var o={},l=[],c=bn.read(t.numbers,{type:"base64"});c.FileIndex.map(function(e,t){return[e,c.FullPaths[t]]}).forEach(function(e){var t=e[0],a=e[1];2==t.type&&t.name.match(/\.iwa/)&&Bm(Vm(t.content)).forEach(function(e){l.push(e.id),o[e.id]={deps:[],location:a,type:Lm(e.messages[0].meta[1][0].data)}})}),l.sort(function(e,t){return e-t});var u=l.filter(function(e){return e>1}).map(function(e){return[e,Im(e)]});c.FileIndex.map(function(e,t){return[e,c.FullPaths[t]]}).forEach(function(e){var t=e[0];e[1],t.name.match(/\.iwa/)&&Bm(Vm(t.content)).forEach(function(e){e.messages.forEach(function(t){u.forEach(function(t){e.messages.some(function(e){return 11006!=Lm(e.meta[1][0].data)&&function(e,t){e:for(var a=0;a<=e.length-t.length;++a){for(var r=0;r<t.length;++r)if(e[a+r]!=t[r])continue e;return!0}return!1}(e.data,t[1])})&&o[t[0]].deps.push(e.id)})})})});for(var d,f=bn.find(c,o[1].location),h=Bm(Vm(f.content)),m=0;m<h.length;++m){var p=h[m];1==p.id&&(d=p)}var g=Km(Mm(d.messages[0].data)[1][0].data);for(h=Bm(Vm((f=bn.find(c,o[g].location)).content)),m=0;m<h.length;++m)(p=h[m]).id==g&&(d=p);for(g=Km(Mm(d.messages[0].data)[2][0].data),h=Bm(Vm((f=bn.find(c,o[g].location)).content)),m=0;m<h.length;++m)(p=h[m]).id==g&&(d=p);for(g=Km(Mm(d.messages[0].data)[2][0].data),h=Bm(Vm((f=bn.find(c,o[g].location)).content)),m=0;m<h.length;++m)(p=h[m]).id==g&&(d=p);var v=Mm(d.messages[0].data);v[6][0].data=Im(r.e.r+1),v[7][0].data=Im(r.e.c+1);for(var y=Km(v[46][0].data),b=bn.find(c,o[y].location),w=Bm(Vm(b.content)),x=0;x<w.length&&w[x].id!=y;++x);if(w[x].id!=y)throw"Bad ColumnRowUIDMapArchive";var k=Mm(w[x].messages[0].data);k[1]=[],k[2]=[],k[3]=[];for(var S=0;S<=r.e.c;++S){var E=[];E[1]=E[2]=[{type:0,data:Im(S+420690)}],k[1].push({type:2,data:zm(E)}),k[2].push({type:0,data:Im(S)}),k[3].push({type:0,data:Im(S)})}k[4]=[],k[5]=[],k[6]=[];for(var T=0;T<=r.e.r;++T)(E=[])[1]=E[2]=[{type:0,data:Im(T+726270)}],k[4].push({type:2,data:zm(E)}),k[5].push({type:0,data:Im(T)}),k[6].push({type:0,data:Im(T)});w[x].messages[0].data=zm(k),b.content=Gm(Wm(w)),b.size=b.content.length,delete v[46];var N=Mm(v[4][0].data);N[7][0].data=Im(r.e.r+1);var j=Km(Mm(N[1][0].data)[2][0].data);if((w=Bm(Vm((b=bn.find(c,o[j].location)).content)))[0].id!=j)throw"Bad HeaderStorageBucket";var C=Mm(w[0].messages[0].data);for(T=0;T<s.length;++T){var _=Mm(C[2][0].data);_[1][0].data=Im(T),_[4][0].data=Im(s[T].length),C[2][T]={type:C[2][0].type,data:zm(_)}}w[0].messages[0].data=zm(C),b.content=Gm(Wm(w)),b.size=b.content.length;var A=Km(N[2][0].data);if((w=Bm(Vm((b=bn.find(c,o[A].location)).content)))[0].id!=A)throw"Bad HeaderStorageBucket";for(C=Mm(w[0].messages[0].data),S=0;S<=r.e.c;++S)(_=Mm(C[2][0].data))[1][0].data=Im(S),_[4][0].data=Im(r.e.r+1),C[2][S]={type:C[2][0].type,data:zm(_)};w[0].messages[0].data=zm(C),b.content=Gm(Wm(w)),b.size=b.content.length;var P=Km(N[4][0].data);!function(){for(var e,t=bn.find(c,o[P].location),a=Bm(Vm(t.content)),r=0;r<a.length;++r){var n=a[r];n.id==P&&(e=n)}var s=Mm(e.messages[0].data);s[3]=[];var l=[];i.forEach(function(e,t){l[1]=[{type:0,data:Im(t)}],l[2]=[{type:0,data:Im(1)}],l[3]=[{type:2,data:Rm(e)}],s[3].push({type:2,data:zm(l)})}),e.messages[0].data=zm(s);var u=Gm(Wm(a));t.content=u,t.size=t.content.length}();var R=Mm(N[3][0].data),O=R[1][0];delete R[2];var D=Mm(O.data),F=Km(D[2][0].data);!function(){for(var e,t=bn.find(c,o[F].location),a=Bm(Vm(t.content)),n=0;n<a.length;++n){var l=a[n];l.id==F&&(e=l)}var u=Mm(e.messages[0].data);delete u[6],delete R[7];var d=new Uint8Array(u[5][0].data);u[5]=[];for(var f=0,h=0;h<=r.e.r;++h){var m=Mm(d);f+=ap(m,s[h],i),m[1][0].data=Im(h),u[5].push({data:zm(m),type:2})}u[1]=[{type:0,data:Im(r.e.c+1)}],u[2]=[{type:0,data:Im(r.e.r+1)}],u[3]=[{type:0,data:Im(f)}],u[4]=[{type:0,data:Im(r.e.r+1)}],e.messages[0].data=zm(u);var p=Gm(Wm(a));t.content=p,t.size=t.content.length}(),O.data=zm(D),N[3][0].data=zm(R),v[4][0].data=zm(N),d.messages[0].data=zm(v);var I=Gm(Wm(h));return f.content=I,f.size=f.content.length,c}(e,t):"xlsb"==t.bookType?function(e,t){od=1024,e&&!e.SSF&&(e.SSF=zn(Or));e&&e.SSF&&(pn(),mn(e.SSF),t.revssf=Nn(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF);t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,ff?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var a="xlsb"==t.bookType?"bin":"xml",r=md.indexOf(t.bookType)>-1,n={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};sp(t=t||{});var s=es(),i="",o=0;t.cellXfs=[],gf(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});if(Zn(s,i="docProps/core.xml",dl(e.Props,t)),n.coreprops.push(i),rl(t.rels,2,i,Zo.CORE_PROPS),i="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var l=[],c=0;c<e.SheetNames.length;++c)2!=(e.Workbook.Sheets[c]||{}).Hidden&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,Zn(s,i,pl(e.Props)),n.extprops.push(i),rl(t.rels,3,i,Zo.EXT_PROPS),e.Custprops!==e.Props&&Sn(e.Custprops||{}).length>0&&(Zn(s,i="docProps/custom.xml",vl(e.Custprops)),n.custprops.push(i),rl(t.rels,4,i,Zo.CUST_PROPS));for(o=1;o<=e.SheetNames.length;++o){var u={"!id":{}},d=e.Sheets[e.SheetNames[o-1]];(d||{})["!type"];if(Zn(s,i="xl/worksheets/sheet"+o+"."+a,Eh(o-1,i,t,e,u)),n.sheets.push(i),rl(t.wbrels,-1,"worksheets/sheet"+o+"."+a,Zo.WS[0]),d){var f=d["!comments"],h=!1,m="";f&&f.length>0&&(Zn(s,m="xl/comments"+o+"."+a,Th(f,m,t)),n.comments.push(m),rl(u,-1,"../comments"+o+"."+a,Zo.CMNT),h=!0),d["!legacy"]&&h&&Zn(s,"xl/drawings/vmlDrawing"+o+".vml",ld(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}u["!id"].rId1&&Zn(s,el(i),al(u))}null!=t.Strings&&t.Strings.length>0&&(Zn(s,i="xl/sharedStrings."+a,function(e,t,a){return(".bin"===t.slice(-4)?tu:Zc)(e,a)}(t.Strings,i,t)),n.strs.push(i),rl(t.wbrels,-1,"sharedStrings."+a,Zo.SST));Zn(s,i="xl/workbook."+a,function(e,t,a){return(".bin"===t.slice(-4)?mh:uh)(e,a)}(e,i,t)),n.workbooks.push(i),rl(t.rels,1,i,Zo.WB),Zn(s,i="xl/theme/theme1.xml",td(e.Themes,t)),n.themes.push(i),rl(t.wbrels,-1,"theme/theme1.xml",Zo.THEME),Zn(s,i="xl/styles."+a,function(e,t,a){return(".bin"===t.slice(-4)?Gu:Ru)(e,a)}(e,i,t)),n.styles.push(i),rl(t.wbrels,-1,"styles."+a,Zo.STY),e.vbaraw&&r&&(Zn(s,i="xl/vbaProject.bin",e.vbaraw),n.vba.push(i),rl(t.wbrels,-1,"vbaProject.bin",Zo.VBA));return Zn(s,i="xl/metadata."+a,function(e){return(".bin"===e.slice(-4)?sd:id)()}(i)),n.metadata.push(i),rl(t.wbrels,-1,"metadata."+a,Zo.XLMETA),Zn(s,"[Content_Types].xml",Qo(n,t)),Zn(s,"_rels/.rels",al(t.rels)),Zn(s,"xl/_rels/workbook."+a+".rels",al(t.wbrels)),delete t.revssf,delete t.ssf,s}(e,t):dp(e,t)}function dp(e,t){od=1024,e&&!e.SSF&&(e.SSF=zn(Or)),e&&e.SSF&&(pn(),mn(e.SSF),t.revssf=Nn(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,ff?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var a="xml",r=md.indexOf(t.bookType)>-1,n={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};sp(t=t||{});var s=es(),i="",o=0;if(t.cellXfs=[],gf(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),Zn(s,i="docProps/core.xml",dl(e.Props,t)),n.coreprops.push(i),rl(t.rels,2,i,Zo.CORE_PROPS),i="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var l=[],c=0;c<e.SheetNames.length;++c)2!=(e.Workbook.Sheets[c]||{}).Hidden&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,Zn(s,i,pl(e.Props)),n.extprops.push(i),rl(t.rels,3,i,Zo.EXT_PROPS),e.Custprops!==e.Props&&Sn(e.Custprops||{}).length>0&&(Zn(s,i="docProps/custom.xml",vl(e.Custprops)),n.custprops.push(i),rl(t.rels,4,i,Zo.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var d={"!id":{}},f=e.Sheets[e.SheetNames[o-1]];(f||{})["!type"];if(Zn(s,i="xl/worksheets/sheet"+o+"."+a,If(o-1,t,e,d)),n.sheets.push(i),rl(t.wbrels,-1,"worksheets/sheet"+o+"."+a,Zo.WS[0]),f){var h=f["!comments"],m=!1,p="";if(h&&h.length>0){var g=!1;h.forEach(function(e){e[1].forEach(function(e){1==e.T&&(g=!0)})}),g&&(Zn(s,p="xl/threadedComments/threadedComment"+o+"."+a,dd(h,u,t)),n.threadedcomments.push(p),rl(d,-1,"../threadedComments/threadedComment"+o+"."+a,Zo.TCMNT)),Zn(s,p="xl/comments"+o+"."+a,ud(h)),n.comments.push(p),rl(d,-1,"../comments"+o+"."+a,Zo.CMNT),m=!0}f["!legacy"]&&m&&Zn(s,"xl/drawings/vmlDrawing"+o+".vml",ld(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}d["!id"].rId1&&Zn(s,el(i),al(d))}return null!=t.Strings&&t.Strings.length>0&&(Zn(s,i="xl/sharedStrings."+a,Zc(t.Strings,t)),n.strs.push(i),rl(t.wbrels,-1,"sharedStrings."+a,Zo.SST)),Zn(s,i="xl/workbook."+a,uh(e)),n.workbooks.push(i),rl(t.rels,1,i,Zo.WB),Zn(s,i="xl/theme/theme1.xml",td(e.Themes,t)),n.themes.push(i),rl(t.wbrels,-1,"theme/theme1.xml",Zo.THEME),Zn(s,i="xl/styles."+a,Ru(e,t)),n.styles.push(i),rl(t.wbrels,-1,"styles."+a,Zo.STY),e.vbaraw&&r&&(Zn(s,i="xl/vbaProject.bin",e.vbaraw),n.vba.push(i),rl(t.wbrels,-1,"vbaProject.bin",Zo.VBA)),Zn(s,i="xl/metadata."+a,id()),n.metadata.push(i),rl(t.wbrels,-1,"metadata."+a,Zo.XLMETA),u.length>1&&(Zn(s,i="xl/persons/person.xml",function(e){var t=[rs,Ls("personList",null,{xmlns:$s,"xmlns:x":ei[0]}).replace(/[\/]>/,">")];return e.forEach(function(e,a){t.push(Ls("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:e,providerId:"None"}))}),t.push("</personList>"),t.join("")}(u)),n.people.push(i),rl(t.wbrels,-1,"persons/person.xml",Zo.PEOPLE)),Zn(s,"[Content_Types].xml",Qo(n,t)),Zn(s,"_rels/.rels",al(t.rels)),Zn(s,"xl/_rels/workbook.xml.rels",al(t.wbrels)),delete t.revssf,delete t.ssf,s}function fp(e,t){var a="";switch((t||{}).type||"base64"){case"buffer":case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":a=fr(e.slice(0,12));break;case"binary":a=e;break;default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[a.charCodeAt(0),a.charCodeAt(1),a.charCodeAt(2),a.charCodeAt(3),a.charCodeAt(4),a.charCodeAt(5),a.charCodeAt(6),a.charCodeAt(7)]}function hp(e,t){var a=0;e:for(;a<e.length;)switch(e.charCodeAt(a)){case 10:case 13:case 32:++a;break;case 60:return Lh(e.slice(a),t);default:break e}return Bc.to_workbook(e,t)}function mp(e,t,a,r){return r?(a.type="string",Bc.to_workbook(e,a)):Bc.to_workbook(t,a)}function pp(e,t){rr();var a=t||{};if("undefined"!==typeof ArrayBuffer&&e instanceof ArrayBuffer)return pp(new Uint8Array(e),((a=zn(a)).type="array",a));"undefined"!==typeof Uint8Array&&e instanceof Uint8Array&&!a.type&&(a.type="undefined"!==typeof Deno?"buffer":"array");var r,n=e,s=!1;if(a.cellStyles&&(a.cellNF=!0,a.sheetStubs=!0),df={},a.dateNF&&(df.dateNF=a.dateNF),a.type||(a.type=hr&&Buffer.isBuffer(e)?"buffer":"base64"),"file"==a.type&&(a.type=hr?"buffer":"binary",n=function(e){if("undefined"!==typeof wn)return wn.readFileSync(e);if("undefined"!==typeof Deno)return Deno.readFileSync(e);if("undefined"!==typeof $&&"undefined"!==typeof File&&"undefined"!==typeof Folder)try{var t=File(e);t.open("r"),t.encoding="binary";var a=t.read();return t.close(),a}catch(Ig){if(!Ig.message||!Ig.message.match(/onstruct/))throw Ig}throw new Error("Cannot access file "+e)}(e),"undefined"===typeof Uint8Array||hr||(a.type="array")),"string"==a.type&&(s=!0,a.type="binary",a.codepage=65001,n=function(e){return e.match(/[^\x00-\x7F]/)?js(e):e}(e)),"array"==a.type&&"undefined"!==typeof Uint8Array&&e instanceof Uint8Array&&"undefined"!==typeof ArrayBuffer){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return(a=zn(a)).type="array",pp(wr(n),a)}switch((r=fp(n,a))[0]){case 208:if(207===r[1]&&17===r[2]&&224===r[3]&&161===r[4]&&177===r[5]&&26===r[6]&&225===r[7])return function(e,t){return bn.find(e,"EncryptedPackage")?cp(e,t):Zh(e,t)}(bn.read(n,a),a);break;case 9:if(r[1]<=8)return Zh(n,a);break;case 60:return Lh(n,a);case 73:if(73===r[1]&&42===r[2]&&0===r[3])throw new Error("TIFF Image File is not a spreadsheet");if(68===r[1])return function(e,t){var a=t||{},r=!!a.WTF;a.WTF=!0;try{var n=Mc.to_workbook(e,a);return a.WTF=r,n}catch(Ig){if(a.WTF=r,!Ig.message.match(/SYLK bad record ID/)&&r)throw Ig;return Bc.to_workbook(e,t)}}(n,a);break;case 84:if(65===r[1]&&66===r[2]&&76===r[3])return zc.to_workbook(n,a);break;case 80:return 75===r[1]&&r[2]<9&&r[3]<9?function(e,t){var a=e,r=t||{};return r.type||(r.type=hr&&Buffer.isBuffer(e)?"buffer":"base64"),lp(ts(a,r),r)}(n,a):mp(e,n,a,s);case 239:return 60===r[3]?Lh(n,a):mp(e,n,a,s);case 255:if(254===r[1])return function(e,t){var a=e;return"base64"==t.type&&(a=fr(a)),a=ir.utils.decode(1200,a.slice(2),"str"),t.type="binary",hp(a,t)}(n,a);if(0===r[1]&&2===r[2]&&0===r[3])return Wc.to_workbook(n,a);break;case 0:if(0===r[1]){if(r[2]>=2&&0===r[3])return Wc.to_workbook(n,a);if(0===r[2]&&(8===r[3]||9===r[3]))return Wc.to_workbook(n,a)}break;case 3:case 131:case 139:case 140:return Lc.to_workbook(n,a);case 123:if(92===r[1]&&114===r[2]&&116===r[3])return pu.to_workbook(n,a);break;case 10:case 13:case 32:return function(e,t){var a="",r=fp(e,t);switch(t.type){case"base64":a=fr(e);break;case"binary":a=e;break;case"buffer":a=e.toString("binary");break;case"array":a=Mn(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==r[0]&&187==r[1]&&191==r[2]&&(a=Ns(a)),t.type="binary",hp(a,t)}(n,a);case 137:if(80===r[1]&&78===r[2]&&71===r[3])throw new Error("PNG Image File is not a spreadsheet")}return Ic.indexOf(r[0])>-1&&r[2]<=12&&r[3]<=31?Lc.to_workbook(n,a):mp(e,n,a,s)}function gp(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return kn(t.file,bn.write(e,{type:hr?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return bn.write(e,t)}function vp(e,t){var a={},r=hr?"nodebuffer":"undefined"!==typeof Uint8Array?"array":"string";if(t.compression&&(a.compression="DEFLATE"),t.password)a.type=r;else switch(t.type){case"base64":a.type="base64";break;case"binary":a.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":a.type=r;break;default:throw new Error("Unrecognized type "+t.type)}var n=e.FullPaths?bn.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[a.type]||a.type,compression:!!t.compression}):e.generate(a);if("undefined"!==typeof Deno&&"string"==typeof n){if("binary"==t.type||"base64"==t.type)return n;n=new Uint8Array(yr(n))}return t.password&&"undefined"!==typeof encrypt_agile?gp(encrypt_agile(n,t.password),t):"file"===t.type?kn(t.file,n):"string"==t.type?Ns(n):n}function yp(e,t,a){a||(a="");var r=a+e;switch(t.type){case"base64":return dr(js(r));case"binary":return js(r);case"string":return e;case"file":return kn(t.file,r,"utf8");case"buffer":return hr?mr(r,"utf8"):"undefined"!==typeof TextEncoder?(new TextEncoder).encode(r):yp(r,{type:"binary"}).split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function bp(e,t){switch(t.type){case"string":case"base64":case"binary":for(var a="",r=0;r<e.length;++r)a+=String.fromCharCode(e[r]);return"base64"==t.type?dr(a):"string"==t.type?Ns(a):a;case"file":return kn(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function wp(e,t){rr(),lh(e);var a=zn(t||{});if(a.cellStyles&&(a.cellNF=!0,a.sheetStubs=!0),"array"==a.type){a.type="binary";var r=wp(e,a);return a.type="array",yr(r)}var n=0;if(a.sheet&&(n="number"==typeof a.sheet?a.sheet:e.SheetNames.indexOf(a.sheet),!e.SheetNames[n]))throw new Error("Sheet not found: "+a.sheet+" : "+typeof a.sheet);switch(a.bookType||"xlsb"){case"xml":case"xlml":return yp(Hh(e,a),a);case"slk":case"sylk":return yp(Mc.from_sheet(e.Sheets[e.SheetNames[n]],a),a);case"htm":case"html":return yp(ym(e.Sheets[e.SheetNames[n]],a),a);case"txt":return function(e,t){switch(t.type){case"base64":return dr(e);case"binary":case"string":return e;case"file":return kn(t.file,e,"binary");case"buffer":return hr?mr(e,"binary"):e.split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}(jp(e.Sheets[e.SheetNames[n]],a),a);case"csv":return yp(Np(e.Sheets[e.SheetNames[n]],a),a,"\ufeff");case"dif":return yp(zc.from_sheet(e.Sheets[e.SheetNames[n]],a),a);case"dbf":return bp(Lc.from_sheet(e.Sheets[e.SheetNames[n]],a),a);case"prn":return yp(Bc.from_sheet(e.Sheets[e.SheetNames[n]],a),a);case"rtf":return yp(pu.from_sheet(e.Sheets[e.SheetNames[n]],a),a);case"eth":return yp(Uc.from_sheet(e.Sheets[e.SheetNames[n]],a),a);case"fods":return yp(_m(e,a),a);case"wk1":return bp(Wc.sheet_to_wk1(e.Sheets[e.SheetNames[n]],a),a);case"wk3":return bp(Wc.book_to_wk3(e,a),a);case"biff2":a.biff||(a.biff=2);case"biff3":a.biff||(a.biff=3);case"biff4":return a.biff||(a.biff=4),bp(fm(e,a),a);case"biff5":a.biff||(a.biff=5);case"biff8":case"xla":case"xls":return a.biff||(a.biff=8),function(e,t){var a=t||{};return gp(em(e,a),a)}(e,a);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return function(e,t){var a=zn(t||{});return vp(up(e,a),a)}(e,a);default:throw new Error("Unrecognized bookType |"+a.bookType+"|")}}function xp(e){if(!e.bookType){var t=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(e.bookType=t.slice(1)),e.bookType={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"}[e.bookType]||e.bookType}}function kp(e,t,a,r,n,s,i,o){var l=Zi(a),c=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),d=!0,f=1===n?[]:{};if(1!==n)if(Object.defineProperty)try{Object.defineProperty(f,"__rowNum__",{value:a,enumerable:!1})}catch(Ig){f.__rowNum__=a}else f.__rowNum__=a;if(!i||e[a])for(var h=t.s.c;h<=t.e.c;++h){var m=i?e[a][h]:e[r[h]+l];if(void 0!==m&&void 0!==m.t){var p=m.v;switch(m.t){case"z":if(null==p)break;continue;case"e":p=0==p?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(null!=s[h]){if(null==p)if("e"==m.t&&null===p)f[s[h]]=null;else if(void 0!==c)f[s[h]]=c;else{if(!u||null!==p)continue;f[s[h]]=null}else f[s[h]]=u&&("n"!==m.t||"n"===m.t&&!1!==o.rawNumbers)?p:lo(m,p,o);null!=p&&(d=!1)}}else{if(void 0===c)continue;null!=s[h]&&(f[s[h]]=c)}}return{row:f,isempty:d}}function Sp(e,t){if(null==e||null==e["!ref"])return[];var a={t:"n",v:0},r=0,n=1,s=[],i=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=null!=c.range?c.range:e["!ref"];switch(1===c.header?r=1:"A"===c.header?r=2:Array.isArray(c.header)?r=3:null==c.header&&(r=0),typeof u){case"string":l=io(u);break;case"number":(l=io(e["!ref"])).s.r=u;break;default:l=u}r>0&&(n=0);var d=Zi(l.s.r),f=[],h=[],m=0,p=0,g=Array.isArray(e),v=l.s.r,y=0,b={};g&&!e[v]&&(e[v]=[]);var w=c.skipHidden&&e["!cols"]||[],x=c.skipHidden&&e["!rows"]||[];for(y=l.s.c;y<=l.e.c;++y)if(!(w[y]||{}).hidden)switch(f[y]=to(y),a=g?e[v][y]:e[f[y]+d],r){case 1:s[y]=y-l.s.c;break;case 2:s[y]=f[y];break;case 3:s[y]=c.header[y-l.s.c];break;default:if(null==a&&(a={w:"__EMPTY",t:"s"}),o=i=lo(a,null,c),p=b[i]||0){do{o=i+"_"+p++}while(b[o]);b[i]=p,b[o]=1}else b[i]=1;s[y]=o}for(v=l.s.r+n;v<=l.e.r;++v)if(!(x[v]||{}).hidden){var k=kp(e,l,v,f,r,s,g,c);(!1===k.isempty||(1===r?!1!==c.blankrows:c.blankrows))&&(h[m++]=k.row)}return h.length=m,h}var Ep=/"/g;function Tp(e,t,a,r,n,s,i,o){for(var l=!0,c=[],u="",d=Zi(a),f=t.s.c;f<=t.e.c;++f)if(r[f]){var h=o.dense?(e[a]||[])[f]:e[r[f]+d];if(null==h)u="";else if(null!=h.v){l=!1,u=""+(o.rawNumbers&&"n"==h.t?h.v:lo(h,null,o));for(var m=0,p=0;m!==u.length;++m)if((p=u.charCodeAt(m))===n||p===s||34===p||o.forceQuotes){u='"'+u.replace(Ep,'""')+'"';break}"ID"==u&&(u='"ID"')}else null==h.f||h.F?u="":(l=!1,(u="="+h.f).indexOf(",")>=0&&(u='"'+u.replace(Ep,'""')+'"'));c.push(u)}return!1===o.blankrows&&l?null:c.join(i)}function Np(e,t){var a=[],r=null==t?{}:t;if(null==e||null==e["!ref"])return"";var n=io(e["!ref"]),s=void 0!==r.FS?r.FS:",",i=s.charCodeAt(0),o=void 0!==r.RS?r.RS:"\n",l=o.charCodeAt(0),c=new RegExp(("|"==s?"\\|":s)+"+$"),u="",d=[];r.dense=Array.isArray(e);for(var f=r.skipHidden&&e["!cols"]||[],h=r.skipHidden&&e["!rows"]||[],m=n.s.c;m<=n.e.c;++m)(f[m]||{}).hidden||(d[m]=to(m));for(var p=0,g=n.s.r;g<=n.e.r;++g)(h[g]||{}).hidden||null!=(u=Tp(e,n,g,d,i,l,s,r))&&(r.strip&&(u=u.replace(c,"")),(u||!1!==r.blankrows)&&a.push((p++?o:"")+u));return delete r.dense,a.join("")}function jp(e,t){t||(t={}),t.FS="\t",t.RS="\n";var a=Np(e,t);if("undefined"==typeof ir||"string"==t.type)return a;var r=ir.utils.encode(1200,a,"str");return String.fromCharCode(255)+String.fromCharCode(254)+r}function Cp(e,t,a){var r,n=a||{},s=+!n.skipHeader,i=e||{},o=0,l=0;if(i&&null!=n.origin)if("number"==typeof n.origin)o=n.origin;else{var c="string"==typeof n.origin?ao(n.origin):n.origin;o=c.r,l=c.c}var u={s:{c:0,r:0},e:{c:l,r:o+t.length-1+s}};if(i["!ref"]){var d=io(i["!ref"]);u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),-1==o&&(o=d.e.r+1,u.e.r=o+t.length-1+s)}else-1==o&&(o=0,u.e.r=t.length-1+s);var f=n.header||[],h=0;t.forEach(function(e,t){Sn(e).forEach(function(a){-1==(h=f.indexOf(a))&&(f[h=f.length]=a);var c=e[a],u="z",d="",m=ro({c:l+h,r:o+t+s});r=_p(i,m),!c||"object"!==typeof c||c instanceof Date?("number"==typeof c?u="n":"boolean"==typeof c?u="b":"string"==typeof c?u="s":c instanceof Date?(u="d",n.cellDates||(u="n",c=Cn(c)),d=n.dateNF||Or[14]):null===c&&n.nullError&&(u="e",c=0),r?(r.t=u,r.v=c,delete r.w,delete r.R,d&&(r.z=d)):i[m]=r={t:u,v:c},d&&(r.z=d)):i[m]=c})}),u.e.c=Math.max(u.e.c,l+f.length-1);var m=Zi(o);if(s)for(h=0;h<f.length;++h)i[to(h+l)+m]={t:"s",v:f[h]};return i["!ref"]=so(u),i}function _p(e,t,a){if("string"==typeof t){if(Array.isArray(e)){var r=ao(t);return e[r.r]||(e[r.r]=[]),e[r.r][r.c]||(e[r.r][r.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return _p(e,ro("number"!=typeof t?t:{r:t,c:a||0}))}function Ap(){return{SheetNames:[],Sheets:{}}}function Pp(e,t,a,r){var n=1;if(!a)for(;n<=65535&&-1!=e.SheetNames.indexOf(a="Sheet"+n);++n,a=void 0);if(!a||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&e.SheetNames.indexOf(a)>=0){var s=a.match(/(^.*?)(\d+)$/);n=s&&+s[2]||0;var i=s&&s[1]||a;for(++n;n<=65535&&-1!=e.SheetNames.indexOf(a=i+n);++n);}if(oh(a),e.SheetNames.indexOf(a)>=0)throw new Error("Worksheet with name |"+a+"| already exists!");return e.SheetNames.push(a),e.Sheets[a]=t,a}function Rp(e,t,a){return t?(e.l={Target:t},a&&(e.l.Tooltip=a)):delete e.l,e}var Op={encode_col:to,encode_row:Zi,encode_cell:ro,encode_range:so,decode_col:eo,decode_row:Qi,split_cell:function(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:ao,decode_range:no,format_cell:lo,sheet_add_aoa:uo,sheet_add_json:Cp,sheet_add_dom:bm,aoa_to_sheet:fo,json_to_sheet:function(e,t){return Cp(null,e,t)},table_to_sheet:wm,table_to_book:function(e,t){return co(wm(e,t),t)},sheet_to_csv:Np,sheet_to_txt:jp,sheet_to_json:Sp,sheet_to_html:ym,sheet_to_formulae:function(e){var t,a="",r="";if(null==e||null==e["!ref"])return[];var n,s=io(e["!ref"]),i="",o=[],l=[],c=Array.isArray(e);for(n=s.s.c;n<=s.e.c;++n)o[n]=to(n);for(var u=s.s.r;u<=s.e.r;++u)for(i=Zi(u),n=s.s.c;n<=s.e.c;++n)if(a=o[n]+i,r="",void 0!==(t=c?(e[u]||[])[n]:e[a])){if(null!=t.F){if(a=t.F,!t.f)continue;r=t.f,-1==a.indexOf(":")&&(a=a+":"+a)}if(null!=t.f)r=t.f;else{if("z"==t.t)continue;if("n"==t.t&&null!=t.v)r=""+t.v;else if("b"==t.t)r=t.v?"TRUE":"FALSE";else if(void 0!==t.w)r="'"+t.w;else{if(void 0===t.v)continue;r="s"==t.t?"'"+t.v:""+t.v}}l[l.length]=a+"="+r}return l},sheet_to_row_object_array:Sp,sheet_get_cell:_p,book_new:Ap,book_append_sheet:Pp,book_set_sheet_visibility:function(e,t,a){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var r=function(e,t){if("number"==typeof t){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}if("string"==typeof t){var a=e.SheetNames.indexOf(t);if(a>-1)return a;throw new Error("Cannot find sheet name |"+t+"|")}throw new Error("Cannot find sheet |"+t+"|")}(e,t);switch(e.Workbook.Sheets[r]||(e.Workbook.Sheets[r]={}),a){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+a)}e.Workbook.Sheets[r].Hidden=a},cell_set_number_format:function(e,t){return e.z=t,e},cell_set_hyperlink:Rp,cell_set_internal_link:function(e,t,a){return Rp(e,"#"+t,a)},cell_add_comment:function(e,t,a){e.c||(e.c=[]),e.c.push({t:t,a:a||"SheetJS"})},sheet_set_array_formula:function(e,t,a,r){for(var n="string"!=typeof t?t:io(t),s="string"==typeof t?t:so(t),i=n.s.r;i<=n.e.r;++i)for(var o=n.s.c;o<=n.e.c;++o){var l=_p(e,i,o);l.t="n",l.F=s,delete l.v,i==n.s.r&&o==n.s.c&&(l.f=a,r&&(l.D=!0))}return e},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};Ka.version;const Dp=e=>{if(!e)return"";if("string"===typeof e&&e.match(/^\d{4}-\d{2}-\d{2}$/))return e;if("string"===typeof e){const t=e.trim(),a=[/^\d{4}-\d{1,2}-\d{1,2}$/,/^\d{1,2}\/\d{1,2}\/\d{4}$/,/^\d{1,2}-\d{1,2}-\d{4}$/];for(const e of a)if(e.test(t)){const e=new Date(t);if(!isNaN(e.getTime()))return Ip(e)}const r=parseFloat(t);return!isNaN(r)&&r>0?Fp(r):""}return"number"===typeof e?Fp(e):""},Fp=e=>{if(!e||e<1)return"";const t=new Date(1899,11,30),a=e>59?e-1:e,r=new Date(t.getTime()+864e5*a);return Ip(r)},Ip=e=>{if(!(e instanceof Date)||isNaN(e.getTime()))return"";const t=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(a,"-").concat(r)},Lp=e=>e.map(e=>u(u({},e),{},{startDate:Dp(e.startDate||e.joiningDate),joiningDate:Dp(e.joiningDate||e.startDate),dob:Dp(e.dob)})),Mp=e=>{let{onClose:t,onSuccess:a}=e;const[n,s]=(0,r.useState)([{firstName:"",lastName:"",email:"",phone:"",department:"",position:"",startDate:""}]),[i,o]=(0,r.useState)(!1),[l,c]=(0,r.useState)([]),[d,f]=(0,r.useState)({}),[h,m]=((0,r.useMemo)(()=>d,[d]),(0,r.useState)("manual")),[p,g]=(0,r.useState)(""),[v,y]=(0,r.useState)(""),[b,w]=(0,r.useState)(null),[x,k]=(0,r.useState)(0),S=Fa,E=(0,r.useCallback)((e,t,a)=>{var r;const i="startDate"===t?Dp(a):a,o=[...n];if(o[e]=u(u({},o[e]),{},{[t]:i}),s(o),null!==(r=d[e])&&void 0!==r&&r[t]){const a=u({},d);delete a[e][t],0===Object.keys(a[e]).length&&delete a[e],f(a)}},[n,d]),T=(0,r.useCallback)((e,t)=>{var a,r,n,s;const i={};if(null!==(a=e.firstName)&&void 0!==a&&a.trim()||(i.firstName="First name is required"),null!==(r=e.lastName)&&void 0!==r&&r.trim()||(i.lastName="Last name is required"),null!==(n=e.email)&&void 0!==n&&n.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.email)||(i.email="Invalid email format"):i.email="Email is required",e.department||(i.department="Department is required"),null!==(s=e.position)&&void 0!==s&&s.trim()||(i.position="Position is required"),e.phone){10!==e.phone.replace(/\D/g,"").length&&(i.phone="Phone number must be exactly 10 digits")}return e.startDate&&!(e=>{if(!e)return!0;if(!/^\d{4}-\d{2}-\d{2}$/.test(e))return!1;const t=new Date(e);return!isNaN(t.getTime())&&e===Ip(t)})(e.startDate)&&(i.startDate="Start date must be in YYYY-MM-DD format"),i},[]),N=(0,r.useCallback)(()=>{const e={};let t=!1;return n.forEach((a,r)=>{const n=T(a,r);Object.keys(n).length>0&&(e[r]=n,t=!0)}),f(e),!t},[n,T]),j=()=>{const e=new Blob(["firstName,lastName,email,phone,department,position,startDate\nJohn,Doe,john.doe@company.com,+1234567890,Engineering,Software Engineer,2024-01-15\n"],{type:"text/csv"}),t=window.URL.createObjectURL(e),a=document.createElement("a");a.href=t,a.download="employee_template.csv",document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(t)},C=(e,t)=>{try{let a,r;if("csv"===t)a=e.trim().split("\n"),r=a[0].toLowerCase().split(",").map(e=>e.trim());else{if(!e||e.length<2)return c(["Excel file must contain at least a header row and one data row."]),!1;r=e[0].map(e=>e.toString().toLowerCase().trim()),a=e.slice(1)}const n=["firstname","lastname","email"].filter(e=>!r.some(t=>t.includes(e)));if(n.length>0)return c(["Missing required headers: ".concat(n.join(", "))]),!1;const i=[];for(let e=0;e<a.length;e++){let n;if("csv"===t){if(0===e)continue;n=a[e].split(",").map(e=>e.trim())}else n=a[e]||[];if(n.length>0&&n.some(e=>e&&e.toString().trim())){const e={firstName:"",lastName:"",email:"",phone:"",department:"",position:"",startDate:""};r.forEach((t,a)=>{const r=n[a]?n[a].toString().trim():"";switch(t.replace(/[^a-z]/g,"")){case"firstname":case"fname":e.firstName=r;break;case"lastname":case"lname":e.lastName=r;break;case"startdate":case"dateofjoining":case"joindate":e.startDate=Dp(r);break;case"phonenumber":case"phone":case"mobile":e.phone=r;break;default:const a=t.replace(/[^a-z]/g,"");["email","department","position"].includes(a)&&(e[a]=r)}}),e.firstName&&e.lastName&&e.email&&i.push(e)}}if(0===i.length)return c(["No valid employee data found in the file."]),!1;const o=Lp(i);return s(o),c([]),y("Successfully parsed ".concat(o.length," employees from file.")),!0}catch(a){return c(["Error parsing file data. Please check the file format."]),!1}},_=(0,r.useCallback)(async e=>{e.preventDefault();const r=localStorage.getItem("company_id")||localStorage.getItem("companyId");if(r)if(N()){o(!0),c([]),y("");try{const e=Lp(n);y("Processing ".concat(e.length," employees...")),k(10);const o=await Oa.bulkCreateEmployees(r,e,e=>k(e));if(o.success){var s,i,l,u;const r=(null===(s=o.data)||void 0===s||null===(i=s.successful)||void 0===i?void 0:i.length)||e.length,n=(null===(l=o.data)||void 0===l||null===(u=l.failed)||void 0===u?void 0:u.length)||0;y(n>0?"Successfully created ".concat(r," employees. ").concat(n," failed due to duplicates or validation errors."):"Successfully created ".concat(r," employees!")),setTimeout(()=>{a&&a(o.data),t&&t()},2e3)}else{const e=Da(o.message||"Failed to create employees","bulk_create");c([e])}}catch(d){console.error("Bulk create employees error:",d);const e=Da(d.message||d,"bulk_create");c([e])}finally{o(!1),k(0)}}else c(["Please fix the validation errors before submitting."]);else c(["Company ID not found. Please ensure you are logged in as a company user."])},[n,N,a,t]);return(0,Pt.jsx)("div",{className:"bulk-add-overlay",children:(0,Pt.jsxs)("div",{className:"bulk-add-modal",children:[(0,Pt.jsxs)("div",{className:"bulk-add-header",children:[(0,Pt.jsx)("h2",{children:"Bulk Add Employees"}),(0,Pt.jsx)("button",{className:"close-btn",onClick:t,children:(0,Pt.jsx)(fa,{size:20})})]}),(0,Pt.jsxs)("div",{className:"bulk-add-content",children:[(0,Pt.jsxs)("div",{className:"mode-selection",children:[(0,Pt.jsx)("button",{className:"mode-btn ".concat("manual"===h?"active":""),onClick:()=>m("manual"),children:"Manual Entry"}),(0,Pt.jsx)("button",{className:"mode-btn ".concat("csv"===h?"active":""),onClick:()=>m("csv"),children:"CSV Text"}),(0,Pt.jsxs)("button",{className:"mode-btn ".concat("file"===h?"active":""),onClick:()=>m("file"),children:[(0,Pt.jsx)(qa,{size:16}),"File Upload"]})]}),"csv"===h&&(0,Pt.jsxs)("div",{className:"csv-section",children:[(0,Pt.jsxs)("div",{className:"csv-instructions",children:[(0,Pt.jsx)("h3",{children:"CSV Upload Instructions"}),(0,Pt.jsx)("p",{children:"Upload a CSV file with the following headers (firstName and lastName will be combined into name):"}),(0,Pt.jsx)("code",{children:"firstName,lastName,email,phone,department,position,startDate"}),(0,Pt.jsx)("p",{children:(0,Pt.jsx)("small",{children:"Note: Email will be used as personal email for login credentials"})}),(0,Pt.jsxs)("button",{className:"download-template-btn",onClick:j,children:[(0,Pt.jsx)(Ya,{size:16}),"Download Template"]})]}),(0,Pt.jsx)("textarea",{className:"csv-textarea",placeholder:"Paste your CSV data here or upload a file...",value:p,onChange:e=>g(e.target.value),rows:8}),(0,Pt.jsx)("button",{className:"parse-csv-btn",onClick:()=>{try{const e=p.trim().split("\n"),t=e[0].split(",").map(e=>e.trim().toLowerCase()),a=["firstname","lastname","email","phone","department","position","startdate"].filter(e=>!t.includes(e));if(a.length>0)return c(["Missing required CSV headers: ".concat(a.join(", "))]),!1;const r=[];for(let n=1;n<e.length;n++){const a=e[n].split(",").map(e=>e.trim());if(a.length===t.length){const e={};t.forEach((t,r)=>{switch(t){case"firstname":e.firstName=a[r];break;case"lastname":e.lastName=a[r];break;case"startdate":e.startDate=Dp(a[r]);break;default:e[t]=a[r]}}),r.push(e)}}return s(r),c([]),!0}catch(e){return c(["Invalid CSV format. Please check your data."]),!1}},disabled:!p.trim(),children:"Parse CSV Data"})]}),"file"===h&&(0,Pt.jsxs)("div",{className:"file-section",children:[(0,Pt.jsxs)("div",{className:"file-instructions",children:[(0,Pt.jsx)("h3",{children:"File Upload Instructions"}),(0,Pt.jsx)("p",{children:"Upload a CSV or Excel file (.csv, .xlsx, .xls) with the following headers:"}),(0,Pt.jsx)("code",{children:"firstName,lastName,email,phone,department,position,startDate"}),(0,Pt.jsx)("p",{children:(0,Pt.jsx)("small",{children:"Note: firstName and lastName will be combined into full name, email will be used as personal email"})}),(0,Pt.jsxs)("div",{className:"template-buttons",children:[(0,Pt.jsxs)("button",{type:"button",className:"download-template-btn",onClick:j,children:[(0,Pt.jsx)(Ya,{size:16}),"Download CSV Template"]}),(0,Pt.jsxs)("button",{type:"button",className:"download-template-btn excel",onClick:()=>{const e=Op.book_new(),t=Op.aoa_to_sheet([["firstName","lastName","email","phone","department","position","startDate"],["John","Doe","john.doe@company.com","+1234567890","Engineering","Software Engineer","2024-01-15"],["Jane","Smith","jane.smith@company.com","+1234567891","Marketing","Marketing Manager","2024-01-20"]]);Op.book_append_sheet(e,t,"Employees"),function(e,t,a){var r=a||{};r.type="file",r.file=t,xp(r),wp(e,r)}(e,"employee_template.xlsx")},children:[(0,Pt.jsx)(Ya,{size:16}),"Download Excel Template"]})]})]}),(0,Pt.jsxs)("div",{className:"file-upload-area",children:[(0,Pt.jsx)("input",{type:"file",id:"fileUpload",accept:".csv,.xlsx,.xls",onChange:e=>{const t=e.target.files[0];if(!t)return;const a=t.name.split(".").pop().toLowerCase();if(!["csv","xlsx","xls"].includes(a))return void c(["Please upload a CSV or Excel file (.csv, .xlsx, .xls)"]);w(t),c([]);const r=new FileReader;r.onload=e=>{try{if("csv"===a){const t=e.target.result;g(t),C(t,"csv")}else{const t=pp(new Uint8Array(e.target.result),{type:"array"}),a=t.SheetNames[0],r=t.Sheets[a],n=Op.sheet_to_json(r,{header:1});C(n,"excel")}}catch(t){c(["Error reading file. Please check the file format and try again."]),w(null)}},"csv"===a?r.readAsText(t):r.readAsArrayBuffer(t)},style:{display:"none"}}),(0,Pt.jsxs)("label",{htmlFor:"fileUpload",className:"file-upload-label",children:[(0,Pt.jsx)(Wa,{size:24}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{children:"Click to upload file or drag and drop"}),(0,Pt.jsx)("span",{children:"Supports CSV, Excel (.xlsx, .xls) files"})]})]}),b&&(0,Pt.jsxs)("div",{className:"uploaded-file-info",children:[(0,Pt.jsx)(qa,{size:16}),(0,Pt.jsx)("span",{children:b.name}),(0,Pt.jsx)("button",{type:"button",onClick:()=>{w(null),s([{firstName:"",lastName:"",email:"",phone:"",department:"",position:"",startDate:""}]),y("")},className:"remove-file-btn",children:(0,Pt.jsx)(fa,{size:14})})]})]})]}),l.length>0&&(0,Pt.jsxs)("div",{className:"error-messages",children:[(0,Pt.jsx)(Yt,{size:16}),(0,Pt.jsx)("div",{children:l.map((e,t)=>(0,Pt.jsx)("p",{children:e},t))})]}),v&&(0,Pt.jsxs)("div",{className:"success-message",children:[(0,Pt.jsx)(Xa,{size:16}),(0,Pt.jsx)("p",{children:v})]}),(0,Pt.jsxs)("form",{onSubmit:_,className:"bulk-form",children:[(0,Pt.jsxs)("div",{className:"employees-section",children:[(0,Pt.jsxs)("div",{className:"section-header",children:[(0,Pt.jsxs)("h3",{children:["Employees (",n.length,")"]}),(0,Pt.jsxs)("button",{type:"button",className:"add-employee-btn",onClick:()=>{s([...n,{firstName:"",lastName:"",email:"",phone:"",department:"",position:"",startDate:""}])},children:[(0,Pt.jsx)(ka,{size:16}),"Add Employee"]})]}),(0,Pt.jsx)("div",{className:"employees-list",children:n.map((e,t)=>{var a,r,i,o,l,c,h,m,p,g,v,y;return(0,Pt.jsxs)("div",{className:"employee-form",children:[(0,Pt.jsxs)("div",{className:"employee-form-header",children:[(0,Pt.jsxs)("h4",{children:["Employee ",t+1]}),n.length>1&&(0,Pt.jsx)("button",{type:"button",className:"remove-employee-btn",onClick:()=>(e=>{if(n.length>1){const t=n.filter((t,a)=>a!==e);s(t);const a=u({},d);delete a[e],f(a)}})(t),children:(0,Pt.jsx)($a,{size:16})})]}),(0,Pt.jsxs)("div",{className:"form-grid",children:[(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsx)("label",{children:"First Name *"}),(0,Pt.jsx)("input",{type:"text",value:e.firstName,onChange:e=>E(t,"firstName",e.target.value),className:null!==(a=d[t])&&void 0!==a&&a.firstName?"error":"",placeholder:"Enter first name"}),(null===(r=d[t])||void 0===r?void 0:r.firstName)&&(0,Pt.jsx)("span",{className:"field-error",children:d[t].firstName})]}),(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsx)("label",{children:"Last Name *"}),(0,Pt.jsx)("input",{type:"text",value:e.lastName,onChange:e=>E(t,"lastName",e.target.value),className:null!==(i=d[t])&&void 0!==i&&i.lastName?"error":"",placeholder:"Enter last name"}),(null===(o=d[t])||void 0===o?void 0:o.lastName)&&(0,Pt.jsx)("span",{className:"field-error",children:d[t].lastName})]}),(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsx)("label",{children:"Email *"}),(0,Pt.jsx)("input",{type:"email",value:e.email,onChange:e=>E(t,"email",e.target.value),className:null!==(l=d[t])&&void 0!==l&&l.email?"error":"",placeholder:"Enter email address"}),(null===(c=d[t])||void 0===c?void 0:c.email)&&(0,Pt.jsx)("span",{className:"field-error",children:d[t].email})]}),(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsx)("label",{children:"Phone"}),(0,Pt.jsx)(Ma,{value:e.phone,onChange:e=>E(t,"phone",e),placeholder:"Enter phone number"})]}),(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsx)("label",{children:"Department *"}),(0,Pt.jsxs)("select",{value:e.department,onChange:e=>E(t,"department",e.target.value),className:null!==(h=d[t])&&void 0!==h&&h.department?"error":"",children:[(0,Pt.jsx)("option",{value:"",children:"Select Department"}),S.map(e=>(0,Pt.jsx)("option",{value:e,children:e},e))]}),(null===(m=d[t])||void 0===m?void 0:m.department)&&(0,Pt.jsx)("span",{className:"field-error",children:d[t].department})]}),(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsx)("label",{children:"Position *"}),(0,Pt.jsx)("input",{type:"text",value:e.position,onChange:e=>E(t,"position",e.target.value),className:null!==(p=d[t])&&void 0!==p&&p.position?"error":"",placeholder:"Enter job position"}),(null===(g=d[t])||void 0===g?void 0:g.position)&&(0,Pt.jsx)("span",{className:"field-error",children:d[t].position})]}),(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsx)("label",{children:"Start Date"}),(0,Pt.jsx)("input",{type:"date",value:e.startDate,onChange:e=>E(t,"startDate",e.target.value),className:null!==(v=d[t])&&void 0!==v&&v.startDate?"error":""}),(null===(y=d[t])||void 0===y?void 0:y.startDate)&&(0,Pt.jsx)("span",{className:"field-error",children:d[t].startDate})]})]})]},t)})})]}),i&&x>0&&(0,Pt.jsxs)("div",{className:"processing-progress",children:[(0,Pt.jsxs)("div",{className:"progress-info",children:[(0,Pt.jsx)("span",{children:"Processing employees..."}),(0,Pt.jsxs)("span",{children:[x,"%"]})]}),(0,Pt.jsx)("div",{className:"progress-bar",children:(0,Pt.jsx)("div",{className:"progress-fill",style:{width:"".concat(x,"%")}})})]}),(0,Pt.jsxs)("div",{className:"bulk-add-actions",children:[(0,Pt.jsx)("button",{type:"button",className:"cancel-btn",onClick:t,disabled:i,children:"Cancel"}),(0,Pt.jsx)("button",{type:"submit",className:"submit-btn",disabled:i||0===n.length,children:i?(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)("div",{className:"spinner"}),"Creating Employees..."]}):(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)(Wa,{size:16}),"Create ",n.length," Employee",1!==n.length?"s":""]})})]})]})]})]})})},zp=()=>{var e;const[t,a]=(0,r.useState)([]),[n,s]=(0,r.useState)(""),[i,o]=(0,r.useState)(""),[l,c]=(0,r.useState)([]),[d,f]=(0,r.useState)([]),[h,m]=(0,r.useState)(!1),[p,g]=(0,r.useState)({show:!1,employee:null}),[v,y]=(0,r.useState)(!1),[b,w]=(0,r.useState)(!1),[x,k]=(0,r.useState)(""),[S,E]=(0,r.useState)(!1),[T,N]=(0,r.useState)({}),[j,C]=(0,r.useState)({}),_=ge(),A=(0,r.useCallback)(e=>e.map(e=>e.department).filter(e=>e&&""!==e.trim()).filter((e,t,a)=>a.indexOf(e)===t).sort(),[]),P=(0,r.useCallback)(async()=>{console.log("EmployeeList: Starting fetchEmployees..."),w(!0),k("");try{const e=At.getStoredCompanyId();if(console.log("EmployeeList: Retrieved company ID:",e),!e){console.warn("EmployeeList: No company ID found, loading from localStorage");const e=localStorage.getItem("employees");if(e){const t=JSON.parse(e);console.log("EmployeeList: Loaded employees from localStorage:",t.length),a(t),c(t),f(A(t))}else console.log("EmployeeList: No employees in localStorage either");return}console.log("EmployeeList: Calling API with company ID:",e);const t=await Oa.getEmployeesByCompany(e);if(console.log("EmployeeList: API result:",t),t.success&&t.data){const e=Array.isArray(t.data)?t.data:[];console.log("EmployeeList: Successfully fetched employees from API:",e.length),console.log("EmployeeList: Employee data:",e),t.total&&t.total>e.length&&console.log("EmployeeList: Fetched ".concat(e.length," of ").concat(t.total," total employees")),a(e),c(e),f(A(e)),E(!0),setTimeout(()=>E(!1),2e3),localStorage.setItem("employees",JSON.stringify(e))}else{console.warn("EmployeeList: API call failed or no data, falling back to localStorage"),console.log("EmployeeList: Result was:",t);const e=localStorage.getItem("employees");if(e){const t=JSON.parse(e);console.log("EmployeeList: Using localStorage fallback:",t.length,"employees"),a(t),c(t),f(A(t)),k("Unable to load latest data from server. Showing previously saved information.")}else console.log("EmployeeList: No localStorage fallback available"),k("Unable to load employee data. Please check your internet connection and try refreshing.")}}catch(e){console.error("EmployeeList: Failed to fetch employees:",e),console.error("EmployeeList: Error details:",e.message,e.stack);const t=Da(e,"loading"),r=localStorage.getItem("employees");if(r){const e=JSON.parse(r);console.log("EmployeeList: Error fallback - using localStorage:",e.length,"employees"),a(e),c(e),f(A(e)),k("".concat(t," Showing previously saved data."))}else console.log("EmployeeList: Error fallback - no localStorage data available"),k(t)}finally{w(!1)}},[A]);(0,r.useEffect)(()=>{P()},[P]),(0,r.useEffect)(()=>{let e=t;n&&(e=e.filter(e=>e.name.toLowerCase().includes(n.toLowerCase())||e.personal_email&&e.personal_email.toLowerCase().includes(n.toLowerCase())||e.personalEmail&&e.personalEmail.toLowerCase().includes(n.toLowerCase())||e.email&&e.email.toLowerCase().includes(n.toLowerCase()))),i&&(e=e.filter(e=>e.department===i)),c(e)},[n,i,t]);const R=()=>{g({show:!1,employee:null})},O=()=>{_("/add-employee")};return console.log("EmployeeList: Render state - employees:",t.length,"filtered:",l.length,"loading:",b),r.useEffect(()=>{window.debugEmployeeFetch=P,window.debugEmployeeState={employees:t,filteredEmployees:l,loading:b,error:x}},[P,t,l,b,x]),(0,Pt.jsxs)("div",{className:"employee-list-container",children:[(0,Pt.jsx)(pa,{}),(0,Pt.jsxs)("div",{className:"employee-list-content",children:[(0,Pt.jsxs)("div",{className:"employee-list-header",children:[(0,Pt.jsxs)("div",{className:"header-left",children:[(0,Pt.jsx)(la,{size:28,className:"header-icon"}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("h2",{className:"page-title",children:"Employee Management"}),(0,Pt.jsx)("p",{className:"page-subtitle",children:"Manage your team members"})]})]}),(0,Pt.jsxs)("div",{className:"header-buttons",children:[(0,Pt.jsx)("button",{onClick:P,className:"refresh-btn ".concat(b?"refreshing":""," ").concat(S?"success":""),title:"Refresh employee list",disabled:b,children:S?(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)(Ua,{size:20,className:"success-icon"}),(0,Pt.jsx)("span",{children:"Updated!"})]}):(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)(Ba,{size:20,className:"refresh-icon ".concat(b?"spinning":"")}),(0,Pt.jsx)("span",{children:b?"Refreshing...":"Refresh"})]})}),(0,Pt.jsxs)("button",{onClick:O,className:"add-employee-btn",children:[(0,Pt.jsx)(da,{size:20}),(0,Pt.jsx)("span",{children:"Add Employee"})]}),(0,Pt.jsxs)("button",{onClick:()=>m(!0),className:"bulk-add-btn",children:[(0,Pt.jsx)(Wa,{size:20}),(0,Pt.jsx)("span",{children:"Bulk Add"})]})]})]}),(0,Pt.jsxs)("div",{className:"employee-list-actions",children:[(0,Pt.jsxs)("div",{className:"search-container",children:[(0,Pt.jsx)(Ha,{size:20,className:"search-icon"}),(0,Pt.jsx)("input",{type:"text",placeholder:"Search Employee",value:n,onChange:e=>s(e.target.value),className:"search-input"})]}),(0,Pt.jsx)("div",{className:"filter-container",children:(0,Pt.jsxs)("select",{value:i,onChange:e=>o(e.target.value),className:"department-filter",children:[(0,Pt.jsx)("option",{value:"",children:"All Departments"}),d.map(e=>(0,Pt.jsx)("option",{value:e,children:e},e))]})}),(0,Pt.jsx)("div",{className:"employee-count",children:(0,Pt.jsx)("span",{children:n||i?"".concat(l.length," of ").concat(t.length," employee").concat(1!==t.length?"s":""):"".concat(t.length," employee").concat(1!==t.length?"s":"")})})]}),x&&(0,Pt.jsx)("div",{className:"error-banner",children:(0,Pt.jsxs)("div",{className:"error-content",children:[(0,Pt.jsx)("span",{className:"error-icon",children:"\u26a0\ufe0f"}),(0,Pt.jsx)("span",{className:"error-message",children:x}),(0,Pt.jsx)("button",{onClick:()=>k(""),className:"error-dismiss",title:"Dismiss",children:"\xd7"})]})}),0===l.length?(0,Pt.jsxs)("div",{className:"empty-state",children:[(0,Pt.jsx)(la,{size:64,className:"empty-icon"}),(0,Pt.jsx)("h3",{children:"No employees found"}),(0,Pt.jsx)("p",{children:0===t.length?"Start by adding your first employee to the team.":"No employees match your search criteria."}),0===t.length&&(0,Pt.jsxs)("button",{onClick:O,className:"empty-add-btn",children:[(0,Pt.jsx)(da,{size:20}),"Add First Employee"]})]}):(0,Pt.jsx)("div",{className:"employee-grid",children:l.map(e=>(0,Pt.jsxs)("div",{className:"employee-card",children:[(0,Pt.jsxs)("div",{className:"employee-info",children:[(0,Pt.jsx)("div",{className:"employee-avatar",children:e.name.charAt(0).toUpperCase()}),(0,Pt.jsxs)("div",{className:"employee-details",children:[(0,Pt.jsx)("h3",{className:"employee-name",children:e.name}),(0,Pt.jsxs)("p",{className:"employee-email",children:[(0,Pt.jsx)("span",{className:"email-label",children:"Mail ID: "}),e.personal_email||e.personalEmail||"No email provided"]}),e.department&&(0,Pt.jsx)("span",{className:"employee-department",children:e.department}),(0,Pt.jsxs)("p",{className:"employee-id",children:["ID: ",e.employee_id||e.id]})]})]}),(0,Pt.jsxs)("div",{className:"employee-actions",children:[(0,Pt.jsxs)("button",{onClick:()=>{return t=e.id,void _("/add-employee?id=".concat(t));var t},className:"action-btn edit-btn",title:"Edit employee",children:[(0,Pt.jsx)(Va,{size:32}),(0,Pt.jsx)("span",{children:"Edit"})]}),(0,Pt.jsx)("button",{onClick:()=>(async e=>{const t=e.id,a=e.personal_email||e.personalEmail;if(a){N(e=>u(u({},e),{},{[t]:!0})),k("");try{const e=localStorage.getItem("company_id")||localStorage.getItem("companyId");if(!e)throw new Error("Company ID not found");(await Oa.resendEmployeeCredentials(e,t,a)).success&&(C(e=>u(u({},e),{},{[t]:!0})),setTimeout(()=>{C(e=>u(u({},e),{},{[t]:!1}))},3e3))}catch(x){console.error("Error resending credentials:",x);const t=Da(x.message,"resend_credentials");k(t)}finally{N(e=>u(u({},e),{},{[t]:!1}))}}else k("Personal email is required to resend credentials")})(e),className:"action-btn resend-btn ".concat(T[e.id]?"loading":""," ").concat(j[e.id]?"success":""),title:"Resend credentials",disabled:T[e.id],children:j[e.id]?(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)(Ua,{size:32}),(0,Pt.jsx)("span",{children:"Sent!"})]}):(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)(Ga,{size:32,className:T[e.id]?"spinning":""}),(0,Pt.jsx)("span",{children:"Resend"})]})}),(0,Pt.jsxs)("button",{onClick:()=>(e=>{g({show:!0,employee:e})})(e),className:"action-btn delete-btn",title:"Delete employee",children:[(0,Pt.jsx)($a,{size:32}),(0,Pt.jsx)("span",{children:"Delete"})]})]})]},e.id))})]}),v&&(0,Pt.jsxs)("div",{className:"success-message",children:[(0,Pt.jsx)(Ua,{size:20}),"Employee deleted successfully!"]}),p.show&&(0,Pt.jsx)("div",{className:"modal-overlay",children:(0,Pt.jsxs)("div",{className:"confirmation-modal",children:[(0,Pt.jsxs)("div",{className:"modal-header",children:[(0,Pt.jsx)("h3",{children:"Delete Employee"}),(0,Pt.jsx)("button",{onClick:R,className:"modal-close-btn",title:"Close",disabled:b,children:(0,Pt.jsx)(fa,{size:20})})]}),(0,Pt.jsx)("div",{className:"modal-body",children:(0,Pt.jsxs)("div",{className:"employee-delete-details",children:[(0,Pt.jsxs)("p",{className:"delete-confirmation-text",children:["Are you sure you want to delete ",(0,Pt.jsx)("strong",{children:null===(e=p.employee)||void 0===e?void 0:e.name}),"?"]}),p.employee&&(0,Pt.jsxs)("div",{className:"employee-info-box",children:[(0,Pt.jsxs)("div",{className:"info-row",children:[(0,Pt.jsx)("span",{className:"info-label",children:"Email:"}),(0,Pt.jsx)("span",{className:"info-value",children:p.employee.email||p.employee.personalEmail||"N/A"})]}),p.employee.department&&(0,Pt.jsxs)("div",{className:"info-row",children:[(0,Pt.jsx)("span",{className:"info-label",children:"Department:"}),(0,Pt.jsx)("span",{className:"info-value",children:p.employee.department})]}),p.employee.position&&(0,Pt.jsxs)("div",{className:"info-row",children:[(0,Pt.jsx)("span",{className:"info-label",children:"Position:"}),(0,Pt.jsx)("span",{className:"info-value",children:p.employee.position})]})]}),(0,Pt.jsxs)("div",{className:"warning-box",children:[(0,Pt.jsx)("p",{className:"warning-text",children:"\u26a0\ufe0f This will soft delete the employee from the company."}),(0,Pt.jsx)("p",{className:"info-text",children:"Only company owners, admins, and HR managers can delete employees."})]})]})}),(0,Pt.jsxs)("div",{className:"modal-actions",children:[(0,Pt.jsx)("button",{onClick:R,className:"cancel-btn",disabled:b,children:"Cancel"}),(0,Pt.jsx)("button",{onClick:async()=>{const e=p.employee.id,r=At.getStoredCompanyId();w(!0),k("");try{console.log("Attempting to delete employee:",e,"from company:",r);const s=await Oa.removeEmployeeFromCompany(e,r);if(!s.success)throw new Error(s.error||"Failed to delete employee");{console.log("Employee deleted successfully:",s);const r=t.filter(t=>t.id!==e);a(r),c(r.filter(e=>{var t,a,r;const s=(null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(n.toLowerCase()))||(null===(a=e.email)||void 0===a?void 0:a.toLowerCase().includes(n.toLowerCase()))||(null===(r=e.personalEmail)||void 0===r?void 0:r.toLowerCase().includes(n.toLowerCase())),o=!i||e.department===i;return s&&o})),f(A(r)),localStorage.setItem("employees",JSON.stringify(r)),g({show:!1,employee:null}),y(!0),setTimeout(()=>y(!1),3e3)}}catch(x){console.error("Error deleting employee:",x);const t=Da(x);k(t||"Failed to delete employee. Please try again."),g({show:!1,employee:null})}finally{w(!1)}},className:"confirm-delete-btn",disabled:b,children:b?(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)(Ba,{size:16,className:"spinning"}),"Deleting..."]}):(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)($a,{size:16}),"Delete Employee"]})})]})]})}),h&&(0,Pt.jsx)(Mp,{onClose:()=>m(!1),onSuccess:()=>{m(!1);const e=JSON.parse(localStorage.getItem("employees")||"[]");a(e)}})]})},Up=Vt("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),Bp=Vt("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]),Wp=Vt("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]),Hp=Vt("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]),Vp=Vt("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),Gp=Vt("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),$p=Vt("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);const qp=new class{async createCompany(e){try{console.log("Posting company data to API:",e);const t=await _t.post("/companies",e);if(console.log("API Response:",t),t&&t.success&&t.data)return t.data;if(t&&t.error)throw new Error(t.error);throw new Error("Failed to create company")}catch(t){throw console.error("Company creation error:",t),t}}async getCompanyById(e){try{const t=await _t.get("/companies/".concat(e));if(t&&t.success&&t.data)return t.data;throw new Error("Failed to fetch company")}catch(t){throw console.error("Error fetching company:",t),t}}async getAllCompanies(){try{const e=await _t.get("/companies");if(e&&e.success&&e.data)return e.data;throw new Error("Failed to fetch companies")}catch(e){throw console.error("Error fetching companies:",e),e}}async updateCompany(e,t){try{const a=await _t.put("/companies/".concat(e),t);if(a&&a.success&&a.data)return a.data;throw new Error("Failed to update company")}catch(a){throw console.error("Error updating company:",a),a}}async deleteCompany(e){try{const t=await _t.delete("/companies/".concat(e));if(t&&t.success)return{success:!0};throw new Error("Failed to delete company")}catch(t){throw console.error("Error deleting company:",t),t}}async getCompanyStats(e){try{const t=await _t.get("/companies/".concat(e,"/stats"));if(t&&t.success&&t.data)return t.data;throw new Error("Failed to fetch company stats")}catch(t){throw console.error("Error fetching stats:",t),t}}async getCompanySubscription(e){try{const t=await _t.get("/companies/".concat(e,"/subscription"));if(t&&t.success&&t.data)return t.data;throw new Error("Failed to fetch subscription")}catch(t){throw console.error("Error fetching subscription:",t),t}}async updateCompanySettings(e,t){try{const a=await _t.put("/companies/".concat(e,"/settings"),t);if(a&&a.success&&a.data)return a.data;throw new Error("Failed to update settings")}catch(a){throw console.error("Error updating settings:",a),a}}async getCompanyUsers(e){try{const t=await _t.get("/companies/".concat(e,"/users"));if(t&&t.success&&t.data)return t.data;throw new Error("Failed to fetch company users")}catch(t){throw console.error("Error fetching users:",t),t}}async createCompanyUser(e,t){try{const a=await _t.post("/companies/".concat(e,"/users"),t);if(a&&a.success&&a.data)return a.data;throw new Error("Failed to create user")}catch(a){throw console.error("Error creating user:",a),a}}async updateCompanyUser(e,t,a){try{const r=await _t.put("/companies/".concat(e,"/users/").concat(t),a);if(r&&r.success&&r.data)return r.data;throw new Error("Failed to update user")}catch(r){throw console.error("Error updating user:",r),r}}async deleteCompanyUser(e,t){try{const a=await _t.delete("/companies/".concat(e,"/users/").concat(t));if(a&&a.success)return{success:!0};throw new Error("Failed to delete user")}catch(a){throw console.error("Error deleting user:",a),a}}async createEmployeeWithTempPassword(e){try{const t=await _t.post("/auth/supabase/create-employee",{email:e.email,name:e.name,company_id:e.company_id,department:e.department,position:e.position,employee_id:e.employee_id,phone:e.phone});if(t&&t.success&&t.data)return t.data;throw new Error("Failed to create employee")}catch(t){throw console.error("Error creating employee:",t),t}}async getEmployeesWithCredentialStatus(e){try{const t=await _t.get("/auth/supabase/company/".concat(e,"/employees-status"));if(t&&t.success&&t.data)return t.data;throw new Error("Failed to get employee status")}catch(t){throw console.error("Error fetching employee status:",t),t}}async getMyCompanyProfile(){const e=this.getCurrentCompanyId();if(!e)throw new Error("No company ID found");return this.getCompanyById(e)}async updateMyCompanyProfile(e){const t=this.getCurrentCompanyId();if(!t)throw new Error("No company ID found");return this.updateCompany(t,e)}getCurrentCompanyId(){const e=localStorage.getItem("company_id");if(e)return e;const t=localStorage.getItem("userProfile");if(t)try{return JSON.parse(t).company_id}catch(a){return null}return null}storeCompanyId(e){localStorage.setItem("company_id",e)}clearCompanyId(){localStorage.removeItem("company_id")}isAdmin(){const e=localStorage.getItem("userProfile");if(e)try{return"admin"===JSON.parse(e).role}catch(t){return!1}return!1}canManageCompany(e){if(this.isAdmin())return!0;return this.getCurrentCompanyId()===e}async getAllCompaniesAdmin(){try{const e=await _t.get("/admin/companies");if(e&&e.success&&e.data)return e.data;throw new Error("Failed to fetch companies")}catch(e){throw console.error("Error fetching admin companies:",e),e}}async deleteCompanyAdmin(e){try{const t=await _t.delete("/admin/companies/".concat(e));if(t&&t.success)return{success:!0};throw new Error("Failed to delete company")}catch(t){throw console.error("Error deleting company (admin):",t),t}}async getSubscriptionConfig(e){try{const t=await _t.get("/companies/".concat(e,"/subscription-config"));if(t&&t.success&&t.data)return t.data;if(t&&404===t.status)return null;throw new Error("Failed to fetch subscription configuration")}catch(t){if(t.response&&404===t.response.status)return null;throw console.error("Error fetching subscription config:",t),t}}async updateSubscriptionConfig(e,t){try{const a=await _t.put("/companies/".concat(e,"/subscription-config"),t);if(a&&a.success&&a.data)return a.data;throw new Error("Failed to update subscription configuration")}catch(a){throw console.error("Error updating subscription config:",a),a}}async createSubscriptionConfig(e,t){try{const a=await _t.post("/companies/".concat(e,"/subscription-config"),t);if(a&&a.success&&a.data)return a.data;throw new Error("Failed to create subscription configuration")}catch(a){throw console.error("Error creating subscription config:",a),a}}},Yp=e=>{let{credentials:t,onClose:a}=e;const[n,s]=(0,r.useState)(!1),[i,o]=(0,r.useState)(!1),[l,c]=(0,r.useState)(!1);return(0,Pt.jsx)("div",{className:"credentials-overlay",children:(0,Pt.jsxs)("div",{className:"credentials-modal",children:[(0,Pt.jsxs)("div",{className:"credentials-header",children:[(0,Pt.jsx)("h2",{children:"Company Login Credentials Created"}),(0,Pt.jsx)("p",{children:"Please save these credentials and share them with the company."})]}),(0,Pt.jsxs)("div",{className:"credentials-content",children:[(0,Pt.jsxs)("div",{className:"credential-item",children:[(0,Pt.jsx)("label",{children:"Login Email:"}),(0,Pt.jsx)("div",{className:"credential-value",children:(0,Pt.jsx)("input",{type:"text",value:t.email,readOnly:!0})})]}),(0,Pt.jsxs)("div",{className:"credential-item",children:[(0,Pt.jsx)("label",{children:"Temporary Password:"}),(0,Pt.jsxs)("div",{className:"credential-value",children:[(0,Pt.jsx)("input",{type:i?"text":"password",value:t.temporaryPassword,readOnly:!0}),(0,Pt.jsx)("button",{type:"button",onClick:()=>o(!i),className:"toggle-password",children:i?(0,Pt.jsx)($t,{size:16}):(0,Pt.jsx)(qt,{size:16})})]})]}),(0,Pt.jsxs)("div",{className:"credentials-warning",children:[(0,Pt.jsx)("strong",{children:"Important:"})," This is a temporary password. The company will be required to change it on their first login."]})]}),(0,Pt.jsxs)("div",{className:"credentials-actions",children:[(0,Pt.jsxs)("button",{onClick:async()=>{const e="\nCompany Login Credentials\nEmail: ".concat(t.email,"\nTemporary Password: ").concat(t.temporaryPassword,"\n\nImportant: This is a temporary password. The company will need to set a new password on first login.\n    ").trim();try{await navigator.clipboard.writeText(e),s(!0),setTimeout(()=>s(!1),2e3)}catch(a){console.error("Failed to copy:",a)}},className:"copy-button",children:[(0,Pt.jsx)($p,{size:16}),n?"Copied!":"Copy Credentials"]}),(0,Pt.jsxs)("button",{onClick:async()=>{c(!0);try{await qp.sendCompanyCredentials(t.companyId,t.email,t.temporaryPassword),alert("Credentials sent successfully to "+t.email)}catch(e){alert("Failed to send credentials: "+e.message)}finally{c(!1)}},className:"send-button",disabled:l,children:[(0,Pt.jsx)(Hp,{size:16}),l?"Sending...":"Send via Email"]}),(0,Pt.jsx)("button",{onClick:a,className:"close-button",children:"Close"})]})]})})},Xp=Vt("briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]),Kp=Vt("globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]),Jp=Vt("key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]),Qp=Vt("loader",[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]]),Zp=e=>{let{onSuccess:t,onBack:a}=e;const n=ge(),[s,i]=(0,r.useState)({name:"",email:"",phone:"",website:"",address:"",industry:"",size:"",description:"",contactPerson:"",contactPersonEmail:"",contactPersonPhone:"",contactPersonPosition:"",subscriptionPlan:"basic",status:"active",createLogin:!0,loginEmail:"",temporaryPassword:""}),[o,l]=(0,r.useState)(!1),[c,d]=(0,r.useState)({}),[f,h]=(0,r.useState)(!1),[m,p]=(0,r.useState)(!1),[g,v]=(0,r.useState)(null),y=()=>{const e="ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnpqrstuvwxyz23456789!@#$%";let t="";for(let a=0;a<12;a++)t+=e.charAt(Math.floor(61*Math.random()));return t};(0,r.useEffect)(()=>{if(s.createLogin){const e=y();i(t=>u(u({},t),{},{temporaryPassword:e}))}},[s.createLogin]),(0,r.useEffect)(()=>{s.createLogin&&s.email&&i(e=>u(u({},e),{},{loginEmail:s.email}))},[s.email,s.createLogin]);const b=e=>{e.persist();const{name:t,value:a,type:r,checked:n}=e.target;i(e=>u(u({},e),{},{[t]:"checkbox"===r?n:a})),c[t]&&d(e=>u(u({},e),{},{[t]:""}))};return f&&g?(0,Pt.jsx)("div",{className:"add-company-container",children:(0,Pt.jsx)("div",{className:"add-company-content",children:(0,Pt.jsxs)("div",{className:"success-container",children:[(0,Pt.jsx)(Xa,{className:"success-icon",size:64}),(0,Pt.jsx)("h2",{children:"Company Created Successfully!"}),(0,Pt.jsx)("p",{children:"The company has been registered in the system."}),(0,Pt.jsxs)("div",{className:"credentials-display",children:[(0,Pt.jsx)("h3",{children:"Login Credentials"}),(0,Pt.jsxs)("div",{className:"credentials-info",children:[(0,Pt.jsxs)("div",{className:"credential-item",children:[(0,Pt.jsx)("span",{className:"label",children:"Company Name:"}),(0,Pt.jsx)("span",{className:"value",children:g.companyName})]}),(0,Pt.jsxs)("div",{className:"credential-item",children:[(0,Pt.jsx)("span",{className:"label",children:"Email:"}),(0,Pt.jsx)("span",{className:"value",children:g.email})]}),(0,Pt.jsxs)("div",{className:"credential-item",children:[(0,Pt.jsx)("span",{className:"label",children:"Temporary Password:"}),(0,Pt.jsx)("span",{className:"value password",children:g.password})]})]}),(0,Pt.jsx)("p",{className:"credentials-note",children:"\u26a0\ufe0f Please save these credentials securely. The company will be required to change the password on first login."})]}),(0,Pt.jsx)("p",{className:"redirect-notice",children:"Redirecting to companies list..."})]})})}):(0,Pt.jsx)("div",{className:"add-company-container",children:(0,Pt.jsxs)("div",{className:"add-company-content",children:[(0,Pt.jsxs)("div",{className:"page-header",children:[a&&(0,Pt.jsxs)("button",{className:"back-button",onClick:a,children:[(0,Pt.jsx)(Ra,{size:16}),"Back to Companies"]}),(0,Pt.jsxs)("div",{className:"header-title",children:[(0,Pt.jsx)("h1",{children:"Add New Company"}),(0,Pt.jsx)("p",{children:"Fill in the company details to create a new organization"})]})]}),(0,Pt.jsx)("div",{className:"form-container",children:(0,Pt.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),console.log("Form submission started..."),console.log("Form data:",s);const a=(()=>{const e={};if(s.name.trim()||(e.name="Company name is required"),s.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s.email)||(e.email="Please enter a valid email address"):e.email="Company email is required",s.phone.trim()){const t=s.phone.replace(/\D/g,"");10!==(t.length>10?t.slice(-10):t).length&&(e.phone="Phone number must be exactly 10 digits")}else e.phone="Company phone is required";if(s.contactPerson.trim()||(e.contactPerson="Contact person name is required"),s.contactPersonEmail.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s.contactPersonEmail)||(e.contactPersonEmail="Please enter a valid email address"):e.contactPersonEmail="Contact person email is required",s.industry.trim()||(e.industry="Industry is required"),s.size||(e.size="Company size is required"),s.subscriptionPlan||(e.subscriptionPlan="Subscription plan is required"),s.contactPersonPhone.trim()){const t=s.contactPersonPhone.replace(/\D/g,"");10!==(t.length>10?t.slice(-10):t).length&&(e.contactPersonPhone="Phone number must be exactly 10 digits")}return s.website&&!/^https?:\/\/.+/.test(s.website)&&(e.website="Website must start with http:// or https://"),s.createLogin&&(s.loginEmail.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s.loginEmail)||(e.loginEmail="Please enter a valid email address"):e.loginEmail="Login email is required",s.temporaryPassword.trim()?s.temporaryPassword.length<8&&(e.temporaryPassword="Password must be at least 8 characters"):e.temporaryPassword="Temporary password is required"),e})();if(console.log("Validation errors:",a),Object.keys(a).length>0)return console.log("Form validation failed, stopping submission"),void d(a);console.log("Form validation passed, proceeding with submission..."),l(!0),d({});try{var r,i;const e=s.name.toLowerCase().replace(/[^a-z0-9\s-]/g,"").trim().replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-+|-+$/g,""),a="".concat(e,".com");console.log("Generated domain:",a);const o={1:"1-10",50:"11-50",100:"51-100",200:"101-200",500:"201-500",1e3:"500+"},l={name:s.name,domain:a,industry:s.industry,companySize:o[s.size]||"11-50",description:s.description||"".concat(s.name," - Leading solutions provider"),website:s.website||"https://".concat(a),address:{street:s.address||"123 Business Street",city:"Default City",state:"Default State",zipCode:"12345",country:"India"},contact:{email:s.email,phone:s.phone.replace(/\D/g,"").slice(-10)},ownerName:s.contactPerson,ownerEmail:s.contactPersonEmail||s.email,ownerPassword:s.temporaryPassword,employee_subscription_config:{default_plan_type:s.subscriptionPlan,default_validity_days:90,subscription_expiry_days:180,account_expiry_days:365,employee_limit:100,auto_assign_subscription:!0,enforce_employee_limit:!0,allowed_plan_types:["basic","premium","ultra"]}};console.log("Sending payload to API:",l);const c=await qp.createCompany(l);console.log("Company created successfully:",c),v({companyName:(null===(r=c.company)||void 0===r?void 0:r.name)||s.name,email:s.loginEmail,password:s.temporaryPassword,companyId:null===(i=c.company)||void 0===i?void 0:i.id}),h(!0),t?setTimeout(()=>{t(c)},3e3):setTimeout(()=>{n("/admin/companies")},3e3)}catch(o){console.error("Error creating company:",o),d({submit:o.message||"Failed to create company. Please try again."})}finally{l(!1)}},className:"company-form",children:[(0,Pt.jsxs)("div",{className:"form-section",children:[(0,Pt.jsxs)("div",{className:"section-header",children:[(0,Pt.jsx)(ea,{size:24}),(0,Pt.jsx)("h2",{children:"Company Information"})]}),(0,Pt.jsxs)("div",{className:"form-grid",children:[(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsxs)("label",{htmlFor:"name",className:"required",children:[(0,Pt.jsx)(ea,{size:16}),"Company Name"]}),(0,Pt.jsx)("input",{type:"text",id:"name",name:"name",value:s.name,onChange:b,className:c.name?"error":"",placeholder:"Enter company name",disabled:o}),c.name&&(0,Pt.jsx)("span",{className:"error-message",children:c.name})]}),(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsxs)("label",{htmlFor:"industry",className:"required",children:[(0,Pt.jsx)(Xp,{size:16}),"Industry"]}),(0,Pt.jsxs)("select",{id:"industry",name:"industry",value:s.industry,onChange:b,className:c.industry?"error":"",disabled:o,children:[(0,Pt.jsx)("option",{value:"",children:"Select Industry"}),(0,Pt.jsx)("option",{value:"Technology",children:"Technology"}),(0,Pt.jsx)("option",{value:"Healthcare",children:"Healthcare"}),(0,Pt.jsx)("option",{value:"Finance",children:"Finance"}),(0,Pt.jsx)("option",{value:"Education",children:"Education"}),(0,Pt.jsx)("option",{value:"Retail",children:"Retail"}),(0,Pt.jsx)("option",{value:"Manufacturing",children:"Manufacturing"}),(0,Pt.jsx)("option",{value:"Services",children:"Services"}),(0,Pt.jsx)("option",{value:"Other",children:"Other"})]}),c.industry&&(0,Pt.jsx)("span",{className:"error-message",children:c.industry})]}),(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsxs)("label",{htmlFor:"email",className:"required",children:[(0,Pt.jsx)(Hp,{size:16}),"Company Email"]}),(0,Pt.jsx)("input",{type:"email",id:"email",name:"email",value:s.email,onChange:b,className:c.email?"error":"",placeholder:"company@example.com",disabled:o}),c.email&&(0,Pt.jsx)("span",{className:"error-message",children:c.email})]}),(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsxs)("label",{htmlFor:"phone",className:"required",children:[(0,Pt.jsx)(Ia,{size:16}),"Company Phone"]}),(0,Pt.jsx)(Ma,{id:"company-phone",value:s.phone,onChange:e=>i(t=>u(u({},t),{},{phone:e})),placeholder:"Enter phone number",disabled:o,error:c.phone}),c.phone&&(0,Pt.jsx)("span",{className:"error-message",children:c.phone})]}),(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsxs)("label",{htmlFor:"website",children:[(0,Pt.jsx)(Kp,{size:16}),"Website"]}),(0,Pt.jsx)("input",{type:"url",id:"website",name:"website",value:s.website,onChange:b,className:c.website?"error":"",placeholder:"https://company.com",disabled:o}),c.website&&(0,Pt.jsx)("span",{className:"error-message",children:c.website})]}),(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsxs)("label",{htmlFor:"size",className:"required",children:[(0,Pt.jsx)(la,{size:16}),"Company Size"]}),(0,Pt.jsxs)("select",{id:"size",name:"size",value:s.size,onChange:b,className:c.size?"error":"",disabled:o,children:[(0,Pt.jsx)("option",{value:"",children:"Select Size"}),(0,Pt.jsx)("option",{value:"1",children:"1-10 employees"}),(0,Pt.jsx)("option",{value:"50",children:"11-50 employees"}),(0,Pt.jsx)("option",{value:"100",children:"51-100 employees"}),(0,Pt.jsx)("option",{value:"200",children:"101-200 employees"}),(0,Pt.jsx)("option",{value:"500",children:"201-500 employees"}),(0,Pt.jsx)("option",{value:"1000",children:"500+ employees"})]}),c.size&&(0,Pt.jsx)("span",{className:"error-message",children:c.size})]}),(0,Pt.jsxs)("div",{className:"form-group full-width",children:[(0,Pt.jsxs)("label",{htmlFor:"address",children:[(0,Pt.jsx)(Vp,{size:16}),"Address"]}),(0,Pt.jsx)("textarea",{id:"address",name:"address",value:s.address,onChange:b,placeholder:"Enter company address",rows:3,disabled:o})]}),(0,Pt.jsxs)("div",{className:"form-group full-width",children:[(0,Pt.jsx)("label",{htmlFor:"description",children:"Description"}),(0,Pt.jsx)("textarea",{id:"description",name:"description",value:s.description,onChange:b,placeholder:"Brief description about the company",rows:3,disabled:o})]})]})]}),(0,Pt.jsxs)("div",{className:"form-section",children:[(0,Pt.jsxs)("div",{className:"section-header",children:[(0,Pt.jsx)(Sa,{size:24}),(0,Pt.jsx)("h2",{children:"Contact Person Details"})]}),(0,Pt.jsxs)("div",{className:"form-grid",children:[(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsxs)("label",{htmlFor:"contactPerson",className:"required",children:[(0,Pt.jsx)(Sa,{size:16}),"Contact Person Name"]}),(0,Pt.jsx)("input",{type:"text",id:"contactPerson",name:"contactPerson",value:s.contactPerson,onChange:b,className:c.contactPerson?"error":"",placeholder:"Enter contact person name",disabled:o}),c.contactPerson&&(0,Pt.jsx)("span",{className:"error-message",children:c.contactPerson})]}),(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsx)("label",{htmlFor:"contactPersonPosition",children:"Position"}),(0,Pt.jsx)("input",{type:"text",id:"contactPersonPosition",name:"contactPersonPosition",value:s.contactPersonPosition,onChange:b,placeholder:"e.g., HR Manager, CEO",disabled:o})]}),(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsxs)("label",{htmlFor:"contactPersonEmail",className:"required",children:[(0,Pt.jsx)(Hp,{size:16}),"Contact Email"]}),(0,Pt.jsx)("input",{type:"email",id:"contactPersonEmail",name:"contactPersonEmail",value:s.contactPersonEmail,onChange:b,className:c.contactPersonEmail?"error":"",placeholder:"contact@company.com",disabled:o}),c.contactPersonEmail&&(0,Pt.jsx)("span",{className:"error-message",children:c.contactPersonEmail})]}),(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsxs)("label",{htmlFor:"contactPersonPhone",children:[(0,Pt.jsx)(Ia,{size:16}),"Contact Phone"]}),(0,Pt.jsx)(Ma,{id:"contact-phone",value:s.contactPersonPhone,onChange:e=>i(t=>u(u({},t),{},{contactPersonPhone:e})),placeholder:"Contact person phone",disabled:o,error:c.contactPersonPhone}),c.contactPersonPhone&&(0,Pt.jsx)("span",{className:"error-message",children:c.contactPersonPhone})]})]})]}),(0,Pt.jsxs)("div",{className:"form-section",children:[(0,Pt.jsxs)("div",{className:"section-header",children:[(0,Pt.jsx)(Gt,{size:24}),(0,Pt.jsx)("h2",{children:"Subscription Plan Selection"})]}),(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsx)("label",{htmlFor:"subscriptionPlan",className:"required",children:"Select Subscription Plan for this Company"}),(0,Pt.jsx)("select",{id:"subscriptionPlan",name:"subscriptionPlan",value:s.subscriptionPlan,onChange:b,className:c.subscriptionPlan?"error":"",disabled:o,children:[{value:"basic",label:"Basic Plan",description:"Up to 50 employees"},{value:"premium",label:"Premium Plan",description:"Up to 200 employees"},{value:"ultra",label:"Ultra Plan",description:"Unlimited employees"}].map(e=>(0,Pt.jsxs)("option",{value:e.value,children:[e.label," - ",e.description]},e.value))}),c.subscriptionPlan&&(0,Pt.jsx)("span",{className:"error-message",children:c.subscriptionPlan}),(0,Pt.jsx)("p",{className:"form-hint",children:"Choose the appropriate subscription plan based on the company's size and requirements"})]}),(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsx)("label",{htmlFor:"status",children:"Company Status"}),(0,Pt.jsxs)("select",{id:"status",name:"status",value:s.status,onChange:b,disabled:o,children:[(0,Pt.jsx)("option",{value:"active",children:"Active"}),(0,Pt.jsx)("option",{value:"inactive",children:"Inactive"}),(0,Pt.jsx)("option",{value:"suspended",children:"Suspended"})]})]})]}),(0,Pt.jsxs)("div",{className:"form-section",children:[(0,Pt.jsxs)("div",{className:"section-header",children:[(0,Pt.jsx)(Jp,{size:24}),(0,Pt.jsx)("h2",{children:"Login Credentials"})]}),(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsxs)("label",{className:"checkbox-label",children:[(0,Pt.jsx)("input",{type:"checkbox",name:"createLogin",checked:s.createLogin,onChange:b,disabled:o}),(0,Pt.jsx)("span",{className:"checkmark"}),"Create login credentials for this company"]}),(0,Pt.jsx)("p",{className:"form-hint",children:"Enable this to create login access for the company to use the platform"})]}),s.createLogin&&(0,Pt.jsxs)("div",{className:"credentials-fields",children:[(0,Pt.jsxs)("div",{className:"form-grid",children:[(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsxs)("label",{htmlFor:"loginEmail",className:"required",children:[(0,Pt.jsx)(Hp,{size:16}),"Login Email"]}),(0,Pt.jsx)("input",{type:"email",id:"loginEmail",name:"loginEmail",value:s.loginEmail,onChange:b,className:c.loginEmail?"error":"",placeholder:"login@company.com",disabled:o}),c.loginEmail&&(0,Pt.jsx)("span",{className:"error-message",children:c.loginEmail}),(0,Pt.jsx)("p",{className:"form-hint",children:"This email will be used for company login"})]}),(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsxs)("label",{htmlFor:"temporaryPassword",className:"required",children:[(0,Pt.jsx)(Jp,{size:16}),"Password"]}),(0,Pt.jsxs)("div",{className:"password-input",children:[(0,Pt.jsx)("input",{type:m?"text":"password",id:"temporaryPassword",name:"temporaryPassword",value:s.temporaryPassword,onChange:b,className:c.temporaryPassword?"error":"",disabled:o}),(0,Pt.jsx)("button",{type:"button",className:"password-toggle",onClick:()=>p(!m),disabled:o,children:m?(0,Pt.jsx)($t,{size:16}):(0,Pt.jsx)(qt,{size:16})})]}),c.temporaryPassword&&(0,Pt.jsx)("span",{className:"error-message",children:c.temporaryPassword}),(0,Pt.jsx)("p",{className:"form-hint",children:"Company will be required to change this password on first login"})]})]}),(0,Pt.jsx)("button",{type:"button",className:"generate-password-btn",onClick:()=>i(e=>u(u({},e),{},{temporaryPassword:y()})),disabled:o,children:"Generate New Password"})]})]}),(0,Pt.jsxs)("div",{className:"form-actions",children:[c.submit&&(0,Pt.jsxs)("div",{className:"error-alert",children:[(0,Pt.jsx)(Yt,{size:16}),c.submit]}),(0,Pt.jsx)("button",{type:"button",className:"reset-btn",onClick:()=>{i({name:"",email:"",phone:"",website:"",address:"",industry:"",size:"",description:"",contactPerson:"",contactPersonEmail:"",contactPersonPhone:"",contactPersonPosition:"",subscriptionPlan:"basic",status:"active",createLogin:!0,loginEmail:"",temporaryPassword:""}),d({}),h(!1),v(null)},disabled:o,children:"Reset Form"}),(0,Pt.jsx)("button",{type:"submit",className:"submit-btn",disabled:o,children:o?(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)(Qp,{className:"spinning",size:16}),"Creating Company"]}):(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)(wa,{size:16}),"Create Company"]})})]})]})})]})})},eg=()=>{const e=ge(),t=he(),{id:a}=ve(),[n,s]=(0,r.useState)("list"),[i,o]=(0,r.useState)(!1),[l,c]=(0,r.useState)([]),[d,f]=(0,r.useState)({}),[h,m]=(0,r.useState)(""),[p,g]=(0,r.useState)("all"),[v,y]=(0,r.useState)(null),[b,w]=(0,r.useState)(null),[x,k]=(0,r.useState)(null),[S,E]=(0,r.useState)(null),[T,N]=(0,r.useState)(null),[j,C]=(0,r.useState)(!1),[_,A]=(0,r.useState)({name:"",email:"",phone:"",address:"",contactPerson:"",contactPersonEmail:"",contactPersonPhone:"",description:"",website:"",industry:"",size:"",status:"active",loginEmail:"",temporaryPassword:"",generatePassword:!1}),[P,R]=(0,r.useState)(""),[O,D]=(0,r.useState)(!1),F=()=>{const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*";let t="";for(let a=0;a<12;a++)t+=e.charAt(Math.floor(70*Math.random()));return t};(0,r.useEffect)(()=>{"list"===n&&I(),t.state&&(t.state.showCredentials&&w(t.state.showCredentials),t.state.message&&(k({message:t.state.message,type:t.state.type||"success"}),setTimeout(()=>k(null),5e3)),window.history.replaceState({},document.title)),a&&"list"===n&&(s("edit"),L(a))},[n,t.state,a]);const I=async()=>{try{o(!0);const e=await qp.getAllCompaniesAdmin();Array.isArray(e)?c(e):e.data&&Array.isArray(e.data)?c(e.data):c([])}catch(t){var e;console.error("Error loading companies:",t),c([]),k({type:"error",message:null!==t&&void 0!==t&&null!==(e=t.message)&&void 0!==e&&e.includes("Server error")?"Unable to load company list. Server may be temporarily unavailable.":"Failed to load company list. Please try again."}),setTimeout(()=>k(null),5e3)}finally{o(!1)}},L=async e=>{try{o(!0);const t=await qp.getCompanyById(e);if(t&&(t.success||t.id)){const e=t.data||t;E(e),A({name:e.name||"",email:e.email||"",phone:e.phone||"",address:e.address||"",contactPerson:e.contactPerson||"",contactPersonEmail:e.contactPersonEmail||"",contactPersonPhone:e.contactPersonPhone||"",description:e.description||"",website:e.website||"",industry:e.industry||"",size:e.size||"",status:e.status||"active"})}}catch(t){console.error("Error loading company:",t),f({load:"Failed to load company details"})}finally{o(!1)}},M=e=>{const{name:t,value:a,type:r,checked:n}=e.target,s="checkbox"===r?n:a;if(A(e=>u(u({},e),{},{[t]:s})),"generatePassword"===t)if(n){const e=F();R(e),A(t=>u(u({},t),{},{temporaryPassword:e}))}else R(""),D(!1),A(e=>u(u({},e),{},{temporaryPassword:""}));d[t]&&f(e=>u(u({},e),{},{[t]:""}))},z=async e=>{if(e.preventDefault(),(()=>{const e={};return _.name.trim()||(e.name="Company name is required"),_.email.trim()?/\S+@\S+\.\S+/.test(_.email)||(e.email="Please enter a valid email"):e.email="Email is required",_.contactPerson.trim()||(e.contactPerson="Contact person name is required"),_.contactPersonEmail.trim()?/\S+@\S+\.\S+/.test(_.contactPersonEmail)||(e.contactPersonEmail="Please enter a valid contact person email"):e.contactPersonEmail="Contact person email is required","add"===n&&(_.loginEmail.trim()?/\S+@\S+\.\S+/.test(_.loginEmail)||(e.loginEmail="Please enter a valid login email"):e.loginEmail="Login email is required",_.generatePassword||_.temporaryPassword.trim()?!_.generatePassword&&_.temporaryPassword.length<8&&(e.temporaryPassword="Password must be at least 8 characters long"):e.temporaryPassword="Temporary password is required"),f(e),0===Object.keys(e).length})()){o(!0);try{if("edit"===n&&S){const e=await qp.updateCompany(S.id,_);e.success||e.id?(s("list"),k({message:"Company updated successfully",type:"success"}),setTimeout(()=>k(null),5e3),I()):f({submit:e.error||"Failed to update company"})}else{const e=await qp.createCompany(_);if(e.success||e.id){var t;const r=(null===(t=e.data)||void 0===t?void 0:t.id)||e.id;try{const e=await qp.createCompanyLogin({companyId:r,email:_.contactPersonEmail,password:Math.random().toString(36).slice(-8),contactPersonName:_.contactPerson});(e.success||e.username)&&(s("list"),w({username:e.username||_.contactPersonEmail,password:e.password,companyName:_.name,contactPerson:_.contactPerson}),I())}catch(a){console.error("Company created but login creation failed:",a),s("list"),k({message:"Company created successfully, but login creation failed",type:"warning"}),setTimeout(()=>k(null),5e3),I()}}else f({submit:e.error||"Failed to create company"})}}catch(r){console.error("Error submitting form:",r),f({submit:r.message||"Failed to process request"})}finally{o(!1)}}},U=l.filter(e=>{var t,a,r;const n=(null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(h.toLowerCase()))||(null===(a=e.email)||void 0===a?void 0:a.toLowerCase().includes(h.toLowerCase()))||(null===(r=e.contactPerson)||void 0===r?void 0:r.toLowerCase().includes(h.toLowerCase())),s="all"===p||e.status===p;return n&&s}),B=e=>{let{company:t}=e;return(0,Pt.jsxs)("tr",{className:"company-row",children:[(0,Pt.jsx)("td",{children:(0,Pt.jsxs)("div",{className:"company-info",children:[(0,Pt.jsx)("div",{className:"company-avatar",children:(0,Pt.jsx)(ea,{size:20})}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("div",{className:"company-name",children:t.name}),(0,Pt.jsx)("div",{className:"company-email",children:t.email})]})]})}),(0,Pt.jsx)("td",{children:(0,Pt.jsx)("div",{className:"contact-person",children:t.contactPerson||"N/A"})}),(0,Pt.jsx)("td",{children:(0,Pt.jsxs)("div",{className:"status-badge ".concat(t.status),children:["active"===t.status?(0,Pt.jsx)(Xa,{size:14}):(0,Pt.jsx)(Up,{size:14}),t.status]})}),(0,Pt.jsx)("td",{children:(0,Pt.jsxs)("div",{className:"employee-count",children:[(0,Pt.jsx)(la,{size:14}),t.employeeCount||0]})}),(0,Pt.jsx)("td",{children:(0,Pt.jsx)("div",{className:"subscription-plan",children:t.subscriptionPlan||"Standard"})}),(0,Pt.jsx)("td",{children:(0,Pt.jsx)("div",{className:"created-date",children:t.createdAt?new Date(t.createdAt).toLocaleDateString():"N/A"})}),(0,Pt.jsx)("td",{children:(0,Pt.jsxs)("div",{className:"actions",children:[(0,Pt.jsx)("button",{className:"action-btn edit",onClick:()=>(e=>{E(e),A({name:e.name||"",email:e.email||"",phone:e.phone||"",address:e.address||"",contactPerson:e.contactPerson||"",contactPersonEmail:e.contactPersonEmail||"",contactPersonPhone:e.contactPersonPhone||"",description:e.description||"",website:e.website||"",industry:e.industry||"",size:e.size||"",status:e.status||"active"}),s("edit")})(t),title:"Edit Company",children:(0,Pt.jsx)(Bp,{size:16})}),(0,Pt.jsx)("button",{className:"action-btn subscription",onClick:()=>N(t),title:"Manage Subscription",children:(0,Pt.jsx)(ua,{size:16})}),(0,Pt.jsx)("button",{className:"action-btn delete",onClick:()=>y(t.id),title:"Delete Company",children:(0,Pt.jsx)($a,{size:16})})]})})]})},W=()=>(0,Pt.jsxs)("div",{className:"company-management-list",children:[(0,Pt.jsxs)("div",{className:"page-header",children:[(0,Pt.jsxs)("div",{className:"header-left",children:[(0,Pt.jsxs)("button",{className:"back-button",onClick:()=>e("/admin/dashboard"),children:[(0,Pt.jsx)(Ra,{size:20}),(0,Pt.jsx)("span",{children:"Back to Dashboard"})]}),(0,Pt.jsx)("h1",{children:"Company Management"}),(0,Pt.jsx)("p",{children:"Manage all registered companies"})]}),(0,Pt.jsxs)("button",{className:"btn-primary",onClick:()=>{return s(e="add"),f({}),R(""),D(!1),void("add"===e&&(A({name:"",email:"",phone:"",address:"",contactPerson:"",contactPersonEmail:"",contactPersonPhone:"",description:"",website:"",industry:"",size:"",status:"active",loginEmail:"",temporaryPassword:"",generatePassword:!1}),E(null)));var e},children:[(0,Pt.jsx)(ka,{size:20}),"Add Company"]})]}),(0,Pt.jsxs)("div",{className:"filters-bar",children:[(0,Pt.jsxs)("div",{className:"search-box",children:[(0,Pt.jsx)(Ha,{size:20}),(0,Pt.jsx)("input",{type:"text",placeholder:"Search companies...",value:h,onChange:e=>m(e.target.value)})]}),(0,Pt.jsxs)("div",{className:"filter-group",children:[(0,Pt.jsx)(Wp,{size:20}),(0,Pt.jsxs)("select",{value:p,onChange:e=>g(e.target.value),children:[(0,Pt.jsx)("option",{value:"all",children:"All Status"}),(0,Pt.jsx)("option",{value:"active",children:"Active"}),(0,Pt.jsx)("option",{value:"inactive",children:"Inactive"})]})]})]}),(0,Pt.jsx)("div",{className:"table-container",children:i?(0,Pt.jsxs)("div",{className:"loading-state",children:[(0,Pt.jsx)("div",{className:"spinner"}),(0,Pt.jsx)("p",{children:"Loading companies..."})]}):(0,Pt.jsxs)("table",{className:"companies-table",children:[(0,Pt.jsx)("thead",{children:(0,Pt.jsxs)("tr",{children:[(0,Pt.jsx)("th",{children:"Company"}),(0,Pt.jsx)("th",{children:"Contact Person"}),(0,Pt.jsx)("th",{children:"Status"}),(0,Pt.jsx)("th",{children:"Employees"}),(0,Pt.jsx)("th",{children:"Plan"}),(0,Pt.jsx)("th",{children:"Created"}),(0,Pt.jsx)("th",{children:"Actions"})]})}),(0,Pt.jsx)("tbody",{children:U.length>0?U.map(e=>(0,Pt.jsx)(B,{company:e},e.id)):(0,Pt.jsx)("tr",{children:(0,Pt.jsx)("td",{colSpan:"7",className:"no-data",children:"No companies found"})})})]})})]}),H=()=>(0,Pt.jsxs)("div",{className:"add-company-container",children:[(0,Pt.jsxs)("div",{className:"add-company-header",children:[(0,Pt.jsxs)("button",{onClick:()=>s("list"),className:"back-button",children:[(0,Pt.jsx)(Ra,{size:20}),(0,Pt.jsx)("span",{children:"Back to Companies"})]}),(0,Pt.jsxs)("div",{className:"page-title",children:[(0,Pt.jsx)(ea,{size:24}),(0,Pt.jsx)("h1",{children:"edit"===n?"Edit Company":"Add New Company"})]})]}),(0,Pt.jsx)("div",{className:"add-company-content",children:(0,Pt.jsxs)("form",{onSubmit:z,className:"company-form",children:[d.submit&&(0,Pt.jsx)("div",{className:"error-message",children:d.submit}),d.load&&(0,Pt.jsx)("div",{className:"error-message",children:d.load}),(0,Pt.jsxs)("div",{className:"form-section",children:[(0,Pt.jsx)("h3",{children:"Company Information"}),(0,Pt.jsxs)("div",{className:"form-row",children:[(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsxs)("label",{htmlFor:"name",children:[(0,Pt.jsx)(ea,{size:16}),"Company Name *"]}),(0,Pt.jsx)("input",{type:"text",id:"name",name:"name",value:_.name,onChange:M,className:d.name?"error":"",placeholder:"Enter company name"}),d.name&&(0,Pt.jsx)("span",{className:"field-error",children:d.name})]}),(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsxs)("label",{htmlFor:"email",children:[(0,Pt.jsx)(Hp,{size:16}),"Company Email *"]}),(0,Pt.jsx)("input",{type:"email",id:"email",name:"email",value:_.email,onChange:M,className:d.email?"error":"",placeholder:"company@example.com"}),d.email&&(0,Pt.jsx)("span",{className:"field-error",children:d.email})]})]}),(0,Pt.jsxs)("div",{className:"form-row",children:[(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsxs)("label",{htmlFor:"phone",children:[(0,Pt.jsx)(Ia,{size:16}),"Phone Number"]}),(0,Pt.jsx)("input",{type:"tel",id:"phone",name:"phone",value:_.phone,onChange:M,placeholder:"+1 (555) 123-4567"})]}),(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsx)("label",{htmlFor:"website",children:"Website"}),(0,Pt.jsx)("input",{type:"url",id:"website",name:"website",value:_.website,onChange:M,placeholder:"https://www.company.com"})]})]}),(0,Pt.jsxs)("div",{className:"form-group full-width",children:[(0,Pt.jsxs)("label",{htmlFor:"address",children:[(0,Pt.jsx)(Vp,{size:16}),"Address"]}),(0,Pt.jsx)("textarea",{id:"address",name:"address",value:_.address,onChange:M,placeholder:"Enter company address",rows:"3"})]}),(0,Pt.jsxs)("div",{className:"form-row",children:[(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsx)("label",{htmlFor:"industry",children:"Industry"}),(0,Pt.jsxs)("select",{id:"industry",name:"industry",value:_.industry,onChange:M,children:[(0,Pt.jsx)("option",{value:"",children:"Select Industry"}),(0,Pt.jsx)("option",{value:"technology",children:"Technology"}),(0,Pt.jsx)("option",{value:"healthcare",children:"Healthcare"}),(0,Pt.jsx)("option",{value:"finance",children:"Finance"}),(0,Pt.jsx)("option",{value:"education",children:"Education"}),(0,Pt.jsx)("option",{value:"manufacturing",children:"Manufacturing"}),(0,Pt.jsx)("option",{value:"retail",children:"Retail"}),(0,Pt.jsx)("option",{value:"consulting",children:"Consulting"}),(0,Pt.jsx)("option",{value:"other",children:"Other"})]})]}),(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsx)("label",{htmlFor:"size",children:"Company Size"}),(0,Pt.jsxs)("select",{id:"size",name:"size",value:_.size,onChange:M,children:[(0,Pt.jsx)("option",{value:"",children:"Select Size"}),(0,Pt.jsx)("option",{value:"1-10",children:"1-10 employees"}),(0,Pt.jsx)("option",{value:"11-50",children:"11-50 employees"}),(0,Pt.jsx)("option",{value:"51-200",children:"51-200 employees"}),(0,Pt.jsx)("option",{value:"201-500",children:"201-500 employees"}),(0,Pt.jsx)("option",{value:"501-1000",children:"501-1000 employees"}),(0,Pt.jsx)("option",{value:"1000+",children:"1000+ employees"})]})]})]}),(0,Pt.jsxs)("div",{className:"form-group full-width",children:[(0,Pt.jsx)("label",{htmlFor:"description",children:"Description"}),(0,Pt.jsx)("textarea",{id:"description",name:"description",value:_.description,onChange:M,placeholder:"Brief description of the company",rows:"3"})]})]}),(0,Pt.jsxs)("div",{className:"form-section",children:[(0,Pt.jsx)("h3",{children:"Primary Contact Information"}),(0,Pt.jsxs)("div",{className:"form-row",children:[(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsxs)("label",{htmlFor:"contactPerson",children:[(0,Pt.jsx)(Sa,{size:16}),"Contact Person *"]}),(0,Pt.jsx)("input",{type:"text",id:"contactPerson",name:"contactPerson",value:_.contactPerson,onChange:M,className:d.contactPerson?"error":"",placeholder:"Full name of contact person"}),d.contactPerson&&(0,Pt.jsx)("span",{className:"field-error",children:d.contactPerson})]}),(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsxs)("label",{htmlFor:"contactPersonEmail",children:[(0,Pt.jsx)(Hp,{size:16}),"Contact Email *"]}),(0,Pt.jsx)("input",{type:"email",id:"contactPersonEmail",name:"contactPersonEmail",value:_.contactPersonEmail,onChange:M,className:d.contactPersonEmail?"error":"",placeholder:"contact@company.com"}),d.contactPersonEmail&&(0,Pt.jsx)("span",{className:"field-error",children:d.contactPersonEmail})]})]}),(0,Pt.jsxs)("div",{className:"form-row",children:[(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsxs)("label",{htmlFor:"contactPersonPhone",children:[(0,Pt.jsx)(Ia,{size:16}),"Contact Phone"]}),(0,Pt.jsx)("input",{type:"tel",id:"contactPersonPhone",name:"contactPersonPhone",value:_.contactPersonPhone,onChange:M,placeholder:"+1 (555) 123-4567"})]}),(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsx)("label",{htmlFor:"status",children:"Status"}),(0,Pt.jsxs)("select",{id:"status",name:"status",value:_.status,onChange:M,children:[(0,Pt.jsx)("option",{value:"active",children:"Active"}),(0,Pt.jsx)("option",{value:"inactive",children:"Inactive"}),(0,Pt.jsx)("option",{value:"suspended",children:"Suspended"})]})]})]})]}),"add"===n&&(0,Pt.jsxs)("div",{className:"form-section",children:[(0,Pt.jsx)("h3",{children:"Company Login Credentials"}),(0,Pt.jsxs)("div",{className:"form-row",children:[(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsxs)("label",{htmlFor:"loginEmail",children:[(0,Pt.jsx)(Hp,{size:16}),"Login Email *"]}),(0,Pt.jsx)("input",{type:"email",id:"loginEmail",name:"loginEmail",value:_.loginEmail,onChange:M,className:d.loginEmail?"error":"",placeholder:"company.admin@company.com"}),d.loginEmail&&(0,Pt.jsx)("span",{className:"field-error",children:d.loginEmail})]}),(0,Pt.jsx)("div",{className:"form-group",children:(0,Pt.jsx)("div",{className:"checkbox-group",children:(0,Pt.jsxs)("label",{className:"checkbox-label",children:[(0,Pt.jsx)("input",{type:"checkbox",name:"generatePassword",checked:_.generatePassword,onChange:M}),(0,Pt.jsx)("span",{className:"checkmark"}),"Generate Password Automatically"]})})})]}),_.generatePassword&&P&&(0,Pt.jsx)("div",{className:"form-row",children:(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsxs)("label",{children:[(0,Pt.jsx)(Gp,{size:16}),"Generated Password"]}),(0,Pt.jsxs)("div",{className:"password-display",children:[(0,Pt.jsx)("input",{type:"text",value:P,readOnly:!0,className:"generated-password-input"}),(0,Pt.jsx)("button",{type:"button",onClick:()=>(async e=>{try{await navigator.clipboard.writeText(e),D(!0),setTimeout(()=>D(!1),2e3)}catch(t){console.error("Failed to copy password:",t);const r=document.createElement("textarea");r.value=e,document.body.appendChild(r),r.focus(),r.select();try{document.execCommand("copy"),D(!0),setTimeout(()=>D(!1),2e3)}catch(a){console.error("Fallback copy failed:",a)}document.body.removeChild(r)}})(P),className:"copy-password-btn",title:"Copy to clipboard",children:(0,Pt.jsx)($p,{size:16})}),(0,Pt.jsx)("button",{type:"button",onClick:()=>{const e=F();R(e),A(t=>u(u({},t),{},{temporaryPassword:e}))},className:"regenerate-password-btn",title:"Generate new password",children:(0,Pt.jsx)(Ba,{size:16})})]}),O&&(0,Pt.jsx)("span",{className:"copy-success",children:"\u2713 Password copied to clipboard!"}),(0,Pt.jsx)("small",{className:"field-hint",children:"12-character password with letters, numbers, and symbols"})]})}),!_.generatePassword&&(0,Pt.jsx)("div",{className:"form-row",children:(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsxs)("label",{htmlFor:"temporaryPassword",children:[(0,Pt.jsx)(Gp,{size:16}),"Temporary Password *"]}),(0,Pt.jsx)("input",{type:"password",id:"temporaryPassword",name:"temporaryPassword",value:_.temporaryPassword,onChange:M,className:d.temporaryPassword?"error":"",placeholder:"Enter temporary password"}),d.temporaryPassword&&(0,Pt.jsx)("span",{className:"field-error",children:d.temporaryPassword}),(0,Pt.jsx)("small",{className:"field-hint",children:"Password should be at least 8 characters with numbers and letters"})]})})]}),(0,Pt.jsxs)("div",{className:"form-actions",children:[(0,Pt.jsx)("button",{type:"button",onClick:()=>s("list"),className:"cancel-button",disabled:i,children:"Cancel"}),(0,Pt.jsxs)("button",{type:"submit",className:"submit-button",disabled:i,children:[(0,Pt.jsx)(wa,{size:16}),i?"edit"===n?"Updating...":"Creating...":"edit"===n?"Update Company":"Create Company"]})]})]})})]}),V=()=>{const[e,t]=(0,r.useState)((null===T||void 0===T?void 0:T.subscriptionPlan)||"basic");return(0,Pt.jsx)("div",{className:"modal-overlay",children:(0,Pt.jsxs)("div",{className:"modal-content subscription-modal",children:[(0,Pt.jsxs)("div",{className:"modal-header",children:[(0,Pt.jsx)("h3",{children:"Manage Subscription Plan"}),(0,Pt.jsx)("button",{className:"modal-close",onClick:()=>N(null),disabled:j,children:(0,Pt.jsx)(fa,{size:20})})]}),(0,Pt.jsxs)("div",{className:"modal-body",children:[(0,Pt.jsxs)("div",{className:"company-info",children:[(0,Pt.jsx)("div",{className:"company-name",children:null===T||void 0===T?void 0:T.name}),(0,Pt.jsxs)("div",{className:"current-plan",children:[(0,Pt.jsx)("span",{className:"label",children:"Current Plan:"}),(0,Pt.jsx)("span",{className:"plan-badge",children:(null===T||void 0===T?void 0:T.subscriptionPlan)||"Basic"})]})]}),(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsx)("label",{htmlFor:"subscriptionPlan",className:"form-label",children:"Select New Plan"}),(0,Pt.jsxs)("select",{id:"subscriptionPlan",value:e,onChange:e=>t(e.target.value),disabled:j,className:"subscription-select",children:[(0,Pt.jsx)("option",{value:"basic",children:"Basic Plan"}),(0,Pt.jsx)("option",{value:"premium",children:"Premium Plan"}),(0,Pt.jsx)("option",{value:"ultra",children:"Ultra Plan"}),(0,Pt.jsx)("option",{value:"business",children:"Business Plan"}),(0,Pt.jsx)("option",{value:"enterprise",children:"Enterprise Plan"})]})]}),(0,Pt.jsxs)("div",{className:"plan-info",children:[(0,Pt.jsx)("div",{className:"plan-info-header",children:"Plan Features"}),(0,Pt.jsxs)("ul",{className:"plan-features-list",children:["basic"===e&&(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)("li",{children:"Up to 50 employees"}),(0,Pt.jsx)("li",{children:"Basic analytics"}),(0,Pt.jsx)("li",{children:"Email support"})]}),"premium"===e&&(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)("li",{children:"Up to 200 employees"}),(0,Pt.jsx)("li",{children:"Advanced analytics"}),(0,Pt.jsx)("li",{children:"Priority support"}),(0,Pt.jsx)("li",{children:"Custom reports"})]}),"ultra"===e&&(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)("li",{children:"Up to 500 employees"}),(0,Pt.jsx)("li",{children:"Premium analytics"}),(0,Pt.jsx)("li",{children:"24/7 support"}),(0,Pt.jsx)("li",{children:"Advanced integrations"})]}),"business"===e&&(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)("li",{children:"Up to 1000 employees"}),(0,Pt.jsx)("li",{children:"Business analytics"}),(0,Pt.jsx)("li",{children:"Dedicated support"}),(0,Pt.jsx)("li",{children:"Custom features"})]}),"enterprise"===e&&(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)("li",{children:"Unlimited employees"}),(0,Pt.jsx)("li",{children:"Enterprise analytics"}),(0,Pt.jsx)("li",{children:"White-label options"}),(0,Pt.jsx)("li",{children:"Custom solutions"})]})]})]})]}),(0,Pt.jsxs)("div",{className:"modal-actions",children:[(0,Pt.jsx)("button",{type:"button",onClick:()=>N(null),disabled:j,className:"cancel-button",children:"Cancel"}),(0,Pt.jsx)("button",{type:"button",onClick:()=>(async(e,t)=>{C(!0);try{await qp.updateCompanySubscriptionConfig(e,{subscriptionPlan:t,updated_at:(new Date).toISOString()}),c(a=>a.map(a=>a.id===e?u(u({},a),{},{subscriptionPlan:t}):a)),N(null),k({type:"success",message:"Subscription plan updated successfully!"}),setTimeout(()=>k(null),3e3)}catch(a){console.error("Error updating subscription:",a),k({type:"error",message:"Failed to update subscription plan: "+a.message}),setTimeout(()=>k(null),5e3)}finally{C(!1)}})(T.id,e),disabled:j||e===(null===T||void 0===T?void 0:T.subscriptionPlan),className:"update-button",children:j?"Updating...":"Update Plan"})]})]})})},G=()=>(0,Pt.jsx)("div",{className:"modal-overlay",children:(0,Pt.jsxs)("div",{className:"modal-content delete-confirm",children:[(0,Pt.jsx)("h3",{children:"Delete Company"}),(0,Pt.jsx)("p",{children:"Are you sure you want to delete this company? This action cannot be undone and will also remove all associated employees and data."}),(0,Pt.jsxs)("div",{className:"form-actions",children:[(0,Pt.jsx)("button",{onClick:()=>y(null),children:"Cancel"}),(0,Pt.jsx)("button",{className:"delete-btn",onClick:()=>(async e=>{try{o(!0);const t=await qp.deleteCompanyAdmin(e);t.success?(c(l.filter(t=>t.id!==e)),y(null),k({message:"Company deleted successfully",type:"success"}),setTimeout(()=>k(null),5e3)):f({delete:t.error||"Failed to delete company"})}catch(t){console.error("Error deleting company:",t),f({delete:t.message||"Failed to delete company"})}finally{o(!1)}})(v),disabled:i,children:i?"Deleting...":"Delete Company"})]})]})});return(0,Pt.jsxs)("div",{className:"company-management-page",children:[(0,Pt.jsx)(Ta,{}),(0,Pt.jsxs)("div",{className:"company-management",children:["list"===n?(0,Pt.jsx)(W,{}):"add"===n?(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("div",{className:"add-company-header",children:(0,Pt.jsxs)("button",{onClick:()=>s("list"),className:"back-button",children:[(0,Pt.jsx)(Ra,{size:20}),(0,Pt.jsx)("span",{children:"Back to Companies"})]})}),(0,Pt.jsx)(Zp,{onSuccess:()=>{s("list"),k({message:"Company created successfully",type:"success"}),I()},onBack:()=>s("list")})]}):(0,Pt.jsx)(H,{}),v&&(0,Pt.jsx)(G,{}),T&&(0,Pt.jsx)(V,{}),b&&(0,Pt.jsx)(Yp,{credentials:b,onClose:()=>w(null)}),x&&(0,Pt.jsxs)("div",{className:"notification ".concat(x.type),children:[x.message,(0,Pt.jsx)("button",{onClick:()=>k(null),className:"notification-close",children:"\xd7"})]})]})]})},tg=Vt("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),ag=Vt("power",[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]]),rg="https://thoughtprob2b.thoughthealer.org/api/v1",ng={storePsychologistId:e=>{localStorage.setItem("currentPsychologistId",e)},getPsychologistId:()=>localStorage.getItem("currentPsychologistId"),getAllPsychologists:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;try{const a=await fetch("".concat(rg,"/psychologists?page=").concat(e,"&limit=").concat(t),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))}});if(!a.ok)throw new Error("Failed to fetch psychologists: ".concat(a.statusText));return await a.json()}catch(a){throw console.error("Error fetching psychologists:",a),a}},getPsychologistById:async e=>{try{const t=await fetch("".concat(rg,"/psychologists/").concat(e),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))}});if(!t.ok)throw new Error("Failed to fetch psychologist: ".concat(t.statusText));return await t.json()}catch(t){throw console.error("Error fetching psychologist:",t),t}},searchPsychologists:async e=>{try{const t=await fetch("".concat(rg,"/psychologists/search?query=").concat(encodeURIComponent(e)),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))}});if(!t.ok)throw new Error("Failed to search psychologists: ".concat(t.statusText));return await t.json()}catch(t){throw console.error("Error searching psychologists:",t),t}},createPsychologist:async e=>{try{const t=await fetch("".concat(rg,"/psychologists"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify(e)});if(!t.ok){const e=await t.json();throw new Error(e.message||"Failed to create psychologist: ".concat(t.statusText))}const a=await t.json();return{success:!0,id:a.id,data:a}}catch(t){return console.error("Error creating psychologist:",t),{success:!1,error:t.message}}},updatePsychologist:async(e,t)=>{try{const a=await fetch("".concat(rg,"/psychologists/").concat(e),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify(t)});if(!a.ok){const e=await a.json();throw new Error(e.message||"Failed to update psychologist: ".concat(a.statusText))}return{success:!0,data:await a.json()}}catch(a){return console.error("Error updating psychologist:",a),{success:!1,error:a.message}}},deletePsychologist:async e=>{try{const t=await fetch("".concat(rg,"/psychologists/").concat(e),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))}});if(!t.ok){const e=await t.json();throw new Error(e.message||"Failed to delete psychologist: ".concat(t.statusText))}return{success:!0}}catch(t){throw console.error("Error deleting psychologist:",t),t}},updatePsychologistSettings:async(e,t)=>{try{console.log("Updating psychologist booking limits:",{id:e,settingsData:t});const a={weekly_booking_limit:t.weeklySessionsAllowed||t.weekly_booking_limit,monthly_booking_limit:t.monthlySessionsAllowed||t.monthly_booking_limit},r=await fetch("".concat(rg,"/admin/psychologists/").concat(e,"/booking-limits"),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify(a)});if(!r.ok){let e="Failed to update booking limits: ".concat(r.statusText);try{const t=await r.json();e=t.message||t.error||e,console.error("Backend error response:",t)}catch(Ig){console.error("Could not parse error response")}throw new Error(e)}const n=await r.json();return console.log("Booking limits updated successfully:",n),n}catch(a){throw console.error("Error updating booking limits:",a),a}},getPsychologistBookingLimits:async e=>{try{const t=await fetch("".concat(rg,"/admin/psychologists/").concat(e,"/booking-limits"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))}});if(!t.ok)throw new Error("Failed to fetch booking limits: ".concat(t.statusText));return await t.json()}catch(t){throw console.error("Error fetching booking limits:",t),t}},getPsychologistsOverview:async()=>{try{const e=await fetch("".concat(rg,"/admin/psychologists-overview"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))}});if(!e.ok)throw new Error("Failed to fetch overview: ".concat(e.statusText));return await e.json()}catch(e){throw console.error("Error fetching overview:",e),e}},disablePsychologist:async e=>{try{const t=await fetch("".concat(rg,"/admin/psychologists/").concat(e,"/disable"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))}});if(!t.ok){const e=await t.json();throw new Error(e.message||"Failed to disable psychologist: ".concat(t.statusText))}return{success:!0,data:await t.json()}}catch(t){throw console.error("Error disabling psychologist:",t),t}},enablePsychologist:async e=>{try{const t=await fetch("".concat(rg,"/admin/psychologists/").concat(e,"/enable"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))}});if(!t.ok){const e=await t.json();throw new Error(e.message||"Failed to enable psychologist: ".concat(t.statusText))}return{success:!0,data:await t.json()}}catch(t){throw console.error("Error enabling psychologist:",t),t}},getPsychologistStatus:async e=>{try{const t=await fetch("".concat(rg,"/admin/psychologists/").concat(e,"/status"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))}});if(!t.ok)throw new Error("Failed to fetch status: ".concat(t.statusText));return await t.json()}catch(t){throw console.error("Error fetching status:",t),t}},deletePsychologistAdmin:async e=>{try{const t=await fetch("".concat(rg,"/admin/psychologists/").concat(e),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))}});if(!t.ok){const e=await t.json();throw new Error(e.message||"Failed to delete psychologist: ".concat(t.statusText))}return{success:!0,data:await t.json()}}catch(t){throw console.error("Error deleting psychologist:",t),t}},setBookingLimits:async(e,t)=>{try{const a={psychologist_id:e,weekly_booking_limit:t.weeklyLimit||t.weekly_booking_limit,monthly_booking_limit:t.monthlyLimit||t.monthly_booking_limit};console.log("Setting booking limits:"),console.log("  - Psychologist ID:",e),console.log("  - Request Data:",JSON.stringify(a,null,2)),console.log("  - Full URL:","".concat(rg,"/admin/psychologists/").concat(e,"/booking-limits")),console.log("  - Request Body:",JSON.stringify(a));const r=await fetch("".concat(rg,"/admin/psychologists/").concat(e,"/booking-limits"),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify(a)});if(!r.ok){let e="Failed to set booking limits: ".concat(r.statusText);try{const t=await r.json();e=t.message||t.error||e,console.error("Backend error:",t)}catch(Ig){console.error("Could not parse error response")}throw new Error(e)}const n=await r.json();return console.log("Booking limits set successfully:",n),{success:!0,data:n}}catch(a){throw console.error("Error setting booking limits:",a),a}},getBookingLimits:async e=>{try{const o=await fetch("".concat(rg,"/admin/psychologists/").concat(e,"/booking-limits"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))}});if(!o.ok)throw new Error("Failed to fetch booking limits: ".concat(o.statusText));const l=await o.json();var t,a,r,n,s,i;return l.success&&l.data?{success:!0,psychologist:l.data.psychologist,limits:{weeklyLimit:null===(t=l.data.limits)||void 0===t?void 0:t.weekly_booking_limit,monthlyLimit:null===(a=l.data.limits)||void 0===a?void 0:a.monthly_booking_limit},usage:{weekly:(null===(r=l.data.current_usage)||void 0===r?void 0:r.weekly_bookings)||0,monthly:(null===(n=l.data.current_usage)||void 0===n?void 0:n.monthly_bookings)||0,weeklyRemaining:null===(s=l.data.current_usage)||void 0===s?void 0:s.weekly_remaining,monthlyRemaining:null===(i=l.data.current_usage)||void 0===i?void 0:i.monthly_remaining}}:l}catch(o){throw console.error("Error fetching booking limits:",o),o}}},sg=Vt("graduation-cap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]),ig=Vt("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]),og=Vt("dollar-sign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),lg=e=>{let{onSuccess:t,onBack:a}=e;const n=ge(),[s,i]=(0,r.useState)(!1),[o,l]=(0,r.useState)({}),[c,d]=(0,r.useState)({name:"",email:"",mobile_number:"",degree:"",specialization:[],experience_years:"",languages:[],emergency_call_rate:"",session_45_minute_rate:"",session_30_minute_rate:"",rating:""}),f=e=>{const{name:t,value:a,type:r,checked:n}=e.target;if("checkbox"===r){if(t.includes("specialization")){const e=t.replace("specialization_","");d(t=>u(u({},t),{},{specialization:n?[...t.specialization,e]:t.specialization.filter(t=>t!==e)}))}else if(t.includes("languages")){const e=t.replace("languages_","");d(t=>u(u({},t),{},{languages:n?[...t.languages,e]:t.languages.filter(t=>t!==e)}))}}else d(e=>u(u({},e),{},{[t]:a}));o[t]&&l(e=>u(u({},e),{},{[t]:""}))},h=()=>{a?a():n("/admin/psychologists")};return(0,Pt.jsxs)("div",{className:"add-psychologist-page",children:[(0,Pt.jsx)(Ta,{}),(0,Pt.jsxs)("div",{className:"add-psychologist-container",children:[(0,Pt.jsxs)("div",{className:"add-psychologist-header",children:[(0,Pt.jsxs)("button",{onClick:h,className:"back-button",children:[(0,Pt.jsx)(Ra,{size:20}),(0,Pt.jsx)("span",{children:"Back to Psychologists"})]}),(0,Pt.jsxs)("div",{className:"page-title",children:[(0,Pt.jsx)(da,{size:24}),(0,Pt.jsx)("h1",{children:"Add New Psychologist"})]})]}),(0,Pt.jsx)("div",{className:"add-psychologist-content",children:(0,Pt.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={};return c.name.trim()||(e.name="Name is required"),c.email.trim()?/\S+@\S+\.\S+/.test(c.email)||(e.email="Please enter a valid email"):e.email="Email is required",c.mobile_number.trim()||(e.mobile_number="Phone number is required"),c.degree.trim()||(e.degree="Degree is required"),0===c.specialization.length&&(e.specialization="Please select at least one specialization"),l(e),0===Object.keys(e).length})()){i(!0);try{const e={name:c.name,email:c.email,mobile_number:c.mobile_number.replace(/\D/g,""),degree:c.degree,specialization:c.specialization,languages:c.languages,experience_years:c.experience_years?parseInt(c.experience_years):void 0,emergency_call_rate:c.emergency_call_rate?parseFloat(c.emergency_call_rate):void 0,session_45_minute_rate:c.session_45_minute_rate?parseFloat(c.session_45_minute_rate):void 0,session_30_minute_rate:c.session_30_minute_rate?parseFloat(c.session_30_minute_rate):void 0,rating:c.rating?parseFloat(c.rating):void 0},a=await ng.createPsychologist(e);a.success||a.id?t?t():n("/admin/psychologists",{state:{message:"Psychologist created successfully",type:"success"}}):l({submit:a.error||"Failed to create psychologist"})}catch(a){console.error("Error creating psychologist:",a),l({submit:a.message||"Failed to create psychologist"})}finally{i(!1)}}},className:"psychologist-form",children:[o.submit&&(0,Pt.jsx)("div",{className:"error-message",children:o.submit}),(0,Pt.jsxs)("div",{className:"form-section",children:[(0,Pt.jsx)("h3",{children:"Personal Information"}),(0,Pt.jsxs)("div",{className:"form-row",children:[(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsxs)("label",{htmlFor:"name",children:[(0,Pt.jsx)(Sa,{size:16}),"Full Name *"]}),(0,Pt.jsx)("input",{type:"text",id:"name",name:"name",value:c.name,onChange:f,className:o.name?"error":"",placeholder:"Enter full name"}),o.name&&(0,Pt.jsx)("span",{className:"field-error",children:o.name})]}),(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsxs)("label",{htmlFor:"email",children:[(0,Pt.jsx)(Hp,{size:16}),"Email *"]}),(0,Pt.jsx)("input",{type:"email",id:"email",name:"email",value:c.email,onChange:f,className:o.email?"error":"",placeholder:"psychologist@example.com"}),o.email&&(0,Pt.jsx)("span",{className:"field-error",children:o.email})]})]}),(0,Pt.jsxs)("div",{className:"form-row",children:[(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsx)("label",{htmlFor:"mobile_number",children:"Mobile Number *"}),(0,Pt.jsx)(Ma,{id:"mobile_number",name:"mobile_number",value:c.mobile_number,onChange:e=>d(t=>u(u({},t),{},{mobile_number:e})),error:o.mobile_number,placeholder:"Enter phone number",required:!0}),o.mobile_number&&(0,Pt.jsx)("span",{className:"field-error",children:o.mobile_number})]}),(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsxs)("label",{htmlFor:"degree",children:[(0,Pt.jsx)(sg,{size:16}),"Degree *"]}),(0,Pt.jsx)("input",{type:"text",id:"degree",name:"degree",value:c.degree,onChange:f,className:o.degree?"error":"",placeholder:"e.g., Ph.D. in Clinical Psychology"}),o.degree&&(0,Pt.jsx)("span",{className:"field-error",children:o.degree})]})]}),(0,Pt.jsxs)("div",{className:"form-row",children:[(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsxs)("label",{htmlFor:"experience_years",children:[(0,Pt.jsx)(ig,{size:16}),"Years of Experience"]}),(0,Pt.jsx)("input",{type:"number",id:"experience_years",name:"experience_years",value:c.experience_years,onChange:f,placeholder:"Years of experience",min:"0"})]}),(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsxs)("label",{htmlFor:"rating",children:[(0,Pt.jsx)(ig,{size:16}),"Rating (Optional)"]}),(0,Pt.jsx)("input",{type:"number",id:"rating",name:"rating",value:c.rating,onChange:f,placeholder:"e.g., 4.8",min:"0",max:"5",step:"0.1"})]})]})]}),(0,Pt.jsxs)("div",{className:"form-section",children:[(0,Pt.jsx)("h3",{children:"Rate Information (Optional)"}),(0,Pt.jsxs)("div",{className:"form-row",children:[(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsxs)("label",{htmlFor:"emergency_call_rate",children:[(0,Pt.jsx)(og,{size:16}),"Emergency Call Rate"]}),(0,Pt.jsx)("input",{type:"number",id:"emergency_call_rate",name:"emergency_call_rate",value:c.emergency_call_rate,onChange:f,placeholder:"Enter emergency call rate",min:"0",step:"0.01"})]}),(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsxs)("label",{htmlFor:"session_45_minute_rate",children:[(0,Pt.jsx)(tg,{size:16}),"45-Minute Session Rate"]}),(0,Pt.jsx)("input",{type:"number",id:"session_45_minute_rate",name:"session_45_minute_rate",value:c.session_45_minute_rate,onChange:f,placeholder:"Enter 45-minute session rate",min:"0",step:"0.01"})]})]}),(0,Pt.jsxs)("div",{className:"form-row",children:[(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsxs)("label",{htmlFor:"session_30_minute_rate",children:[(0,Pt.jsx)(tg,{size:16}),"30-Minute Session Rate"]}),(0,Pt.jsx)("input",{type:"number",id:"session_30_minute_rate",name:"session_30_minute_rate",value:c.session_30_minute_rate,onChange:f,placeholder:"Enter 30-minute session rate",min:"0",step:"0.01"})]}),(0,Pt.jsx)("div",{className:"form-group"})]})]}),(0,Pt.jsxs)("div",{className:"form-section",children:[(0,Pt.jsx)("h3",{children:"Specializations *"}),o.specialization&&(0,Pt.jsx)("span",{className:"field-error",children:o.specialization}),(0,Pt.jsx)("div",{className:"checkbox-grid",children:["anxiety","depression","stress_management","ptsd","couples_therapy","family_therapy","child_psychology","adolescent_psychology","addiction_counseling","grief_counseling","cognitive_behavioral_therapy","dialectical_behavior_therapy","emdr","mindfulness_based_therapy","trauma_therapy","eating_disorders","ocd","bipolar_disorder","adhd","autism_spectrum_disorders","workplace_mental_health"].map(e=>(0,Pt.jsxs)("label",{className:"checkbox-label",children:[(0,Pt.jsx)("input",{type:"checkbox",name:"specialization_".concat(e),checked:c.specialization.includes(e),onChange:f}),(0,Pt.jsx)("span",{children:e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())})]},e))})]}),(0,Pt.jsxs)("div",{className:"form-section",children:[(0,Pt.jsx)("h3",{children:"Languages"}),(0,Pt.jsx)("div",{className:"checkbox-grid",children:["English","Marathi","Hindi","Spanish","French","German","Italian","Portuguese","Chinese (Mandarin)","Japanese","Korean","Arabic","Russian"].map(e=>(0,Pt.jsxs)("label",{className:"checkbox-label",children:[(0,Pt.jsx)("input",{type:"checkbox",name:"languages_".concat(e),checked:c.languages.includes(e),onChange:f}),(0,Pt.jsx)("span",{children:e})]},e))})]}),(0,Pt.jsxs)("div",{className:"form-actions",children:[(0,Pt.jsx)("button",{type:"button",onClick:h,className:"cancel-button",disabled:s,children:"Cancel"}),(0,Pt.jsxs)("button",{type:"submit",className:"submit-button",disabled:s,children:[(0,Pt.jsx)(wa,{size:16}),s?"Creating...":"Create Psychologist"]})]})]})})]})]})},cg="https://thoughtprob2b.thoughthealer.org/api/v1",ug={createSlot:async e=>{const t="".concat(cg,"/availability");console.log("\ud83d\ude80 createSlot called with:",e),console.log("\ud83d\udd17 Endpoint:",t),console.log("\ud83d\udd11 Token exists:",!!localStorage.getItem("authToken"));try{const r=new Date(e.time_slot||e.timeSlot||"".concat(e.date,"T").concat(e.startTime,":00")),n=new Date;if(n.setHours(0,0,0,0),r<n){const e=new Error("Cannot create availability slots for past dates. You can only view past bookings.");throw e.technicalDetails={endpoint:t,method:"POST",validation:"Date validation failed",attemptedDate:r.toISOString(),currentDate:n.toISOString()},e}const s={psychologist_id:e.psychologistId||e.psychologist_id,time_slot:e.time_slot||e.timeSlot||"".concat(e.date,"T").concat(e.startTime,":00"),availability_status:e.availability_status||e.status||"Available"};console.log("\ud83d\udce4 Sending request to:",t),console.log("\ud83d\udce6 Request payload:",JSON.stringify(s,null,2)),console.log("\ud83d\udce6 Psychologist ID type:",typeof s.psychologist_id),console.log("\ud83d\udce6 Time slot format:",s.time_slot);const i=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("authToken"))},body:JSON.stringify(s)});let o;console.log("\ud83d\udce5 Response status:",i.status,i.statusText);try{o=await i.json(),console.log("\ud83d\udce5 Response data:",JSON.stringify(o,null,2))}catch(a){throw console.error("\u274c Failed to parse response as JSON:",a),console.log("\ud83d\udce5 Raw response text:",await i.text()),new Error("Server returned invalid JSON response")}if(!i.ok){console.error("\u274c API Error Response:",{status:i.status,statusText:i.statusText,result:o,requestSent:s});const e=new Error(o.message||o.error||o.detail||"Failed to create availability slot");throw e.technicalDetails={endpoint:t,method:"POST",statusCode:i.status,statusText:i.statusText,requestPayload:s,responseData:o,timestamp:(new Date).toISOString()},e}return console.log("\u2705 Slot created successfully!"),o}catch(r){throw console.error("Error creating availability slot:",r),r.technicalDetails||(r.technicalDetails={endpoint:t,method:"POST",error:r.message,timestamp:(new Date).toISOString()}),r}},createBulkSlots:async e=>{const t="".concat(cg,"/availability/populate-n-days");try{const a=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("authToken"))},body:JSON.stringify(e)}),r=await a.json();if(!a.ok){const n=new Error(r.message||r.error||"Failed to create bulk availability slots");throw n.technicalDetails={endpoint:t,method:"POST",statusCode:a.status,statusText:a.statusText,requestPayload:e,responseData:r,timestamp:(new Date).toISOString()},n}return r}catch(a){throw console.error("Error creating bulk availability slots:",a),a.technicalDetails||(a.technicalDetails={endpoint:t,method:"POST",error:a.message,timestamp:(new Date).toISOString()}),a}},getAvailabilityByPsychologist:async e=>{const t="".concat(cg,"/availability/").concat(e);try{console.log("Fetching availability from:",t);const a=await fetch(t,{method:"GET",headers:{Authorization:"Bearer ".concat(localStorage.getItem("authToken"))}}),r=await a.json();if(console.log("Availability API response:",r),!a.ok){const n=new Error(r.message||r.error||"Failed to fetch availability slots");throw n.technicalDetails={endpoint:t,method:"GET",statusCode:a.status,statusText:a.statusText,psychologistId:e,responseData:r,timestamp:(new Date).toISOString()},n}return r}catch(a){throw console.error("Error fetching availability slots:",a),a.technicalDetails||(a.technicalDetails={endpoint:t,method:"GET",psychologistId:e,error:a.message,timestamp:(new Date).toISOString()}),a}},updateSlotStatus:async(e,t)=>{const a="".concat(cg,"/availability/").concat(e);try{const r={availability_status:t.availability_status||t.status||"Available",notes:t.notes},n=await fetch(a,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("authToken"))},body:JSON.stringify(r)}),s=await n.json();if(!n.ok){const t=new Error(s.message||s.error||"Failed to update availability slot");throw t.technicalDetails={endpoint:a,method:"PATCH",statusCode:n.status,statusText:n.statusText,slotId:e,requestPayload:r,responseData:s,timestamp:(new Date).toISOString()},t}return s}catch(r){throw console.error("Error updating availability slot:",r),r.technicalDetails||(r.technicalDetails={endpoint:a,method:"PATCH",slotId:e,error:r.message,timestamp:(new Date).toISOString()}),r}},deleteSlot:async e=>{const t="".concat(cg,"/availability/").concat(e);try{const a=await fetch(t,{method:"DELETE",headers:{Authorization:"Bearer ".concat(localStorage.getItem("authToken"))}}),r=await a.json();if(!a.ok){const n=new Error(r.message||r.error||"Failed to delete availability slot");throw n.technicalDetails={endpoint:t,method:"DELETE",statusCode:a.status,statusText:a.statusText,slotId:e,responseData:r,timestamp:(new Date).toISOString()},n}return r}catch(a){throw console.error("Error deleting availability slot:",a),a.technicalDetails||(a.technicalDetails={endpoint:t,method:"DELETE",slotId:e,error:a.message,timestamp:(new Date).toISOString()}),a}},toggleDayAvailability:async e=>{const t="".concat(cg,"/availability/toggle-day");try{const a=new Date(e.date),r=new Date;if(r.setHours(0,0,0,0),a<r){const e=new Error("Cannot modify availability for past dates. You can only view past bookings.");throw e.technicalDetails={endpoint:t,method:"PATCH",validation:"Date validation failed",attemptedDate:a.toISOString(),currentDate:r.toISOString()},e}const n=await fetch(t,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("authToken"))},body:JSON.stringify(e)}),s=await n.json();if(!n.ok){const a=new Error(s.message||s.error||"Failed to toggle day availability");throw a.technicalDetails={endpoint:t,method:"PATCH",statusCode:n.status,statusText:n.statusText,requestPayload:e,responseData:s,timestamp:(new Date).toISOString()},a}return s}catch(a){throw console.error("Error toggling day availability:",a),a.technicalDetails||(a.technicalDetails={endpoint:t,method:"PATCH",error:a.message,timestamp:(new Date).toISOString()}),a}},countAvailableSlots:async(e,t,a)=>{try{const r=await fetch("".concat(cg,"/availability/").concat(e,"?startDate=").concat(t,"&endDate=").concat(a),{method:"GET",headers:{Authorization:"Bearer ".concat(localStorage.getItem("authToken"))}});if(!r.ok)return 0;const n=await r.json();return Array.isArray(n)?n.length:n.count||0}catch(r){return console.error("Error counting available slots:",r),0}},getAllHolidays:async()=>{try{const e=await fetch("".concat(cg,"/holidays"),{method:"GET",headers:{Authorization:"Bearer ".concat(localStorage.getItem("authToken"))}});if(!e.ok){const t=await e.json();throw new Error(t.message||"Failed to fetch holidays")}return await e.json()}catch(e){throw console.error("Error fetching holidays:",e),e}},addHoliday:async e=>{try{const t={date:e.date,description:e.description||e.name},a=await fetch("".concat(cg,"/holidays"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("authToken"))},body:JSON.stringify(t)});if(!a.ok){const e=await a.json();throw new Error(e.message||"Failed to add holiday")}return await a.json()}catch(t){throw console.error("Error adding holiday:",t),t}},deleteHoliday:async e=>{try{const t=await fetch("".concat(cg,"/holidays/").concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(localStorage.getItem("authToken"))}});if(!t.ok){const e=await t.json();throw new Error(e.message||"Failed to delete holiday")}return await t.json()}catch(t){throw console.error("Error deleting holiday:",t),t}},isPastDate:e=>{const t=new Date(e),a=new Date;return a.setHours(0,0,0,0),t.setHours(0,0,0,0),t<a},canEditDate:e=>{const t=new Date(e),a=new Date;return a.setHours(0,0,0,0),t.setHours(0,0,0,0),t>=a}},dg=e=>{let{psychologist:t,onSuccess:a,onClose:n}=e;const[s,i]=(0,r.useState)(!1),[o,l]=(0,r.useState)(null),[c,d]=(0,r.useState)(null),[f,h]=(0,r.useState)({displayCharges:(null===t||void 0===t?void 0:t.displayCharges)||0,costToSynept:(null===t||void 0===t?void 0:t.costToSynept)||0,weeklySessionsAllowed:(null===t||void 0===t?void 0:t.weeklySessionsAllowed)||10,monthlySessionsAllowed:(null===t||void 0===t?void 0:t.monthlySessionsAllowed)||40}),[m,p]=(0,r.useState)({currentWeeklySlots:0,currentMonthlySlots:0,weeklyLimit:f.weeklySessionsAllowed,monthlyLimit:f.monthlySessionsAllowed,loadingStats:!0});(0,r.useEffect)(()=>{g()},[null===t||void 0===t?void 0:t.id]);const g=async()=>{try{if(p(e=>u(u({},e),{},{loadingStats:!0})),null===t||void 0===t||!t.id)return void p(e=>u(u({},e),{},{loadingStats:!1}));const e=await ug.countAvailableSlots(t.id,v(),y()),a=await ug.countAvailableSlots(t.id,b(),w());p({currentWeeklySlots:e||0,currentMonthlySlots:a||0,weeklyLimit:f.weeklySessionsAllowed,monthlyLimit:f.monthlySessionsAllowed,loadingStats:!1})}catch(e){console.error("Error fetching session stats:",e),p(e=>u(u({},e),{},{currentWeeklySlots:0,currentMonthlySlots:0,loadingStats:!1}))}},v=()=>{const e=new Date,t=new Date(e);return t.setDate(e.getDate()-e.getDay()),t.toISOString().split("T")[0]},y=()=>{const e=new Date,t=new Date(e);return t.setDate(e.getDate()-e.getDay()+7),t.toISOString().split("T")[0]},b=()=>{const e=new Date;return new Date(e.getFullYear(),e.getMonth(),1).toISOString().split("T")[0]},w=()=>{const e=new Date;return new Date(e.getFullYear(),e.getMonth()+1,0).toISOString().split("T")[0]},x=e=>{const{name:t,value:a}=e.target;h(e=>u(u({},e),{},{[t]:t.includes("Sessions")?parseInt(a):parseFloat(a)})),l(null)};return(0,Pt.jsxs)("div",{className:"psychologist-settings",children:[(0,Pt.jsxs)("div",{className:"settings-header",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("h2",{children:"Update Settings"}),(0,Pt.jsxs)("p",{className:"psychologist-name-subtitle",children:[(null===t||void 0===t?void 0:t.name)||"".concat((null===t||void 0===t?void 0:t.firstName)||""," ").concat((null===t||void 0===t?void 0:t.lastName)||"").trim()," ",(null===t||void 0===t?void 0:t.licenseNumber)&&"\u2022 ".concat(t.licenseNumber)]})]}),(0,Pt.jsx)("button",{onClick:n,className:"close-button",title:"Close",children:(0,Pt.jsx)(fa,{size:24})})]}),(0,Pt.jsxs)("form",{onSubmit:async e=>{e.preventDefault();const r=(()=>{const e=[];return f.displayCharges<0&&e.push("Display Charges cannot be negative"),f.costToSynept<0&&e.push("Cost To Synept cannot be negative"),f.weeklySessionsAllowed<1&&e.push("Weekly Sessions Allowed must be at least 1"),f.monthlySessionsAllowed<1&&e.push("Monthly Sessions Allowed must be at least 1"),f.monthlySessionsAllowed<f.weeklySessionsAllowed&&e.push("Monthly Sessions cannot be less than Weekly Sessions"),m.currentWeeklySlots>f.weeklySessionsAllowed&&e.push("Current weekly slots (".concat(m.currentWeeklySlots,") exceed new limit (").concat(f.weeklySessionsAllowed,")")),m.currentMonthlySlots>f.monthlySessionsAllowed&&e.push("Current monthly slots (".concat(m.currentMonthlySlots,") exceed new limit (").concat(f.monthlySessionsAllowed,")")),e})();if(r.length>0)l(r.join("\n"));else{i(!0),l(null);try{await ng.updatePsychologistSettings(t.id,f);d("Settings updated successfully!"),setTimeout(()=>{null===a||void 0===a||a()},1500)}catch(o){var n,s;null!==(n=o.message)&&void 0!==n&&n.includes("booking")||null!==(s=o.message)&&void 0!==s&&s.includes("booked")?l("Cannot update: Already existing bookings must stay in place."):l(o.message||"Failed to update settings"),console.error("Error updating settings:",o)}finally{i(!1)}}},className:"settings-form",children:[o&&(0,Pt.jsxs)("div",{className:"alert alert-error",children:[(0,Pt.jsx)(Yt,{size:18}),(0,Pt.jsx)("div",{className:"alert-content",children:(0,Pt.jsx)("p",{children:o})})]}),c&&(0,Pt.jsxs)("div",{className:"alert alert-success",children:[(0,Pt.jsx)(Ua,{size:18}),(0,Pt.jsx)("div",{className:"alert-content",children:(0,Pt.jsx)("p",{children:c})})]}),(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsxs)("label",{htmlFor:"displayCharges",children:["Display Charges",(0,Pt.jsx)("span",{className:"required",children:"*"})]}),(0,Pt.jsxs)("div",{className:"input-wrapper",children:[(0,Pt.jsx)("span",{className:"currency-symbol",children:"$"}),(0,Pt.jsx)("input",{type:"number",id:"displayCharges",name:"displayCharges",value:f.displayCharges,onChange:x,step:"0.01",min:"0",placeholder:"0.00",disabled:s})]}),(0,Pt.jsx)("span",{className:"help-text",children:"Amount displayed to clients for a single session"})]}),(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsxs)("label",{htmlFor:"costToSynept",children:["Cost To Synept",(0,Pt.jsx)("span",{className:"required",children:"*"})]}),(0,Pt.jsxs)("div",{className:"input-wrapper",children:[(0,Pt.jsx)("span",{className:"currency-symbol",children:"$"}),(0,Pt.jsx)("input",{type:"number",id:"costToSynept",name:"costToSynept",value:f.costToSynept,onChange:x,step:"0.01",min:"0",placeholder:"0.00",disabled:s})]}),(0,Pt.jsx)("span",{className:"help-text",children:"Your cost or platform fee per session"})]}),(0,Pt.jsxs)("div",{className:"session-limits-section",children:[(0,Pt.jsx)("h3",{children:"Session Limits"}),(0,Pt.jsx)("p",{className:"section-description",children:"Maximum available slots per week and month"}),(0,Pt.jsxs)("div",{className:"limits-row",children:[(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsxs)("label",{htmlFor:"weeklySessionsAllowed",children:["Weekly Sessions",(0,Pt.jsx)("span",{className:"required",children:"*"})]}),(0,Pt.jsx)("input",{type:"number",id:"weeklySessionsAllowed",name:"weeklySessionsAllowed",value:f.weeklySessionsAllowed,onChange:x,min:"1",step:"1",disabled:s}),!m.loadingStats&&(0,Pt.jsxs)("span",{className:"help-text",children:["Current: ",m.currentWeeklySlots," / ",f.weeklySessionsAllowed]})]}),(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsxs)("label",{htmlFor:"monthlySessionsAllowed",children:["Monthly Sessions",(0,Pt.jsx)("span",{className:"required",children:"*"})]}),(0,Pt.jsx)("input",{type:"number",id:"monthlySessionsAllowed",name:"monthlySessionsAllowed",value:f.monthlySessionsAllowed,onChange:x,min:"1",step:"1",disabled:s}),!m.loadingStats&&(0,Pt.jsxs)("span",{className:"help-text",children:["Current: ",m.currentMonthlySlots," / ",f.monthlySessionsAllowed]})]})]})]}),(0,Pt.jsxs)("div",{className:"info-box",children:[(0,Pt.jsx)("h4",{children:"Important Notes"}),(0,Pt.jsxs)("ul",{children:[(0,Pt.jsx)("li",{children:"Existing bookings will remain unchanged"}),(0,Pt.jsx)("li",{children:"You cannot lower limits below current slots"}),(0,Pt.jsx)("li",{children:"Changes take effect immediately"})]})]}),(0,Pt.jsxs)("div",{className:"form-actions",children:[(0,Pt.jsx)("button",{type:"button",onClick:n,className:"cancel-button",disabled:s,children:"Cancel"}),(0,Pt.jsxs)("button",{type:"submit",className:"submit-button",disabled:s,children:[(0,Pt.jsx)(wa,{size:18}),s?"Updating...":"Update Settings"]})]})]})]})},fg=()=>{const e=ge(),[t,a]=(0,r.useState)([]),[n,s]=(0,r.useState)([]),[i,o]=(0,r.useState)(!0),[l,c]=(0,r.useState)(null),[u,d]=(0,r.useState)("");(0,r.useEffect)(()=>{f()},[]),(0,r.useEffect)(()=>{h()},[u,t]);const f=async()=>{try{o(!0),c(null);const e=await ng.getAllPsychologists(1,100),t=Array.isArray(e)?e:e.data||[];a(t),s(t)}catch(e){c(e.message||"Failed to fetch psychologists"),console.error("Error fetching psychologists:",e)}finally{o(!1)}},h=()=>{let e=t;if(u.trim()){const t=u.toLowerCase();e=e.filter(e=>{var a,r;return(null===(a=e.name)||void 0===a?void 0:a.toLowerCase().includes(t))||(null===(r=e.email)||void 0===r?void 0:r.toLowerCase().includes(t))})}s(e)};return i?(0,Pt.jsxs)("div",{className:"loading-state",children:[(0,Pt.jsx)("div",{className:"spinner"}),(0,Pt.jsx)("p",{children:"Loading psychologists..."})]}):l?(0,Pt.jsxs)("div",{className:"error-message",children:[(0,Pt.jsx)(Yt,{size:20}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{children:l}),(0,Pt.jsx)("button",{onClick:f,className:"retry-button",children:"Retry"})]})]}):(0,Pt.jsxs)("div",{className:"availability-tab",children:[(0,Pt.jsx)("div",{className:"tab-header",children:(0,Pt.jsxs)("div",{className:"tab-header-left",children:[(0,Pt.jsx)(tg,{size:24}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("h2",{children:"Availability Management"}),(0,Pt.jsx)("p",{children:"Manage psychologist availability slots and holidays"})]})]})}),(0,Pt.jsx)("div",{className:"search-section",children:(0,Pt.jsxs)("div",{className:"search-box",children:[(0,Pt.jsx)(Ha,{size:18}),(0,Pt.jsx)("input",{type:"text",placeholder:"Search psychologist by name or email...",value:u,onChange:e=>d(e.target.value)})]})}),(0,Pt.jsx)("div",{className:"psychologists-grid",children:0===n.length?(0,Pt.jsx)("div",{className:"no-data",children:0===t.length?"No psychologists found.":"No psychologists match your search."}):n.map(t=>{var a;return(0,Pt.jsxs)("div",{className:"psychologist-card",children:[(0,Pt.jsxs)("div",{className:"card-header",children:[(0,Pt.jsx)("div",{className:"psychologist-avatar-large",children:(null===(a=t.name)||void 0===a?void 0:a.split(" ").map(e=>e[0]).join("").toUpperCase())||"?"}),(0,Pt.jsxs)("div",{className:"psychologist-details",children:[(0,Pt.jsx)("h3",{children:t.name}),(0,Pt.jsx)("p",{className:"email",children:t.email}),t.mobile_number&&(0,Pt.jsx)("p",{className:"phone",children:t.mobile_number})]})]}),(0,Pt.jsxs)("div",{className:"card-body",children:[t.degree&&(0,Pt.jsxs)("div",{className:"info-row",children:[(0,Pt.jsx)("span",{className:"label",children:"Degree:"}),(0,Pt.jsx)("span",{className:"value",children:t.degree})]}),t.languages&&t.languages.length>0&&(0,Pt.jsxs)("div",{className:"info-row",children:[(0,Pt.jsx)("span",{className:"label",children:"Languages:"}),(0,Pt.jsx)("span",{className:"value",children:t.languages.join(", ")})]})]}),(0,Pt.jsx)("div",{className:"card-footer",children:(0,Pt.jsxs)("button",{onClick:()=>(t=>{e("/admin/psychologists/".concat(t.id,"/availability"))})(t),className:"btn-manage-availability",children:[(0,Pt.jsx)(ca,{size:16}),"Manage Availability"]})})]},t.id)})})]})},hg=Vt("sliders-vertical",[["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M12 21v-9",key:"17s77i"}],["path",{d:"M12 8V3",key:"13r4qs"}],["path",{d:"M17 16h4",key:"h1uq16"}],["path",{d:"M19 12V3",key:"o1uvq1"}],["path",{d:"M19 21v-5",key:"qua636"}],["path",{d:"M3 14h4",key:"bcjad9"}],["path",{d:"M5 10V3",key:"cb8scm"}],["path",{d:"M5 21v-7",key:"1w1uti"}]]),mg=e=>{let{psychologist:t,onSuccess:a,onClose:n}=e;const[s,i]=(0,r.useState)(!1),[o,l]=(0,r.useState)(!0),[c,d]=(0,r.useState)(null),[f,h]=(0,r.useState)(null),[m,p]=(0,r.useState)({weeklyLimit:25,monthlyLimit:100}),[g,v]=(0,r.useState)({weekly:0,monthly:0});(0,r.useEffect)(()=>{if(console.log("=== BookingLimitsManager Debug ==="),console.log("Full psychologist object:",JSON.stringify(t,null,2)),console.log("psychologist.id:",null===t||void 0===t?void 0:t.id),console.log("psychologist.psychologist_id:",null===t||void 0===t?void 0:t.psychologist_id),console.log("psychologist.email:",null===t||void 0===t?void 0:t.email),console.log("All keys:",t?Object.keys(t):"null"),t){const e=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;Object.keys(t).forEach(a=>{const r=t[a];"string"===typeof r&&e.test(r)&&console.log('Found UUID in field "'.concat(a,'":'),r)})}console.log("==================================")},[t]);const y=(0,r.useCallback)(async()=>{try{l(!0),d(null);const e=t.psychologist_id||t.id;console.log("Using psychologist ID for fetch:",e);const a=await ng.getBookingLimits(e);a&&a.limits&&p({weeklyLimit:a.limits.weeklyLimit||25,monthlyLimit:a.limits.monthlyLimit||100}),a&&a.usage&&v({weekly:a.usage.weekly||0,monthly:a.usage.monthly||0})}catch(e){console.error("Error fetching booking limits:",e),d("Failed to load current booking limits. Using defaults.")}finally{l(!1)}},[null===t||void 0===t?void 0:t.id,null===t||void 0===t?void 0:t.psychologist_id]);(0,r.useEffect)(()=>{null!==t&&void 0!==t&&t.id&&y()},[null===t||void 0===t?void 0:t.id,y]);const b=e=>{const{name:t,value:a}=e.target,r=parseInt(a)||0;p(e=>u(u({},e),{},{[t]:r}))},w=(e,t)=>0===t?0:Math.min(e/t*100,100),x=e=>e>=90?"#ef4444":e>=70?"#f59e0b":"#10b981";return o?(0,Pt.jsx)("div",{className:"booking-limits-modal-overlay",children:(0,Pt.jsxs)("div",{className:"booking-limits-modal",children:[(0,Pt.jsxs)("div",{className:"modal-header",children:[(0,Pt.jsx)("h2",{children:"Booking Limits Manager"}),(0,Pt.jsx)("button",{onClick:n,className:"close-btn",children:(0,Pt.jsx)(fa,{size:20})})]}),(0,Pt.jsx)("div",{className:"modal-content loading-state",children:(0,Pt.jsx)("p",{children:"Loading booking limits..."})})]})}):(0,Pt.jsx)("div",{className:"booking-limits-modal-overlay",children:(0,Pt.jsxs)("div",{className:"booking-limits-modal",children:[(0,Pt.jsxs)("div",{className:"modal-header",children:[(0,Pt.jsxs)("h2",{children:[(0,Pt.jsx)(ca,{size:24}),"Booking Limits Manager"]}),(0,Pt.jsx)("button",{onClick:n,className:"close-btn",disabled:s,children:(0,Pt.jsx)(fa,{size:20})})]}),(0,Pt.jsxs)("div",{className:"modal-content",children:[(0,Pt.jsxs)("div",{className:"psychologist-info",children:[(0,Pt.jsx)("h3",{children:(null===t||void 0===t?void 0:t.name)||"".concat(null===t||void 0===t?void 0:t.firstName," ").concat(null===t||void 0===t?void 0:t.lastName)}),(0,Pt.jsx)("p",{className:"email",children:null===t||void 0===t?void 0:t.email}),(0,Pt.jsxs)("p",{className:"license",children:["License: ",null===t||void 0===t?void 0:t.licenseNumber]})]}),(0,Pt.jsxs)("div",{className:"usage-stats",children:[(0,Pt.jsxs)("h4",{children:[(0,Pt.jsx)(ga,{size:18}),"Current Usage"]}),(0,Pt.jsxs)("div",{className:"stats-grid",children:[(0,Pt.jsxs)("div",{className:"stat-card",children:[(0,Pt.jsxs)("div",{className:"stat-header",children:[(0,Pt.jsx)("span",{children:"Weekly"}),(0,Pt.jsxs)("span",{className:"stat-value",children:[g.weekly," / ",m.weeklyLimit]})]}),(0,Pt.jsx)("div",{className:"progress-bar",children:(0,Pt.jsx)("div",{className:"progress-fill",style:{width:"".concat(w(g.weekly,m.weeklyLimit),"%"),backgroundColor:x(w(g.weekly,m.weeklyLimit))}})}),(0,Pt.jsxs)("span",{className:"percentage",children:[w(g.weekly,m.weeklyLimit).toFixed(0),"% used"]})]}),(0,Pt.jsxs)("div",{className:"stat-card",children:[(0,Pt.jsxs)("div",{className:"stat-header",children:[(0,Pt.jsx)("span",{children:"Monthly"}),(0,Pt.jsxs)("span",{className:"stat-value",children:[g.monthly," / ",m.monthlyLimit]})]}),(0,Pt.jsx)("div",{className:"progress-bar",children:(0,Pt.jsx)("div",{className:"progress-fill",style:{width:"".concat(w(g.monthly,m.monthlyLimit),"%"),backgroundColor:x(w(g.monthly,m.monthlyLimit))}})}),(0,Pt.jsxs)("span",{className:"percentage",children:[w(g.monthly,m.monthlyLimit).toFixed(0),"% used"]})]})]})]}),(0,Pt.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),i(!0),d(null),h(null);try{if(m.weeklyLimit<=0||m.monthlyLimit<=0)throw new Error("All limits must be greater than 0");if(m.weeklyLimit>m.monthlyLimit)throw new Error("Weekly limit cannot exceed monthly limit");const e=t.psychologist_id||t.id;console.log("Using psychologist ID for submit:",e);if(!(await ng.setBookingLimits(e,m)).success)throw new Error("Failed to update booking limits");h("Booking limits updated successfully!"),setTimeout(()=>{null===a||void 0===a||a(),n()},1500)}catch(r){console.error("Error updating booking limits:",r),d(r.message||"Failed to update booking limits")}finally{i(!1)}},className:"limits-form",children:[(0,Pt.jsxs)("h4",{children:[(0,Pt.jsx)(tg,{size:18}),"Set Booking Limits"]}),(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsxs)("label",{htmlFor:"weeklyLimit",children:["Weekly Booking Limit",(0,Pt.jsx)("span",{className:"hint",children:"Maximum bookings allowed per week"})]}),(0,Pt.jsx)("input",{type:"number",id:"weeklyLimit",name:"weeklyLimit",value:m.weeklyLimit,onChange:b,min:"1",max:"200",required:!0,disabled:s})]}),(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsxs)("label",{htmlFor:"monthlyLimit",children:["Monthly Booking Limit",(0,Pt.jsx)("span",{className:"hint",children:"Maximum bookings allowed per month"})]}),(0,Pt.jsx)("input",{type:"number",id:"monthlyLimit",name:"monthlyLimit",value:m.monthlyLimit,onChange:b,min:"1",max:"500",required:!0,disabled:s})]}),c&&(0,Pt.jsxs)("div",{className:"error-message",children:[(0,Pt.jsx)(Yt,{size:16}),c]}),f&&(0,Pt.jsxs)("div",{className:"success-message",children:[(0,Pt.jsx)(Ua,{size:16}),f]}),(0,Pt.jsxs)("div",{className:"form-actions",children:[(0,Pt.jsx)("button",{type:"button",onClick:n,className:"btn-cancel",disabled:s,children:"Cancel"}),(0,Pt.jsx)("button",{type:"submit",className:"btn-save",disabled:s,children:s?(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)("span",{className:"spinner"}),"Saving..."]}):(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)(wa,{size:16}),"Save Limits"]})})]})]})]})]})})},pg=()=>{const[e,t]=(0,r.useState)([]),[a,n]=(0,r.useState)([]),[s,i]=(0,r.useState)(!0),[o,l]=(0,r.useState)(null),[c,u]=(0,r.useState)(""),[d,f]=(0,r.useState)(null),[h,m]=(0,r.useState)(!1);(0,r.useEffect)(()=>{p()},[]),(0,r.useEffect)(()=>{g()},[c,e]);const p=async()=>{try{i(!0),l(null);const e=await ng.getAllPsychologists(1,100),a=Array.isArray(e)?e:e.data||[];t(a),n(a)}catch(e){l(e.message||"Failed to fetch psychologists"),console.error("Error fetching psychologists:",e)}finally{i(!1)}},g=()=>{let t=e;if(c.trim()){const e=c.toLowerCase();t=t.filter(t=>{var a,r;return(null===(a=t.name)||void 0===a?void 0:a.toLowerCase().includes(e))||(null===(r=t.email)||void 0===r?void 0:r.toLowerCase().includes(e))})}n(t)};return s?(0,Pt.jsxs)("div",{className:"loading-state",children:[(0,Pt.jsx)("div",{className:"spinner"}),(0,Pt.jsx)("p",{children:"Loading psychologists..."})]}):o?(0,Pt.jsxs)("div",{className:"error-message",children:[(0,Pt.jsx)(Yt,{size:20}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{children:o}),(0,Pt.jsx)("button",{onClick:p,className:"retry-button",children:"Retry"})]})]}):(0,Pt.jsxs)("div",{className:"booking-tab",children:[(0,Pt.jsx)("div",{className:"tab-header",children:(0,Pt.jsxs)("div",{className:"tab-header-left",children:[(0,Pt.jsx)(hg,{size:24}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("h2",{children:"Booking Management"}),(0,Pt.jsx)("p",{children:"Manage psychologist booking limits and settings"})]})]})}),(0,Pt.jsx)("div",{className:"search-section",children:(0,Pt.jsxs)("div",{className:"search-box",children:[(0,Pt.jsx)(Ha,{size:18}),(0,Pt.jsx)("input",{type:"text",placeholder:"Search psychologist by name or email...",value:c,onChange:e=>u(e.target.value)})]})}),(0,Pt.jsx)("div",{className:"psychologists-grid",children:0===a.length?(0,Pt.jsx)("div",{className:"no-data",children:0===e.length?"No psychologists found.":"No psychologists match your search."}):a.map(e=>{var t;return(0,Pt.jsxs)("div",{className:"psychologist-card",children:[(0,Pt.jsxs)("div",{className:"card-header",children:[(0,Pt.jsx)("div",{className:"psychologist-avatar-large",children:(null===(t=e.name)||void 0===t?void 0:t.split(" ").map(e=>e[0]).join("").toUpperCase())||"?"}),(0,Pt.jsxs)("div",{className:"psychologist-details",children:[(0,Pt.jsx)("h3",{children:e.name}),(0,Pt.jsx)("p",{className:"email",children:e.email}),e.mobile_number&&(0,Pt.jsx)("p",{className:"phone",children:e.mobile_number})]})]}),(0,Pt.jsxs)("div",{className:"card-body",children:[(0,Pt.jsxs)("div",{className:"limits-info",children:[(0,Pt.jsxs)("div",{className:"limit-item",children:[(0,Pt.jsx)("span",{className:"limit-label",children:"Weekly Limit:"}),(0,Pt.jsx)("span",{className:"limit-value",children:e.weekly_booking_limit||"Not Set"})]}),(0,Pt.jsxs)("div",{className:"limit-item",children:[(0,Pt.jsx)("span",{className:"limit-label",children:"Monthly Limit:"}),(0,Pt.jsx)("span",{className:"limit-value",children:e.monthly_booking_limit||"Not Set"})]})]}),e.degree&&(0,Pt.jsxs)("div",{className:"info-row",children:[(0,Pt.jsx)("span",{className:"label",children:"Degree:"}),(0,Pt.jsx)("span",{className:"value",children:e.degree})]})]}),(0,Pt.jsx)("div",{className:"card-footer",children:(0,Pt.jsxs)("button",{onClick:()=>(e=>{f(e),m(!0)})(e),className:"btn-manage-booking",children:[(0,Pt.jsx)(ca,{size:16}),"Manage Booking Limits"]})})]},e.id)})}),h&&d&&(0,Pt.jsx)(mg,{psychologist:d,onSuccess:()=>{m(!1),p()},onClose:()=>m(!1)})]})},gg=e=>{let{onBack:t}=e;const a=ge(),[n,s]=(0,r.useState)([]),[i,o]=(0,r.useState)([]),[l,c]=(0,r.useState)(!0),[u,d]=(0,r.useState)(null),[f,h]=(0,r.useState)(""),[m,p]=(0,r.useState)(""),[g,v]=(0,r.useState)(""),[y,b]=(0,r.useState)("list"),[w,x]=(0,r.useState)(!1),[k,S]=(0,r.useState)(null),[E,T]=(0,r.useState)(null),[N,j]=(0,r.useState)("psychologists");(0,r.useEffect)(()=>{C()},[]),(0,r.useEffect)(()=>{_()},[f,m,g,n]);const C=async()=>{try{c(!0),d(null);const e=await ng.getAllPsychologists(1,100);s(Array.isArray(e)?e:e.data||[])}catch(e){d(e.message||"Failed to fetch psychologists"),console.error("Error fetching psychologists:",e)}finally{c(!1)}},_=()=>{let e=n;if(f.trim()){const t=f.toLowerCase();e=e.filter(e=>{var a,r,n,s,i;return(null===(a=e.name)||void 0===a?void 0:a.toLowerCase().includes(t))||(null===(r=e.firstName)||void 0===r?void 0:r.toLowerCase().includes(t))||(null===(n=e.lastName)||void 0===n?void 0:n.toLowerCase().includes(t))||(null===(s=e.email)||void 0===s?void 0:s.toLowerCase().includes(t))||(null===(i=e.licenseNumber)||void 0===i?void 0:i.toLowerCase().includes(t))})}m&&(e=e.filter(e=>{var t;return null===(t=e.specializations)||void 0===t?void 0:t.includes(m)})),g&&("active"===g?e=e.filter(e=>!e.is_disabled):"inactive"===g&&(e=e.filter(e=>!0===e.is_disabled))),o(e)},A=function(e){T({message:e,type:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success"}),setTimeout(()=>T(null),3e3)},P=e=>e.name||"".concat(e.firstName||""," ").concat(e.lastName||"").trim();return(0,Pt.jsxs)("div",{className:"psychologist-management-page",children:["add"===y&&(0,Pt.jsx)(lg,{onSuccess:()=>{b("list"),C(),A("Psychologist added successfully","success")},onBack:()=>b("list")}),"list"===y&&(0,Pt.jsxs)("div",{className:"psychologist-management",children:[(0,Pt.jsx)(Ta,{}),(0,Pt.jsxs)("button",{onClick:()=>{t?t():a("/admin/dashboard")},className:"back-button",children:[(0,Pt.jsx)(Ra,{size:20}),(0,Pt.jsx)("span",{children:"Back to Admin"})]}),(0,Pt.jsxs)("div",{className:"page-header",children:[(0,Pt.jsxs)("div",{className:"header-left",children:[(0,Pt.jsx)("h1",{children:"Psychologist Management"}),(0,Pt.jsx)("p",{children:"Manage psychologist profiles, availability, bookings, and settings"})]}),(0,Pt.jsxs)("button",{onClick:()=>b("add"),className:"btn-primary btn-small",children:[(0,Pt.jsx)(ka,{size:14}),"Add Psychologist"]})]}),(0,Pt.jsxs)("div",{className:"tabs-navigation",children:[(0,Pt.jsxs)("button",{className:"tab-button ".concat("psychologists"===N?"active":""),onClick:()=>j("psychologists"),children:[(0,Pt.jsx)(Sa,{size:16}),"Psychologists"]}),(0,Pt.jsxs)("button",{className:"tab-button ".concat("availability"===N?"active":""),onClick:()=>j("availability"),children:[(0,Pt.jsx)(tg,{size:16}),"Availability Management"]}),(0,Pt.jsxs)("button",{className:"tab-button ".concat("bookings"===N?"active":""),onClick:()=>j("bookings"),children:[(0,Pt.jsx)(ca,{size:16}),"Booking Management"]})]}),"psychologists"===N&&(0,Pt.jsxs)("div",{className:"filters-bar",children:[(0,Pt.jsxs)("div",{className:"search-box",children:[(0,Pt.jsx)(Ha,{size:18}),(0,Pt.jsx)("input",{type:"text",placeholder:"Search by name, email, or license...",value:f,onChange:e=>h(e.target.value)})]}),(0,Pt.jsxs)("div",{className:"filter-group",children:[(0,Pt.jsx)("label",{htmlFor:"specialization",children:"Specialization:"}),(0,Pt.jsxs)("select",{id:"specialization",value:m,onChange:e=>p(e.target.value),children:[(0,Pt.jsx)("option",{value:"",children:"All Specializations"}),["Anxiety Disorders","Depression","PTSD","Couples Therapy","Family Therapy","Child Psychology","Adolescent Psychology","Addiction Counseling","Grief Counseling","Cognitive Behavioral Therapy","Dialectical Behavior Therapy","EMDR","Mindfulness-Based Therapy","Trauma Therapy","Eating Disorders","OCD","Bipolar Disorder","ADHD","Autism Spectrum Disorders","Workplace Mental Health"].map(e=>(0,Pt.jsx)("option",{value:e,children:e},e))]})]}),(0,Pt.jsxs)("div",{className:"filter-group",children:[(0,Pt.jsx)("label",{htmlFor:"status",children:"Status:"}),(0,Pt.jsxs)("select",{id:"status",value:g,onChange:e=>v(e.target.value),children:[(0,Pt.jsx)("option",{value:"",children:"All Status"}),(0,Pt.jsx)("option",{value:"active",children:"Active"}),(0,Pt.jsx)("option",{value:"inactive",children:"Inactive"})]})]})]}),E&&(0,Pt.jsxs)("div",{className:"notification ".concat(E.type),children:[E.message,(0,Pt.jsx)("button",{className:"notification-close",onClick:()=>T(null),children:"\xd7"})]}),l&&(0,Pt.jsxs)("div",{className:"loading-state",children:[(0,Pt.jsx)("div",{className:"spinner"}),(0,Pt.jsx)("p",{children:"Loading data..."})]}),u&&(0,Pt.jsxs)("div",{className:"error-message",children:[(0,Pt.jsx)(Yt,{size:20}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("p",{children:u}),(0,Pt.jsx)("button",{onClick:C,className:"retry-button",children:"Retry"})]})]}),"psychologists"===N&&!l&&!u&&(0,Pt.jsx)("div",{className:"table-container",children:0===i.length?(0,Pt.jsx)("div",{className:"no-data",children:0===n.length?'No psychologists found. Click "Add Psychologist" to create one.':"No psychologists match your filters."}):(0,Pt.jsxs)("table",{className:"psychologists-table",children:[(0,Pt.jsx)("thead",{children:(0,Pt.jsxs)("tr",{children:[(0,Pt.jsx)("th",{children:"Name"}),(0,Pt.jsx)("th",{children:"Email"}),(0,Pt.jsx)("th",{children:"License"}),(0,Pt.jsx)("th",{children:"Specializations"}),(0,Pt.jsx)("th",{children:"Experience"}),(0,Pt.jsx)("th",{children:"Status"}),(0,Pt.jsx)("th",{children:"Actions"})]})}),(0,Pt.jsx)("tbody",{children:i.map(e=>{var t,a;return(0,Pt.jsxs)("tr",{children:[(0,Pt.jsx)("td",{children:(0,Pt.jsxs)("div",{className:"psychologist-info",children:[(0,Pt.jsx)("div",{className:"psychologist-avatar",children:P(e).split(" ").map(e=>e[0]).join("").toUpperCase()}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("div",{className:"psychologist-name",children:P(e)}),(0,Pt.jsx)("div",{className:"psychologist-email",children:e.email})]})]})}),(0,Pt.jsx)("td",{children:e.email}),(0,Pt.jsx)("td",{children:(0,Pt.jsx)("span",{className:"license-number",children:e.licenseNumber||"N/A"})}),(0,Pt.jsx)("td",{children:(0,Pt.jsxs)("div",{className:"specializations",children:[null===(t=e.specializations)||void 0===t?void 0:t.slice(0,2).map(e=>(0,Pt.jsx)("span",{className:"specialization-tag",children:e},e)),(null===(a=e.specializations)||void 0===a?void 0:a.length)>2&&(0,Pt.jsxs)("span",{className:"specialization-count",children:["+",e.specializations.length-2]})]})}),(0,Pt.jsx)("td",{children:(0,Pt.jsxs)("span",{className:"experience",children:[e.experience||0," years"]})}),(0,Pt.jsx)("td",{children:(0,Pt.jsxs)("span",{className:"status-badge ".concat(e.is_disabled?"disabled":"active"),children:[(0,Pt.jsx)("span",{className:"status-dot"}),e.is_disabled?"Disabled":"Active"]})}),(0,Pt.jsx)("td",{children:(0,Pt.jsxs)("div",{className:"actions",children:[(0,Pt.jsx)("button",{onClick:()=>(e=>{S(e),x(!0)})(e),className:"action-btn edit",title:"Settings",children:(0,Pt.jsx)(ua,{size:16})}),(0,Pt.jsx)("button",{onClick:()=>(async e=>{try{const t=!e.is_disabled;(t?await ng.disablePsychologist(e.id):await ng.enablePsychologist(e.id)).success&&(C(),A("".concat(P(e)," ").concat(t?"disabled":"enabled"," successfully"),"success"))}catch(t){A(t.message||"Failed to update status","error")}})(e),className:"action-btn power-btn ".concat(e.is_disabled?"disabled":"enabled"),title:e.is_disabled?"Enable":"Disable",children:(0,Pt.jsx)(ag,{size:16})}),(0,Pt.jsx)("button",{onClick:()=>(async(e,t)=>{if(window.confirm("Are you sure you want to delete ".concat(t,"? This action cannot be undone.")))try{await ng.deletePsychologistAdmin(e),s(t=>t.filter(t=>t.id!==e)),A("".concat(t," deleted successfully"),"success")}catch(a){A(a.message||"Failed to delete psychologist","error")}})(e.id,P(e)),className:"action-btn delete",title:"Delete",children:(0,Pt.jsx)($a,{size:16})})]})})]},e.id)})})]})}),"bookings"===N&&!l&&!u&&(0,Pt.jsx)(pg,{}),"availability"===N&&!l&&!u&&(0,Pt.jsx)(fg,{})]}),w&&k&&(0,Pt.jsx)("div",{className:"modal-overlay",onClick:()=>x(!1),children:(0,Pt.jsx)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:(0,Pt.jsx)(dg,{psychologist:k,onSuccess:()=>{x(!1),C(),A("Settings updated successfully","success")},onClose:()=>x(!1)})})})]})},vg=Vt("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),yg=Vt("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),bg="https://thoughtprob2b.thoughthealer.org/api/v1",wg=[{date:"2025-01-14",description:"Makar Sankranti / Pongal",type:"Festival"},{date:"2025-01-26",description:"Republic Day",type:"National"},{date:"2025-02-26",description:"Maha Shivaratri",type:"Festival"},{date:"2025-03-14",description:"Holi",type:"Festival"},{date:"2025-03-30",description:"Eid ul-Fitr",type:"Festival"},{date:"2025-03-31",description:"Ram Navami",type:"Festival"},{date:"2025-04-04",description:"Mahavir Jayanti",type:"Festival"},{date:"2025-04-10",description:"Rama Navami",type:"Festival"},{date:"2025-04-13",description:"Vaisakhi",type:"Festival"},{date:"2025-04-14",description:"Ambedkar Jayanti",type:"National"},{date:"2025-04-18",description:"Good Friday",type:"Festival"},{date:"2025-05-01",description:"May Day",type:"National"},{date:"2025-05-12",description:"Buddha Purnima",type:"Festival"},{date:"2025-06-06",description:"Eid ul-Adha",type:"Festival"},{date:"2025-07-06",description:"Muharram",type:"Festival"},{date:"2025-08-15",description:"Independence Day",type:"National"},{date:"2025-08-16",description:"Parsi New Year",type:"Festival"},{date:"2025-08-27",description:"Janmashtami",type:"Festival"},{date:"2025-09-05",description:"Milad un-Nabi",type:"Festival"},{date:"2025-10-02",description:"Gandhi Jayanti / Mahatma Gandhi Birthday",type:"National"},{date:"2025-10-02",description:"Dussehra",type:"Festival"},{date:"2025-10-20",description:"Diwali / Deepavali",type:"Festival"},{date:"2025-10-21",description:"Govardhan Puja",type:"Festival"},{date:"2025-11-05",description:"Guru Nanak Jayanti",type:"Festival"},{date:"2025-12-25",description:"Christmas",type:"Festival"}],xg=[{date:"2026-01-14",description:"Makar Sankranti / Pongal",type:"Festival"},{date:"2026-01-26",description:"Republic Day",type:"National"},{date:"2026-02-16",description:"Maha Shivaratri",type:"Festival"},{date:"2026-03-04",description:"Holi",type:"Festival"},{date:"2026-03-20",description:"Eid ul-Fitr",type:"Festival"},{date:"2026-03-28",description:"Ram Navami",type:"Festival"},{date:"2026-04-03",description:"Good Friday",type:"Festival"},{date:"2026-04-06",description:"Mahavir Jayanti",type:"Festival"},{date:"2026-04-13",description:"Vaisakhi",type:"Festival"},{date:"2026-04-14",description:"Ambedkar Jayanti",type:"National"},{date:"2026-05-01",description:"May Day",type:"National"},{date:"2026-05-01",description:"Buddha Purnima",type:"Festival"},{date:"2026-05-27",description:"Eid ul-Adha",type:"Festival"},{date:"2026-06-25",description:"Muharram",type:"Festival"},{date:"2026-08-15",description:"Independence Day",type:"National"},{date:"2026-08-15",description:"Janmashtami",type:"Festival"},{date:"2026-08-25",description:"Milad un-Nabi",type:"Festival"},{date:"2026-09-21",description:"Dussehra",type:"Festival"},{date:"2026-10-02",description:"Gandhi Jayanti / Mahatma Gandhi Birthday",type:"National"},{date:"2026-10-09",description:"Diwali / Deepavali",type:"Festival"},{date:"2026-10-10",description:"Govardhan Puja",type:"Festival"},{date:"2026-11-24",description:"Guru Nanak Jayanti",type:"Festival"},{date:"2026-12-25",description:"Christmas",type:"Festival"}],kg=[{date:"2024-01-14",description:"Makar Sankranti / Pongal",type:"Festival"},{date:"2024-01-26",description:"Republic Day",type:"National"},{date:"2024-03-08",description:"Maha Shivaratri",type:"Festival"},{date:"2024-03-25",description:"Holi",type:"Festival"},{date:"2024-03-29",description:"Good Friday",type:"Festival"},{date:"2024-04-11",description:"Eid ul-Fitr",type:"Festival"},{date:"2024-04-17",description:"Ram Navami",type:"Festival"},{date:"2024-04-21",description:"Mahavir Jayanti",type:"Festival"},{date:"2024-05-01",description:"May Day",type:"National"},{date:"2024-05-23",description:"Buddha Purnima",type:"Festival"},{date:"2024-06-17",description:"Eid ul-Adha",type:"Festival"},{date:"2024-07-17",description:"Muharram",type:"Festival"},{date:"2024-08-15",description:"Independence Day",type:"National"},{date:"2024-08-26",description:"Janmashtami",type:"Festival"},{date:"2024-09-16",description:"Milad un-Nabi",type:"Festival"},{date:"2024-10-02",description:"Gandhi Jayanti",type:"National"},{date:"2024-10-12",description:"Dussehra",type:"Festival"},{date:"2024-10-31",description:"Diwali / Deepavali",type:"Festival"},{date:"2024-11-01",description:"Govardhan Puja",type:"Festival"},{date:"2024-11-15",description:"Guru Nanak Jayanti",type:"Festival"},{date:"2024-12-25",description:"Christmas",type:"Festival"}],Sg={getHolidaysForYear:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(new Date).getFullYear();return 2026===e?xg:2025===e?wg:2024===e?kg:[]},getBackendHolidays:async()=>{try{const e=await fetch("".concat(bg,"/holidays"),{method:"GET",headers:{Authorization:"Bearer ".concat(localStorage.getItem("authToken"))}});if(!e.ok)throw new Error("Failed to fetch holidays from backend");const t=await e.json();let a=[];return Array.isArray(t)?a=t:t.data&&Array.isArray(t.data)?a=t.data:t.holidays&&Array.isArray(t.holidays)&&(a=t.holidays),a}catch(e){return console.error("Error fetching backend holidays:",e),[]}},getAllHolidays:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(new Date).getFullYear();try{const t=await Sg.getBackendHolidays(),a=Sg.getHolidaysForYear(e),r=Array.isArray(t)?t:[],n=Array.isArray(a)?a:[],s=new Map;return r.forEach(e=>{if(e&&e.date){const t=e.date.split("T")[0];s.set(t,e)}}),n.forEach(e=>{e&&e.date&&!s.has(e.date)&&s.set(e.date,e)}),Array.from(s.values())}catch(t){return console.error("Error getting all holidays:",t),Sg.getHolidaysForYear(e)}},syncHolidaysToBackend:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(new Date).getFullYear();try{const a=Sg.getHolidaysForYear(e),r=await Sg.getBackendHolidays(),n=new Set(r.map(e=>e.date.split("T")[0])),s=a.filter(e=>!n.has(e.date)),i=[];for(const e of s)try{(await fetch("".concat(bg,"/holidays"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("authToken"))},body:JSON.stringify({date:e.date,description:e.description})})).ok&&i.push({success:!0,holiday:e})}catch(t){console.error("Failed to sync holiday ".concat(e.description,":"),t),i.push({success:!1,holiday:e,error:t.message})}return i}catch(a){throw console.error("Error syncing holidays:",a),a}}},Eg=Vt("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),Tg="https://thoughtprob2b.thoughthealer.org/api/v1",Ng={getPsychologistsOverview:async()=>{try{const e=await fetch("".concat(Tg,"/admin/psychologists-overview"),{method:"GET",headers:{Authorization:"Bearer ".concat(localStorage.getItem("authToken"))}});if(!e.ok){const t=await e.json();throw new Error(t.message||"Failed to fetch psychologists overview")}return await e.json()}catch(e){throw console.error("Error fetching psychologists overview:",e),e}},getBookingsByPsychologist:async e=>{try{const t=await fetch("".concat(Tg,"/admin/psychologist-bookings/").concat(e),{method:"GET",headers:{Authorization:"Bearer ".concat(localStorage.getItem("authToken"))}});if(!t.ok){const e=await t.json();throw new Error(e.message||"Failed to fetch psychologist bookings")}return await t.json()}catch(t){throw console.error("Error fetching psychologist bookings:",t),t}},getAllBookings:async()=>{try{const e=await fetch("".concat(Tg,"/admin/all-bookings"),{method:"GET",headers:{Authorization:"Bearer ".concat(localStorage.getItem("authToken"))}});if(!e.ok){const t=await e.json();throw new Error(t.message||"Failed to fetch all bookings")}return await e.json()}catch(e){throw console.error("Error fetching all bookings:",e),e}},reassignBooking:async(e,t)=>{try{const a=await fetch("".concat(Tg,"/admin/bookings/").concat(e,"/reassign"),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("authToken"))},body:JSON.stringify({new_psychologist_id:t})});if(!a.ok){const e=await a.json();throw new Error(e.message||"Failed to reassign booking")}return await a.json()}catch(a){throw console.error("Error reassigning booking:",a),a}},disablePsychologist:async e=>{try{const t=await fetch("".concat(Tg,"/admin/psychologists/").concat(e,"/disable"),{method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.getItem("authToken"))}});if(!t.ok){const e=await t.json();throw new Error(e.message||"Failed to disable psychologist")}return await t.json()}catch(t){throw console.error("Error disabling psychologist:",t),t}},enablePsychologist:async e=>{try{const t=await fetch("".concat(Tg,"/admin/psychologists/").concat(e,"/enable"),{method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.getItem("authToken"))}});if(!t.ok){const e=await t.json();throw new Error(e.message||"Failed to enable psychologist")}return await t.json()}catch(t){throw console.error("Error enabling psychologist:",t),t}},getPsychologistStatus:async e=>{try{const t=await fetch("".concat(Tg,"/admin/psychologists/").concat(e,"/status"),{method:"GET",headers:{Authorization:"Bearer ".concat(localStorage.getItem("authToken"))}});if(!t.ok){const e=await t.json();throw new Error(e.message||"Failed to fetch psychologist status")}return await t.json()}catch(t){throw console.error("Error fetching psychologist status:",t),t}}},jg={getAllBookings:async()=>Ng.getAllBookings(),getBookingsByPsychologist:async e=>Ng.getBookingsByPsychologist(e),reassignBooking:async(e,t)=>Ng.reassignBooking(e,t),searchBookings:async e=>{try{const t=new URLSearchParams;Object.keys(e).forEach(a=>{e[a]&&t.append(a,e[a])});const a=await fetch("".concat(Tg,"/bookings/search?").concat(t.toString()),{method:"GET",headers:{Authorization:"Bearer ".concat(localStorage.getItem("authToken"))}});if(!a.ok){const e=await a.json();throw new Error(e.message||"Failed to search bookings")}return await a.json()}catch(t){throw console.error("Error searching bookings:",t),t}},getBookingDetails:async e=>{try{const t=await fetch("".concat(Tg,"/bookings/").concat(e),{method:"GET",headers:{Authorization:"Bearer ".concat(localStorage.getItem("authToken"))}});if(!t.ok){const e=await t.json();throw new Error(e.message||"Failed to fetch booking details")}return await t.json()}catch(t){throw console.error("Error fetching booking details:",t),t}},updateBookingStatus:async(e,t)=>{try{const a=await fetch("".concat(Tg,"/bookings/").concat(e),{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("authToken"))},body:JSON.stringify({status:t})});if(!a.ok){const e=await a.json();throw new Error(e.message||"Failed to update booking status")}return await a.json()}catch(a){throw console.error("Error updating booking status:",a),a}},updateBooking:async(e,t)=>{try{const a=await fetch("".concat(Tg,"/bookings/").concat(e),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("authToken"))},body:JSON.stringify(t)});if(!a.ok){const e=await a.json();throw new Error(e.message||"Failed to update booking")}return await a.json()}catch(a){throw console.error("Error updating booking:",a),a}},cancelBooking:async(e,t)=>{try{const a=await fetch("".concat(Tg,"/bookings/").concat(e),{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("authToken"))},body:JSON.stringify({status:"cancelled",cancellation_reason:t})});if(!a.ok){const e=await a.json();throw new Error(e.message||"Failed to cancel booking")}return await a.json()}catch(a){throw console.error("Error cancelling booking:",a),a}}},Cg=e=>{var t;let{psychologist:a,onClose:n}=e;const[s,i]=(0,r.useState)([]),[o,l]=(0,r.useState)(!1),[c,d]=(0,r.useState)(null),[f,h]=(0,r.useState)(null),[m,p]=(0,r.useState)("all"),[g,v]=(0,r.useState)([]),[y,b]=(0,r.useState)(null),[w,x]=(0,r.useState)(!1),[k,S]=(0,r.useState)(!1),[E,T]=(0,r.useState)(""),[N,j]=(0,r.useState)({appointment_date:"",start_time:"",end_time:"",session_type:"",status:"",notes:""});(0,r.useEffect)(()=>{C(),_()},[null===a||void 0===a?void 0:a.id]);const C=async()=>{try{if(l(!0),d(null),null!==a&&void 0!==a&&a.id){const e=await jg.getBookingsByPsychologist(a.id);i(Array.isArray(e)?e:e.bookings||[])}else{const e=await jg.getAllBookings();i(Array.isArray(e)?e:e.bookings||[])}}catch(e){d(e.message||"Failed to fetch bookings"),console.error("Error fetching bookings:",e)}finally{l(!1)}},_=async()=>{try{const e=await ng.getAllPsychologists(1,100);v(Array.isArray(e)?e:e.data||[])}catch(e){console.error("Error fetching psychologists:",e)}},A=function(e){h({message:e,type:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success"}),setTimeout(()=>h(null),3e3)},P=e=>{try{return new Date(e).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"})}catch(t){return"Invalid date"}},R=e=>{try{return new Date("2000-01-01 ".concat(e)).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})}catch(t){return e}},O=e=>{switch(e){case"confirmed":case"completed":return"success";case"pending":return"warning";case"cancelled":return"error";default:return"default"}},D="all"===m?s:s.filter(e=>{const t=new Date(e.date||e.appointmentDate),a=new Date;return"upcoming"===m?t>a&&"cancelled"!==e.status:"completed"===m?t<=a&&"cancelled"!==e.status:"cancelled"!==m||"cancelled"===e.status});return(0,Pt.jsxs)("div",{className:"booking-manager",children:[(0,Pt.jsxs)("div",{className:"manager-header",children:[(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("h2",{children:"Booking Management"}),a&&(0,Pt.jsx)("p",{className:"psychologist-subtitle",children:a.name||"".concat(a.firstName," ").concat(a.lastName)})]}),(0,Pt.jsx)("button",{onClick:n,className:"close-button",title:"Close",children:(0,Pt.jsx)(fa,{size:24})})]}),f&&(0,Pt.jsx)("div",{className:"notification ".concat(f.type),children:f.message}),(0,Pt.jsxs)("div",{className:"filter-tabs",children:[(0,Pt.jsxs)("button",{className:"filter-tab ".concat("all"===m?"active":""),onClick:()=>p("all"),children:["All Bookings",(0,Pt.jsx)("span",{className:"count",children:s.length})]}),(0,Pt.jsxs)("button",{className:"filter-tab ".concat("upcoming"===m?"active":""),onClick:()=>p("upcoming"),children:["Upcoming",(0,Pt.jsx)("span",{className:"count",children:s.filter(e=>new Date(e.date||e.appointmentDate)>new Date&&"cancelled"!==e.status).length})]}),(0,Pt.jsxs)("button",{className:"filter-tab ".concat("completed"===m?"active":""),onClick:()=>p("completed"),children:["Completed",(0,Pt.jsx)("span",{className:"count",children:s.filter(e=>new Date(e.date||e.appointmentDate)<=new Date&&"cancelled"!==e.status).length})]}),(0,Pt.jsxs)("button",{className:"filter-tab ".concat("cancelled"===m?"active":""),onClick:()=>p("cancelled"),children:["Cancelled",(0,Pt.jsx)("span",{className:"count",children:s.filter(e=>"cancelled"===e.status).length})]})]}),c&&(0,Pt.jsxs)("div",{className:"error-state",children:[(0,Pt.jsx)(Yt,{size:20}),(0,Pt.jsx)("p",{children:c}),(0,Pt.jsx)("button",{onClick:C,className:"retry-button",children:"Retry"})]}),o&&(0,Pt.jsxs)("div",{className:"loading-state",children:[(0,Pt.jsx)("div",{className:"spinner"}),(0,Pt.jsx)("p",{children:"Loading bookings..."})]}),!o&&!c&&(0,Pt.jsx)("div",{className:"bookings-container",children:0===D.length?(0,Pt.jsxs)("div",{className:"no-bookings",children:[(0,Pt.jsx)(ca,{size:48}),(0,Pt.jsx)("p",{children:"No bookings found"})]}):(0,Pt.jsx)("div",{className:"bookings-list",children:D.map(e=>{var t,a;return(0,Pt.jsxs)("div",{className:"booking-card",children:[(0,Pt.jsxs)("div",{className:"booking-header",children:[(0,Pt.jsxs)("div",{className:"booking-title",children:[(0,Pt.jsx)(ca,{size:18}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("h4",{children:e.clientName||(null===(t=e.client)||void 0===t?void 0:t.name)||"Client"}),(0,Pt.jsx)("p",{className:"booking-type",children:e.type||"Session"})]})]}),(0,Pt.jsx)("span",{className:"status-badge ".concat(O(e.status)),children:e.status})]}),(0,Pt.jsxs)("div",{className:"booking-details",children:[(0,Pt.jsxs)("div",{className:"detail-item",children:[(0,Pt.jsx)(tg,{size:16}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("span",{className:"detail-label",children:"Date & Time"}),(0,Pt.jsxs)("span",{className:"detail-value",children:[P(e.date||e.appointmentDate)," ","at ",R(e.time||e.appointmentTime)]})]})]}),(0,Pt.jsxs)("div",{className:"detail-item",children:[(0,Pt.jsx)(Sa,{size:16}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("span",{className:"detail-label",children:"Client Email"}),(0,Pt.jsx)("span",{className:"detail-value",children:e.clientEmail||(null===(a=e.client)||void 0===a?void 0:a.email)||"N/A"})]})]}),e.notes&&(0,Pt.jsxs)("div",{className:"detail-item",children:[(0,Pt.jsx)(Yt,{size:16}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("span",{className:"detail-label",children:"Notes"}),(0,Pt.jsx)("span",{className:"detail-value",children:e.notes})]})]})]}),(0,Pt.jsx)("div",{className:"booking-actions",children:"cancelled"!==e.status&&(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsxs)("button",{className:"action-btn edit",onClick:()=>(e=>{b(e),j({appointment_date:e.appointment_date||e.date||"",start_time:e.start_time||e.time||"",end_time:e.end_time||"",session_type:e.session_type||e.type||"45_minute",status:e.status||"pending",notes:e.notes||""}),S(!0)})(e),title:"Edit booking details",children:[(0,Pt.jsx)(Bp,{size:16}),"Edit"]}),(0,Pt.jsxs)("button",{className:"action-btn reassign",onClick:()=>{b(e),x(!0)},title:"Reassign to another psychologist",children:[(0,Pt.jsx)(Eg,{size:16}),"Reassign"]}),(0,Pt.jsxs)("button",{className:"action-btn cancel",onClick:()=>(async e=>{if(window.confirm("Are you sure you want to cancel this booking?"))try{await jg.cancelBooking(e,"Cancelled by admin"),C(),A("Booking cancelled successfully","success")}catch(t){A(t.message||"Failed to cancel booking","error")}})(e.id),title:"Cancel booking",children:[(0,Pt.jsx)($a,{size:16}),"Cancel"]})]})})]},e.id)})})}),w&&y&&(0,Pt.jsx)("div",{className:"modal-overlay",children:(0,Pt.jsxs)("div",{className:"modal-content reassign-modal",children:[(0,Pt.jsx)("h3",{children:"Reassign Booking"}),(0,Pt.jsx)("p",{className:"modal-subtitle",children:"Select a psychologist to reassign this booking to"}),(0,Pt.jsxs)("div",{className:"booking-info",children:[(0,Pt.jsxs)("p",{children:[(0,Pt.jsx)("strong",{children:"Client:"})," ",y.clientName||(null===(t=y.client)||void 0===t?void 0:t.name)||"Client"]}),(0,Pt.jsxs)("p",{children:[(0,Pt.jsx)("strong",{children:"Date:"})," ",P(y.date||y.appointmentDate)]}),(0,Pt.jsxs)("p",{children:[(0,Pt.jsx)("strong",{children:"Time:"})," ",R(y.time||y.appointmentTime)]})]}),(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsx)("label",{children:"Select Psychologist"}),(0,Pt.jsxs)("select",{value:E,onChange:e=>T(e.target.value),className:"psychologist-select",children:[(0,Pt.jsx)("option",{value:"",children:"-- Choose a psychologist --"}),g.filter(e=>e.id!==y.psychologistId).map(e=>(0,Pt.jsx)("option",{value:e.id,children:e.name||"".concat(e.firstName," ").concat(e.lastName)},e.id))]})]}),(0,Pt.jsxs)("div",{className:"modal-actions",children:[(0,Pt.jsx)("button",{onClick:()=>{x(!1),b(null),T("")},className:"btn-secondary",children:"Cancel"}),(0,Pt.jsx)("button",{onClick:async()=>{if(E)try{await jg.reassignBooking(y.id,E),C(),x(!1),b(null),T(""),A("Booking reassigned successfully","success")}catch(e){A(e.message||"Failed to reassign booking","error")}else A("Please select a psychologist","error")},className:"btn-primary",children:"Reassign Booking"})]})]})}),k&&y&&(0,Pt.jsx)("div",{className:"modal-overlay",children:(0,Pt.jsxs)("div",{className:"modal-content edit-modal",children:[(0,Pt.jsx)("h3",{children:"Edit Booking"}),(0,Pt.jsxs)("p",{className:"modal-subtitle",children:["Update booking details for ",y.clientName||"Client"]}),(0,Pt.jsxs)("div",{className:"edit-form",children:[(0,Pt.jsxs)("div",{className:"form-row",children:[(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsx)("label",{children:"Appointment Date"}),(0,Pt.jsx)("input",{type:"date",value:N.appointment_date,onChange:e=>j(u(u({},N),{},{appointment_date:e.target.value}))})]}),(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsx)("label",{children:"Start Time"}),(0,Pt.jsx)("input",{type:"time",value:N.start_time,onChange:e=>j(u(u({},N),{},{start_time:e.target.value}))})]}),(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsx)("label",{children:"End Time"}),(0,Pt.jsx)("input",{type:"time",value:N.end_time,onChange:e=>j(u(u({},N),{},{end_time:e.target.value}))})]})]}),(0,Pt.jsxs)("div",{className:"form-row",children:[(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsx)("label",{children:"Session Type"}),(0,Pt.jsxs)("select",{value:N.session_type,onChange:e=>j(u(u({},N),{},{session_type:e.target.value})),children:[(0,Pt.jsx)("option",{value:"45_minute",children:"45 Minute Session"}),(0,Pt.jsx)("option",{value:"20_minute",children:"20 Minute Session"}),(0,Pt.jsx)("option",{value:"emergency",children:"Emergency Session"})]})]}),(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsx)("label",{children:"Status"}),(0,Pt.jsxs)("select",{value:N.status,onChange:e=>j(u(u({},N),{},{status:e.target.value})),children:[(0,Pt.jsx)("option",{value:"pending",children:"Pending"}),(0,Pt.jsx)("option",{value:"confirmed",children:"Confirmed"}),(0,Pt.jsx)("option",{value:"completed",children:"Completed"}),(0,Pt.jsx)("option",{value:"cancelled",children:"Cancelled"})]})]})]}),(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsx)("label",{children:"Notes"}),(0,Pt.jsx)("textarea",{value:N.notes,onChange:e=>j(u(u({},N),{},{notes:e.target.value})),rows:"3",placeholder:"Add any notes or special instructions..."})]})]}),(0,Pt.jsxs)("div",{className:"modal-actions",children:[(0,Pt.jsx)("button",{onClick:()=>{S(!1),b(null)},className:"btn-secondary",children:"Cancel"}),(0,Pt.jsx)("button",{onClick:async()=>{try{await jg.updateBooking(y.id,N),C(),S(!1),b(null),A("Booking updated successfully","success")}catch(e){A(e.message||"Failed to update booking","error")}},className:"btn-primary",children:"Update Booking"})]})]})})]})},_g=()=>{var e;const{psychologistId:t}=ve(),a=ge(),[n,s]=(0,r.useState)(null),[i,o]=(0,r.useState)([]),[l,c]=(0,r.useState)([]),[d,f]=(0,r.useState)(new Date),[h,m]=(0,r.useState)(null),[p,g]=(0,r.useState)(!0),[v,y]=(0,r.useState)(!1),[b,w]=(0,r.useState)(!1),[x,k]=(0,r.useState)(null),[S,E]=(0,r.useState)(null),[T,N]=(0,r.useState)(null),[j,C]=(0,r.useState)(!1),[_,A]=(0,r.useState)({date:"",startTime:"09:00",endTime:"10:00",status:"Available"}),[P,R]=(0,r.useState)({numDays:30,startTime:"09:00",endTime:"18:00"}),[O,D]=(0,r.useState)(!1),[F,I]=(0,r.useState)(!1),[L,M]=(0,r.useState)("Unavailable"),z=["Available","Unavailable","Break"],U=r.useCallback(async()=>{try{g(!0),console.log("\ud83d\udd0d Loading psychologist data for ID:",t);const e=await ng.getPsychologistById(t),a=(null===e||void 0===e?void 0:e.data)||e;console.log("\u2705 Loaded psychologist data:",a),console.log("\ud83d\udc64 Psychologist ID from data:",null===a||void 0===a?void 0:a.id),console.log("\ud83d\udc64 Psychologist name:",null===a||void 0===a?void 0:a.name),s(a)}catch(e){const t=e.message||"Failed to load psychologist data";k(t),console.error("\u274c Failed to load psychologist:",e),e.technicalDetails&&E(e.technicalDetails),console.error(e)}finally{g(!1)}},[t]),B=r.useCallback(async()=>{try{console.log("Fetching availability for psychologist:",t);const e=await ug.getAvailabilityByPsychologist(t);console.log("Raw availability data received:",e);let a=[];Array.isArray(e)?a=e:(e&&Array.isArray(e.data)||e&&e.success&&Array.isArray(e.data))&&(a=e.data),console.log("Processed slots:",a),o(a)}catch(e){console.error("Error loading availability:",e);const t=e.message||"Failed to load availability data";k(t),e.technicalDetails&&E(e.technicalDetails),o([])}},[t]),W=(0,r.useCallback)(async()=>{try{const e=d.getFullYear(),t=await Sg.getAllHolidays(e);console.log("Loaded holidays:",t),c(t)}catch(e){console.error("Error loading holidays:",e);const t=d.getFullYear(),a=Sg.getHolidaysForYear(t);c(a)}},[d]);(0,r.useEffect)(()=>{U(),W()},[U,W]),(0,r.useEffect)(()=>{t&&B()},[t,B]),(0,r.useEffect)(()=>{W()},[W]);const H=e=>{if(!e)return[];if(!Array.isArray(i))return console.warn("Availability is not an array:",i),[];const t=e.toISOString().split("T")[0];return i.filter(e=>new Date(e.time_slot).toISOString().split("T")[0]===t)},V=e=>{if(!e||!Array.isArray(l))return null;const t=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0"),n="".concat(t,"-").concat(a,"-").concat(r),s=l.find(e=>{if(!e.date)return!1;return e.date.split("T")[0]===n});return s&&console.log("Holiday found for ".concat(n,":"),s),s},G=e=>{switch(null===e||void 0===e?void 0:e.toLowerCase()){case"available":return"status-available";case"unavailable":return"status-unavailable";case"break":return"status-break";default:return"status-default"}},$=e=>{switch(null===e||void 0===e?void 0:e.toLowerCase()){case"available":return(0,Pt.jsx)(Xa,{size:14});case"unavailable":return(0,Pt.jsx)(Up,{size:14});case"break":return(0,Pt.jsx)(tg,{size:14});default:return null}},q=e=>new Date(e).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0});return p?(0,Pt.jsxs)("div",{className:"availability-page",children:[(0,Pt.jsx)(Ta,{}),(0,Pt.jsxs)("div",{className:"loading-container",children:[(0,Pt.jsx)("div",{className:"spinner"}),(0,Pt.jsx)("p",{children:"Loading availability..."})]})]}):(0,Pt.jsxs)("div",{className:"availability-page",children:[(0,Pt.jsx)(Ta,{}),(0,Pt.jsxs)("div",{className:"availability-content",children:[(0,Pt.jsxs)("div",{className:"page-header",children:[(0,Pt.jsxs)("button",{onClick:()=>a(-1),className:"back-button",children:[(0,Pt.jsx)(Ra,{size:20}),(0,Pt.jsx)("span",{children:"Back"})]}),(0,Pt.jsxs)("div",{className:"page-title-section",children:[(0,Pt.jsxs)("div",{className:"psychologist-info",children:[(0,Pt.jsx)("div",{className:"avatar-large",children:(null===n||void 0===n||null===(e=n.name)||void 0===e?void 0:e.split(" ").map(e=>e[0]).join("").toUpperCase())||"?"}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("h1",{children:(null===n||void 0===n?void 0:n.name)||"Psychologist"}),(0,Pt.jsx)("p",{className:"subtitle",children:"Availability Management"})]})]}),(0,Pt.jsxs)("button",{onClick:()=>y(!0),className:"btn-view-bookings",children:[(0,Pt.jsx)(la,{size:18}),"View Bookings"]})]})]}),T&&(0,Pt.jsxs)("div",{className:"message success-message",children:[(0,Pt.jsx)(Xa,{size:20}),(0,Pt.jsx)("span",{children:T})]}),x&&(0,Pt.jsxs)("div",{className:"message error-message",children:[(0,Pt.jsx)(Yt,{size:20}),(0,Pt.jsxs)("div",{className:"error-content",children:[(0,Pt.jsx)("span",{className:"error-text",children:x}),S&&(0,Pt.jsxs)("details",{className:"error-technical-details",children:[(0,Pt.jsx)("summary",{children:"\ud83d\udd27 Technical Details (for developers)"}),(0,Pt.jsxs)("div",{className:"technical-info",children:[(0,Pt.jsxs)("div",{className:"tech-info-section",children:[(0,Pt.jsx)("strong",{children:"Endpoint:"}),(0,Pt.jsx)("code",{children:S.endpoint||"N/A"})]}),(0,Pt.jsxs)("div",{className:"tech-info-section",children:[(0,Pt.jsx)("strong",{children:"Method:"}),(0,Pt.jsx)("code",{children:S.method||"N/A"})]}),S.statusCode&&(0,Pt.jsxs)("div",{className:"tech-info-section",children:[(0,Pt.jsx)("strong",{children:"HTTP Status:"}),(0,Pt.jsxs)("code",{children:[S.statusCode," - ",S.statusText]})]}),S.validation&&(0,Pt.jsxs)("div",{className:"tech-info-section",children:[(0,Pt.jsx)("strong",{children:"Validation Error:"}),(0,Pt.jsx)("code",{children:S.validation})]}),S.responseData&&(0,Pt.jsxs)("div",{className:"tech-info-section",children:[(0,Pt.jsx)("strong",{children:"API Response:"}),(0,Pt.jsx)("pre",{children:JSON.stringify(S.responseData,null,2)})]}),S.requestPayload&&(0,Pt.jsxs)("div",{className:"tech-info-section",children:[(0,Pt.jsx)("strong",{children:"Request Payload:"}),(0,Pt.jsx)("pre",{children:JSON.stringify(S.requestPayload,null,2)})]}),S.timestamp&&(0,Pt.jsxs)("div",{className:"tech-info-section",children:[(0,Pt.jsx)("strong",{children:"Timestamp:"}),(0,Pt.jsx)("code",{children:new Date(S.timestamp).toLocaleString()})]}),(0,Pt.jsx)("button",{className:"btn-copy-error",onClick:()=>{navigator.clipboard.writeText(JSON.stringify(u({error:x},S),null,2)),alert("Error details copied to clipboard! Share this with the developer.")},children:"\ud83d\udccb Copy Error Details"})]})]})]})]}),(0,Pt.jsxs)("div",{className:"calendar-controls",children:[(0,Pt.jsxs)("button",{onClick:()=>{f(new Date(d.getFullYear(),d.getMonth()-1))},className:"nav-button",children:[(0,Pt.jsx)(vg,{size:20}),"Previous"]}),(0,Pt.jsxs)("h2",{className:"current-month",children:[["January","February","March","April","May","June","July","August","September","October","November","December"][d.getMonth()]," ",d.getFullYear()]}),(0,Pt.jsxs)("button",{onClick:()=>{f(new Date(d.getFullYear(),d.getMonth()+1))},className:"nav-button",children:["Next",(0,Pt.jsx)(yg,{size:20})]})]}),(0,Pt.jsxs)("div",{className:"quick-actions-bar",children:[(0,Pt.jsxs)("button",{onClick:()=>D(!0),className:"btn-quick-action bulk",title:"Create slots for multiple days (9 AM - 6 PM, skips weekends)",children:[(0,Pt.jsx)(ca,{size:16}),"Bulk Create Slots"]}),h&&(0,Pt.jsxs)("button",{onClick:()=>I(!0),className:"btn-quick-action toggle",disabled:ug.isPastDate(h),title:ug.isPastDate(h)?"Cannot modify past dates":"Set all slots for selected date to same status",children:[(0,Pt.jsx)(tg,{size:16}),"Toggle Entire Day"]})]}),(0,Pt.jsxs)("div",{className:"calendar-container",children:[(0,Pt.jsx)("div",{className:"calendar-header",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(e=>(0,Pt.jsx)("div",{className:"calendar-day-name",children:e},e))}),(0,Pt.jsx)("div",{className:"calendar-grid",children:(e=>{const t=e.getFullYear(),a=e.getMonth(),r=new Date(t,a,1),n=new Date(t,a+1,0).getDate(),s=r.getDay(),i=[];for(let o=0;o<s;o++)i.push(null);for(let o=1;o<=n;o++)i.push(new Date(t,a,o));return i})(d).map((e,t)=>{if(!e)return(0,Pt.jsx)("div",{className:"calendar-day empty"},"empty-".concat(t));const a=H(e),r=V(e),n=(new Date).toDateString()===e.toDateString(),s=(null===h||void 0===h?void 0:h.toDateString())===e.toDateString(),i=!!r;return(0,Pt.jsxs)("div",{className:"calendar-day ".concat(n?"today":""," ").concat(s?"selected":""," ").concat(a.length>0?"has-slots":""," ").concat(i?"has-holiday":""),onClick:()=>(e=>{h&&h.toDateString()===e.toDateString()?(m(null),A(u(u({},_),{},{date:""}))):(m(e),A(u(u({},_),{},{date:e.toISOString().split("T")[0]})))})(e),children:[(0,Pt.jsx)("div",{className:"day-number",children:e.getDate()}),r&&(0,Pt.jsxs)("div",{className:"holiday-indicator",title:r.description,children:[(0,Pt.jsx)("span",{className:"holiday-icon",children:"\ud83c\udf89"}),(0,Pt.jsx)("span",{className:"holiday-name",children:r.description})]}),a.length>0&&(0,Pt.jsxs)("div",{className:"day-slots",children:[a.slice(0,3).map((e,t)=>(0,Pt.jsx)("div",{className:"slot-indicator ".concat(G(e.availability_status)),title:"".concat(q(e.time_slot)," - ").concat(e.availability_status),children:$(e.availability_status)},t)),a.length>3&&(0,Pt.jsxs)("div",{className:"more-slots",children:["+",a.length-3]})]})]},t)})})]}),h&&(0,Pt.jsxs)("div",{className:"date-details",children:[(0,Pt.jsxs)("div",{className:"details-header",children:[(0,Pt.jsxs)("h3",{children:[(0,Pt.jsx)(ca,{size:20}),h.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),ug.isPastDate(h)&&(0,Pt.jsx)("span",{className:"past-date-badge",children:"Past Date - View Only"})]}),(0,Pt.jsxs)("button",{onClick:()=>C(!0),className:"btn-add-slot",disabled:ug.isPastDate(h),title:ug.isPastDate(h)?"Cannot add slots to past dates":"Add availability slot",children:[(0,Pt.jsx)(ka,{size:16}),"Add Slot"]})]}),V(h)&&(0,Pt.jsxs)("div",{className:"holiday-banner",children:[(0,Pt.jsx)("span",{className:"holiday-banner-icon",children:"\ud83c\udf89"}),(0,Pt.jsxs)("div",{className:"holiday-banner-content",children:[(0,Pt.jsx)("strong",{children:V(h).description}),(0,Pt.jsx)("small",{children:"This is a public holiday"})]})]}),(0,Pt.jsx)("div",{className:"slots-list",children:0===H(h).length?(0,Pt.jsxs)("div",{className:"no-slots",children:[(0,Pt.jsx)(tg,{size:32}),(0,Pt.jsx)("p",{children:"No availability slots for this day"}),(0,Pt.jsx)("button",{onClick:()=>C(!0),className:"btn-secondary",disabled:ug.isPastDate(h),children:"Add First Slot"})]}):H(h).sort((e,t)=>new Date(e.time_slot)-new Date(t.time_slot)).map(e=>{const t=new Date(e.time_slot),a=ug.isPastDate(t);return(0,Pt.jsxs)("div",{className:"slot-card ".concat(G(e.availability_status)," ").concat(a?"past-slot":""),children:[(0,Pt.jsxs)("div",{className:"slot-info",children:[(0,Pt.jsxs)("div",{className:"slot-time",children:[(0,Pt.jsx)(tg,{size:16}),q(e.time_slot),a&&(0,Pt.jsx)("span",{className:"past-label",children:"(Past - View Only)"})]}),(0,Pt.jsx)("select",{value:e.availability_status,onChange:a=>(async(e,t,a)=>{if(ug.isPastDate(a))return k("Cannot update slots for past dates. Past bookings are view-only."),void setTimeout(()=>k(null),5e3);try{w(!0),k(null),E(null);const a=await ug.updateSlotStatus(e,{availability_status:t});N(a.message||"Status updated successfully"),B(),setTimeout(()=>N(null),3e3)}catch(r){const e=r.message||"Failed to update status";k(e),r.technicalDetails&&E(r.technicalDetails),setTimeout(()=>{k(null),E(null)},1e4)}finally{w(!1)}})(e.id,a.target.value,t),className:"status-select",disabled:b||a,title:a?"Cannot edit past slots":"Change status",children:z.map(e=>(0,Pt.jsx)("option",{value:e,children:e},e))})]}),(0,Pt.jsx)("button",{onClick:()=>(async(e,t)=>{if(ug.isPastDate(t))return k("Cannot delete slots for past dates. Past bookings are view-only."),void setTimeout(()=>k(null),5e3);if(window.confirm("Are you sure you want to delete this slot?"))try{w(!0),k(null),E(null);const t=await ug.deleteSlot(e);N(t.message||"Slot deleted successfully"),B(),setTimeout(()=>N(null),3e3)}catch(a){const e=a.message||"Failed to delete slot";k(e),a.technicalDetails&&E(a.technicalDetails),setTimeout(()=>{k(null),E(null)},1e4)}finally{w(!1)}})(e.id,t),className:"btn-delete",disabled:b||a,title:a?"Cannot delete past slots":"Delete slot",children:(0,Pt.jsx)($a,{size:16})})]},e.id)})})]}),j&&(0,Pt.jsx)("div",{className:"modal-overlay",onClick:()=>C(!1),children:(0,Pt.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[(0,Pt.jsx)("div",{className:"modal-header",children:(0,Pt.jsx)("h3",{children:"Add Availability Slot"})}),(0,Pt.jsxs)("div",{className:"modal-body",children:[(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsx)("label",{children:"Date"}),(0,Pt.jsx)("input",{type:"date",value:_.date,min:(new Date).toISOString().split("T")[0],onChange:e=>A(u(u({},_),{},{date:e.target.value}))}),(0,Pt.jsx)("small",{className:"form-hint",children:"You can only create slots for today or future dates"})]}),(0,Pt.jsxs)("div",{className:"form-row",children:[(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsx)("label",{children:"Start Time"}),(0,Pt.jsx)("input",{type:"time",value:_.startTime,onChange:e=>A(u(u({},_),{},{startTime:e.target.value}))})]}),(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsx)("label",{children:"End Time"}),(0,Pt.jsx)("input",{type:"time",value:_.endTime,onChange:e=>A(u(u({},_),{},{endTime:e.target.value}))})]})]}),(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsx)("label",{children:"Status"}),(0,Pt.jsx)("select",{value:_.status,onChange:e=>A(u(u({},_),{},{status:e.target.value})),children:z.map(e=>(0,Pt.jsx)("option",{value:e,children:e},e))})]})]}),(0,Pt.jsxs)("div",{className:"modal-footer",children:[(0,Pt.jsx)("button",{onClick:()=>C(!1),className:"btn-secondary",disabled:b,children:"Cancel"}),(0,Pt.jsxs)("button",{onClick:async()=>{try{if(w(!0),k(null),E(null),ug.isPastDate(_.date))return k("Cannot create availability slots for past dates. You can only view past bookings."),void w(!1);if(!t)return k("Psychologist ID is missing. Please refresh the page."),void w(!1);const e="".concat(_.date,"T").concat(_.startTime,":00Z");console.log("\ud83d\udd0d Psychologist ID:",t),console.log("\ud83d\udd0d Psychologist object:",n),console.log("\ud83d\udd0d Creating slot with data:",{psychologist_id:t,time_slot:e,availability_status:_.status});const a=await ug.createSlot({psychologist_id:t,time_slot:e,availability_status:_.status});console.log("\u2705 Slot created successfully:",a),N(a.message||"Availability slot created successfully"),C(!1),A({date:"",startTime:"09:00",endTime:"10:00",status:"Available"}),console.log("\ud83d\udd04 Reloading availability data..."),await B(),console.log("\u2705 Availability reloaded successfully"),setTimeout(()=>N(null),3e3)}catch(e){console.error("\u274c Error adding slot:",e);const t=e.message||"Failed to add availability slot";k(t),e.technicalDetails&&E(e.technicalDetails),setTimeout(()=>{k(null),E(null)},1e4)}finally{w(!1)}},className:"btn-primary",disabled:b||!_.date,children:[(0,Pt.jsx)(wa,{size:16}),b?"Adding...":"Add Slot"]})]})]})}),O&&(0,Pt.jsx)("div",{className:"modal-overlay",onClick:()=>D(!1),children:(0,Pt.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[(0,Pt.jsxs)("div",{className:"modal-header",children:[(0,Pt.jsx)("h3",{children:"Bulk Create Availability Slots"}),(0,Pt.jsx)("p",{className:"modal-description",children:"Creates slots from 9 AM to 6 PM in 30-minute intervals. Automatically skips weekends and holidays."})]}),(0,Pt.jsxs)("div",{className:"modal-body",children:[(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsx)("label",{children:"Number of Days (Max 365)"}),(0,Pt.jsx)("input",{type:"number",value:P.numDays,onChange:e=>R(u(u({},P),{},{numDays:e.target.value})),min:"1",max:"365",placeholder:"30"}),(0,Pt.jsxs)("small",{children:["Slots will be created for the next ",P.numDays," days"]})]}),(0,Pt.jsxs)("div",{className:"form-row",children:[(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsx)("label",{children:"Start Time"}),(0,Pt.jsx)("input",{type:"time",value:P.startTime,onChange:e=>R(u(u({},P),{},{startTime:e.target.value}))})]}),(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsx)("label",{children:"End Time"}),(0,Pt.jsx)("input",{type:"time",value:P.endTime,onChange:e=>R(u(u({},P),{},{endTime:e.target.value}))})]})]}),(0,Pt.jsxs)("div",{className:"info-box",children:[(0,Pt.jsx)(Yt,{size:16}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("strong",{children:"Note:"})," This will create availability slots for all working hours. Existing slots will be skipped (no duplicates)."]})]})]}),(0,Pt.jsxs)("div",{className:"modal-footer",children:[(0,Pt.jsx)("button",{onClick:()=>D(!1),className:"btn-secondary",disabled:b,children:"Cancel"}),(0,Pt.jsxs)("button",{onClick:async()=>{try{w(!0),k(null),E(null);const e=await ug.createBulkSlots({psychologist_ids:[t],num_days:parseInt(P.numDays),start_time:P.startTime,end_time:P.endTime});N(e.message||"Successfully created slots for ".concat(P.numDays," days")),D(!1),B(),setTimeout(()=>N(null),3e3)}catch(e){console.error("Error creating bulk slots:",e);const t=e.message||"Failed to create bulk availability slots";k(t),e.technicalDetails&&E(e.technicalDetails),setTimeout(()=>{k(null),E(null)},1e4)}finally{w(!1)}},className:"btn-primary",disabled:b||!P.numDays,children:[(0,Pt.jsx)(ca,{size:16}),b?"Creating...":"Create ".concat(P.numDays," Days")]})]})]})}),F&&h&&(0,Pt.jsx)("div",{className:"modal-overlay",onClick:()=>I(!1),children:(0,Pt.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[(0,Pt.jsxs)("div",{className:"modal-header",children:[(0,Pt.jsx)("h3",{children:"Toggle Entire Day Status"}),(0,Pt.jsxs)("p",{className:"modal-description",children:["Set all slots for ",h.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})," to the same status."]})]}),(0,Pt.jsxs)("div",{className:"modal-body",children:[(0,Pt.jsxs)("div",{className:"form-group",children:[(0,Pt.jsx)("label",{children:"Set All Slots To"}),(0,Pt.jsx)("select",{value:L,onChange:e=>M(e.target.value),className:"large-select",children:z.map(e=>(0,Pt.jsx)("option",{value:e,children:e},e))})]}),(0,Pt.jsxs)("div",{className:"info-box",children:[(0,Pt.jsx)(Yt,{size:16}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("strong",{children:"Note:"})," This will update all existing slots for this date. Only slots that already exist will be affected."]})]})]}),(0,Pt.jsxs)("div",{className:"modal-footer",children:[(0,Pt.jsx)("button",{onClick:()=>I(!1),className:"btn-secondary",disabled:b,children:"Cancel"}),(0,Pt.jsxs)("button",{onClick:async()=>{if(h){if(ug.isPastDate(h))return k("Cannot modify availability for past dates. Past bookings are view-only."),void setTimeout(()=>k(null),5e3);try{w(!0),k(null),E(null);const e=h.toISOString().split("T")[0],a=await ug.toggleDayAvailability({psychologist_id:t,date:e,status:L});N(a.message||"All slots for ".concat(e," set to ").concat(L)),I(!1),B(),setTimeout(()=>N(null),3e3)}catch(e){console.error("Error toggling day:",e);const t=e.message||"Failed to toggle day availability";k(t),e.technicalDetails&&E(e.technicalDetails),setTimeout(()=>{k(null),E(null)},1e4)}finally{w(!1)}}},className:"btn-primary",disabled:b,children:[(0,Pt.jsx)(Xa,{size:16}),b?"Updating...":"Update All Slots"]})]})]})})]}),v&&n&&(0,Pt.jsx)("div",{className:"modal-overlay-full",children:(0,Pt.jsx)("div",{className:"modal-full-content",children:(0,Pt.jsx)(Cg,{psychologist:n,onClose:()=>y(!1)})})})]})},Ag=()=>{const[e,t]=(0,r.useState)([]),[a,n]=(0,r.useState)(!0),[s,i]=(0,r.useState)(null),[o,l]=(0,r.useState)(""),[c,d]=(0,r.useState)(1),[f,h]=(0,r.useState)(1),[m,p]=(0,r.useState)({status:"all",dateRange:"all",psychologist:"",company:""}),[g,v]=(0,r.useState)(!1),y=async()=>{try{n(!0);const e=await jg.getAllBookings(c,10,u(u({},m),{},{search:o}));e.success?(t(e.data.bookings||[]),h(Math.ceil((e.data.total||0)/10))):i(e.message||"Failed to fetch bookings")}catch(e){i(e.message)}finally{n(!1)}};(0,r.useEffect)(()=>{y()},[c,o,m]);const b=(e,t)=>{p(a=>u(u({},a),{},{[e]:t})),d(1)},w=async(e,t)=>{try{let a;switch(t){case"confirmed":a=await jg.confirmBooking(e);break;case"cancelled":a=await jg.cancelBooking(e,"Cancelled by admin");break;case"completed":a=await jg.completeBooking(e);break;default:return}a.success&&y()}catch(a){i(a.message)}};return a?(0,Pt.jsx)("div",{className:"booking-list-container",children:(0,Pt.jsx)("div",{className:"loading-spinner",children:"Loading bookings"})}):s?(0,Pt.jsx)("div",{className:"booking-list-container",children:(0,Pt.jsxs)("div",{className:"error-message",children:[(0,Pt.jsxs)("p",{children:["Error: ",s]}),(0,Pt.jsx)("button",{onClick:y,className:"retry-button",children:"Retry"})]})}):(0,Pt.jsxs)(Pt.Fragment,{children:[(0,Pt.jsx)(pa,{}),(0,Pt.jsx)("div",{className:"booking-list-container",children:(0,Pt.jsxs)("div",{className:"booking-list-content",children:[(0,Pt.jsxs)("div",{className:"booking-list-header",children:[(0,Pt.jsxs)("div",{className:"header-left",children:[(0,Pt.jsx)(ca,{size:32,className:"header-icon"}),(0,Pt.jsxs)("div",{children:[(0,Pt.jsx)("h1",{className:"page-title",children:"Booking Management"}),(0,Pt.jsx)("p",{className:"page-subtitle",children:"Manage therapy session bookings and schedules"})]})]}),(0,Pt.jsx)("div",{className:"header-actions",children:(0,Pt.jsxs)("button",{className:"create-booking-btn",onClick:()=>v(!0),children:[(0,Pt.jsx)(ka,{size:20}),"Create Booking"]})})]}),(0,Pt.jsxs)("div",{className:"filters-section",children:[(0,Pt.jsxs)("div",{className:"search-box",children:[(0,Pt.jsx)(Ha,{size:20,className:"search-icon"}),(0,Pt.jsx)("input",{type:"text",placeholder:"Search bookings...",value:o,onChange:e=>{l(e.target.value),d(1)},className:"search-input"})]}),(0,Pt.jsxs)("div",{className:"filters",children:[(0,Pt.jsxs)("select",{value:m.status,onChange:e=>b("status",e.target.value),className:"filter-select",children:[(0,Pt.jsx)("option",{value:"all",children:"All Status"}),(0,Pt.jsx)("option",{value:"pending",children:"Pending"}),(0,Pt.jsx)("option",{value:"confirmed",children:"Confirmed"}),(0,Pt.jsx)("option",{value:"in-progress",children:"In Progress"}),(0,Pt.jsx)("option",{value:"completed",children:"Completed"}),(0,Pt.jsx)("option",{value:"cancelled",children:"Cancelled"}),(0,Pt.jsx)("option",{value:"no-show",children:"No Show"})]}),(0,Pt.jsxs)("select",{value:m.dateRange,onChange:e=>b("dateRange",e.target.value),className:"filter-select",children:[(0,Pt.jsx)("option",{value:"all",children:"All Dates"}),(0,Pt.jsx)("option",{value:"today",children:"Today"}),(0,Pt.jsx)("option",{value:"tomorrow",children:"Tomorrow"}),(0,Pt.jsx)("option",{value:"this-week",children:"This Week"}),(0,Pt.jsx)("option",{value:"next-week",children:"Next Week"}),(0,Pt.jsx)("option",{value:"this-month",children:"This Month"})]}),(0,Pt.jsxs)("button",{className:"filter-btn",children:[(0,Pt.jsx)(Wp,{size:16}),"More Filters"]})]})]}),(0,Pt.jsxs)("div",{className:"bookings-table",children:[(0,Pt.jsx)("div",{className:"table-header",children:(0,Pt.jsxs)("div",{className:"table-row header-row",children:[(0,Pt.jsx)("div",{className:"table-cell",children:"Patient"}),(0,Pt.jsx)("div",{className:"table-cell",children:"Psychologist"}),(0,Pt.jsx)("div",{className:"table-cell",children:"Date & Time"}),(0,Pt.jsx)("div",{className:"table-cell",children:"Duration"}),(0,Pt.jsx)("div",{className:"table-cell",children:"Status"}),(0,Pt.jsx)("div",{className:"table-cell",children:"Type"}),(0,Pt.jsx)("div",{className:"table-cell",children:"Actions"})]})}),(0,Pt.jsx)("div",{className:"table-body",children:0===e.length?(0,Pt.jsxs)("div",{className:"empty-state",children:[(0,Pt.jsx)(ca,{size:64,className:"empty-icon"}),(0,Pt.jsx)("h3",{children:"No bookings found"}),(0,Pt.jsx)("p",{children:"No bookings match your current filters"}),(0,Pt.jsxs)("button",{onClick:()=>v(!0),className:"create-booking-btn primary",children:[(0,Pt.jsx)(ka,{size:20}),"Create First Booking"]})]}):e.map(e=>{var t,a,r,n,s,i,o,l,c,u,d,f,h;const{date:m,time:p}=(e=>{const t=new Date(e);return{date:t.toLocaleDateString(),time:t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}})(e.scheduledDateTime);return(0,Pt.jsxs)("div",{className:"table-row booking-row",children:[(0,Pt.jsx)("div",{className:"table-cell patient-cell",children:(0,Pt.jsxs)("div",{className:"patient-info",children:[(0,Pt.jsx)("div",{className:"patient-avatar",children:null!==(t=e.employee)&&void 0!==t&&t.profileImage?(0,Pt.jsx)("img",{src:e.employee.profileImage,alt:e.employee.name}):(0,Pt.jsxs)("div",{className:"avatar-placeholder",children:[null===(a=e.employee)||void 0===a||null===(r=a.firstName)||void 0===r?void 0:r.charAt(0),null===(n=e.employee)||void 0===n||null===(s=n.lastName)||void 0===s?void 0:s.charAt(0)]})}),(0,Pt.jsxs)("div",{className:"patient-details",children:[(0,Pt.jsxs)("span",{className:"patient-name",children:[null===(i=e.employee)||void 0===i?void 0:i.firstName," ",null===(o=e.employee)||void 0===o?void 0:o.lastName]}),(0,Pt.jsx)("span",{className:"patient-company",children:(null===(l=e.employee)||void 0===l||null===(c=l.company)||void 0===c?void 0:c.name)||"Unknown Company"})]})]})}),(0,Pt.jsx)("div",{className:"table-cell psychologist-cell",children:(0,Pt.jsxs)("div",{className:"psychologist-info",children:[(0,Pt.jsxs)("span",{className:"psychologist-name",children:["Dr. ",null===(u=e.psychologist)||void 0===u?void 0:u.firstName," ",null===(d=e.psychologist)||void 0===d?void 0:d.lastName]}),(0,Pt.jsx)("span",{className:"psychologist-specialization",children:(null===(f=e.psychologist)||void 0===f?void 0:f.specialization)||"Clinical Psychology"})]})}),(0,Pt.jsx)("div",{className:"table-cell datetime-cell",children:(0,Pt.jsxs)("div",{className:"datetime-info",children:[(0,Pt.jsxs)("div",{className:"date-info",children:[(0,Pt.jsx)(ca,{size:16,className:"datetime-icon"}),(0,Pt.jsx)("span",{children:m})]}),(0,Pt.jsxs)("div",{className:"time-info",children:[(0,Pt.jsx)(tg,{size:16,className:"datetime-icon"}),(0,Pt.jsx)("span",{children:p})]})]})}),(0,Pt.jsx)("div",{className:"table-cell duration-cell",children:(0,Pt.jsxs)("span",{children:[e.duration||60," mins"]})}),(0,Pt.jsx)("div",{className:"table-cell status-cell",children:(0,Pt.jsx)("span",{className:"status-badge ".concat((g=e.status,{pending:"status-pending",confirmed:"status-confirmed","in-progress":"status-in-progress",completed:"status-completed",cancelled:"status-cancelled","no-show":"status-no-show"}[g]||"status-pending")),children:(null===(h=e.status)||void 0===h?void 0:h.replace("-"," ").toUpperCase())||"PENDING"})}),(0,Pt.jsxs)("div",{className:"table-cell type-cell",children:[(0,Pt.jsx)("span",{className:"booking-type",children:e.type||"Individual"}),(0,Pt.jsx)("span",{className:"booking-mode",children:e.mode||"Video Call"})]}),(0,Pt.jsx)("div",{className:"table-cell actions-cell",children:(0,Pt.jsxs)("div",{className:"action-buttons",children:[(0,Pt.jsx)("button",{className:"action-btn view",title:"View Details",children:(0,Pt.jsx)(qt,{size:16})}),(0,Pt.jsx)("button",{className:"action-btn edit",title:"Edit Booking",children:(0,Pt.jsx)(Bp,{size:16})}),"pending"===e.status&&(0,Pt.jsx)("button",{className:"action-btn confirm",title:"Confirm Booking",onClick:()=>w(e.id,"confirmed"),children:"\u2713"}),("pending"===e.status||"confirmed"===e.status)&&(0,Pt.jsx)("button",{className:"action-btn cancel",title:"Cancel Booking",onClick:()=>w(e.id,"cancelled"),children:(0,Pt.jsx)(fa,{size:16})})]})})]},e.id);var g})})]}),f>1&&(0,Pt.jsxs)("div",{className:"pagination",children:[(0,Pt.jsx)("button",{onClick:()=>d(e=>Math.max(e-1,1)),disabled:1===c,className:"pagination-btn",children:"Previous"}),(0,Pt.jsxs)("span",{className:"pagination-info",children:["Page ",c," of ",f]}),(0,Pt.jsx)("button",{onClick:()=>d(e=>Math.min(e+1,f)),disabled:c===f,className:"pagination-btn",children:"Next"})]}),g&&(0,Pt.jsx)("div",{className:"modal-overlay",onClick:()=>v(!1),children:(0,Pt.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[(0,Pt.jsx)("h2",{children:"Create New Booking"}),(0,Pt.jsx)("p",{children:"Booking creation form would go here"}),(0,Pt.jsx)("button",{onClick:()=>v(!1),children:"Close"})]})})]})})]})},Pg=()=>{const[e,t]=(0,r.useState)(""),[a,n]=(0,r.useState)(!1),[s,i]=(0,r.useState)(!1),[o,l]=(0,r.useState)(""),c=ge();return s?(0,Pt.jsx)("div",{className:"login-container",children:(0,Pt.jsxs)("div",{className:"login-card company-login",children:[(0,Pt.jsxs)("div",{className:"login-header",children:[(0,Pt.jsx)("div",{className:"logo company-logo",children:(0,Pt.jsx)(ea,{size:40})}),(0,Pt.jsx)("h1",{className:"login-title",children:"Password Reset Sent"}),(0,Pt.jsx)("p",{className:"login-subtitle",children:"Check your personal email"})]}),(0,Pt.jsxs)("div",{className:"success-content",children:[(0,Pt.jsx)("div",{className:"success-icon",children:(0,Pt.jsx)(Xa,{size:48})}),(0,Pt.jsxs)("p",{className:"success-message",children:["We've sent a password reset link to your personal email address:",(0,Pt.jsxs)("strong",{children:[" ",e]})]}),(0,Pt.jsx)("p",{className:"success-instructions",children:"Please check your inbox and follow the instructions to reset your company account password."}),(0,Pt.jsx)("div",{className:"success-actions",children:(0,Pt.jsx)("button",{onClick:()=>c("/company/login"),className:"primary-button company-button",children:"Back to Login"})})]})]})}):(0,Pt.jsx)("div",{className:"login-container",children:(0,Pt.jsxs)("div",{className:"login-card company-login",children:[(0,Pt.jsxs)("div",{className:"login-header",children:[(0,Pt.jsx)("div",{className:"logo company-logo",children:(0,Pt.jsx)(ea,{size:40})}),(0,Pt.jsx)("h1",{className:"login-title",children:"Reset Password"}),(0,Pt.jsx)("p",{className:"login-subtitle",children:"Company account password recovery"})]}),(0,Pt.jsxs)("form",{onSubmit:async t=>{if(t.preventDefault(),l(""),i(!1),e)if(Kt(e)){n(!0);try{const t=await At.forgotPasswordCompany(e);t.success?i(!0):l(t.message||"Failed to send password reset email")}catch(a){console.error("Forgot password error:",a),l(a.message||"Failed to send password reset email. Please try again.")}finally{n(!1)}}else l("Please enter a valid email address");else l("Please enter your personal email address")},className:"login-form",children:[(0,Pt.jsx)("div",{className:"forgot-password-info",children:(0,Pt.jsx)("p",{children:"Enter your personal email address associated with your company account. We'll send you a secure link to reset your password."})}),(0,Pt.jsxs)("div",{className:"input-group",children:[(0,Pt.jsx)("label",{className:"label",children:"Personal Email Address"}),(0,Pt.jsx)("input",{type:"email",value:e,onChange:e=>t(e.target.value),placeholder:"your.personal@email.com",className:"input",disabled:a,required:!0}),(0,Pt.jsx)("small",{className:"input-hint",children:"This is your personal email, not your company email address"})]}),o&&(0,Pt.jsxs)("div",{className:"error",children:[(0,Pt.jsx)(Yt,{size:16}),o]}),(0,Pt.jsx)("button",{type:"submit",className:"primary-button company-button",disabled:a,children:a?"Sending...":"Send Reset Link"})]}),(0,Pt.jsxs)("div",{className:"login-footer",children:[(0,Pt.jsx)("div",{className:"back-to-login",children:(0,Pt.jsxs)(bt,{to:"/company/login",className:"back-link",children:[(0,Pt.jsx)(Ra,{size:16}),"Back to Company Login"]})}),(0,Pt.jsxs)("div",{className:"help-section",children:[(0,Pt.jsx)("h4",{children:"Need Help?"}),(0,Pt.jsx)("p",{children:"If you don't have access to your personal email or need assistance, please contact your system administrator."})]})]})]})})},Rg=e=>{let{children:t,requiredRole:a=null}=e;const{isAuthenticated:r,userRole:n}=It();return r?a&&n!==a?"admin"===a&&"super_admin"===n?t:(0,Pt.jsx)(De,{to:"/dashboard"}):t:(0,Pt.jsx)(De,{to:"/company/login"})},Og=()=>(0,Pt.jsx)(gg,{}),Dg=()=>{const{isAuthenticated:e,userRole:t}=It();return(0,Pt.jsxs)(Le,{children:[(0,Pt.jsx)(Fe,{path:"/login",element:(0,Pt.jsx)(Lt,{})}),(0,Pt.jsx)(Fe,{path:"/admin/login",element:e&&"admin"===t?(0,Pt.jsx)(De,{to:"/admin/dashboard"}):(0,Pt.jsx)(Jt,{})}),(0,Pt.jsx)(Fe,{path:"/admin",element:(0,Pt.jsx)(De,{to:"/admin/dashboard",replace:!0})}),(0,Pt.jsx)(Fe,{path:"/super-admin/login",element:e&&"super_admin"===t?(0,Pt.jsx)(De,{to:"/super-admin/dashboard"}):(0,Pt.jsx)(Zt,{})}),(0,Pt.jsx)(Fe,{path:"/super-admin",element:(0,Pt.jsx)(De,{to:"/super-admin/dashboard",replace:!0})}),(0,Pt.jsx)(Fe,{path:"/company/login",element:e?"admin"===t?(0,Pt.jsx)(De,{to:"/admin/dashboard"}):(0,Pt.jsx)(De,{to:"/dashboard"}):(0,Pt.jsx)(aa,{})}),(0,Pt.jsx)(Fe,{path:"/company",element:(0,Pt.jsx)(De,{to:"/company/login",replace:!0})}),(0,Pt.jsx)(Fe,{path:"/company/set-password",element:(0,Pt.jsx)(ra,{})}),(0,Pt.jsx)(Fe,{path:"/company/forgot-password",element:(0,Pt.jsx)(Pg,{})}),(0,Pt.jsx)(Fe,{path:"/admin/dashboard",element:(0,Pt.jsx)(Rg,{requiredRole:"admin",children:(0,Pt.jsx)(Na,{})})}),(0,Pt.jsx)(Fe,{path:"/super-admin/dashboard",element:(0,Pt.jsx)(Rg,{requiredRole:"super_admin",children:(0,Pt.jsx)(Na,{})})}),(0,Pt.jsx)(Fe,{path:"/dashboard",element:(0,Pt.jsx)(Rg,{children:(0,Pt.jsx)(Pa,{})})}),(0,Pt.jsx)(Fe,{path:"/admin/companies",element:(0,Pt.jsx)(Rg,{requiredRole:"admin",children:(0,Pt.jsx)(eg,{})})}),(0,Pt.jsx)(Fe,{path:"/admin/companies/add",element:(0,Pt.jsx)(Rg,{requiredRole:"admin",children:(0,Pt.jsx)(De,{to:"/admin/companies"})})}),(0,Pt.jsx)(Fe,{path:"/admin/companies/:id/edit",element:(0,Pt.jsx)(Rg,{requiredRole:"admin",children:(0,Pt.jsx)(eg,{})})}),(0,Pt.jsx)(Fe,{path:"/admin/psychologists",element:(0,Pt.jsx)(Rg,{requiredRole:"admin",children:(0,Pt.jsx)(gg,{})})}),(0,Pt.jsx)(Fe,{path:"/admin/psychologists/add",element:(0,Pt.jsx)(Rg,{requiredRole:"admin",children:(0,Pt.jsx)(De,{to:"/admin/psychologists"})})}),(0,Pt.jsx)(Fe,{path:"/admin/psychologists/:id/edit",element:(0,Pt.jsx)(Rg,{requiredRole:"admin",children:(0,Pt.jsx)(gg,{})})}),(0,Pt.jsx)(Fe,{path:"/admin/psychologists/:psychologistId/availability",element:(0,Pt.jsx)(Rg,{requiredRole:"admin",children:(0,Pt.jsx)(_g,{})})}),(0,Pt.jsx)(Fe,{path:"/companies",element:(0,Pt.jsx)(Rg,{requiredRole:"admin",children:(0,Pt.jsx)(De,{to:"/admin/companies"})})}),(0,Pt.jsx)(Fe,{path:"/companies/add",element:(0,Pt.jsx)(Rg,{requiredRole:"admin",children:(0,Pt.jsx)(De,{to:"/admin/companies"})})}),(0,Pt.jsx)(Fe,{path:"/psychologists/add",element:(0,Pt.jsx)(Rg,{children:(0,Pt.jsx)(De,{to:"/admin/psychologists"})})}),(0,Pt.jsx)(Fe,{path:"/settings",element:(0,Pt.jsx)(Rg,{children:(0,Pt.jsxs)("div",{style:{padding:"20px",textAlign:"center"},children:[(0,Pt.jsx)("h2",{children:"Settings"}),(0,Pt.jsx)("p",{children:"Settings functionality coming soon..."})]})})}),(0,Pt.jsx)(Fe,{path:"/companies/credentials",element:(0,Pt.jsx)(Rg,{requiredRole:"admin",children:(0,Pt.jsx)(De,{to:"/admin/companies"})})}),(0,Pt.jsx)(Fe,{path:"/add-employee",element:(0,Pt.jsx)(Rg,{children:(0,Pt.jsx)(za,{})})}),(0,Pt.jsx)(Fe,{path:"/employee-list",element:(0,Pt.jsx)(Rg,{children:(0,Pt.jsx)(zp,{})})}),(0,Pt.jsx)(Fe,{path:"/employees",element:(0,Pt.jsx)(Rg,{children:(0,Pt.jsx)(zp,{})})}),(0,Pt.jsx)(Fe,{path:"/psychologists",element:(0,Pt.jsx)(Rg,{requiredRole:"admin",children:(0,Pt.jsx)(Og,{})})}),(0,Pt.jsx)(Fe,{path:"/bookings",element:(0,Pt.jsx)(Rg,{requiredRole:"admin",children:(0,Pt.jsx)(Ag,{})})}),(0,Pt.jsx)(Fe,{path:"/",element:e?"admin"===t?(0,Pt.jsx)(De,{to:"/admin/dashboard"}):(0,Pt.jsx)(De,{to:"/dashboard"}):(0,Pt.jsx)(De,{to:"/company/login"})})]})};const Fg=function(){return(0,Pt.jsx)(vt,{children:(0,Pt.jsx)(Ot,{children:(0,Pt.jsx)(Ft,{children:(0,Pt.jsx)(Dg,{})})})})};n.createRoot(document.getElementById("root")).render((0,Pt.jsx)(r.StrictMode,{children:(0,Pt.jsx)(Fg,{})}))})();
//# sourceMappingURL=main.f3eb8063.js.map